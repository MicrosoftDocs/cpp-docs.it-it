---
description: 'Altre informazioni su: classe CTreeCtrl'
title: CTreeCtrl Class
ms.date: 11/04/2016
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
ms.openlocfilehash: 8b5c31138601c96ca7af530dbfb1d3517e3998a8
ms.sourcegitcommit: 6183207b11575d7b44ebd7c18918e916a0d8c63d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "97951522"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class

Fornisce la funzionalità del controllo di visualizzazione albero comune di Windows.

## <a name="syntax"></a>Sintassi

```
class CTreeCtrl : public CWnd
```

## <a name="members"></a>Members

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CTreeCtrl:: CTreeCtrl](#ctreectrl)|Costruisce un oggetto `CTreeCtrl`.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CTreeCtrl:: create](#create)|Crea un controllo di visualizzazione ad albero e lo collega a un `CTreeCtrl` oggetto.|
|[CTreeCtrl:: CreateDragImage](#createdragimage)|Crea una bitmap di trascinamento per l'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: CreateEx](#createex)|Crea un controllo struttura ad albero con gli stili estesi di Windows specificati e lo associa a un `CTreeCtrl` oggetto.|
|[CTreeCtrl::D eleteAllItems](#deleteallitems)|Elimina tutti gli elementi di un controllo di visualizzazione albero.|
|[CTreeCtrl::D eleteItem](#deleteitem)|Elimina un nuovo elemento in un controllo di visualizzazione albero.|
|[CTreeCtrl:: EditLabel](#editlabel)|Modifica sul posto un elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: EndEditLabelNow](#endeditlabelnow)|Annulla l'operazione di modifica sull'etichetta di un elemento della visualizzazione albero nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl:: EnsureVisible](#ensurevisible)|Garantisce che un elemento della visualizzazione struttura ad albero sia visibile nel controllo di visualizzazione albero.|
|[CTreeCtrl:: Expand](#expand)|Espande o comprime gli elementi figlio dell'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: GetBkColor](#getbkcolor)|Recupera il colore di sfondo corrente del controllo.|
|[CTreeCtrl:: GetCheck](#getcheck)|Recupera lo stato di selezione di un elemento del controllo Tree.|
|[CTreeCtrl:: GetChildItem](#getchilditem)|Recupera l'elemento figlio di un elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: GetCount](#getcount)|Recupera il numero di elementi della struttura ad albero associati a un controllo di visualizzazione albero.|
|[CTreeCtrl:: GetDropHilightItem](#getdrophilightitem)|Recupera la destinazione di un'operazione di trascinamento della selezione.|
|[CTreeCtrl:: GetEditControl](#geteditcontrol)|Recupera l'handle del controllo di modifica utilizzato per modificare l'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: GetExtendedStyle](#getextendedstyle)|Recupera gli stili estesi utilizzati dal controllo visualizzazione albero corrente.|
|[CTreeCtrl:: GetFirstVisibleItem](#getfirstvisibleitem)|Recupera il primo elemento visibile dell'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: GetImages](#getimagelist)|Recupera l'handle dell'elenco immagini associato a un controllo di visualizzazione albero.|
|[CTreeCtrl:: GetIndent](#getindent)|Recupera l'offset, in pixel, di un elemento della visualizzazione struttura ad albero dal padre.|
|[CTreeCtrl:: GetInsertMarkColor](#getinsertmarkcolor)|Recupera il colore utilizzato per creare il segno di inserimento per la visualizzazione albero.|
|[CTreeCtrl:: GetItem](#getitem)|Recupera gli attributi di un elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: GetItemData](#getitemdata)|Restituisce il valore specifico dell'applicazione associato a un elemento.|
|[CTreeCtrl:: GetItemExpandedImageIndex](#getitemexpandedimageindex)|Recupera l'indice dell'immagine da visualizzare quando l'elemento specificato del controllo di visualizzazione albero corrente è nello stato espanso.|
|[CTreeCtrl:: GetItemHeight](#getitemheight)|Recupera l'altezza corrente degli elementi della visualizzazione struttura ad albero.|
|[CTreeCtrl:: GetItemImage](#getitemimage)|Recupera le immagini associate a un elemento.|
|[CTreeCtrl:: GetItemPartRect](#getitempartrect)|Recupera il rettangolo di delimitazione per una parte specificata di un elemento specificato nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl:: GetItemRect](#getitemrect)|Recupera il rettangolo di delimitazione di un elemento della visualizzazione struttura ad albero.|
|[CTreeCtrl:: GetItemState](#getitemstate)|Restituisce lo stato di un elemento.|
|[CTreeCtrl:: GetItemStateEx](#getitemstateex)|Recupera lo stato esteso dell'elemento specificato nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl:: GetItemText](#getitemtext)|Restituisce il testo di un elemento.|
|[CTreeCtrl:: GetLastVisibleItem](#getlastvisibleitem)|Recupera l'ultimo elemento espanso nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl:: GetLineColor](#getlinecolor)|Recupera il colore della linea corrente per il controllo di visualizzazione ad albero.|
|[CTreeCtrl:: GetNextItem](#getnextitem)|Recupera l'elemento della visualizzazione struttura ad albero successivo che corrisponde a una relazione specificata.|
|[CTreeCtrl:: GetNextSiblingItem](#getnextsiblingitem)|Recupera l'elemento di pari livello successivo dell'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: GetNextVisibleItem](#getnextvisibleitem)|Recupera il successivo elemento visibile dell'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: GetParentItem](#getparentitem)|Recupera l'elemento padre dell'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: GetPrevSiblingItem](#getprevsiblingitem)|Recupera l'elemento di pari livello precedente dell'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: GetPrevVisibleItem](#getprevvisibleitem)|Recupera l'elemento visibile precedente dell'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: GetRootItem](#getrootitem)|Recupera la radice dell'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: GetScrollTime](#getscrolltime)|Recupera il tempo massimo di scorrimento per il controllo di visualizzazione ad albero.|
|[CTreeCtrl:: GetSelectedCount](#getselectedcount)|Recupera il numero di elementi selezionati nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl:: GetSelectedItem](#getselecteditem)|Recupera l'elemento della visualizzazione struttura ad albero correntemente selezionato.|
|[CTreeCtrl:: GetTextColor](#gettextcolor)|Recupera il colore del testo corrente del controllo.|
|[CTreeCtrl:: GetToolTips](#gettooltips)|Recupera l'handle per il controllo ToolTip figlio utilizzato da un controllo di visualizzazione albero.|
|[CTreeCtrl:: GetVisibleCount](#getvisiblecount)|Recupera il numero di elementi della struttura ad albero visibili associati a un controllo di visualizzazione albero.|
|[CTreeCtrl:: HitTest](#hittest)|Restituisce la posizione corrente del cursore correlato all' `CTreeCtrl` oggetto.|
|[CTreeCtrl:: InsertItem](#insertitem)|Inserisce un nuovo elemento in un controllo di visualizzazione albero.|
|[CTreeCtrl:: ItemHasChildren](#itemhaschildren)|Restituisce un valore diverso da zero se l'elemento specificato dispone di elementi figlio.|
|[CTreeCtrl:: MapAccIdToItem](#mapaccidtoitem)|Esegue il mapping dell'identificatore di accessibilità specificato all'handle a un elemento della visualizzazione albero nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl:: MapItemToAccID](#mapitemtoaccid)|Esegue il mapping dell'handle specificato a un elemento della visualizzazione struttura ad albero nel controllo di visualizzazione albero corrente a un identificatore di accessibilità.|
|[CTreeCtrl:: Select](#select)|Seleziona, scorre la visualizzazione o ritraccia un elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: SelectDropTarget](#selectdroptarget)|Ridisegnato l'elemento della struttura ad albero come destinazione di un'operazione di trascinamento della selezione.|
|[CTreeCtrl:: SelectItem](#selectitem)|Seleziona un elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: SelectSetFirstVisible](#selectsetfirstvisible)|Seleziona un elemento della visualizzazione struttura ad albero specificato come primo elemento visibile.|
|[CTreeCtrl:: SetAutoscrollInfo](#setautoscrollinfo)|Imposta la velocità di scorrimento automatico del controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl:: SetBkColor](#setbkcolor)|Imposta il colore di sfondo del controllo.|
|[CTreeCtrl:: secheck](#setcheck)|Imposta lo stato di selezione di un elemento di controllo della struttura ad albero.|
|[CTreeCtrl:: SetExtendedStyle](#setextendedstyle)|Imposta gli stili estesi per il controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl:: seimagine](#setimagelist)|Imposta l'handle dell'elenco immagini associato a un controllo di visualizzazione albero.|
|[CTreeCtrl:: sedent](#setindent)|Imposta l'offset, in pixel, di un elemento della visualizzazione struttura ad albero dal relativo elemento padre.|
|[CTreeCtrl:: SetInsertMark](#setinsertmark)|Imposta il segno di inserimento in un controllo di visualizzazione albero.|
|[CTreeCtrl:: SetInsertMarkColor](#setinsertmarkcolor)|Imposta il colore utilizzato per creare il segno di inserimento per la visualizzazione albero.|
|[CTreeCtrl:: SetItem](#setitem)|Imposta gli attributi di un elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl:: SetItemData](#setitemdata)|Imposta il valore specifico dell'applicazione associato a un elemento.|
|[CTreeCtrl:: SetItemExpandedImageIndex](#setitemexpandedimageindex)|Imposta l'indice dell'immagine da visualizzare quando l'elemento specificato del controllo visualizzazione albero corrente è nello stato espanso.|
|[CTreeCtrl:: SetItemHeight](#setitemheight)|Imposta l'altezza degli elementi della visualizzazione albero.|
|[CTreeCtrl:: SetItemImage](#setitemimage)|Associa le immagini a un elemento.|
|[CTreeCtrl:: SetItemState](#setitemstate)|Imposta lo stato di un elemento.|
|[CTreeCtrl:: SetItemStateEx](#setitemstateex)|Imposta lo stato esteso dell'elemento specificato nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl:: SetItemText](#setitemtext)|Imposta il testo di un elemento.|
|[CTreeCtrl:: SetLineColor](#setlinecolor)|Imposta il colore della linea corrente per il controllo di visualizzazione ad albero.|
|[CTreeCtrl:: SetScrollTime](#setscrolltime)|Imposta il tempo massimo di scorrimento per il controllo di visualizzazione albero.|
|[CTreeCtrl:: SetTextColor](#settextcolor)|Imposta il colore del testo del controllo.|
|[CTreeCtrl:: setooltips](#settooltips)|Imposta il controllo ToolTip figlio di un controllo di visualizzazione albero.|
|[CTreeCtrl:: ShowInfoTip](#showinfotip)|Visualizza il infotip per l'elemento specificato nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl:: SortChildren](#sortchildren)|Ordina gli elementi figlio di un elemento padre specificato.|
|[CTreeCtrl:: SortChildrenCB](#sortchildrencb)|Ordina gli elementi figlio di un elemento padre specificato utilizzando una funzione di ordinamento definita dall'applicazione.|

## <a name="remarks"></a>Commenti

Un "controllo di visualizzazione albero" è una finestra che visualizza un elenco gerarchico di elementi, ad esempio le intestazioni in un documento, le voci in un indice o i file e le directory su un disco. Ogni elemento è costituito da un'etichetta e da un'immagine bitmap facoltativa e a ogni elemento può essere associato un elenco di elementi secondari. Facendo clic su un elemento, l'utente può espandere e comprimere l'elenco associato di elementi secondari.

Questo controllo (e pertanto la `CTreeCtrl` classe) è disponibile solo per i programmi in esecuzione in windows 98 e Windows NT versione 4 e successive.

Per ulteriori informazioni sull'utilizzo di `CTreeCtrl` , vedere:

- [Controlli](../../mfc/controls-mfc.md)

- [Utilizzo di CTreeCtrl](../../mfc/using-ctreectrl.md)

- [Riferimento al controllo di visualizzazione albero](/windows/win32/Controls/tree-view-control-reference) nella Windows SDK.

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CTreeCtrl`

## <a name="requirements"></a>Requisiti

**Intestazione:** afxcmn.h

## <a name="ctreectrlcreate"></a><a name="create"></a> CTreeCtrl:: create

Se si specifica il controllo albero in un modello di finestra di dialogo o se si utilizza [CTreeView](../../mfc/reference/ctreeview-class.md), il controllo struttura ad albero viene creato automaticamente quando viene creata la finestra di dialogo o la vista.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Parametri

*dwStyle*<br/>
Specifica lo stile del controllo di visualizzazione albero. Applicare gli stili della finestra, descritti in [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww)e qualsiasi combinazione di [stili di controllo di visualizzazione ad albero](/windows/win32/Controls/tree-view-control-window-styles) , come descritto nell'Windows SDK.

*Rect*<br/>
Specifica la posizione e le dimensioni del controllo di visualizzazione albero. Può essere un oggetto [CRect](../../atl-mfc-shared/reference/crect-class.md) o una struttura [Rect](/windows/win32/api/windef/ns-windef-rect) .

*pParentWnd*<br/>
Specifica la finestra padre del controllo di visualizzazione albero, in genere `CDialog` . Non deve essere NULL.

*nID*<br/>
Specifica l'ID del controllo di visualizzazione albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'inizializzazione ha esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Commenti

Se si desidera creare il controllo albero come finestra figlio di un'altra finestra, utilizzare la `Create` funzione membro. Se si crea il controllo albero usando `Create` , è necessario passarlo WS_VISIBLE, oltre ad altri stili di visualizzazione ad albero.

Si costruisce un `CTreeCtrl` in due passaggi. Chiamare prima il costruttore, quindi chiamare `Create` , che crea il controllo di visualizzazione ad albero e lo collega all' `CTreeCtrl` oggetto.

Per creare un controllo struttura ad albero con stili estesi della finestra, chiamare [CreateEx](#createex) anziché `Create` .

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]

## <a name="ctreectrlcreateex"></a><a name="createex"></a> CTreeCtrl:: CreateEx

Chiamare questa funzione per creare un controllo, ovvero una finestra figlio, e associarlo all' `CTreeCtrl` oggetto.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Parametri

*dwExStyle*<br/>
Specifica lo stile esteso del controllo da creare. Per un elenco degli stili Windows estesi, vedere il parametro *dwExStyle* per [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw) nel Windows SDK.

*dwStyle*<br/>
Specifica lo stile del controllo di visualizzazione albero. Applicare gli stili della finestra, descritti in [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww)e qualsiasi combinazione di [stili di controllo di visualizzazione ad albero](/windows/win32/Controls/tree-view-control-window-styles) , come descritto nell'Windows SDK.

*Rect*<br/>
Riferimento a una struttura [Rect](/windows/win32/api/windef/ns-windef-rect) che descrive le dimensioni e la posizione della finestra da creare, nelle coordinate client di *pParentWnd*.

*pParentWnd*<br/>
Puntatore alla finestra che rappresenta l'elemento padre del controllo.

*nID*<br/>
ID della finestra figlio del controllo.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo, altrimenti 0.

### <a name="remarks"></a>Commenti

Usare `CreateEx` anziché [create](#create) per applicare gli stili estesi di Windows, specificati dall'introduzione allo stile esteso di Windows **WS_EX_**.

## <a name="ctreectrlcreatedragimage"></a><a name="createdragimage"></a> CTreeCtrl:: CreateDragImage

Chiamare questa funzione per creare una bitmap di trascinamento per l'elemento specificato in un controllo di visualizzazione ad albero, creare un elenco di immagini per la bitmap e aggiungere la bitmap all'elenco di immagini.

```
CImageList* CreateDragImage(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento della struttura ad albero da trascinare.

### <a name="return-value"></a>Valore restituito

Puntatore all'elenco di immagini a cui è stata aggiunta la bitmap di trascinamento; se ha esito positivo; in caso contrario, NULL.

### <a name="remarks"></a>Commenti

Un'applicazione usa le funzioni dell'elenco immagini per visualizzare l'immagine quando l'elemento viene trascinato.

L' `CImageList` oggetto è permanente ed è necessario eliminarlo al termine dell'operazione. Ad esempio:

[!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]

## <a name="ctreectrlctreectrl"></a><a name="ctreectrl"></a> CTreeCtrl:: CTreeCtrl

Costruisce un oggetto `CTreeCtrl`.

```
CTreeCtrl();
```

## <a name="ctreectrldeleteallitems"></a><a name="deleteallitems"></a> CTreeCtrl::D eleteAllItems

Chiamare questa funzione per eliminare tutti gli elementi dal controllo di visualizzazione albero.

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]

## <a name="ctreectrldeleteitem"></a><a name="deleteitem"></a> CTreeCtrl::D eleteItem

Chiamare questa funzione per eliminare un elemento dal controllo di visualizzazione albero.

```
BOOL DeleteItem(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento della struttura ad albero da eliminare. Se *hitet* ha il valore TVI_ROOT, tutti gli elementi vengono eliminati dal controllo di visualizzazione albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]

## <a name="ctreectrleditlabel"></a><a name="editlabel"></a> CTreeCtrl:: EditLabel

Chiamare questa funzione per iniziare la modifica sul posto del testo dell'elemento specificato.

```
CEdit* EditLabel(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento della struttura ad albero da modificare.

### <a name="return-value"></a>Valore restituito

In caso di esito positivo, puntatore all' `CEdit` oggetto utilizzato per modificare il testo dell'elemento; in caso contrario, null.

### <a name="remarks"></a>Commenti

La modifica viene eseguita sostituendo il testo dell'elemento con un controllo di modifica a riga singola contenente il testo.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]

## <a name="ctreectrlendeditlabelnow"></a><a name="endeditlabelnow"></a> CTreeCtrl:: EndEditLabelNow

Termina l'operazione di modifica sull'etichetta di un elemento della visualizzazione struttura ad albero nel controllo di visualizzazione ad albero corrente.

```
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```

### <a name="parameters"></a>Parametri

*fCancelWithoutSave*\
in TRUE per annullare le modifiche apportate all'elemento della visualizzazione struttura ad albero prima di terminare l'operazione di modifica oppure FALSE per salvare le modifiche apportate all'elemento della visualizzazione struttura ad albero prima di terminare l'operazione.

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TVM_ENDEDITLABELNOW](/windows/win32/Controls/tvm-endeditlabelnow) , descritto nel Windows SDK.

## <a name="ctreectrlensurevisible"></a><a name="ensurevisible"></a> CTreeCtrl:: EnsureVisible

Chiamare questa funzione per assicurarsi che un elemento della visualizzazione struttura ad albero sia visibile.

```
BOOL EnsureVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento della struttura ad albero reso visibile.

### <a name="return-value"></a>Valore restituito

Restituisce TRUE se il sistema ha eseguito lo scorrimento degli elementi nel controllo di visualizzazione albero per assicurarsi che l'elemento specificato sia visibile. In caso contrario, il valore restituito è FALSE.

### <a name="remarks"></a>Commenti

Se necessario, la funzione espande l'elemento padre o scorre il controllo di visualizzazione ad albero in modo che l'elemento sia visibile.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]

## <a name="ctreectrlexpand"></a><a name="expand"></a> CTreeCtrl:: Expand

Chiamare questa funzione per espandere o comprimere l'elenco di elementi figlio, se presenti, associato all'elemento padre specificato.

```
BOOL Expand(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento della struttura ad albero espanso.

*nCode*<br/>
Flag che indica il tipo di azione da intraprendere. Questo flag può avere uno dei valori seguenti:

- TVE_COLLAPSE comprime l'elenco.

- TVE_COLLAPSERESET comprime l'elenco e rimuove gli elementi figlio. Il flag di stato del TVIS_EXPANDEDONCE viene reimpostato. Questo flag deve essere utilizzato con il flag TVE_COLLAPSE.

- TVE_EXPAND espande l'elenco.

- TVE_TOGGLE comprime l'elenco se è attualmente espanso o lo espande se è attualmente compresso.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: EnsureVisible](#ensurevisible).

## <a name="ctreectrlgetbkcolor"></a><a name="getbkcolor"></a> CTreeCtrl:: GetBkColor

Questa funzione membro implementa il comportamento del [TVM_GETBKCOLOR](/windows/win32/Controls/tvm-getbkcolor)del messaggio Win32, come descritto nel Windows SDK.

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>Valore restituito

Valore COLORREF che rappresenta il colore di sfondo della finestra corrente per il controllo. Se questo valore è-1, il controllo Usa il colore della finestra di sistema. In questo caso, è possibile utilizzare `::GetSysColor(COLOR_WINDOW)` per ottenere il colore di sistema corrente utilizzato dal controllo.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: SetTextColor](#settextcolor).

## <a name="ctreectrlgetcheck"></a><a name="getcheck"></a> CTreeCtrl:: GetCheck

Chiamare questa funzione membro per recuperare lo stato di selezione di un elemento.

```
BOOL GetCheck(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
HTREEITEM su cui ricevere le informazioni sullo stato.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento del controllo Tree è selezionato; in caso contrario, 0.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: secheck](#setcheck).

## <a name="ctreectrlgetchilditem"></a><a name="getchilditem"></a> CTreeCtrl:: GetChildItem

Chiamare questa funzione per recuperare l'elemento della visualizzazione albero che è figlio dell'elemento specificato da *hitet*.

```
HTREEITEM GetChildItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento figlio in caso di esito positivo; in caso contrario, NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]

## <a name="ctreectrlgetcount"></a><a name="getcount"></a> CTreeCtrl:: GetCount

Chiamare questa funzione per recuperare un conteggio degli elementi in un controllo di visualizzazione albero.

```
UINT GetCount() const;
```

### <a name="return-value"></a>Valore restituito

Numero di elementi nel controllo di visualizzazione albero.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]

## <a name="ctreectrlgetdrophilightitem"></a><a name="getdrophilightitem"></a> CTreeCtrl:: GetDropHilightItem

Chiamare questa funzione per recuperare l'elemento che è la destinazione di un'operazione di trascinamento della selezione.

```
HTREEITEM GetDropHilightItem() const;
```

### <a name="return-value"></a>Valore restituito

Handle dell'elemento eliminato in caso di esito positivo; in caso contrario, NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlgeteditcontrol"></a><a name="geteditcontrol"></a> CTreeCtrl:: GetEditControl

Chiamare questa funzione per recuperare l'handle del controllo di modifica utilizzato per modificare il testo di un elemento della visualizzazione struttura ad albero.

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>Valore restituito

Puntatore al controllo di modifica utilizzato per modificare il testo dell'elemento, se ha esito positivo; in caso contrario, NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]

## <a name="ctreectrlgetextendedstyle"></a><a name="getextendedstyle"></a> CTreeCtrl:: GetExtendedStyle

Recupera gli stili estesi utilizzati dal controllo visualizzazione albero corrente.

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>Valore restituito

Valore che contiene una combinazione bit per bit (o) degli stili estesi del controllo visualizzazione albero corrente. Per altre informazioni, vedere [stili estesi del controllo di visualizzazione albero](/windows/win32/Controls/tree-view-control-window-extended-styles).

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TVM_GETEXTENDEDSTYLE](/windows/win32/Controls/tvm-getextendedstyle) , descritto nel Windows SDK.

## <a name="ctreectrlgetfirstvisibleitem"></a><a name="getfirstvisibleitem"></a> CTreeCtrl:: GetFirstVisibleItem

Chiamare questa funzione per recuperare il primo elemento visibile del controllo di visualizzazione ad albero.

```
HTREEITEM GetFirstVisibleItem() const;
```

### <a name="return-value"></a>Valore restituito

Handle del primo elemento visibile; in caso contrario, NULL.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: secheck](#setcheck).

## <a name="ctreectrlgetimagelist"></a><a name="getimagelist"></a> CTreeCtrl:: GetImages

Chiamare questa funzione per recuperare l'handle del normale elenco di immagini di stato associato al controllo di visualizzazione ad albero.

```
CImageList* GetImageList(UINT nImageList) const;
```

### <a name="parameters"></a>Parametri

*nImageList*<br/>
Tipo di elenco di immagini da recuperare. L'elenco di immagini può essere uno dei valori seguenti:

- TVSIL_NORMAL recupera l'elenco di immagini normale che contiene le immagini selezionate e non selezionate per l'elemento della visualizzazione struttura ad albero.

- TVSIL_STATE recupera l'elenco di immagini di stato, che contiene le immagini per gli elementi della visualizzazione struttura ad albero che si trovano in uno stato definito dall'utente.

### <a name="return-value"></a>Valore restituito

Puntatore all'elenco di immagini del controllo in caso di esito positivo; in caso contrario, NULL.

### <a name="remarks"></a>Commenti

A ogni elemento di un controllo di visualizzazione albero può essere associata una coppia di immagini bitmap. Quando l'elemento è selezionato, viene visualizzata un'immagine e l'altra viene visualizzata quando l'elemento non è selezionato. Ad esempio, un elemento potrebbe visualizzare una cartella aperta quando è selezionata e una cartella chiusa quando non è selezionata.

Per ulteriori informazioni sugli elenchi di immagini, vedere la classe [CImageList](../../mfc/reference/cimagelist-class.md) .

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]

## <a name="ctreectrlgetindent"></a><a name="getindent"></a> CTreeCtrl:: GetIndent

Chiamare questa funzione per recuperare la quantità, in pixel, in base alla quale gli elementi figlio vengono rientrati rispetto ai relativi elementi padre.

```
UINT GetIndent() const;
```

### <a name="return-value"></a>Valore restituito

Quantità di rientro misurato in pixel.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]

## <a name="ctreectrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a> CTreeCtrl:: GetInsertMarkColor

Questa funzione membro implementa il comportamento del [TVM_GETINSERTMARKCOLOR](/windows/win32/Controls/tvm-getinsertmarkcolor)del messaggio Win32, come descritto nel Windows SDK.

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>Valore restituito

Valore COLORREF che contiene il colore del segno di inserimento corrente.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]

## <a name="ctreectrlgetitem"></a><a name="getitem"></a> CTreeCtrl:: GetItem

Chiamare questa funzione per recuperare gli attributi dell'elemento della visualizzazione struttura ad albero specificato.

```
BOOL GetItem(TVITEM* pItem) const;
```

### <a name="parameters"></a>Parametri

*pItem*<br/>
Puntatore a una struttura [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) , come descritto nell'Windows SDK.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::D eleteitem](#deleteitem).

## <a name="ctreectrlgetitemdata"></a><a name="getitemdata"></a> CTreeCtrl:: GetItemData

Chiamare questa funzione per recuperare il valore specifico dell'applicazione associato all'elemento specificato.

```
DWORD_PTR GetItemData(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento i cui dati devono essere recuperati.

### <a name="return-value"></a>Valore restituito

Valore specifico dell'applicazione a dimensione del puntatore associato all'elemento specificato da *Hite*.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]

## <a name="ctreectrlgetitemexpandedimageindex"></a><a name="getitemexpandedimageindex"></a> CTreeCtrl:: GetItemExpandedImageIndex

Recupera l'indice dell'immagine da visualizzare quando l'elemento specificato del controllo di visualizzazione albero corrente è nello stato espanso.

```
int GetItemExpandedImageIndex(HTREEITEM hItem)const;
```

### <a name="parameters"></a>Parametri

*hItem*\
in Handle per un elemento di controllo di visualizzazione albero.

### <a name="return-value"></a>Valore restituito

Indice dell'immagine da visualizzare quando l'elemento specificato si trova nello stato espanso.

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TVM_GETITEM](/windows/win32/Controls/tvm-getitem) , descritto nel Windows SDK. Il messaggio restituisce la struttura [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) che descrive l'elemento di controllo di visualizzazione ad albero, quindi questo metodo recupera il `iExpandedImage` membro da tale struttura.

## <a name="ctreectrlgetitemheight"></a><a name="getitemheight"></a> CTreeCtrl:: GetItemHeight

Questa funzione membro implementa il comportamento del [TVM_GETITEMHEIGHT](/windows/win32/Controls/tvm-getitemheight)del messaggio Win32, come descritto nel Windows SDK.

```
SHORT GetItemHeight() const;
```

### <a name="return-value"></a>Valore restituito

Altezza dell'elemento, in pixel.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]

## <a name="ctreectrlgetitemimage"></a><a name="getitemimage"></a> CTreeCtrl:: GetItemImage

A ogni elemento di un controllo di visualizzazione albero può essere associata una coppia di immagini bitmap.

```
BOOL GetItemImage(
    HTREEITEM hItem,
    int& nImage,
    int& nSelectedImage) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento di cui deve essere recuperata l'immagine.

*nImage*<br/>
Intero che riceve l'indice dell'immagine dell'elemento all'interno dell'elenco immagini del controllo di visualizzazione albero.

*nSelectedImage*<br/>
Intero che riceve l'indice dell'immagine selezionata dell'elemento all'interno dell'elenco immagini del controllo di visualizzazione albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Le immagini vengono visualizzate sul lato sinistro dell'etichetta di un elemento. Quando l'elemento è selezionato, viene visualizzata un'immagine e l'altra viene visualizzata quando l'elemento non è selezionato. Ad esempio, un elemento potrebbe visualizzare una cartella aperta quando è selezionata e una cartella chiusa quando non è selezionata.

Chiamare questa funzione per recuperare l'indice dell'immagine dell'elemento e la relativa immagine selezionata nell'elenco immagini del controllo di visualizzazione albero.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]

## <a name="ctreectrlgetitempartrect"></a><a name="getitempartrect"></a> CTreeCtrl:: GetItemPartRect

Recupera il rettangolo di delimitazione per una parte specificata di un elemento specificato nel controllo di visualizzazione ad albero corrente.

```
BOOL GetItemPartRect(
    HTREEITEM hItem,
    int nPart,
    LPRECT lpRect)const;
```

### <a name="parameters"></a>Parametri

*hItem*\
in Handle per un elemento di controllo di visualizzazione albero.

*nPart*\
in Identificatore della parte. Deve essere impostato su TVGIPR_BUTTON.

*lpRect*\
out Puntatore a una struttura [Rect](/windows/win32/api/windef/ns-windef-rect) . Se questo metodo ha esito positivo, la struttura riceve le coordinate del rettangolo della parte specificata da *hitet* e *nPart*.

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Ogni elemento del controllo Tree è associato a un rettangolo grafico. Ogni volta che si fa clic su un punto nel rettangolo, viene detto che l'elemento viene *raggiunto*. Questo metodo restituisce il rettangolo più grande in modo tale che, quando si fa clic su un punto nel rettangolo, viene raggiunto l'elemento identificato dal parametro *Hitei* .

Questo metodo invia il messaggio di TVM_GETITEMPARTRECT, descritto nel Windows SDK. Per ulteriori informazioni, vedere la [TreeView_GetItemPartRect](/windows/win32/api/commctrl/nf-commctrl-treeview_getitempartrect) macro.

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene definita una variabile, `m_treeCtrl` , che viene utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un Unsigned Integer e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

L'esempio di codice seguente usa un identificatore di accessibilità e il metodo [CTreeCtrl:: MapAccIdToItem](#mapaccidtoitem) per recuperare un handle per l'elemento della visualizzazione albero radice. L'esempio usa quindi il metodo handle e il metodo [CTreeCtrl:: GetItemPartRect](#getitempartrect) per tracciare un rettangolo 3D intorno a tale elemento. In una sezione precedente dell'esempio di codice, che non viene visualizzato, è stata creata una visualizzazione albero costituita da un nodo paese/area radice per la Stati Uniti, sottonodi per gli Stati di Pennsylvania e Washington ed elementi di albero per le città in tali Stati. È stato usato il metodo [CTreeCtrl:: MapItemToAccID](#mapitemtoaccid) per associare l'elemento della visualizzazione albero radice a un identificatore di accessibilità.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlgetitemrect"></a><a name="getitemrect"></a> CTreeCtrl:: GetItemRect

Chiamare questa funzione per recuperare il rettangolo di delimitazione per *hitet* e determinare se è visibile o meno.

```
BOOL GetItemRect(
    HTREEITEM hItem,
    LPRECT lpRect,
    BOOL bTextOnly) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento di controllo di visualizzazione struttura ad albero.

*lpRect*<br/>
Puntatore a una struttura [Rect](/windows/win32/api/windef/ns-windef-rect) che riceve il rettangolo di delimitazione. Le coordinate sono relative all'angolo superiore sinistro del controllo di visualizzazione albero.

*bTextOnly*<br/>
Se questo parametro è diverso da zero, il rettangolo di delimitazione include solo il testo dell'elemento. In caso contrario, include l'intera riga occupata dall'elemento nel controllo di visualizzazione albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento è visibile, con il rettangolo di delimitazione contenuto in *lpRect*. In caso contrario, 0 con *lpRect* non inizializzato.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]

## <a name="ctreectrlgetitemstate"></a><a name="getitemstate"></a> CTreeCtrl:: GetItemState

Restituisce lo stato dell'elemento specificato da *hitet*.

```
UINT GetItemState(
    HTREEITEM hItem,
    UINT nStateMask) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento di cui deve essere recuperato lo stato.

*nStateMask*<br/>
Maschera che indica uno o più stati da recuperare. Per ulteriori informazioni sui valori possibili per *nStateMask*, vedere la discussione sui `state` membri e `stateMask` della struttura [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) nel Windows SDK.

### <a name="return-value"></a>Valore restituito

UINT che include l'OR bit per bit dei valori specificati da nStateMask. Per informazioni sui possibili valori, vedere [CTreeCtrl:: GetItem](#getitem). Per trovare il valore per uno stato specifico, eseguire un'operazione con AND bit per bit sul valore di stato e sul valore restituito, come illustrato nell'esempio seguente.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]

## <a name="ctreectrlgetitemstateex"></a><a name="getitemstateex"></a> CTreeCtrl:: GetItemStateEx

Recupera lo stato esteso dell'elemento specificato nel controllo di visualizzazione ad albero corrente.

```
UINT GetItemStateEx(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*\
in Handle per un elemento di controllo di visualizzazione albero.

### <a name="return-value"></a>Valore restituito

Stato esteso dell'elemento. Per ulteriori informazioni, vedere il `uStateEx` membro della struttura [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) .

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TVM_GETITEM](/windows/win32/Controls/tvm-getitem) , descritto nel Windows SDK. Il messaggio restituisce la struttura [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) che descrive l'elemento di controllo di visualizzazione ad albero e questo metodo recupera il `uStateEx` membro da tale struttura.

## <a name="ctreectrlgetitemtext"></a><a name="getitemtext"></a> CTreeCtrl:: GetItemText

Restituisce il testo dell'elemento specificato da *Hite*.

```
CString GetItemText(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento di cui deve essere recuperato il testo.

### <a name="return-value"></a>Valore restituito

`CString`Oggetto contenente il testo dell'elemento.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: GetNextItem](#getnextitem).

## <a name="ctreectrlgetlastvisibleitem"></a><a name="getlastvisibleitem"></a> CTreeCtrl:: GetLastVisibleItem

Recupera l'ultimo elemento del nodo non espanso nel controllo di visualizzazione ad albero corrente.

```
HTREEITEM GetLastVisibleItem() const;
```

### <a name="return-value"></a>Valore restituito

Handle per l'ultimo elemento del nodo non espanso se il metodo ha esito positivo; in caso contrario, NULL.

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TVM_GETNEXTITEM](/windows/win32/Controls/tvm-getnextitem) , descritto nel Windows SDK. Per ulteriori informazioni, vedere il flag TVGN_LASTVISIBLE nel parametro *flag* del messaggio.

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene definita una variabile, `m_treeCtrl` , che viene utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un Unsigned Integer e diverse variabili HTREEITEM. Nell'esempio seguente vengono usate una o più di queste variabili.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene recuperato un handle per l'ultimo elemento del nodo della visualizzazione albero non espansa, quindi viene disegnato un rettangolo 3D intorno a tale elemento. In una sezione precedente dell'esempio di codice, che non viene visualizzato, è stata creata una visualizzazione albero costituita da un nodo paese/area radice per la Stati Uniti, sottonodi per gli Stati di Pennsylvania e Washington ed elementi di albero per le città in tali Stati.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]

## <a name="ctreectrlgetlinecolor"></a><a name="getlinecolor"></a> CTreeCtrl:: GetLineColor

Questa funzione membro implementa il comportamento del [TVM_GETLINECOLOR](/windows/win32/Controls/tvm-getlinecolor)del messaggio Win32, come descritto nel Windows SDK.

```
COLORREF GetLineColor() const;
```

### <a name="return-value"></a>Valore restituito

Colore della linea corrente.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]

## <a name="ctreectrlgetnextitem"></a><a name="getnextitem"></a> CTreeCtrl:: GetNextItem

Chiamare questa funzione per recuperare l'elemento della visualizzazione struttura ad albero con la relazione specificata, indicata dal parametro *nCode* , in *Hite*.

```
HTREEITEM GetNextItem(
    HTREEITEM hItem,
    UINT nCode) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento della struttura ad albero.

*nCode*<br/>
Flag che indica il tipo di relazione a *hitee*. Questo flag può essere uno dei valori seguenti:

- TVGN_CARET recupera l'elemento attualmente selezionato.

- TVGN_CHILD recupera il primo elemento figlio dell'elemento specificato dal parametro *hitet* .

- TVGN_DROPHILITE recupera l'elemento che è la destinazione di un'operazione di trascinamento della selezione.

- TVGN_FIRSTVISIBLE recupera il primo elemento visibile.

- TVGN_LASTVISIBLE recupera l'ultimo elemento espanso nell'albero. L'ultimo elemento visualizzato nella finestra visualizzazione albero non viene recuperato.

- TVGN_NEXT Recupera il successivo elemento di pari livello.

- TVGN_NEXTVISIBLE recupera il successivo elemento visibile che segue l'elemento specificato.

- TVGN_PARENT recupera l'elemento padre dell'elemento specificato.

- TVGN_PREVIOUS recupera l'elemento di pari livello precedente.

- TVGN_PREVIOUSVISIBLE recupera il primo elemento visibile che precede l'elemento specificato.

- TVGN_ROOT Recupera il primo elemento figlio dell'elemento radice di cui l'elemento specificato fa parte.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento successivo in caso di esito positivo; in caso contrario, NULL.

### <a name="remarks"></a>Commenti

Questa funzione restituirà NULL se l'elemento da recuperare è il nodo radice dell'albero. Se, ad esempio, si utilizza questo messaggio con il flag TVGN_PARENT su un figlio di primo livello del nodo radice della visualizzazione albero, il messaggio restituirà NULL.

### <a name="example"></a>Esempio

Per un esempio dell'uso di `GetNextItem` in un ciclo, vedere [CTreeCtrl::D eleteitem](#deleteitem).

[!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]

## <a name="ctreectrlgetnextsiblingitem"></a><a name="getnextsiblingitem"></a> CTreeCtrl:: GetNextSiblingItem

Chiamare questa funzione per recuperare il successivo elemento di pari livello di *hitet*.

```
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Handle del successivo elemento di pari livello; in caso contrario, NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]

## <a name="ctreectrlgetnextvisibleitem"></a><a name="getnextvisibleitem"></a> CTreeCtrl:: GetNextVisibleItem

Chiamare questa funzione per recuperare il successivo elemento visibile di *hitey*.

```
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Handle del successivo elemento visibile; in caso contrario, NULL.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: secheck](#setcheck).

## <a name="ctreectrlgetparentitem"></a><a name="getparentitem"></a> CTreeCtrl:: GetParentItem

Chiamare questa funzione per recuperare l'elemento padre di *hitet*.

```
HTREEITEM GetParentItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento padre. in caso contrario, NULL.

### <a name="remarks"></a>Commenti

Questa funzione restituirà NULL se l'elemento padre dell'elemento specificato è il nodo radice dell'albero.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: EnsureVisible](#ensurevisible).

## <a name="ctreectrlgetprevsiblingitem"></a><a name="getprevsiblingitem"></a> CTreeCtrl:: GetPrevSiblingItem

Chiamare questa funzione per recuperare l'elemento di pari livello precedente di *hitet*.

```
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento di pari livello precedente; in caso contrario, NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]

## <a name="ctreectrlgetprevvisibleitem"></a><a name="getprevvisibleitem"></a> CTreeCtrl:: GetPrevVisibleItem

Chiamare questa funzione per recuperare l'elemento visibile precedente di *hitey*.

```
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento visibile precedente; in caso contrario, NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]

## <a name="ctreectrlgetrootitem"></a><a name="getrootitem"></a> CTreeCtrl:: GetRootItem

Chiamare questa funzione per recuperare l'elemento radice del controllo di visualizzazione ad albero.

```
HTREEITEM GetRootItem() const;
```

### <a name="return-value"></a>Valore restituito

Handle dell'elemento radice. in caso contrario, NULL.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: EditLabel](#editlabel).

## <a name="ctreectrlgetscrolltime"></a><a name="getscrolltime"></a> CTreeCtrl:: GetScrollTime

Chiamare questa funzione membro per recuperare il tempo massimo di scorrimento per il controllo di visualizzazione ad albero.

```
UINT GetScrollTime() const;
```

### <a name="return-value"></a>Valore restituito

Tempo massimo di scorrimento, in millisecondi.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TVM_GETSCROLLTIME](/windows/win32/Controls/tvm-getscrolltime)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctreectrlgetselectedcount"></a><a name="getselectedcount"></a> CTreeCtrl:: GetSelectedCount

Recupera il numero di elementi selezionati nel controllo di visualizzazione ad albero corrente.

```
UINT GetSelectedCount();
```

### <a name="return-value"></a>Valore restituito

Numero di elementi selezionati.

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TVM_GETSELECTEDCOUNT](/windows/win32/Controls/tvm-getselectedcount) , descritto nel Windows SDK.

## <a name="ctreectrlgetselecteditem"></a><a name="getselecteditem"></a> CTreeCtrl:: GetSelectedItem

Chiamare questa funzione per recuperare l'elemento attualmente selezionato del controllo di visualizzazione albero.

```
HTREEITEM GetSelectedItem() const;
```

### <a name="return-value"></a>Valore restituito

Handle dell'elemento selezionato; in caso contrario, NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]

## <a name="ctreectrlgettextcolor"></a><a name="gettextcolor"></a> CTreeCtrl:: GetTextColor

Questa funzione membro implementa il comportamento del [TVM_GETTEXTCOLOR](/windows/win32/Controls/tvm-gettextcolor)del messaggio Win32, come descritto nel Windows SDK.

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>Valore restituito

Valore COLORREF che rappresenta il colore del testo corrente. Se questo valore è-1, il controllo Usa il colore di sistema per il colore del testo.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: SetTextColor](#settextcolor).

## <a name="ctreectrlgettooltips"></a><a name="gettooltips"></a> CTreeCtrl:: GetToolTips

Questa funzione membro implementa il comportamento del [TVM_GETTOOLTIPS](/windows/win32/Controls/tvm-gettooltips)del messaggio Win32, come descritto nel Windows SDK.

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>Valore restituito

Puntatore a un oggetto [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) che deve essere utilizzato dal controllo struttura ad albero. Se la funzione membro [create](#create) usa lo stile TVS_NOTOOLTIPS, non viene usata alcuna descrizione comando e viene restituito null.

### <a name="remarks"></a>Commenti

L'implementazione MFC di `GetToolTips` restituisce un `CToolTipCtrl` oggetto, che viene utilizzato dal controllo struttura ad albero, anziché da un handle a un controllo ToolTip.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]

## <a name="ctreectrlgetvisiblecount"></a><a name="getvisiblecount"></a> CTreeCtrl:: GetVisibleCount

Chiamare questa funzione per recuperare un conteggio degli elementi visibili in un controllo di visualizzazione albero.

```
UINT GetVisibleCount() const;
```

### <a name="return-value"></a>Valore restituito

Numero di elementi visibili nel controllo di visualizzazione ad albero. in caso contrario,-1.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: secheck](#setcheck).

## <a name="ctreectrlhittest"></a><a name="hittest"></a> CTreeCtrl:: HitTest

Chiamare questa funzione per determinare la posizione del punto specificato rispetto all'area client di un controllo di visualizzazione albero.

```
HTREEITEM HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;

HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;
```

### <a name="parameters"></a>Parametri

*pt*<br/>
Coordinate client del punto da testare.

*pFlags*<br/>
Puntatore a un intero che riceve informazioni sui risultati dell'hit test. Può essere uno o più valori elencati sotto il `flags` membro nella sezione Osservazioni.

*pHitTestInfo*<br/>
Indirizzo di una struttura [TVHITTESTINFO](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo) che contiene la posizione di hit test e che riceve informazioni sui risultati dell'hit test.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento della visualizzazione struttura ad albero che occupa il punto specificato o NULL se nessun elemento occupa il punto.

### <a name="remarks"></a>Commenti

Quando viene chiamata questa funzione, il parametro *PT* specifica le coordinate del punto da testare. La funzione restituisce l'handle dell'elemento in corrispondenza del punto specificato o NULL se nessun elemento occupa il punto. Inoltre, il parametro *pFlags* contiene un valore che indica la posizione del punto specificato. I valori possibili sono:

|Valore|Descrizione|
|-|-|
|TVHT_ABOVE|Sopra l'area client.|
|TVHT_BELOW|Sotto l'area client.|
|TVHT_NOWHERE|Nell'area client, ma sotto l'ultimo elemento.|
|TVHT_ONITEM|Sulla bitmap o sull'etichetta associata a un elemento.|
|TVHT_ONITEMBUTTON|Sul pulsante associato a un elemento.|
|TVHT_ONITEMICON|Sulla bitmap associata a un elemento.|
|TVHT_ONITEMINDENT|Nel rientro associato a un elemento.|
|TVHT_ONITEMLABEL|Nell'etichetta (stringa) associata a un elemento.|
|TVHT_ONITEMRIGHT|Nell'area a destra di un elemento.|
|TVHT_ONITEMSTATEICON|Sull'icona di stato per un elemento della visualizzazione struttura ad albero che si trova in uno stato definito dall'utente.|
|TVHT_TOLEFT|A sinistra dell'area client.|
|TVHT_TORIGHT|A destra dell'area client.|

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlinsertitem"></a><a name="insertitem"></a> CTreeCtrl:: InsertItem

Chiamare questa funzione per inserire un nuovo elemento in un controllo di visualizzazione albero.

```
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

HTREEITEM InsertItem(
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    HTREEITEM hParent,
    HTREEITEM hInsertAfter);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);
```

### <a name="parameters"></a>Parametri

*lpInsertStruct*<br/>
Puntatore a un oggetto `TVINSERTSTRUCT` che specifica gli attributi dell'elemento della visualizzazione struttura ad albero da inserire.

*nMask*<br/>
Integer che specifica gli attributi da impostare. Vedere la `TVITEM` struttura nel Windows SDK.

*lpszItem*<br/>
Indirizzo di una stringa contenente il testo dell'elemento.

*nImage*<br/>
Indice dell'immagine dell'elemento nell'elenco immagini del controllo di visualizzazione albero.

*nSelectedImage*<br/>
Indice dell'immagine selezionata dell'elemento nell'elenco immagini del controllo di visualizzazione albero.

*nState*<br/>
Specifica i valori per gli Stati dell'elemento. Per un elenco degli stati appropriati, vedere gli Stati degli elementi di controllo di visualizzazione albero nella Windows SDK.

*nStateMask*<br/>
Specifica gli Stati da impostare. Vedere la `TVITEM` struttura nel Windows SDK.

*lParam*<br/>
Valore specifico dell'applicazione a dimensione del puntatore associato all'elemento.

*hParent*<br/>
Handle del padre dell'elemento inserito.

*hInsertAfter*<br/>
Handle dell'elemento dopo il quale deve essere inserito il nuovo elemento.

### <a name="return-value"></a>Valore restituito

Handle del nuovo elemento in caso di esito positivo; in caso contrario, NULL.

### <a name="remarks"></a>Commenti

Nell'esempio vengono illustrate le situazioni in cui potrebbe essere necessario utilizzare ogni versione della funzione quando si inserisce un elemento di controllo di struttura ad albero.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]

## <a name="ctreectrlitemhaschildren"></a><a name="itemhaschildren"></a> CTreeCtrl:: ItemHasChildren

Utilizzare questa funzione per determinare se l'elemento della struttura ad albero specificato da *Hite* ha elementi figlio.

```
BOOL ItemHasChildren(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento della struttura ad albero specificato da *Hite* è costituito da elementi figlio; 0 in caso contrario.

### <a name="remarks"></a>Commenti

In tal caso, è possibile usare [CTreeCtrl:: GetChildItem](#getchilditem) per recuperare gli elementi figlio.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: GetSelectedItem](#getselecteditem).

## <a name="ctreectrlmapaccidtoitem"></a><a name="mapaccidtoitem"></a> CTreeCtrl:: MapAccIdToItem

Esegue il mapping dell'identificatore di accessibilità specificato all'handle di un elemento della visualizzazione albero nel controllo di visualizzazione ad albero corrente.

```
HTREEITEM MapAccIdToItem(UINT uAccId) const;
```

### <a name="parameters"></a>Parametri

*uAccId*\
in Identificatore di accessibilità per un elemento nell'elemento della visualizzazione struttura ad albero.

### <a name="return-value"></a>Valore restituito

Handle per un elemento della visualizzazione struttura ad albero ( `HTREEITEM` ) che corrisponde al parametro *uAccId* . Per ulteriori informazioni, vedere il membro *hitey* della struttura [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) .

### <a name="remarks"></a>Commenti

Gli strumenti di accessibilità sono applicazioni che consentono agli utenti con disabilità di usare i computer. Un identificatore di accessibilità viene usato dall' `IAccessible` interfaccia per specificare in modo univoco un elemento in una finestra. Per ulteriori informazioni sulle `IAccessible` API, vedere [Microsoft Active Accessibility](/windows/win32/winauto/microsoft-active-accessibility).

Questo metodo invia il messaggio di [TVM_MAPACCIDTOHTREEITEM](/windows/win32/Controls/tvm-mapaccidtohtreeitem) , descritto nel Windows SDK.

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene definita una variabile, `m_treeCtrl` , che viene utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un Unsigned Integer e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

L'esempio di codice seguente usa un identificatore di accessibilità e il metodo [CTreeCtrl:: MapAccIdToItem](#mapaccidtoitem) per recuperare un handle per l'elemento della visualizzazione albero radice. L'esempio usa l'handle e il metodo [CTreeCtrl:: GetItemPartRect](#getitempartrect) per tracciare un rettangolo 3D intorno a tale elemento. In una sezione precedente dell'esempio di codice, che non viene visualizzato, è stata creata una visualizzazione albero costituita da un nodo paese/area radice per la Stati Uniti, sottonodi per gli Stati di Pennsylvania e Washington ed elementi di albero per le città in tali Stati. È stato usato il metodo [CTreeCtrl:: MapItemToAccID](#mapitemtoaccid) per associare l'elemento della visualizzazione albero radice a un identificatore di accessibilità.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlmapitemtoaccid"></a><a name="mapitemtoaccid"></a> CTreeCtrl:: MapItemToAccID

Esegue il mapping dell'handle specificato di un elemento della visualizzazione struttura ad albero nel controllo di visualizzazione albero corrente a un identificatore di accessibilità.

```
UINT MapItemToAccID(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*\
in Handle di un elemento della visualizzazione struttura ad albero nel controllo. Per ulteriori informazioni, vedere il membro *hitey* della struttura [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) .

### <a name="return-value"></a>Valore restituito

Identificatore di accessibilità che corrisponde al parametro *hitet* .

### <a name="remarks"></a>Commenti

Gli strumenti di accessibilità sono applicazioni che consentono agli utenti con disabilità di usare i computer. Un identificatore di accessibilità viene usato dall' `IAccessible` interfaccia per specificare in modo univoco un elemento in una finestra. Per ulteriori informazioni sulle `IAccessible` API, vedere [Microsoft Active Accessibility](/windows/win32/winauto/microsoft-active-accessibility).

Questo metodo invia il messaggio di [TVM_MAPHTREEITEMTOACCID](/windows/win32/Controls/tvm-maphtreeitemtoaccid) , descritto nel Windows SDK.

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene definita una variabile, `m_treeCtrl` , che viene utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un Unsigned Integer e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene ottenuto un numero di identificazione per un elemento di controllo di visualizzazione albero. In una sezione precedente dell'esempio di codice, che non viene visualizzato, è stata creata una visualizzazione albero costituita da un nodo paese/area radice per la Stati Uniti, sottonodi per gli Stati di Pennsylvania e Washington ed elementi di albero per le città in tali Stati. Questo esempio di codice ottiene un numero di identificazione univoco per il nodo paese/area radice.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]

## <a name="ctreectrlselect"></a><a name="select"></a> CTreeCtrl:: Select

Chiamare questa funzione per selezionare l'elemento della visualizzazione struttura ad albero specificato, scorrere l'elemento nella visualizzazione o ricreare l'elemento nello stile usato per indicare la destinazione di un'operazione di trascinamento della selezione.

```
BOOL Select(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento della struttura ad albero.

*nCode*<br/>
Tipo di azione da eseguire. Questo parametro può essere uno dei valori seguenti:

- TVGN_CARET imposta la selezione sull'elemento specificato.

- TVGN_DROPHILITE ridisegna l'elemento specificato nello stile usato per indicare la destinazione di un'operazione di trascinamento della selezione.

- TVGN_FIRSTVISIBLE scorre verticalmente la visualizzazione albero in modo che l'elemento specificato sia il primo elemento visibile.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Se *nCode* contiene il valore TVGN_CARET, la finestra padre riceve i messaggi di notifica TVN_SELCHANGING e TVN_SELCHANGED. Inoltre, se l'elemento specificato è figlio di un elemento padre compresso, l'elenco di elementi figlio dell'elemento padre viene espanso per rivelare l'elemento specificato. In questo caso, la finestra padre riceve il TVN_ITEMEXPANDING e TVN_ITEMEXPANDED i messaggi di notifica.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: HitTest](#hittest).

## <a name="ctreectrlselectdroptarget"></a><a name="selectdroptarget"></a> CTreeCtrl:: SelectDropTarget

Chiamare questa funzione per ricreare l'elemento nello stile usato per indicare la destinazione di un'operazione di trascinamento della selezione.

```
BOOL SelectDropTarget(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlselectitem"></a><a name="selectitem"></a> CTreeCtrl:: SelectItem

Chiamare questa funzione per selezionare l'elemento della visualizzazione struttura ad albero specificato.

```
BOOL SelectItem(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Se *Hite* è null, questa funzione non seleziona alcun elemento.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlselectsetfirstvisible"></a><a name="selectsetfirstvisible"></a> CTreeCtrl:: SelectSetFirstVisible

Chiamare questa funzione per scorrere la visualizzazione albero verticalmente in modo che l'elemento specificato sia il primo elemento visibile.

```
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento della struttura ad albero da impostare come primo elemento visibile.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

La funzione Invia un messaggio alla finestra con i parametri TVM_SELECTITEM e TVGN_FIRSTVISIBLE messaggio.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]

## <a name="ctreectrlsetautoscrollinfo"></a><a name="setautoscrollinfo"></a> CTreeCtrl:: SetAutoscrollInfo

Imposta la velocità di scorrimento automatico del controllo di visualizzazione ad albero corrente.

```
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,
    UINT uUpdateTime);
```

### <a name="parameters"></a>Parametri

*uPixelsPerSec*\
in Numero di pixel al secondo da scorrere.

*uUpdateTime*\
in Intervallo di tempo tra gli aggiornamenti del controllo.

### <a name="return-value"></a>Valore restituito

Restituisce sempre TRUE.

### <a name="remarks"></a>Commenti

I parametri di scorrimento automatico vengono usati per scorrere la visualizzazione di un elemento che attualmente non è visibile. Il controllo di visualizzazione albero deve avere lo stile esteso TVS_EX_AUTOHSCROLL, descritto in [stili estesi del controllo di visualizzazione albero](/windows/win32/Controls/tree-view-control-window-extended-styles).

Questo metodo invia il messaggio di [TVM_SETAUTOSCROLLINFO](/windows/win32/Controls/tvm-setautoscrollinfo) , descritto nel Windows SDK.

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene definita una variabile, `m_treeCtrl` , che viene utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un Unsigned Integer e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene impostato il comportamento di scorrimento automatico del controllo visualizzazione albero corrente. In una sezione precedente dell'esempio di codice, che non viene visualizzato, è stata creata una visualizzazione albero costituita da un nodo paese/area radice per la Stati Uniti, sottonodi per gli Stati di Pennsylvania e Washington ed elementi di albero per le città in tali Stati. Il controllo di visualizzazione albero è stato intenzionalmente ridotto in modo che sia necessario scorrere automaticamente per visualizzare l'elemento della struttura ad albero con lo stato attivo. Nell'esempio di codice viene impostato il controllo di visualizzazione albero per scorrere automaticamente 30 pixel al secondo ogni 5 secondi finché l'elemento della struttura ad albero non è in visualizzazione.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]

## <a name="ctreectrlsetbkcolor"></a><a name="setbkcolor"></a> CTreeCtrl:: SetBkColor

Questa funzione membro implementa il comportamento del [TVM_SETBKCOLOR](/windows/win32/Controls/tvm-setbkcolor)del messaggio Win32, come descritto nel Windows SDK.

```
COLORREF SetBkColor(COLORREF clr);
```

### <a name="parameters"></a>Parametri

*CLR*<br/>
Valore COLORREF che contiene il nuovo colore di sfondo. Se questo valore è-1, il controllo verrà ripristinato utilizzando il colore di sistema per il colore di sfondo.

### <a name="return-value"></a>Valore restituito

Valore COLORREF che rappresenta il colore del testo corrente. Se questo valore è-1, il controllo Usa il colore di sistema per il colore del testo.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: SetTextColor](#settextcolor).

## <a name="ctreectrlsetcheck"></a><a name="setcheck"></a> CTreeCtrl:: secheck

Chiamare questa funzione membro per impostare lo stato di selezione di un elemento del controllo Tree.

```
BOOL SetCheck(
    HTREEITEM hItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
HTREEITEM per ricevere la modifica dello stato di controllo.

*fCheck*<br/>
Indica se l'elemento di controllo dell'albero deve essere selezionato o deselezionato. Per impostazione predefinita, `SetCheck` imposta l'elemento da controllare.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Quando l'elemento del controllo Tree è selezionato ( *fCheck* impostato su true), l'elemento viene visualizzato con un segno di spunta adiacente.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]

### <a name="example"></a>Esempio

Per utilizzare le caselle di controllo, impostare TVS_CHECKBOXES prima di popolare il controllo albero.

[!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]

## <a name="ctreectrlsetextendedstyle"></a><a name="setextendedstyle"></a> CTreeCtrl:: SetExtendedStyle

Imposta gli stili estesi per il controllo di visualizzazione ad albero corrente.

```
DWORD SetExtendedStyle(
    DWORD dwExMask,
    DWORD dwExStyles);
```

### <a name="parameters"></a>Parametri

*dwExMask*\
in Maschera di bit che specifica gli stili del controllo visualizzazione albero corrente interessati da questo metodo. Se questo parametro è zero, viene ignorato e il valore del parametro *dwExStyles* viene assegnato al controllo di visualizzazione albero. Specificare zero o una combinazione bit per bit (o) di stili descritti in [stili estesi del controllo di visualizzazione albero](/windows/win32/Controls/tree-view-control-window-extended-styles).

*dwExStyles*\
in Maschera di bit che specifica gli stili del controllo visualizzazione albero corrente da impostare o deselezionare. Per impostare una combinazione di stili, specificare una combinazione bit per bit (o) di stili descritti in [stili estesi del controllo di visualizzazione albero](/windows/win32/Controls/tree-view-control-window-extended-styles). Per cancellare un set di stili, specificare zero.

### <a name="return-value"></a>Valore restituito

Valore che contiene gli stili dei controlli estesi precedenti.

### <a name="remarks"></a>Commenti

Questo metodo cancella gli stili specificati nel parametro *dwExMask* , quindi imposta gli stili specificati nel parametro *dwExStyles* . Solo gli stili estesi che corrispondono ai bit in *dwExMask* cambiano.

Questo metodo invia il messaggio di [TVM_SETEXTENDEDSTYLE](/windows/win32/Controls/tvm-setextendedstyle) , descritto nel Windows SDK.

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene definita una variabile, `m_treeCtrl` , che viene utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un Unsigned Integer e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene aggiunto il TVS_EX_AUTOHSCROLL stile esteso al controllo di visualizzazione ad albero corrente. In una sezione precedente dell'esempio di codice, che non viene visualizzato, è stata creata una visualizzazione albero costituita da un nodo paese/area radice per la Stati Uniti, sottonodi per gli Stati di Pennsylvania e Washington ed elementi di albero per le città in tali Stati. Il controllo di visualizzazione albero è stato intenzionalmente ridotto in modo che sia necessario scorrere automaticamente per visualizzare l'elemento della struttura ad albero con lo stato attivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]

## <a name="ctreectrlsetimagelist"></a><a name="setimagelist"></a> CTreeCtrl:: seimagine

Chiamare questa funzione per impostare l'elenco di immagini normale o di stato per un controllo di visualizzazione albero e ricreare il controllo usando le nuove immagini.

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>Parametri

*pImageList*<br/>
Puntatore all'elenco di immagini da assegnare. Se *pImageList* è null, tutte le immagini vengono rimosse dal controllo di visualizzazione albero.

*nImageListType*<br/>
Tipo di elenco di immagini da impostare. L'elenco di immagini può essere uno dei valori seguenti:

- TVSIL_NORMAL imposta l'elenco di immagini normali, che contiene le immagini selezionate e non selezionate per l'elemento della visualizzazione struttura ad albero. È necessario utilizzare questo stato per le immagini sovrapposte.

- TVSIL_STATE imposta l'elenco di immagini di stato, che contiene le immagini per gli elementi della visualizzazione struttura ad albero che si trovano in uno stato definito dall'utente.

### <a name="return-value"></a>Valore restituito

Puntatore all'elenco di immagini precedente, se presente; in caso contrario, NULL.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: GetImage](#getimagelist).

## <a name="ctreectrlsetindent"></a><a name="setindent"></a> CTreeCtrl:: sedent

Chiamare questa funzione per impostare la larghezza del rientro per un controllo di visualizzazione albero e ricreare il controllo in modo da riflettere la nuova larghezza.

```cpp
void SetIndent(UINT nIndent);
```

### <a name="parameters"></a>Parametri

*nIndent*<br/>
Larghezza, in pixel, del rientro. Se *nIndent* è minore della larghezza minima definita dal sistema, la nuova larghezza viene impostata sul valore minimo definito dal sistema.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: GetIndent](#getindent).

## <a name="ctreectrlsetinsertmark"></a><a name="setinsertmark"></a> CTreeCtrl:: SetInsertMark

Questa funzione membro implementa il comportamento del [TVM_SETINSERTMARK](/windows/win32/Controls/tvm-setinsertmark)del messaggio Win32, come descritto nel Windows SDK.

```
BOOL SetInsertMark(
    HTREEITEM hItem,
    BOOL fAfter = TRUE);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
HTREEITEM che specifica in quale elemento verrà inserito il segno di inserimento. Se questo argomento è NULL, il segno di inserimento verrà rimosso.

*fAfter*<br/>
Valore BOOL che specifica se il segno di inserimento viene inserito prima o dopo l'elemento specificato. Se questo argomento è diverso da zero, il segno di inserimento verrà inserito dopo l'elemento. Se questo argomento è zero, il segno di inserimento verrà inserito prima dell'elemento.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]

## <a name="ctreectrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a> CTreeCtrl:: SetInsertMarkColor

Questa funzione membro implementa il comportamento del [TVM_SETINSERTMARKCOLOR](/windows/win32/Controls/tvm-setinsertmarkcolor)del messaggio Win32, come descritto nel Windows SDK.

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>Parametri

*clrNew*<br/>
Valore COLORREF che contiene il nuovo colore del segno di inserimento.

### <a name="return-value"></a>Valore restituito

Valore COLORREF che contiene il colore del segno di inserimento precedente.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: GetInsertMarkColor](#getinsertmarkcolor).

## <a name="ctreectrlsetitem"></a><a name="setitem"></a> CTreeCtrl:: SetItem

Chiamare questa funzione per impostare gli attributi dell'elemento della visualizzazione struttura ad albero specificato.

```
BOOL SetItem(TVITEM* pItem);

BOOL SetItem(
    HTREEITEM hItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);
```

### <a name="parameters"></a>Parametri

*pItem*<br/>
Puntatore a una struttura [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) che contiene gli attributi del nuovo elemento, come descritto nell'Windows SDK.

*hItem*<br/>
Handle dell'elemento i cui attributi devono essere impostati. Vedere il `hItem` membro della `TVITEM` struttura nel Windows SDK.

*nMask*<br/>
Integer che specifica gli attributi da impostare. Vedere il membro `mask` della struttura `TVITEM`.

*lpszItem*<br/>
Indirizzo di una stringa contenente il testo dell'elemento.

*nImage*<br/>
Indice dell'immagine dell'elemento nell'elenco immagini del controllo di visualizzazione albero. Vedere il membro `iImage` della struttura `TVITEM`.

*nSelectedImage*<br/>
Indice dell'immagine selezionata dell'elemento nell'elenco immagini del controllo di visualizzazione albero. Vedere il membro `iSelectedImage` della struttura `TVITEM`.

*nState*<br/>
Specifica i valori per gli Stati dell'elemento. Vedere il membro `State` della struttura `TVITEM`.

*nStateMask*<br/>
Specifica gli Stati da impostare. Vedere il membro `stateMask` della struttura `TVITEM`.

*lParam*<br/>
Valore specifico dell'applicazione a dimensione del puntatore associato all'elemento.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Nella `TVITEM` struttura il `hItem` membro identifica l'elemento e il `mask` membro specifica gli attributi da impostare.

Se il `mask` membro o il parametro *nMask* specifica il valore TVIF_TEXT, il `pszText` membro o *lpszItem* è l'indirizzo di una stringa con terminazione null e il `cchTextMax` membro viene ignorato. Se `mask` (o *nMask*) specifica il valore TVIF_STATE, il `stateMask` membro o il parametro *nStateMask* specifica quali Stati dell'elemento modificare e il `state` parametro member o *nState* contiene i valori per tali Stati.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]

## <a name="ctreectrlsetitemdata"></a><a name="setitemdata"></a> CTreeCtrl:: SetItemData

Chiamare questa funzione per impostare il valore specifico dell'applicazione associato all'elemento specificato.

```
BOOL SetItemData(
    HTREEITEM hItem,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento i cui dati devono essere recuperati.

*dwData*<br/>
Valore specifico dell'applicazione a dimensione del puntatore associato all'elemento specificato da *Hite*.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]

## <a name="ctreectrlsetitemexpandedimageindex"></a><a name="setitemexpandedimageindex"></a> CTreeCtrl:: SetItemExpandedImageIndex

Imposta l'indice dell'immagine da visualizzare quando l'elemento specificato del controllo visualizzazione albero corrente è nello stato espanso.

```
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,
    int iExpandedImage);
```

### <a name="parameters"></a>Parametri

*hItem*\
in Handle per un elemento di controllo di visualizzazione albero.

*iExpandedImage*\
in Indice dell'immagine da visualizzare quando l'elemento specificato si trova nello stato espanso.

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TVM_SETITEM](/windows/win32/Controls/tvm-setitem) , descritto nel Windows SDK. Questo metodo assegna il parametro *iExpandedImage* al `iExpandedImage` membro di una struttura [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) e quindi utilizza tale struttura nel messaggio.

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene definita una variabile, `m_treeCtrl` , che viene utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un Unsigned Integer e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

L'esempio di codice seguente è un test banale per determinare se il metodo [CTreeCtrl:: GetItemExpandedImageIndex](#getitemexpandedimageindex) restituisce il valore impostato dal metodo [CTreeCtrl:: SetItemExpandedImageIndex](#setitemexpandedimageindex) . In una sezione precedente dell'esempio di codice, che non viene visualizzato, è stata creata una visualizzazione albero costituita da un nodo paese/area radice per la Stati Uniti, sottonodi per gli Stati di Pennsylvania e Washington ed elementi di albero per le città in tali Stati.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]

## <a name="ctreectrlsetitemheight"></a><a name="setitemheight"></a> CTreeCtrl:: SetItemHeight

Questa funzione membro implementa il comportamento del [TVM_SETITEMHEIGHT](/windows/win32/Controls/tvm-setitemheight)del messaggio Win32, come descritto nel Windows SDK.

```
SHORT SetItemHeight(SHORT cyHeight);
```

### <a name="parameters"></a>Parametri

*cyHeight*<br/>
Specifica la nuova altezza di ogni elemento nella visualizzazione albero, in pixel. Se questo argomento è minore dell'altezza delle immagini, verrà impostato sull'altezza delle immagini. Se questo argomento non è pari, verrà arrotondato al valore pari più vicino. Se questo argomento è-1, il controllo verrà ripristinato utilizzando l'altezza predefinita dell'elemento.

### <a name="return-value"></a>Valore restituito

Altezza precedente, in pixel, degli elementi.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: GetItemHeight](#getitemheight).

## <a name="ctreectrlsetitemimage"></a><a name="setitemimage"></a> CTreeCtrl:: SetItemImage

Associa le immagini a un elemento.

```
BOOL SetItemImage(
    HTREEITEM hItem,
    int nImage,
    int nSelectedImage);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento la cui immagine deve essere impostata.

*nImage*<br/>
Indice dell'immagine dell'elemento nell'elenco immagini del controllo di visualizzazione albero.

*nSelectedImage*<br/>
Indice dell'immagine selezionata dell'elemento nell'elenco immagini del controllo di visualizzazione albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

A ogni elemento di un controllo di visualizzazione albero può essere associata una coppia di immagini bitmap. Le immagini vengono visualizzate sul lato sinistro dell'etichetta di un elemento. Quando l'elemento è selezionato, viene visualizzata un'immagine e l'altra viene visualizzata quando l'elemento non è selezionato. Ad esempio, un elemento potrebbe visualizzare una cartella aperta quando è selezionata e una cartella chiusa quando non è selezionata.

Chiamare questa funzione per impostare l'indice dell'immagine dell'elemento e la relativa immagine selezionata nell'elenco immagini del controllo di visualizzazione albero.

Per ulteriori informazioni sulle immagini, vedere [CImageList](../../mfc/reference/cimagelist-class.md).

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: GetItemImage](#getitemimage).

## <a name="ctreectrlsetitemstate"></a><a name="setitemstate"></a> CTreeCtrl:: SetItemState

Imposta lo stato dell'elemento specificato da *Hite*.

```
BOOL SetItemState(
    HTREEITEM hItem,
    UINT nState,
    UINT nStateMask);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento il cui stato deve essere impostato.

*nState*<br/>
Specifica nuovi Stati per l'elemento.

*nStateMask*<br/>
Specifica gli Stati da modificare.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Per informazioni sugli Stati, vedere [CTreeCtrl:: GetItem](#getitem).

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: GetItemState](#getitemstate).

## <a name="ctreectrlsetitemstateex"></a><a name="setitemstateex"></a> CTreeCtrl:: SetItemStateEx

Imposta lo stato esteso dell'elemento specificato nel controllo di visualizzazione ad albero corrente.

```
BOOL SetItemStateEx(
    HTREEITEM hItem,
    UINT uStateEx);
```

### <a name="parameters"></a>Parametri

*hItem*\
in Handle per un elemento di controllo di visualizzazione albero.

*uStateEx*\
in Stato esteso dell'elemento. Per ulteriori informazioni, vedere il `uStateEx` membro della struttura [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) .

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TVM_SETITEM](/windows/win32/Controls/tvm-setitem) , descritto nel Windows SDK. Questo metodo assegna il parametro *uStateEx* al `uStateEx` membro di una struttura [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) e quindi utilizza tale struttura nel messaggio.

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene definita una variabile, `m_treeCtrl` , che viene utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un Unsigned Integer e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene impostato lo stato disabilitato per un elemento della visualizzazione struttura ad albero. In una sezione precedente dell'esempio di codice, che non viene visualizzato, è stata creata una visualizzazione albero costituita da un nodo paese/area radice per la Stati Uniti, sottonodi per gli Stati di Pennsylvania e Washington ed elementi di albero per le città in tali Stati. Questo esempio di codice imposta lo stato disabilitato del nodo Pennsylvania.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]

## <a name="ctreectrlsetitemtext"></a><a name="setitemtext"></a> CTreeCtrl:: SetItemText

Imposta il testo dell'elemento specificato da *Hite*.

```
BOOL SetItemText(
    HTREEITEM hItem,
    LPCTSTR lpszItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento di cui è necessario impostare il testo.

*lpszItem*<br/>
Indirizzo di una stringa contenente il nuovo testo per l'elemento

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]

## <a name="ctreectrlsetlinecolor"></a><a name="setlinecolor"></a> CTreeCtrl:: SetLineColor

Chiamare questa funzione membro per impostare il colore di riga corrente per il controllo di visualizzazione ad albero.

```
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```

### <a name="parameters"></a>Parametri

*clrNew*<br/>
Colore della nuova riga.

### <a name="return-value"></a>Valore restituito

Colore della riga precedente.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TVM_SETLINECOLOR](/windows/win32/Controls/tvm-setlinecolor)del messaggio Win32, come descritto nel Windows SDK.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]

## <a name="ctreectrlsetscrolltime"></a><a name="setscrolltime"></a> CTreeCtrl:: SetScrollTime

Chiamare questa funzione membro per impostare il tempo massimo di scorrimento per il controllo di visualizzazione ad albero.

```
UINT SetScrollTime(UINT uScrollTime);
```

### <a name="parameters"></a>Parametri

*uScrollTime*<br/>
Nuovo tempo di scorrimento massimo, in millisecondi. Se questo valore è inferiore a 100, verrà arrotondato per eccesso a 100.

### <a name="return-value"></a>Valore restituito

Tempo di scorrimento massimo precedente, in millisecondi.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TVM_SETSCROLLTIME](/windows/win32/Controls/tvm-setscrolltime)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctreectrlsettextcolor"></a><a name="settextcolor"></a> CTreeCtrl:: SetTextColor

Questa funzione membro implementa il comportamento del [TVM_SETTEXTCOLOR](/windows/win32/Controls/tvm-settextcolor)del messaggio Win32, come descritto nel Windows SDK.

```
COLORREF SetTextColor(COLORREF clr);
```

### <a name="parameters"></a>Parametri

*CLR*<br/>
Valore COLORREF che contiene il nuovo colore del testo. Se questo argomento è-1, il controllo verrà ripristinato utilizzando il colore di sistema per il colore del testo.

### <a name="return-value"></a>Valore restituito

Valore COLORREF che rappresenta il colore del testo precedente. Se questo valore è-1, il controllo Usa il colore di sistema per il colore del testo.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]

## <a name="ctreectrlsettooltips"></a><a name="settooltips"></a> CTreeCtrl:: setooltips

Questa funzione membro implementa il comportamento del [TVM_SETTOOLTIPS](/windows/win32/Controls/tvm-settooltips)del messaggio Win32, come descritto nel Windows SDK.

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>Parametri

*pWndTip*<br/>
Puntatore a un oggetto [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) che il controllo albero utilizzerà.

### <a name="return-value"></a>Valore restituito

Puntatore a un oggetto [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) contenente la descrizione comando utilizzata in precedenza dal controllo o null se non è stata utilizzata in precedenza alcuna descrizione comando.

### <a name="remarks"></a>Commenti

Per usare le descrizioni comandi, indicare lo stile TVS_NOTOOLTIPS quando si crea l' `CTreeCtrl` oggetto.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl:: GetToolTips](#gettooltips).

## <a name="ctreectrlshowinfotip"></a><a name="showinfotip"></a> CTreeCtrl:: ShowInfoTip

Visualizza il infotip per l'elemento specificato nel controllo di visualizzazione ad albero corrente.

```cpp
void ShowInfoTip(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*\
in Handle per un elemento della visualizzazione struttura ad albero nel controllo. Per ulteriori informazioni, vedere il `hItem` membro della struttura [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) .

### <a name="remarks"></a>Commenti

Per ulteriori informazioni sulla differenza tra le descrizioni comandi e infotip, vedere [tooltips e infotip](/windows/win32/uxguide/ctrl-tooltips-and-infotips).

Questo metodo invia il messaggio di [TVM_SHOWINFOTIP](/windows/win32/Controls/tvm-showinfotip) , descritto nel Windows SDK.

## <a name="ctreectrlsortchildren"></a><a name="sortchildren"></a> CTreeCtrl:: SortChildren

Chiamare questa funzione per ordinare alfabeticamente gli elementi figlio dell'elemento padre specificato in un controllo di visualizzazione albero.

```
BOOL SortChildren(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento padre i cui elementi figlio devono essere ordinati. Se *il* valore è null, l'ordinamento proseguirà dalla radice dell'albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

`SortChildren` non ricorrerà nell'albero; verranno ordinati solo gli elementi figlio immediati di *hitet* .

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]

## <a name="ctreectrlsortchildrencb"></a><a name="sortchildrencb"></a> CTreeCtrl:: SortChildrenCB

Chiamare questa funzione per ordinare gli elementi della visualizzazione albero utilizzando una funzione di callback definita dall'applicazione che confronta gli elementi.

```
BOOL SortChildrenCB(LPTVSORTCB pSort);
```

### <a name="parameters"></a>Parametri

*pSort*<br/>
Puntatore a una struttura [TVSORTCB](/windows/win32/api/commctrl/ns-commctrl-tvsortcb) .

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

La funzione di confronto della struttura, `lpfnCompare` , deve restituire un valore negativo se il primo elemento deve precedere il secondo, un valore positivo se il primo elemento deve seguire il secondo o zero se i due elementi sono equivalenti.

I parametri *lParam1* e *lParam2* corrispondono al `lParam` membro della struttura [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) per i due elementi confrontati. Il parametro *lParamSort* corrisponde al `lParam` membro della `TV_SORTCB` struttura.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]

[!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]

## <a name="see-also"></a>Vedere anche

[CMNCTRL1 di esempio MFC](../../overview/visual-cpp-samples.md)<br/>
[Classe CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Grafico delle gerarchie](../../mfc/hierarchy-chart.md)<br/>
[Classe CImageList](../../mfc/reference/cimagelist-class.md)
