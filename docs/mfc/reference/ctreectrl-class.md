---
title: Classe CTreeCtrl | Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
dev_langs:
- C++
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 98dfdc792341d215830d46d078d9ece69419efed
ms.sourcegitcommit: d3c41b16bf05af2149090e996d8e71cd6cd55c7a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/09/2018
ms.locfileid: "48890842"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class

Fornisce la funzionalità del controllo di visualizzazione albero comune di Windows.

## <a name="syntax"></a>Sintassi

```
class CTreeCtrl : public CWnd
```

## <a name="members"></a>Membri

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CTreeCtrl::CTreeCtrl](#ctreectrl)|Costruisce un oggetto `CTreeCtrl`.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CTreeCtrl::Create](#create)|Crea un controllo di visualizzazione albero e la collega a un `CTreeCtrl` oggetto.|
|[CTreeCtrl::CreateDragImage](#createdragimage)|Crea una bitmap di trascinamento per l'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::CreateEx](#createex)|Crea un controllo albero con gli stili estesi di Windows specificati e lo collega a un `CTreeCtrl` oggetto.|
|[CTreeCtrl::DeleteAllItems](#deleteallitems)|Elimina tutti gli elementi in un controllo di visualizzazione albero.|
|[CTreeCtrl::DeleteItem](#deleteitem)|Elimina un nuovo elemento in un controllo di visualizzazione albero.|
|[CTreeCtrl::EditLabel](#editlabel)|Consente di modificare un albero specificato visualizzazione elemento inserito.|
|[CTreeCtrl::EndEditLabelNow](#endeditlabelnow)|Annulla l'operazione di modifica l'etichetta di un elemento di visualizzazione ad albero nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::EnsureVisible](#ensurevisible)|Garantisce che un elemento della visualizzazione struttura ad albero sia visibile nel relativo controllo di visualizzazione albero.|
|[CTreeCtrl::Expand](#expand)|Espande o comprime, gli elementi figlio dell'elemento di visualizzazione albero specificato.|
|[CTreeCtrl::GetBkColor](#getbkcolor)|Recupera il colore di sfondo corrente del controllo.|
|[CTreeCtrl::GetCheck](#getcheck)|Recupera lo stato di selezione di un elemento del controllo albero.|
|[CTreeCtrl::GetChildItem](#getchilditem)|Recupera l'elemento figlio di un elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::GetCount](#getcount)|Recupera il numero di elementi dell'albero associata a un controllo di visualizzazione albero.|
|[CTreeCtrl::GetDropHilightItem](#getdrophilightitem)|Recupera la destinazione di un'operazione di trascinamento e rilascio.|
|[CTreeCtrl::GetEditControl](#geteditcontrol)|Recupera l'handle del controllo di modifica utilizzato per modificare l'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::GetExtendedStyle](#getextendedstyle)|Recupera gli stili estesi che utilizza il controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::GetFirstVisibleItem](#getfirstvisibleitem)|Recupera il primo elemento visibile dell'elemento di visualizzazione albero specificato.|
|[CTreeCtrl::GetImageList](#getimagelist)|Recupera l'handle dell'elenco immagini associato a un controllo di visualizzazione albero.|
|[CTreeCtrl::GetIndent](#getindent)|Recupera l'offset, in pixel, di un elemento della visualizzazione struttura ad albero dal relativo elemento padre.|
|[CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor)|Recupera il colore utilizzato per disegnare il segno di inserimento per la visualizzazione struttura ad albero.|
|[CTreeCtrl::GetItem](#getitem)|Recupera gli attributi di un elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::GetItemData](#getitemdata)|Restituisce il valore specifiche dell'applicazione a 32 bit associato a un elemento.|
|[CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex)|Recupera l'indice dell'immagine da visualizzare quando l'elemento specificato del controllo di visualizzazione ad albero corrente si trova nello stato espanso.|
|[CTreeCtrl::GetItemHeight](#getitemheight)|Recupera l'altezza degli elementi della visualizzazione struttura ad albero corrente.|
|[CTreeCtrl::GetItemImage](#getitemimage)|Recupera le immagini associate a un elemento.|
|[CTreeCtrl::GetItemPartRect](#getitempartrect)|Recupera il rettangolo di delimitazione per una parte specificata di un elemento specificato nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::GetItemRect](#getitemrect)|Recupera il rettangolo di delimitazione di un elemento della visualizzazione struttura ad albero.|
|[CTreeCtrl::GetItemState](#getitemstate)|Restituisce lo stato di un elemento.|
|[CTreeCtrl::GetItemStateEx](#getitemstateex)|Recupera lo stato dell'elemento specificato nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::GetItemText](#getitemtext)|Restituisce il testo di un elemento.|
|[CTreeCtrl::GetLastVisibleItem](#getlastvisibleitem)|Recupera l'ultimo elemento espanso nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::GetLineColor](#getlinecolor)|Recupera il colore della linea corrente per il controllo di visualizzazione albero.|
|[CTreeCtrl::GetNextItem](#getnextitem)|Recupera il successivo elemento della visualizzazione struttura ad albero che corrisponde a un elemento relationship specificato.|
|[CTreeCtrl::GetNextSiblingItem](#getnextsiblingitem)|Recupera il successivo di pari livello dell'elemento di visualizzazione albero specificato.|
|[CTreeCtrl::GetNextVisibleItem](#getnextvisibleitem)|Recupera il successivo elemento visibile dell'elemento di visualizzazione albero specificato.|
|[CTreeCtrl::GetParentItem](#getparentitem)|Recupera l'elemento padre dell'elemento di visualizzazione albero specificato.|
|[CTreeCtrl::GetPrevSiblingItem](#getprevsiblingitem)|Recupera l'elemento di pari livello precedente dell'elemento di visualizzazione albero specificato.|
|[CTreeCtrl::GetPrevVisibleItem](#getprevvisibleitem)|Recupera il precedente elemento visibile dell'elemento di visualizzazione albero specificato.|
|[CTreeCtrl::GetRootItem](#getrootitem)|Recupera la radice dell'elemento di visualizzazione albero specificato.|
|[CTreeCtrl::GetScrollTime](#getscrolltime)|Recupera l'ora di scorrimento massimo per il controllo di visualizzazione albero.|
|[CTreeCtrl::GetSelectedCount](#getselectedcount)|Recupera il numero di elementi selezionati nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::GetSelectedItem](#getselecteditem)|Recupera l'elemento della visualizzazione struttura ad albero attualmente selezionato.|
|[CTreeCtrl::GetTextColor](#gettextcolor)|Recupera il colore del testo corrente del controllo.|
|[CTreeCtrl::GetToolTips](#gettooltips)|Recupera l'handle per il controllo descrizione comando utilizzato da un controllo di visualizzazione albero figlio.|
|[CTreeCtrl::GetVisibleCount](#getvisiblecount)|Recupera il numero di elementi dell'albero visibile associati a un controllo di visualizzazione albero.|
|[CTreeCtrl::HitTest](#hittest)|Restituisce la posizione corrente del cursore correlato al `CTreeCtrl` oggetto.|
|[CTreeCtrl::InsertItem](#insertitem)|Inserisce un nuovo elemento in un controllo di visualizzazione albero.|
|[CTreeCtrl::ItemHasChildren](#itemhaschildren)|Restituisce diversi da zero se l'elemento specificato presenta elementi figlio.|
|[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)|L'identificatore di accessibilità specificate viene eseguito il mapping all'handle a un elemento di visualizzazione ad albero nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)|L'handle specificato viene eseguito il mapping a un elemento di visualizzazione ad albero nel controllo di visualizzazione ad albero corrente a un identificatore di accessibilità.|
|[CTreeCtrl::Select](#select)|Consente di selezionare, scorre all'interno della visualizzazione o ridisegna un elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::SelectDropTarget](#selectdroptarget)|Ridisegna l'elemento di struttura ad albero come destinazione di un'operazione di trascinamento e rilascio.|
|[CTreeCtrl::SelectItem](#selectitem)|Seleziona un elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::SelectSetFirstVisible](#selectsetfirstvisible)|Seleziona un elemento della visualizzazione struttura ad albero specificato come primo elemento visibile.|
|[CTreeCtrl::SetAutoscrollInfo](#setautoscrollinfo)|Imposta la frequenza di scorrimento automatico del controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::SetBkColor](#setbkcolor)|Imposta il colore di sfondo del controllo.|
|[CTreeCtrl::SetCheck](#setcheck)|Imposta lo stato di selezione di un elemento del controllo albero.|
|[CTreeCtrl::SetExtendedStyle](#setextendedstyle)|Imposta gli stili estesi per il controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::SetImageList](#setimagelist)|Imposta l'handle dell'elenco immagini associato a un controllo di visualizzazione albero.|
|[CTreeCtrl::SetIndent](#setindent)|Imposta l'offset, in pixel, di un elemento della visualizzazione struttura ad albero dal relativo elemento padre.|
|[CTreeCtrl::SetInsertMark](#setinsertmark)|Imposta il segno di inserimento in un controllo di visualizzazione albero.|
|[CTreeCtrl::SetInsertMarkColor](#setinsertmarkcolor)|Imposta il colore utilizzato per disegnare il segno di inserimento per la visualizzazione struttura ad albero.|
|[CTreeCtrl::SetItem](#setitem)|Imposta gli attributi di un elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::SetItemData](#setitemdata)|Imposta il valore specifiche dell'applicazione a 32 bit associato a un elemento.|
|[CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex)|Imposta l'indice dell'immagine da visualizzare quando l'elemento specificato del controllo di visualizzazione ad albero corrente si trova nello stato espanso.|
|[CTreeCtrl::SetItemHeight](#setitemheight)|Imposta l'altezza dell'albero di elementi della visualizzazione.|
|[CTreeCtrl::SetItemImage](#setitemimage)|Associa le immagini a un elemento.|
|[CTreeCtrl::SetItemState](#setitemstate)|Imposta lo stato di un elemento.|
|[CTreeCtrl::SetItemStateEx](#setitemstateex)|Imposta lo stato dell'elemento specificato nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::SetItemText](#setitemtext)|Imposta il testo di un elemento.|
|[CTreeCtrl::SetLineColor](#setlinecolor)|Imposta il colore della linea corrente per il controllo di visualizzazione albero.|
|[CTreeCtrl::SetScrollTime](#setscrolltime)|Imposta l'ora di scorrimento massimo per il controllo di visualizzazione albero.|
|[CTreeCtrl::SetTextColor](#settextcolor)|Imposta il colore del testo del controllo.|
|[CTreeCtrl::SetToolTips](#settooltips)|Imposta figlio del controllo di visualizzazione albero controllo ToolTip.|
|[CTreeCtrl::ShowInfoTip](#showinfotip)|Consente di visualizzare l'infotip per l'elemento specificato nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::SortChildren](#sortchildren)|Ordina gli elementi figlio di un elemento padre specificato.|
|[CTreeCtrl::SortChildrenCB](#sortchildrencb)|Ordina gli elementi figlio di un elemento padre specificato usando una funzione di ordinamento definito dall'applicazione.|

## <a name="remarks"></a>Note

Un "controllo di visualizzazione struttura ad albero" è una finestra che visualizza un elenco gerarchico di elementi, ad esempio le intestazioni in un documento, le voci in un indice, o di file e directory in un disco. Ogni elemento è costituito da un'etichetta e un'immagine bitmap facoltativa e ogni elemento può avere un elenco di elementi secondari associati. Facendo clic su un elemento, l'utente può espandere e comprimere l'elenco di elementi secondari associato.

Questo controllo (e pertanto il `CTreeCtrl` classe) è disponibile solo per i programmi in esecuzione in Windows 98 e Windows NT versione 4 e versioni successive.

Per altre informazioni sull'uso di `CTreeCtrl`, vedere:

- [Controlli](../../mfc/controls-mfc.md)

- [Uso di CTreeCtrl](../../mfc/using-ctreectrl.md)

- [Riferimento al controllo di visualizzazione albero](/windows/desktop/Controls/tree-view-control-reference) in Windows SDK.

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CTreeCtrl`

## <a name="requirements"></a>Requisiti

**Intestazione:** afxcmn.h

##  <a name="create"></a>  CTreeCtrl::Create

Se si specifica il controllo albero in un modello di finestra di dialogo, o se si usa [CTreeView](../../mfc/reference/ctreeview-class.md), controllo struttura ad albero viene creato automaticamente quando viene creata la finestra di dialogo o la vista.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Parametri

*dwStyle*<br/>
Specifica lo stile del controllo di visualizzazione albero. Applicare stili di finestra, descritto nella [CreateWindow](/windows/desktop/api/winuser/nf-winuser-createwindowa)e qualsiasi combinazione delle [stili di visualizzazione del controllo albero](/windows/desktop/Controls/tree-view-control-window-styles) come descritto nel SDK di Windows.

*Rect*<br/>
Specifica le dimensioni e la posizione del controllo di visualizzazione albero. Può essere un' [CRect](../../atl-mfc-shared/reference/crect-class.md) oggetto o una [RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897) struttura.

*pParentWnd*<br/>
Specifica finestra padre del controllo di visualizzazione albero, in genere un `CDialog`. Non deve essere NULL.

*nID*<br/>
Specifica l'ID. del controllo di visualizzazione albero

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'inizializzazione ha avuto esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Se si vuole creare il controllo struttura ad albero come finestra figlio di un'altra finestra, usare il `Create` funzione membro. Se si crea il controllo struttura ad albero usando `Create`, è necessario chiamarla WS_VISIBLE, oltre a altri stili di visualizzazione albero.

Si costruisce un `CTreeCtrl` in due passaggi. Prima chiamata al costruttore, quindi chiamare `Create`, che crea il controllo di visualizzazione albero e lo collega al `CTreeCtrl` oggetto.

Per creare un controllo albero con stili finestra estesi, chiamare [CreateEx](#createex) invece di `Create`.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]

##  <a name="createex"></a>  CTreeCtrl::CreateEx

Chiamare questa funzione per creare un controllo (una finestra figlio) e associarlo con il `CTreeCtrl` oggetto.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Parametri

*dwExStyle*<br/>
Specifica lo stile esteso del controllo da creare. Per un elenco di stili estesi di Windows, vedere la *dwExStyle* parametro per [CreateWindowEx](/windows/desktop/api/winuser/nf-winuser-createwindowexa) nel SDK di Windows.

*dwStyle*<br/>
Specifica lo stile del controllo di visualizzazione albero. Applicare stili di finestra, descritto nella [CreateWindow](/windows/desktop/api/winuser/nf-winuser-createwindowa)e qualsiasi combinazione delle [stili di visualizzazione del controllo albero](/windows/desktop/Controls/tree-view-control-window-styles) come descritto nel SDK di Windows.

*Rect*<br/>
Un riferimento a un [RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897) struttura che descrive le dimensioni e posizione della finestra da creare, nelle coordinate del client *pParentWnd*.

*pParentWnd*<br/>
Puntatore alla finestra padre del controllo.

*nID*<br/>
ID di finestra figlio. del controllo

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo in caso contrario 0.

### <a name="remarks"></a>Note

Uso `CreateEx` invece di [Create](#create) per applicare stili estesi di Windows, specificati dal prefisso di stile esteso di Windows **WS_EX _**.

##  <a name="createdragimage"></a>  CTreeCtrl::CreateDragImage

Chiamare questa funzione per creare un'immagine bitmap di trascinamento per l'elemento specificato in un controllo di visualizzazione albero, creare un elenco di immagini per la bitmap e aggiungere la bitmap all'elenco di immagini.

```
CImageList* CreateDragImage(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento di struttura ad albero da trascinare.

### <a name="return-value"></a>Valore restituito

Puntatore all'elenco di immagini a cui è stata aggiunta la bitmap trascinando, se ha esito positivo. in caso contrario NULL.

### <a name="remarks"></a>Note

Un'applicazione utilizza le funzioni di elenco di immagini per visualizzare l'immagine quando l'elemento viene trascinato.

Il `CImageList` oggetto è permanente e sarà necessario eliminarlo al termine. Ad esempio:

[!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]

##  <a name="ctreectrl"></a>  CTreeCtrl::CTreeCtrl

Costruisce un oggetto `CTreeCtrl`.

```
CTreeCtrl();
```

##  <a name="deleteallitems"></a>  CTreeCtrl::DeleteAllItems

Chiamare questa funzione per eliminare tutti gli elementi dal controllo di visualizzazione albero.

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]

##  <a name="deleteitem"></a>  CTreeCtrl::DeleteItem

Chiamare questa funzione per eliminare un elemento dal controllo di visualizzazione albero.

```
BOOL DeleteItem(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento di struttura ad albero da eliminare. Se *hitem* ha il valore TVI_ROOT al, vengono eliminati tutti gli elementi dal controllo di visualizzazione albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]

##  <a name="editlabel"></a>  CTreeCtrl::EditLabel

Chiamare questa funzione per iniziare la modifica sul posto del testo dell'elemento specificato.

```
CEdit* EditLabel(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento di struttura ad albero da modificare.

### <a name="return-value"></a>Valore restituito

Se ha esito positivo, un puntatore al `CEdit` oggetto che è possibile modificare il testo dell'elemento; in caso contrario, NULL.

### <a name="remarks"></a>Note

L'operazione di modifica viene eseguita sostituendo il testo dell'elemento con un controllo di modifica a riga singola che contiene il testo.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]

##  <a name="endeditlabelnow"></a>  CTreeCtrl::EndEditLabelNow

Si conclude l'operazione di modifica l'etichetta di un elemento di visualizzazione ad albero nel controllo di visualizzazione ad albero corrente.

```
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*fCancelWithoutSave*|[in] TRUE per annullare le modifiche all'elemento di struttura prima di concludere l'operazione di modifica oppure FALSE per salvare le modifiche apportate all'elemento di visualizzazione ad albero prima di concludere l'operazione.|

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Note

Questo metodo invia il [TVM_ENDEDITLABELNOW](/windows/desktop/Controls/tvm-endeditlabelnow) messaggio, che è descritti nel SDK di Windows.

##  <a name="ensurevisible"></a>  CTreeCtrl::EnsureVisible

Chiamare questa funzione per assicurarsi che un elemento della visualizzazione struttura ad albero sia visibile.

```
BOOL EnsureVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento di struttura ad albero viene reso visibile.

### <a name="return-value"></a>Valore restituito

Restituisce TRUE se il sistema di scorre gli elementi nel controllo di visualizzazione albero per assicurarsi che l'elemento specificato sia visibile. In caso contrario, il valore restituito è FALSE.

### <a name="remarks"></a>Note

Se necessario, la funzione si espande l'elemento padre o scorre il controllo di visualizzazione albero in modo che l'elemento è visibile.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]

##  <a name="expand"></a>  CTreeCtrl::Expand

Chiamare questa funzione per espandere o comprimere l'elenco di elementi figlio, se presente, associato all'elemento padre specificato.

```
BOOL Expand(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento di struttura ad albero che viene espansa.

*nCode*<br/>
Un flag che indica il tipo di azione da intraprendere. Questo flag può avere uno dei valori seguenti:

- TVE_COLLAPSE consente di comprimere l'elenco.

- TVE_COLLAPSERESET consente di comprimere l'elenco e rimuove gli elementi figlio. Il flag di stato TVIS_EXPANDEDONCE viene reimpostato. Questo flag deve essere utilizzato con il flag TVE_COLLAPSE.

- TVE_EXPAND espande l'elenco.

- TVE_TOGGLE consente di comprimere l'elenco se è attualmente espanso o lo espande se è attualmente compresso.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::EnsureVisible](#ensurevisible).

##  <a name="getbkcolor"></a>  CTreeCtrl::GetBkColor

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_GETBKCOLOR](/windows/desktop/Controls/tvm-getbkcolor), come descritto nel SDK di Windows.

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>Valore restituito

Valore COLORREF che rappresenta il colore di sfondo finestra corrente per il controllo. Se questo valore è -1, il controllo Usa il colore della finestra del sistema. In questo caso, è possibile usare `::GetSysColor(COLOR_WINDOW)` per ottenere il colore di sistema corrente che utilizza il controllo.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::SetTextColor](#settextcolor).

##  <a name="getcheck"></a>  CTreeCtrl::GetCheck

Chiamare questa funzione membro per recuperare lo stato di controllo di un elemento.

```
BOOL GetCheck(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
HTREEITEM su cui si desidera ricevere le informazioni sullo stato.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento di controllo struttura ad albero è selezionato; in caso contrario 0.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::SetCheck](#setcheck).

##  <a name="getchilditem"></a>  CTreeCtrl::GetChildItem

Chiamata della funzione per recuperare l'albero di visualizzare l'elemento che è l'elemento figlio dell'elemento specificato da *hItem*.

```
HTREEITEM GetChildItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento di struttura ad albero.

### <a name="return-value"></a>Valore restituito

L'handle dell'elemento figlio se ha esito positivo. in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]

##  <a name="getcount"></a>  CTreeCtrl::GetCount

Chiamare questa funzione per recuperare un conteggio degli elementi in un controllo di visualizzazione albero.

```
UINT GetCount() const;
```

### <a name="return-value"></a>Valore restituito

Il numero di elementi nel controllo di visualizzazione albero.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]

##  <a name="getdrophilightitem"></a>  CTreeCtrl::GetDropHilightItem

Chiamare questa funzione per recuperare l'elemento che rappresenta la destinazione di un'operazione di trascinamento e rilascio.

```
HTREEITEM GetDropHilightItem() const;
```

### <a name="return-value"></a>Valore restituito

L'handle dell'elemento eliminato se ha esito positivo. in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

##  <a name="geteditcontrol"></a>  CTreeCtrl::GetEditControl

Chiamare questa funzione per recuperare l'handle del controllo di modifica utilizzato per la modifica di testo dell'elemento di una visualizzazione struttura ad albero.

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>Valore restituito

Un puntatore al controllo di modifica utilizzato per modificare il testo dell'elemento, se ha esito positivo. in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]

##  <a name="getextendedstyle"></a>  CTreeCtrl::GetExtendedStyle

Recupera gli stili estesi che utilizza il controllo di visualizzazione ad albero corrente.

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>Valore restituito

Stili del estesi da un valore che contiene una combinazione bit per bit (OR) del controllo di visualizzazione ad albero corrente. Per altre informazioni, vedere [stili estesi del controllo di visualizzazione ad albero](/windows/desktop/Controls/tree-view-control-window-extended-styles).

### <a name="remarks"></a>Note

Questo metodo invia il [TVM_GETEXTENDEDSTYLE](/windows/desktop/Controls/tvm-getextendedstyle) messaggio, che è descritti nel SDK di Windows.

##  <a name="getfirstvisibleitem"></a>  CTreeCtrl::GetFirstVisibleItem

Chiamare questa funzione per recuperare il primo elemento visibile del controllo di visualizzazione albero.

```
HTREEITEM GetFirstVisibleItem() const;
```

### <a name="return-value"></a>Valore restituito

L'handle del primo elemento visibile; in caso contrario NULL.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::SetCheck](#setcheck).

##  <a name="getimagelist"></a>  CTreeCtrl::GetImageList

Chiamare questa funzione per recuperare l'handle della normale o un elenco di immagini di stato associato al controllo di visualizzazione albero.

```
CImageList* GetImageList(UINT nImageList) const;
```

### <a name="parameters"></a>Parametri

*nImageList*<br/>
Tipo di elenco immagini da recuperare. L'elenco di immagini può essere uno dei valori seguenti:

- TVSIL_NORMAL recupera l'elenco di immagini normale, che contiene le immagini per e selezionate per l'elemento della visualizzazione struttura ad albero.

- TVSIL_STATE recupera l'elenco di immagini di stato, che contiene le immagini per gli elementi di visualizzazione albero che si trovano nello stato definiti dall'utente.

### <a name="return-value"></a>Valore restituito

Puntatore all'elenco di immagini del controllo se ha esito positivo. in caso contrario NULL.

### <a name="remarks"></a>Note

Ogni elemento in un controllo di visualizzazione albero può avere una coppia di immagini bitmap associata. Quando l'elemento è selezionato, e l'altra viene visualizzata quando l'elemento non è selezionata, viene visualizzata un'immagine. Ad esempio, un elemento potrebbe visualizzare una cartella aperta quando viene selezionato e una cartella chiusa quando non è selezionata.

Per altre informazioni sugli elenchi di immagini, vedere la [CImageList](../../mfc/reference/cimagelist-class.md) classe.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]

##  <a name="getindent"></a>  CTreeCtrl::GetIndent

Chiamare questa funzione per recuperare la quantità, in pixel, tale elemento figlio di elementi vengono rientrati rispetto ai relativi elementi padre.

```
UINT GetIndent() const;
```

### <a name="return-value"></a>Valore restituito

La quantità di rientro misurata in pixel.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]

##  <a name="getinsertmarkcolor"></a>  CTreeCtrl::GetInsertMarkColor

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_GETINSERTMARKCOLOR](/windows/desktop/Controls/tvm-getinsertmarkcolor), come descritto nel SDK di Windows.

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>Valore restituito

Valore COLORREF che contiene il colore del segno di inserimento corrente.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]

##  <a name="getitem"></a>  CTreeCtrl::GetItem

Chiamare questa funzione per recuperare gli attributi dell'elemento di visualizzazione albero specificato.

```
BOOL GetItem(TVITEM* pItem) const;
```

### <a name="parameters"></a>Parametri

*pItem*<br/>
Un puntatore a un [struttura TVITEM](/windows/desktop/api/commctrl/ns-commctrl-tagtvitema) strutturare, come descritto nel SDK di Windows.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::DeleteItem](#deleteitem).

##  <a name="getitemdata"></a>  CTreeCtrl::GetItemData

Chiamare questa funzione per recuperare il valore specifiche dell'applicazione a 32 bit associato con l'elemento specificato.

```
DWORD_PTR GetItemData(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento cui i dati da recuperare.

### <a name="return-value"></a>Valore restituito

Un valore specifico dell'applicazione a 32 bit associato all'elemento specificato da *hItem*.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]

##  <a name="getitemexpandedimageindex"></a>  CTreeCtrl::GetItemExpandedImageIndex

Recupera l'indice dell'immagine da visualizzare quando l'elemento specificato del controllo di visualizzazione ad albero corrente si trova nello stato espanso.

```
int GetItemExpandedImageIndex(HTREEITEM hItem)const;
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hItem*|[in] Handle per un elemento di controllo di visualizzazione ad albero.|

### <a name="return-value"></a>Valore restituito

L'indice dell'immagine da visualizzare quando l'elemento specificato si trova nello stato espanso.

### <a name="remarks"></a>Note

Questo metodo invia il [TVM_GETITEM](/windows/desktop/Controls/tvm-getitem) messaggio, che è descritti nel SDK di Windows. Del messaggio che restituisce il [TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa) struttura che descrive l'elemento di controllo di visualizzazione ad albero, quindi questo metodo recupera il `iExpandedImage` membro da tale struttura.

##  <a name="getitemheight"></a>  CTreeCtrl::GetItemHeight

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_GETITEMHEIGHT](/windows/desktop/Controls/tvm-getitemheight), come descritto nel SDK di Windows.

```
SHORT GetItemHeight() const;
```

### <a name="return-value"></a>Valore restituito

L'altezza dell'elemento, in pixel.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]

##  <a name="getitemimage"></a>  CTreeCtrl::GetItemImage

Ogni elemento in un controllo di visualizzazione albero può avere una coppia di immagini bitmap associata.

```
BOOL GetItemImage(
    HTREEITEM hItem,
    int& nImage,
    int& nSelectedImage) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
L'handle dell'elemento cui immagine da recuperare.

*Immagine*<br/>
Integer che riceve l'indice dell'immagine dell'elemento all'interno di elenco di immagini di controllo di visualizzazione albero.

*nSelectedImage*<br/>
Integer che riceve l'indice dell'immagine selezionata dell'elemento all'interno di elenco di immagini di controllo di visualizzazione albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Le immagini vengono visualizzate a sinistra dell'etichetta di un elemento. Quando l'elemento è selezionato, e l'altra viene visualizzata quando l'elemento non è selezionata, viene visualizzata un'immagine. Ad esempio, un elemento potrebbe visualizzare una cartella aperta quando viene selezionato e una cartella chiusa quando non è selezionata.

Chiamare questa funzione per recuperare l'indice dell'immagine dell'elemento e l'immagine selezionata all'interno di elenco di immagini di controllo di visualizzazione albero.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]

##  <a name="getitempartrect"></a>  CTreeCtrl::GetItemPartRect

Recupera il rettangolo di delimitazione per una parte specificata di un elemento specificato nel controllo di visualizzazione ad albero corrente.

```
BOOL GetItemPartRect(
    HTREEITEM hItem,
    int nPart,
    LPRECT lpRect)const;
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hItem*|[in] Handle per un elemento di controllo di visualizzazione ad albero.|
|*nPart*|[in] Identificatore per la parte. Deve essere impostata su TVGIPR_BUTTON.|
|*lpRect*|[out] Puntatore a un [RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897) struttura. Se questo metodo ha esito positivo, la struttura riceve le coordinate del rettangolo della parte specificata da *hItem* e *nPart*.|

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Note

Ogni elemento di controllo struttura ad albero è limitato da un rettangolo di grafica. Ogni volta che si fa clic su un punto in quel rettangolo, l'elemento è detto *hit*. Questo metodo restituisce il rettangolo più grande in modo che quando viene selezionato un punto nel rettangolo, l'elemento identificato dal *hItem* parametro viene raggiunto.

Questo metodo invia il messaggio TVM_GETITEMPARTRECT, che è descritti nel SDK di Windows. Per altre informazioni, vedere la [TreeView_GetItemPartRect](/windows/desktop/api/commctrl/nf-commctrl-treeview_getitempartrect) macro.

### <a name="example"></a>Esempio

L'esempio di codice seguente definisce una variabile, `m_treeCtrl`, che viene usato per accedere al controllo di visualizzazione ad albero corrente. L'esempio di codice definisce anche un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio seguente.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

L'esempio di codice seguente usa un identificatore di accessibilità e la [CTreeCtrl::MapAccIdToItem](#mapaccidtoitem) metodo per recuperare un handle per l'elemento radice della visualizzazione albero. L'esempio utilizza l'handle e il [CTreeCtrl::GetItemPartRect](#getitempartrect) metodo consente di disegnare un rettangolo intorno a tale elemento 3D. In una sezione precedente di esempio di codice, non viene visualizzato, viene creata una visualizzazione albero che è costituito da un nodo di paese/area geografica principale per gli Stati Uniti, i sottonodi per gli stati di Washington e Pennsylvania e gli elementi dell'albero per città degli stati. È stato usato il [CTreeCtrl::MapItemToAccID](#mapitemtoaccid) metodo per associare l'elemento radice della visualizzazione albero con un identificatore di accessibilità.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

##  <a name="getitemrect"></a>  CTreeCtrl::GetItemRect

Chiamare questa funzione per recuperare il rettangolo di delimitazione *hItem* e determinare se è visibile o meno.

```
BOOL GetItemRect(
    HTREEITEM hItem,
    LPRECT lpRect,
    BOOL bTextOnly) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
L'handle di un elemento di controllo di visualizzazione albero.

*lpRect*<br/>
Puntatore a un [RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897) struttura che riceve il rettangolo di delimitazione. Le coordinate sono rispetto all'angolo superiore sinistro del controllo di visualizzazione albero.

*bTextOnly*<br/>
Se questo parametro è diverso da zero, il rettangolo di delimitazione include solo il testo dell'elemento. In caso contrario, contiene l'intera riga che occupa l'elemento nel controllo di visualizzazione albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento è visibile, con il rettangolo di delimitazione racchiusa *lpRect*. In caso contrario, 0 con *lpRect* non inizializzato.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]

##  <a name="getitemstate"></a>  CTreeCtrl::GetItemState

Restituisce lo stato dell'elemento specificato da *hItem*.

```
UINT GetItemState(
    HTREEITEM hItem,
    UINT nStateMask) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento cui stato deve essere recuperato.

*nStateMask*<br/>
Maschera che indica uno o più stati da recuperare. Per altre informazioni sui possibili valori di *nStateMask*, vedere la discussione relativa la `state` e `stateMask` i membri del [struttura TVITEM](/windows/desktop/api/commctrl/ns-commctrl-tagtvitema) struttura nel SDK di Windows.

### <a name="return-value"></a>Valore restituito

UINT che contiene l'operatore OR bit per bit dei valori specificati da nStateMask. Per informazioni sui valori possibili, vedere [CTreeCtrl::GetItem](#getitem). Per trovare il valore per uno stato specifico, eseguire un'operazione con AND bit per bit del valore di stato e il valore restituito, come illustrato nell'esempio seguente.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]

##  <a name="getitemstateex"></a>  CTreeCtrl::GetItemStateEx

Recupera lo stato dell'elemento specificato nel controllo di visualizzazione ad albero corrente.

```
UINT GetItemStateEx(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hItem*|[in] Handle per un elemento di controllo di visualizzazione ad albero.|

### <a name="return-value"></a>Valore restituito

Lo stato dell'elemento. Per altre informazioni, vedere la `uStateEx` membro della [TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa) struttura.

### <a name="remarks"></a>Note

Questo metodo invia il [TVM_GETITEM](/windows/desktop/Controls/tvm-getitem) messaggio, che è descritti nel SDK di Windows. Del messaggio che restituisce il [TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa) struttura che descrive l'elemento di controllo di visualizzazione ad albero e questo metodo recupera il `uStateEx` membro da tale struttura.

##  <a name="getitemtext"></a>  CTreeCtrl::GetItemText

Restituisce il testo dell'elemento specificato dalla *hItem*.

```
CString GetItemText(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento cui testo da recuperare.

### <a name="return-value"></a>Valore restituito

Oggetto `CString` oggetto contenente il testo dell'elemento.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::GetNextItem](#getnextitem).

##  <a name="getlastvisibleitem"></a>  CTreeCtrl::GetLastVisibleItem

Recupera l'ultimo elemento di nodo non espanso nel controllo di visualizzazione ad albero corrente.

```
HTREEITEM GetLastVisibleItem() const;
```

### <a name="return-value"></a>Valore restituito

L'handle per l'ultimo elemento di nodo non espansi se il metodo ha esito positivo. in caso contrario, NULL.

### <a name="remarks"></a>Note

Questo metodo invia il [TVM_GETNEXTITEM](/windows/desktop/Controls/tvm-getnextitem) messaggio, che è descritti nel SDK di Windows. Per altre informazioni, vedere il flag di TVGN_LASTVISIBLE il *flag* parametro del messaggio in questione.

### <a name="example"></a>Esempio

L'esempio di codice seguente definisce una variabile, `m_treeCtrl`, che viene usato per accedere al controllo di visualizzazione ad albero corrente. L'esempio di codice definisce anche un intero senza segno e diverse variabili HTREEITEM. Uno o più di queste variabili vengono usati nell'esempio seguente.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Esempio di codice seguente recupera un handle per l'ultimo elemento di visualizzazione albero non espansi nodo e quindi disegna un rettangolo intorno a tale elemento 3D. In una sezione precedente di esempio di codice, non viene visualizzato, viene creata una visualizzazione albero che è costituito da un nodo di paese/area geografica principale per gli Stati Uniti, i sottonodi per gli stati di Washington e Pennsylvania e gli elementi dell'albero per città degli stati.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]

##  <a name="getlinecolor"></a>  CTreeCtrl::GetLineColor

Questa funzione membro implementa il comportamento del messaggio win32 [TVM_GETLINECOLOR](/windows/desktop/Controls/tvm-getlinecolor), come descritto nel SDK di Windows.

```
COLORREF GetLineColor() const;
```

### <a name="return-value"></a>Valore restituito

Il colore della linea corrente.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]

##  <a name="getnextitem"></a>  CTreeCtrl::GetNextItem

Chiamata questa funzione per recuperare l'albero di visualizzare l'elemento che contiene la relazione specificata, indicata dal *nCode* parametro, alla *hItem*.

```
HTREEITEM GetNextItem(
    HTREEITEM hItem,
    UINT nCode) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento di struttura ad albero.

*nCode*<br/>
Un flag che indica il tipo di relazione *hItem*. Questo flag può essere uno dei valori seguenti:

- TVGN_CARET recupera l'elemento attualmente selezionato.

- TVGN_CHILD recupera il primo elemento figlio dell'elemento specificato per il *hItem* parametro.

- TVGN_DROPHILITE recupera l'elemento che rappresenta la destinazione di un'operazione di trascinamento e rilascio.

- TVGN_FIRSTVISIBLE recupera il primo elemento visibile.

- TVGN_LASTVISIBLE recupera l'ultimo elemento espansi nell'albero. Ciò non recupera l'ultimo elemento visibile nella finestra di visualizzazione ad albero.

- TVGN_NEXT recupera l'elemento di pari livello successivo.

- TVGN_NEXTVISIBLE recupera il successivo elemento visibile che segue l'elemento specificato.

- TVGN_PARENT recupera l'elemento padre dell'elemento specificato.

- TVGN_PREVIOUS recupera l'elemento di pari livello precedente.

- TVGN_PREVIOUSVISIBLE recupera il primo elemento visibile che precede l'elemento specificato.

- TVGN_ROOT recupera il primo elemento figlio dell'elemento radice di cui l'elemento specificato è una parte.

### <a name="return-value"></a>Valore restituito

L'handle dell'elemento successivo se ha esito positivo. in caso contrario NULL.

### <a name="remarks"></a>Note

Questa funzione restituirà NULL se l'elemento viene recuperato è il nodo radice dell'albero. Ad esempio, se si utilizza questo messaggio con il flag TVGN_PARENT su un figlio di primo livello del nodo radice della visualizzazione albero, il messaggio verrà restituito NULL.

### <a name="example"></a>Esempio

Per un esempio d'uso `GetNextItem` in un ciclo, vedere [CTreeCtrl::DeleteItem](#deleteitem).

[!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]

##  <a name="getnextsiblingitem"></a>  CTreeCtrl::GetNextSiblingItem

Chiamare questa funzione per recuperare il pari livello successivo *hItem*.

```
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento di struttura ad albero.

### <a name="return-value"></a>Valore restituito

L'handle dell'elemento di pari livello successivo. in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]

##  <a name="getnextvisibleitem"></a>  CTreeCtrl::GetNextVisibleItem

Chiamare questa funzione per recuperare il successivo elemento visibile della *hItem*.

```
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento di struttura ad albero.

### <a name="return-value"></a>Valore restituito

L'handle dell'elemento visibile successivo. in caso contrario NULL.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::SetCheck](#setcheck).

##  <a name="getparentitem"></a>  CTreeCtrl::GetParentItem

Chiamare questa funzione per recuperare l'elemento padre di *hItem*.

```
HTREEITEM GetParentItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento di struttura ad albero.

### <a name="return-value"></a>Valore restituito

L'handle dell'elemento padre; in caso contrario NULL.

### <a name="remarks"></a>Note

Questa funzione restituirà NULL se l'elemento padre dell'elemento specificato è il nodo radice dell'albero.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::EnsureVisible](#ensurevisible).

##  <a name="getprevsiblingitem"></a>  CTreeCtrl::GetPrevSiblingItem

Chiamare questa funzione per recuperare l'elemento di pari livello precedente di *hItem*.

```
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento di struttura ad albero.

### <a name="return-value"></a>Valore restituito

L'handle di pari livello precedente; in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]

##  <a name="getprevvisibleitem"></a>  CTreeCtrl::GetPrevVisibleItem

Chiamare questa funzione per recuperare il precedente elemento visibile della *hItem*.

```
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento di struttura ad albero.

### <a name="return-value"></a>Valore restituito

L'handle dell'elemento visibile precedente; in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]

##  <a name="getrootitem"></a>  CTreeCtrl::GetRootItem

Chiamare questa funzione per recuperare l'elemento radice del controllo di visualizzazione albero.

```
HTREEITEM GetRootItem() const;
```

### <a name="return-value"></a>Valore restituito

L'handle dell'elemento radice; in caso contrario NULL.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::EditLabel](#editlabel).

##  <a name="getscrolltime"></a>  CTreeCtrl::GetScrollTime

Chiamare questa funzione membro per recuperare l'ora di scorrimento massimo per il controllo di visualizzazione albero.

```
UINT GetScrollTime() const;
```

### <a name="return-value"></a>Valore restituito

Il tempo massimo scorrimento, in millisecondi.

### <a name="remarks"></a>Note

Questa funzione membro implementa il comportamento del messaggio win32 [TVM_GETSCROLLTIME](/windows/desktop/Controls/tvm-getscrolltime), come descritto nel SDK di Windows.

##  <a name="getselectedcount"></a>  CTreeCtrl::GetSelectedCount

Recupera il numero di elementi selezionati nel controllo di visualizzazione ad albero corrente.

```
UINT GetSelectedCount();
```

### <a name="return-value"></a>Valore restituito

Il numero di elementi selezionati.

### <a name="remarks"></a>Note

Questo metodo invia il [TVM_GETSELECTEDCOUNT](/windows/desktop/Controls/tvm-getselectedcount) messaggio, che è descritti nel SDK di Windows.

##  <a name="getselecteditem"></a>  CTreeCtrl::GetSelectedItem

Chiamare questa funzione per recuperare l'elemento attualmente selezionato del controllo di visualizzazione albero.

```
HTREEITEM GetSelectedItem() const;
```

### <a name="return-value"></a>Valore restituito

L'handle dell'elemento selezionato; in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]

##  <a name="gettextcolor"></a>  CTreeCtrl::GetTextColor

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_GETTEXTCOLOR](/windows/desktop/Controls/tvm-gettextcolor), come descritto nel SDK di Windows.

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>Valore restituito

Valore COLORREF che rappresenta il colore del testo corrente. Se questo valore è -1, il controllo Usa il colore di sistema per il colore del testo.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::SetTextColor](#settextcolor).

##  <a name="gettooltips"></a>  CTreeCtrl::GetToolTips

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_GETTOOLTIPS](/windows/desktop/Controls/tvm-gettooltips), come descritto nel SDK di Windows.

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>Valore restituito

Un puntatore a un [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) oggetto utilizzabile dal controllo albero. Se il [Create](#create) funzione membro viene utilizzato lo stile TVS_NOTOOLTIPS, non le descrizioni comandi vengono usate e viene restituito NULL.

### <a name="remarks"></a>Note

L'implementazione MFC di `GetToolTips` restituisce un `CToolTipCtrl` oggetto, che viene utilizzato dal controllo albero, anziché un handle per un controllo tooltip.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]

##  <a name="getvisiblecount"></a>  CTreeCtrl::GetVisibleCount

Chiamare questa funzione per recuperare un numero di elementi visibili in un controllo di visualizzazione albero.

```
UINT GetVisibleCount() const;
```

### <a name="return-value"></a>Valore restituito

Il numero di elementi visibili nel controllo di visualizzazione albero; in caso contrario, - 1.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::SetCheck](#setcheck).

##  <a name="hittest"></a>  CTreeCtrl::HitTest

Chiamare questa funzione per determinare la posizione del punto specificato relativo all'area client del controllo di visualizzazione albero.

```
HTREEITEM HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;

HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;
```

### <a name="parameters"></a>Parametri

*pt*<br/>
Coordinate del client del punto da testare.

*pFlags*<br/>
Puntatore a un integer che riceve informazioni relative ai risultati dell'hit test. Può corrispondere a uno o più dei valori elencati sotto la `flags` membro nella sezione Osservazioni.

*pHitTestInfo*<br/>
Indirizzo di un [TVHITTESTINFO](/windows/desktop/api/commctrl/ns-commctrl-tagtvhittestinfo) struttura che contiene la posizione per l'hit test e che riceve informazioni relative ai risultati dell'hit test.

### <a name="return-value"></a>Valore restituito

L'handle dell'elemento che occupa il punto specificato o NULL se nessun elemento occupa il punto di visualizzazione albero.

### <a name="remarks"></a>Note

Quando questa funzione viene chiamata, il *pt* parametro specifica le coordinate del punto da testare. La funzione restituisce l'handle dell'elemento nel punto specificato o NULL se nessun elemento occupa il punto. Inoltre, il *pFlags* parametro contiene un valore che indica la posizione del punto specificato. I possibili valori sono:

|||
|-|-|
|Valore|Significato|
|TVHT_ABOVE|Sopra l'area client.|
|TVHT_BELOW|Sotto l'area client.|
|TVHT_NOWHERE|Nell'area client, ma di sotto l'ultimo elemento.|
|TVHT_ONITEM|Nel bitmap o l'etichetta associata a un elemento.|
|TVHT_ONITEMBUTTON|Sul pulsante associato a un elemento.|
|TVHT_ONITEMICON|Nella mappa di bit associato a un elemento.|
|TVHT_ONITEMINDENT|Nel rientro associato a un elemento.|
|TVHT_ONITEMLABEL|Nell'etichetta (stringa) associato a un elemento.|
|TVHT_ONITEMRIGHT|Nell'area a destra di un elemento.|
|TVHT_ONITEMSTATEICON|Sull'icona di stato per un elemento della visualizzazione albero che si trova in uno stato definiti dall'utente.|
|TVHT_TOLEFT|A sinistra dell'area client.|
|TVHT_TORIGHT|A destra dell'area client.|
|||

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

##  <a name="insertitem"></a>  CTreeCtrl::InsertItem

Chiamare questa funzione per inserire un nuovo elemento in un controllo di visualizzazione albero.

```
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);


HTREEITEM InsertItem(
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    HTREEITEM hParent,
    HTREEITEM hInsertAfter);


HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);


HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);
```

### <a name="parameters"></a>Parametri

*lpInsertStruct*<br/>
Un puntatore a un `TVINSERTSTRUCT` che specifica gli attributi dell'elemento visualizzazione struttura ad albero da inserire.

*nMask*<br/>
Numero intero che specifica gli attributi da impostare. Vedere il `TVITEM` struttura nel SDK di Windows.

*lpszItem*<br/>
Indirizzo di una stringa contenente il testo dell'elemento.

*Immagine*<br/>
Indice dell'immagine dell'elemento nell'elenco di immagini di controllo di visualizzazione albero.

*nSelectedImage*<br/>
Indice dell'immagine selezionata dell'elemento nell'elenco di immagini di controllo di visualizzazione albero.

*nState*<br/>
Specifica i valori per gli Stati dell'elemento. Vedere albero Visualizzazione controllo stati degli elementi nel SDK di Windows per un elenco di stati appropriati.

*nStateMask*<br/>
Specifica gli stati da impostare. Vedere il `TVITEM` struttura nel SDK di Windows.

*lParam*<br/>
Un valore a 32 bit specifiche dell'applicazione associato all'elemento.

*hParent*<br/>
Handle dell'elemento padre dell'elemento inserito.

*hInsertAfter*<br/>
Handle dell'elemento dopo il quale deve essere inserito il nuovo elemento.

### <a name="return-value"></a>Valore restituito

Handle del nuovo elemento se ha esito positivo. in caso contrario NULL.

### <a name="remarks"></a>Note

L'esempio illustra situazioni in cui è possibile usare ogni versione della funzione durante l'inserimento di un elemento del controllo albero.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]

##  <a name="itemhaschildren"></a>  CTreeCtrl::ItemHasChildren

Utilizzare questa funzione per determinare se l'elemento di struttura ad albero specificato dalla *hItem* possiede elementi figlio.

```
BOOL ItemHasChildren(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento di struttura ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento di struttura ad albero specificato da *hItem* contiene elementi figlio; 0 se non esiste.

### <a name="remarks"></a>Note

Se, pertanto, è quindi possibile usare [CTreeCtrl::GetChildItem](#getchilditem) per recuperare gli elementi figlio.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::GetSelectedItem](#getselecteditem).

##  <a name="mapaccidtoitem"></a>  CTreeCtrl::MapAccIdToItem

L'identificatore di accessibilità specificate viene eseguito il mapping all'handle di un elemento di visualizzazione ad albero nel controllo di visualizzazione ad albero corrente.

```
HTREEITEM MapAccIdToItem(UINT uAccId) const;
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*uAccId*|[in] Un identificatore di accessibilità per un elemento nell'elemento di visualizzazione ad albero.|

### <a name="return-value"></a>Valore restituito

L'handle a un elemento di visualizzazione ad albero ( `HTREEITEM`) che corrisponde alla *uAccId* parametro. Per altre informazioni, vedere la *hItem* membro delle [TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa) struttura.

### <a name="remarks"></a>Note

Gli strumenti di accessibilità sono le applicazioni che consentono agli utenti con particolari esigenze utilizzano i computer. Viene usato un identificatore di accessibilità per il `IAccessible` interfaccia per specificare in modo univoco un elemento in una finestra. Per altre informazioni sugli identificatori di accessibilità, cercare l'argomento "Sull'accessibilità supporto attivo" nella [Microsoft Developer Network](http://go.microsoft.com/fwlink/p/?linkid=56322).

Questo metodo invia il [TVM_MAPACCIDTOHTREEITEM](/windows/desktop/Controls/tvm-mapaccidtohtreeitem) messaggio, che è descritti nel SDK di Windows.

### <a name="example"></a>Esempio

L'esempio di codice seguente definisce una variabile, `m_treeCtrl`, che viene usato per accedere al controllo di visualizzazione ad albero corrente. L'esempio di codice definisce anche un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio seguente.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

L'esempio di codice seguente usa un identificatore di accessibilità e la [CTreeCtrl::MapAccIdToItem](#mapaccidtoitem) metodo per recuperare un handle per l'elemento radice della visualizzazione albero. Nell'esempio viene utilizzato l'handle e il [CTreeCtrl::GetItemPartRect](#getitempartrect) metodo consente di disegnare un rettangolo intorno a tale elemento 3D. In una sezione precedente di esempio di codice, non viene visualizzato, viene creata una visualizzazione albero che è costituito da un nodo di paese/area geografica principale per gli Stati Uniti, i sottonodi per gli stati di Washington e Pennsylvania e gli elementi dell'albero per città degli stati. È stato usato il [CTreeCtrl::MapItemToAccID](#mapitemtoaccid) metodo per associare l'elemento radice della visualizzazione albero con un identificatore di accessibilità.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

##  <a name="mapitemtoaccid"></a>  CTreeCtrl::MapItemToAccID

L'handle specificato di un elemento di visualizzazione ad albero nel controllo di visualizzazione ad albero corrente viene eseguito il mapping a un identificatore di accessibilità.

```
UINT MapItemToAccID(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hItem*|[in] Handle di un elemento di visualizzazione ad albero nel controllo. Per altre informazioni, vedere la *hItem* membro delle [TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa) struttura.|

### <a name="return-value"></a>Valore restituito

L'identificatore di accessibilità che corrisponde alla *hItem* parametro.

### <a name="remarks"></a>Note

Gli strumenti di accessibilità sono le applicazioni che consentono agli utenti con particolari esigenze utilizzano i computer. Viene usato un identificatore di accessibilità per il `IAccessible` interfaccia per specificare in modo univoco un elemento in una finestra. Per altre informazioni sugli identificatori di accessibilità, cercare l'argomento "Sull'accessibilità supporto attivo" nella [Microsoft Developer Network](http://go.microsoft.com/fwlink/p/?linkid=56322).

Questo metodo invia il [TVM_MAPHTREEITEMTOACCID](/windows/desktop/Controls/tvm-maphtreeitemtoaccid) messaggio, che è descritti nel SDK di Windows.

### <a name="example"></a>Esempio

L'esempio di codice seguente definisce una variabile, `m_treeCtrl`, che viene usato per accedere al controllo di visualizzazione ad albero corrente. L'esempio di codice definisce anche un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio seguente.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

L'esempio di codice seguente ottiene un numero di identificazione per un elemento di controllo di visualizzazione ad albero. In una sezione precedente di esempio di codice, non viene visualizzato, viene creata una visualizzazione albero che è costituito da un nodo di paese/area geografica principale per gli Stati Uniti, i sottonodi per gli stati di Washington e Pennsylvania e gli elementi dell'albero per città degli stati. Questo esempio di codice ottiene un numero di identificazione univoco del nodo di paese/area geografica principale.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]

##  <a name="select"></a>  CTreeCtrl::Select

Chiamare questa funzione per selezionare l'elemento della visualizzazione struttura ad albero specificato, scorrere l'elemento all'interno della visualizzazione o ridisegna l'elemento nello stile utilizzato per indicare la destinazione di un'operazione di trascinamento e rilascio.

```
BOOL Select(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento di struttura ad albero.

*nCode*<br/>
Il tipo di azione da intraprendere. Questo parametro può essere uno dei valori seguenti:

- TVGN_CARET imposta la selezione per l'elemento specificato.

- TVGN_DROPHILITE ridisegna l'elemento specificato nello stile utilizzato per indicare la destinazione di un'operazione di trascinamento e rilascio.

- TVGN_FIRSTVISIBLE scorre la visualizzazione ad albero in senso verticale in modo che l'elemento specificato è il primo elemento visibile.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Se *nCode* contiene il valore TVGN_CARET, la finestra padre riceve i messaggi di notifica TVN_SELCHANGING e TVN_SELCHANGED. Inoltre, se l'elemento specificato è figlio di un elemento padre compresso, elenco dell'elemento padre degli elementi figlio viene espanso per visualizzare l'elemento specificato. In questo caso, la finestra padre riceve i messaggi di notifica TVN_ITEMEXPANDING e TVN_ITEMEXPANDED.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::HitTest](#hittest).

##  <a name="selectdroptarget"></a>  CTreeCtrl::SelectDropTarget

Chiamare questa funzione per ridisegnare l'elemento nello stile utilizzato per indicare la destinazione di un'operazione di trascinamento e rilascio.

```
BOOL SelectDropTarget(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento di struttura ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

##  <a name="selectitem"></a>  CTreeCtrl::SelectItem

Chiamare questa funzione per selezionare l'elemento della visualizzazione struttura ad albero specificato.

```
BOOL SelectItem(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle di un elemento di struttura ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Se *hItem* è NULL, questa funzione viene selezionato alcun elemento.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

##  <a name="selectsetfirstvisible"></a>  CTreeCtrl::SelectSetFirstVisible

Chiamare questa funzione per scorrere la visualizzazione struttura ad albero in senso verticale in modo che l'elemento specificato è il primo elemento visibile.

```
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento di struttura ad albero da impostare come primo elemento visibile.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

La funzione Invia un messaggio alla finestra con i parametri del messaggio TVM_SELECTITEM e TVGN_FIRSTVISIBLE.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]

##  <a name="setautoscrollinfo"></a>  CTreeCtrl::SetAutoscrollInfo

Imposta la frequenza di scorrimento automatico del controllo di visualizzazione ad albero corrente.

```
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,
    UINT uUpdateTime);
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*uPixelsPerSec*|[in] Il numero di pixel al secondo da scorrere.|
|*uUpdateTime*|[in] L'intervallo di tempo tra gli aggiornamenti del controllo.|

### <a name="return-value"></a>Valore restituito

Restituisce sempre TRUE.

### <a name="remarks"></a>Note

I parametri per lo scorrimento automatico vengono utilizzati per scorrere all'interno della visualizzazione di un elemento che non è attualmente visibile. Il controllo di visualizzazione ad albero deve avere lo stile, che è descritti TVS_EX_AUTOHSCROLL [stili estesi di controllo di visualizzazione ad albero](/windows/desktop/Controls/tree-view-control-window-extended-styles).

Questo metodo invia il [TVM_SETAUTOSCROLLINFO](/windows/desktop/Controls/tvm-setautoscrollinfo) messaggio, che è descritti nel SDK di Windows.

### <a name="example"></a>Esempio

L'esempio di codice seguente definisce una variabile, `m_treeCtrl`, che viene usato per accedere al controllo di visualizzazione ad albero corrente. L'esempio di codice definisce anche un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio seguente.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Esempio di codice seguente imposta il comportamento di scorrimento automatico del controllo di visualizzazione ad albero corrente. In una sezione precedente di esempio di codice, non viene visualizzato, viene creata una visualizzazione albero che è costituito da un nodo di paese/area geografica principale per gli Stati Uniti, i sottonodi per gli stati di Washington e Pennsylvania e gli elementi dell'albero per città degli stati. Abbiamo messi specificamente il controllo di visualizzazione ad albero ridotta in modo che è necessario abilitare lo scorrimento automatico per visualizzare l'elemento di struttura ad albero con lo stato attivo. L'esempio di codice imposta il controllo di visualizzazione albero per abilitare lo scorrimento automatico 30 pixel al secondo ogni 5 secondi fino a quando non viene visualizzato l'elemento dell'albero.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]

##  <a name="setbkcolor"></a>  CTreeCtrl::SetBkColor

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETBKCOLOR](/windows/desktop/Controls/tvm-setbkcolor), come descritto nel SDK di Windows.

```
COLORREF SetBkColor(COLORREF clr);
```

### <a name="parameters"></a>Parametri

*Common Language Runtime*<br/>
Valore COLORREF che contiene il nuovo colore di sfondo. Se questo valore è -1, il controllo consentirà di ripristinare utilizzando il colore di sistema per il colore di sfondo.

### <a name="return-value"></a>Valore restituito

Valore COLORREF che rappresenta il colore del testo corrente. Se questo valore è -1, il controllo Usa il colore di sistema per il colore del testo.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::SetTextColor](#settextcolor).

##  <a name="setcheck"></a>  CTreeCtrl::SetCheck

Chiamare questa funzione membro per impostare lo stato di selezione per un elemento del controllo albero.

```
BOOL SetCheck(
    HTREEITEM hItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
HTREEITEM per ricevere la modifica dello stato di controllo.

*fCheck*<br/>
Indica se l'elemento del controllo albero deve essere selezionato o deselezionato. Per impostazione predefinita, `SetCheck` imposta l'elemento da controllare.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Quando è selezionato l'elemento del controllo albero ( *fCheck* impostata su TRUE), l'elemento viene visualizzato un segno di spunta accanto.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]

### <a name="example"></a>Esempio

Per usare le caselle di controllo, impostare TVS_CHECKBOXES prima di popolare il controllo struttura ad albero.

[!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]

##  <a name="setextendedstyle"></a>  CTreeCtrl::SetExtendedStyle

Imposta gli stili estesi per il controllo di visualizzazione ad albero corrente.

```
DWORD SetExtendedStyle(
    DWORD dwExMask,
    DWORD dwExStyles);
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*dwExMask*|[in] Maschera di bit che specifica gli stili del controllo di visualizzazione ad albero corrente sono interessati da questo metodo. Se questo parametro è zero, viene ignorato e il valore della *dwExStyles* parametro viene assegnato al controllo di visualizzazione ad albero.<br /><br /> Specificare zero o una combinazione bit per bit (OR) di stili descritto nella [stili estesi del controllo di visualizzazione ad albero](/windows/desktop/Controls/tree-view-control-window-extended-styles).|
|*dwExStyles*|[in] Maschera di bit che specifica il controllo per impostare o cancellare gli stili nella visualizzazione struttura ad albero corrente.<br /><br /> Per impostare una combinazione degli stili, specificare una combinazione bit per bit (OR) di stili descritto nella [stili estesi del controllo di visualizzazione ad albero](/windows/desktop/Controls/tree-view-control-window-extended-styles). Per cancellare un set di stili, specificare zero.|

### <a name="return-value"></a>Valore restituito

Un valore che contiene il precedente estesa degli stili del controllo.

### <a name="remarks"></a>Note

Questo metodo cancella gli stili specificati nel *dwExMask* parametro, quindi imposta gli stili specificati nel *dwExStyles* parametro. Solo gli stili estesi che corrispondono ai bit nel *dwExMask* modificare.

Questo metodo invia il [TVM_SETEXTENDEDSTYLE](/windows/desktop/Controls/tvm-setextendedstyle) messaggio, che è descritti nel SDK di Windows.

### <a name="example"></a>Esempio

L'esempio di codice seguente definisce una variabile, `m_treeCtrl`, che viene usato per accedere al controllo di visualizzazione ad albero corrente. L'esempio di codice definisce anche un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio seguente.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Esempio di codice seguente viene aggiunto lo stile esteso TVS_EX_AUTOHSCROLL e per il controllo di visualizzazione ad albero corrente. In una sezione precedente di esempio di codice, non viene visualizzato, viene creata una visualizzazione albero che è costituito da un nodo di paese/area geografica principale per gli Stati Uniti, i sottonodi per gli stati di Washington e Pennsylvania e gli elementi dell'albero per città degli stati. Abbiamo messi specificamente il controllo di visualizzazione ad albero ridotta in modo che è necessario abilitare lo scorrimento automatico per visualizzare l'elemento di struttura ad albero con lo stato attivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]

##  <a name="setimagelist"></a>  CTreeCtrl::SetImageList

Chiamare questa funzione per impostare la normale o elenco di immagini di stato per una struttura di controllo di visualizzazione e ricreare il controllo usando le nuove immagini.

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>Parametri

*pImageList*<br/>
Puntatore all'elenco di immagini da assegnare. Se *pImageList* è NULL, tutte le immagini vengono rimossi dal controllo di visualizzazione albero.

*nImageListType*<br/>
Tipo di elenco immagini da impostare. L'elenco di immagini può essere uno dei valori seguenti:

- TVSIL_NORMAL imposta l'elenco di immagini normale, che contiene le immagini per e selezionate per l'elemento della visualizzazione struttura ad albero. È necessario utilizzare questo stato per le immagini sovrapposte.

- TVSIL_STATE imposta l'elenco di immagini di stato, che contiene le immagini per gli elementi di visualizzazione albero che si trovano nello stato definiti dall'utente.

### <a name="return-value"></a>Valore restituito

Puntatore all'elenco di immagini precedenti, se presente. in caso contrario NULL.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::GetImageList](#getimagelist).

##  <a name="setindent"></a>  CTreeCtrl::SetIndent

Chiamare questa funzione per impostare la larghezza del rientro per un controllo di visualizzazione albero e ricreare il controllo in modo da riflettere la nuova larghezza.

```
void SetIndent(UINT nIndent);
```

### <a name="parameters"></a>Parametri

*nIndent*<br/>
Larghezza in pixel, del rientro. Se *nIndent* è minore rispetto alla larghezza minima definito dal sistema, la nuova larghezza è impostata su almeno definito dal sistema.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::GetIndent](#getindent).

##  <a name="setinsertmark"></a>  CTreeCtrl::SetInsertMark

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETINSERTMARK](/windows/desktop/Controls/tvm-setinsertmark), come descritto nel SDK di Windows.

```
BOOL SetInsertMark(
    HTREEITEM hItem,
    BOOL fAfter = TRUE);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
HTREEITEM che specifica in quale elemento verrà inserito il segno di inserimento. Se questo argomento è NULL, viene rimosso il segno di inserimento.

*fAfter*<br/>
Valore booleano che specifica se il segno di inserimento viene posizionato prima o dopo l'elemento specificato. Se questo argomento è diverso da zero, verrà posizionato il segno di inserimento dopo l'elemento. Se questo argomento è zero, il segno di inserimento verrà inserito prima dell'elemento.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]

##  <a name="setinsertmarkcolor"></a>  CTreeCtrl::SetInsertMarkColor

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETINSERTMARKCOLOR](/windows/desktop/Controls/tvm-setinsertmarkcolor), come descritto nel SDK di Windows.

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>Parametri

*clrNew*<br/>
Valore COLORREF che contiene il nuovo colore del segno di inserimento.

### <a name="return-value"></a>Valore restituito

Valore COLORREF che contiene il colore del segno di inserimento precedente.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor).

##  <a name="setitem"></a>  CTreeCtrl::SetItem

Chiamare questa funzione per impostare gli attributi dell'elemento di visualizzazione albero specificato.

```
BOOL SetItem(TVITEM* pItem);


BOOL SetItem(
    HTREEITEM hItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);
```

### <a name="parameters"></a>Parametri

*pItem*<br/>
Un puntatore a un [struttura TVITEM](/windows/desktop/api/commctrl/ns-commctrl-tagtvitema) struttura che contiene il nuovo elemento di attributi, come descritto nel SDK di Windows.

*hItem*<br/>
Handle dell'elemento di cui attributi devono essere impostate. Vedere le `hItem` membro del `TVITEM` struttura nel SDK di Windows.

*nMask*<br/>
Numero intero che specifica gli attributi da impostare. Vedere le `mask` membro del `TVITEM` struttura.

*lpszItem*<br/>
Indirizzo di una stringa contenente il testo dell'elemento.

*Immagine*<br/>
Indice dell'immagine dell'elemento nell'elenco di immagini di controllo di visualizzazione albero. Vedere le `iImage` membro del `TVITEM` struttura.

*nSelectedImage*<br/>
Indice dell'immagine selezionata dell'elemento nell'elenco di immagini di controllo di visualizzazione albero. Vedere le `iSelectedImage` membro del `TVITEM` struttura.

*nState*<br/>
Specifica i valori per gli Stati dell'elemento. Vedere le `State` membro del `TVITEM` struttura.

*nStateMask*<br/>
Specifica gli stati da impostare. Vedere le `stateMask` membro del `TVITEM` struttura.

*lParam*<br/>
Un valore a 32 bit specifiche dell'applicazione associato all'elemento.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Nel `TVITEM` struttura, il `hItem` membro identifica l'elemento e il `mask` membro specifica gli attributi da impostare.

Se il `mask` membro o la *nMask* parametro specifica il valore TVIF_TEXT, il `pszText` membro o la *lpszItem* è l'indirizzo di una stringa con terminazione null e il `cchTextMax` membro viene ignorato. Se `mask` (o *nMask*) specifica il valore TVIF_STATE, il `stateMask` membro o la *nStateMask* parametro specifica quale elemento stati da modificare e `state` membro o *nState* parametro contiene i valori per questi stati.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]

##  <a name="setitemdata"></a>  CTreeCtrl::SetItemData

Chiamare questa funzione per impostare il valore specifiche dell'applicazione a 32 bit associato con l'elemento specificato.

```
BOOL SetItemData(
    HTREEITEM hItem,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento cui i dati da recuperare.

*dwData*<br/>
Un valore specifico dell'applicazione a 32 bit associato all'elemento specificato da *hItem*.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]

##  <a name="setitemexpandedimageindex"></a>  CTreeCtrl::SetItemExpandedImageIndex

Imposta l'indice dell'immagine da visualizzare quando l'elemento specificato del controllo di visualizzazione ad albero corrente si trova nello stato espanso.

```
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,
    int iExpandedImage);
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hItem*|[in] Handle per un elemento di controllo di visualizzazione ad albero.|
|*iExpandedImage*|[in] L'indice dell'immagine da visualizzare quando l'elemento specificato si trova nello stato espanso.|

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Note

Questo metodo invia il [TVM_SETITEM](/windows/desktop/Controls/tvm-setitem) messaggio, che è descritti nel SDK di Windows. Questo metodo assegna il *iExpandedImage* parametro per il `iExpandedImage` membro di un [TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa) struttura e quindi usa tale struttura nel messaggio.

### <a name="example"></a>Esempio

L'esempio di codice seguente definisce una variabile, `m_treeCtrl`, che viene usato per accedere al controllo di visualizzazione ad albero corrente. L'esempio di codice definisce anche un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio seguente.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Il codice seguente è un semplice test per determinare se il [CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex) metodo restituisce il valore impostato il [CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex) (metodo). In una sezione precedente di esempio di codice, non viene visualizzato, viene creata una visualizzazione albero che è costituito da un nodo di paese/area geografica principale per gli Stati Uniti, i sottonodi per gli stati di Washington e Pennsylvania e gli elementi dell'albero per città degli stati.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]

##  <a name="setitemheight"></a>  CTreeCtrl::SetItemHeight

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETITEMHEIGHT](/windows/desktop/Controls/tvm-setitemheight), come descritto nel SDK di Windows.

```
SHORT SetItemHeight(SHORT cyHeight);
```

### <a name="parameters"></a>Parametri

*cyHeight*<br/>
Specifica la nuova altezza di ogni elemento nella visualizzazione albero, in pixel. Se questo argomento è minore rispetto all'altezza delle immagini, verrà impostato all'altezza delle immagini. Se questo argomento non è uniformi, verrà arrotondato verso il basso al più vicino anche valore. Se questo argomento è -1, il controllo userà relativa altezza predefinita dell'elemento.

### <a name="return-value"></a>Valore restituito

L'altezza precedente degli elementi, in pixel.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::GetItemHeight](#getitemheight).

##  <a name="setitemimage"></a>  CTreeCtrl::SetItemImage

Associa le immagini a un elemento.

```
BOOL SetItemImage(
    HTREEITEM hItem,
    int nImage,
    int nSelectedImage);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento cui immagine deve essere impostata.

*Immagine*<br/>
Indice dell'immagine dell'elemento nell'elenco di immagini di controllo di visualizzazione albero.

*nSelectedImage*<br/>
Indice dell'immagine selezionata dell'elemento nell'elenco di immagini di controllo di visualizzazione albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Ogni elemento in un controllo di visualizzazione albero può avere una coppia di immagini bitmap associata. Le immagini vengono visualizzate a sinistra dell'etichetta di un elemento. Quando l'elemento è selezionato, e l'altra viene visualizzata quando l'elemento non è selezionata, viene visualizzata un'immagine. Ad esempio, un elemento potrebbe visualizzare una cartella aperta quando viene selezionato e una cartella chiusa quando non è selezionata.

Chiamare questa funzione per impostare l'indice dell'immagine dell'elemento e l'immagine selezionata all'interno di elenco di immagini di controllo di visualizzazione albero.

Per altre informazioni sulle immagini, vedere [CImageList](../../mfc/reference/cimagelist-class.md).

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::GetItemImage](#getitemimage).

##  <a name="setitemstate"></a>  CTreeCtrl::SetItemState

Imposta lo stato dell'elemento specificato dalla *hItem*.

```
BOOL SetItemState(
    HTREEITEM hItem,
    UINT nState,
    UINT nStateMask);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento cui stato da impostare.

*nState*<br/>
Specifica gli stati nuovo per l'elemento.

*nStateMask*<br/>
Specifica gli stati devono essere modificati.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Per informazioni sugli stati, vedere [CTreeCtrl::GetItem](#getitem).

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::GetItemState](#getitemstate).

##  <a name="setitemstateex"></a>  CTreeCtrl::SetItemStateEx

Imposta lo stato dell'elemento specificato nel controllo di visualizzazione ad albero corrente.

```
BOOL SetItemStateEx(
    HTREEITEM hItem,
    UINT uStateEx);
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hItem*|[in] Handle per un elemento di controllo di visualizzazione ad albero.|
|*uStateEx*|[in] Lo stato dell'elemento. Per altre informazioni, vedere la `uStateEx` membro della [TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa) struttura.|

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Note

Questo metodo invia il [TVM_SETITEM](/windows/desktop/Controls/tvm-setitem) messaggio, che è descritti nel SDK di Windows. Questo metodo assegna il *uStateEx* parametro per il `uStateEx` membro di un [TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa) struttura e quindi usa tale struttura nel messaggio.

### <a name="example"></a>Esempio

L'esempio di codice seguente definisce una variabile, `m_treeCtrl`, che viene usato per accedere al controllo di visualizzazione ad albero corrente. L'esempio di codice definisce anche un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono usate nell'esempio seguente.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Esempio di codice seguente imposta un elemento di visualizzazione albero stato disabilitato. In una sezione precedente di esempio di codice, non viene visualizzato, viene creata una visualizzazione albero che è costituito da un nodo di paese/area geografica principale per gli Stati Uniti, i sottonodi per gli stati di Washington e Pennsylvania e gli elementi dell'albero per città degli stati. Questo esempio di codice imposta il nodo Pennsylvania stato disabilitato.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]

##  <a name="setitemtext"></a>  CTreeCtrl::SetItemText

Imposta il testo dell'elemento specificato dalla *hItem*.

```
BOOL SetItemText(
    HTREEITEM hItem,
    LPCTSTR lpszItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento cui testo da impostare.

*lpszItem*<br/>
Indirizzo di una stringa contenente il nuovo testo per l'elemento

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]

##  <a name="setlinecolor"></a>  CTreeCtrl::SetLineColor

Chiamare questa funzione membro per impostare il colore della linea corrente per il controllo di visualizzazione albero.

```
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```

### <a name="parameters"></a>Parametri

*clrNew*<br/>
Il nuovo colore della linea.

### <a name="return-value"></a>Valore restituito

Il colore della linea precedente.

### <a name="remarks"></a>Note

Questa funzione membro implementa il comportamento del messaggio win32 [TVM_SETLINECOLOR](/windows/desktop/Controls/tvm-setlinecolor), come descritto nel SDK di Windows.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]

##  <a name="setscrolltime"></a>  CTreeCtrl::SetScrollTime

Chiamare questa funzione membro per impostare l'intervallo di scorrimento massimo per il controllo di visualizzazione albero.

```
UINT SetScrollTime(UINT uScrollTime);
```

### <a name="parameters"></a>Parametri

*uScrollTime*<br/>
La nuova ora, scorrimento massimo in millisecondi. Se questo valore è minore di 100, sarà arrotondato per eccesso a 100.

### <a name="return-value"></a>Valore restituito

Tempo massimo scorrimento precedente, in millisecondi.

### <a name="remarks"></a>Note

Questa funzione membro implementa il comportamento del messaggio win32 [TVM_SETSCROLLTIME](/windows/desktop/Controls/tvm-setscrolltime), come descritto nel SDK di Windows.

##  <a name="settextcolor"></a>  CTreeCtrl::SetTextColor

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETTEXTCOLOR](/windows/desktop/Controls/tvm-settextcolor), come descritto nel SDK di Windows.

```
COLORREF SetTextColor(COLORREF clr);
```

### <a name="parameters"></a>Parametri

*Common Language Runtime*<br/>
Valore COLORREF che contiene il nuovo colore del testo. Se questo argomento è -1, il controllo consentirà di ripristinare utilizzando il colore di sistema per il colore del testo.

### <a name="return-value"></a>Valore restituito

Valore COLORREF che rappresenta il colore del testo precedente. Se questo valore è -1, il controllo usava il colore di sistema per il colore del testo.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]

##  <a name="settooltips"></a>  CTreeCtrl::SetToolTips

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETTOOLTIPS](/windows/desktop/Controls/tvm-settooltips), come descritto nel SDK di Windows.

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>Parametri

*pWndTip*<br/>
Un puntatore a un [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) oggetto che verrà utilizzato il controllo struttura ad albero.

### <a name="return-value"></a>Valore restituito

Un puntatore a un [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) oggetto contenente la descrizione comando utilizzata in precedenza per il controllo o NULL se delle descrizioni comando sono state usate in precedenza.

### <a name="remarks"></a>Note

Per utilizzare le descrizioni comandi, indicano lo stile TVS_NOTOOLTIPS quando si crea il `CTreeCtrl` oggetto.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CTreeCtrl::GetToolTips](#gettooltips).

##  <a name="showinfotip"></a>  CTreeCtrl::ShowInfoTip

Consente di visualizzare l'infotip per l'elemento specificato nel controllo di visualizzazione ad albero corrente.

```
void ShowInfoTip(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hItem*|[in] Handle per un elemento della visualizzazione albero nel controllo. Per altre informazioni, vedere la `hItem` membro della [TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa) struttura.|

### <a name="remarks"></a>Note

Per altre informazioni sulla differenza tra le descrizioni comandi e infotip, cercare l'argomento "Descrizioni comandi e Infotip" all'indirizzo [Microsoft Developer Network](http://go.microsoft.com/fwlink/p/?linkid=56322).

Questo metodo invia il [TVM_SHOWINFOTIP](/windows/desktop/Controls/tvm-showinfotip) messaggio, che è descritti nel SDK di Windows.

##  <a name="sortchildren"></a>  CTreeCtrl::SortChildren

Chiamare questa funzione per ordinare alfabeticamente gli elementi figlio dell'elemento padre specificato in un controllo di visualizzazione albero.

```
BOOL SortChildren(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hItem*<br/>
Handle dell'elemento padre devono essere ordinati in cui gli elementi figlio. Se *hItem* è NULL, l'ordinamento sarà possibile proseguire dalla radice dell'albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

`SortChildren` non esegue la ricorsione attraverso l'albero. solo i figli immediati del *hItem* verranno ordinati.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]

##  <a name="sortchildrencb"></a>  CTreeCtrl::SortChildrenCB

Chiamare questa funzione per ordinare gli elementi di visualizzazione albero usando una funzione di richiamata definita dall'applicazione che consente di confrontare gli elementi.

```
BOOL SortChildrenCB(LPTVSORTCB pSort);
```

### <a name="parameters"></a>Parametri

*pSort*<br/>
Puntatore a un [TVSORTCB](/windows/desktop/api/commctrl/ns-commctrl-tagtvsortcb) struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Funzione di confronto della struttura, `lpfnCompare`, deve restituire un valore negativo se il primo elemento necessario far precedere il secondo, un valore positivo se il primo elemento deve seguire la seconda, oppure zero se i due elementi sono equivalenti.

Il *lParam1* e *lParam2* parametri corrispondono ai `lParam` membro del [struttura TVITEM](/windows/desktop/api/commctrl/ns-commctrl-tagtvitema) struttura per i due elementi confrontati. Il *lParamSort* parametro corrisponde al `lParam` membro del `TV_SORTCB` struttura.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]

[!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]

## <a name="see-also"></a>Vedere anche

[CMNCTRL1 esempio MFC](../../visual-cpp-samples.md)<br/>
[Classe CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Grafico della gerarchia](../../mfc/hierarchy-chart.md)<br/>
[Classe CImageList](../../mfc/reference/cimagelist-class.md)
