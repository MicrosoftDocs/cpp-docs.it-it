---
description: 'Altre informazioni su: classe CWinAppEx'
title: Classe CWinAppEx
ms.date: 11/04/2016
f1_keywords:
- CWinAppEx
- AFXWINAPPEX/CWinAppEx
- AFXWINAPPEX/CWinAppEx::CWinAppEx
- AFXWINAPPEX/CWinAppEx::CleanState
- AFXWINAPPEX/CWinAppEx::EnableLoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::EnableTearOffMenus
- AFXWINAPPEX/CWinAppEx::EnableUserTools
- AFXWINAPPEX/CWinAppEx::ExitInstance
- AFXWINAPPEX/CWinAppEx::GetBinary
- AFXWINAPPEX/CWinAppEx::GetContextMenuManager
- AFXWINAPPEX/CWinAppEx::GetDataVersion
- AFXWINAPPEX/CWinAppEx::GetDataVersionMajor
- AFXWINAPPEX/CWinAppEx::GetDataVersionMinor
- AFXWINAPPEX/CWinAppEx::GetInt
- AFXWINAPPEX/CWinAppEx::GetKeyboardManager
- AFXWINAPPEX/CWinAppEx::GetMouseManager
- AFXWINAPPEX/CWinAppEx::GetObject
- AFXWINAPPEX/CWinAppEx::GetRegSectionPath
- AFXWINAPPEX/CWinAppEx::GetRegistryBase
- AFXWINAPPEX/CWinAppEx::GetSectionBinary
- AFXWINAPPEX/CWinAppEx::GetSectionInt
- AFXWINAPPEX/CWinAppEx::GetSectionObject
- AFXWINAPPEX/CWinAppEx::GetSectionString
- AFXWINAPPEX/CWinAppEx::GetShellManager
- AFXWINAPPEX/CWinAppEx::GetString
- AFXWINAPPEX/CWinAppEx::GetTooltipManager
- AFXWINAPPEX/CWinAppEx::GetUserToolsManager
- AFXWINAPPEX/CWinAppEx::InitContextMenuManager
- AFXWINAPPEX/CWinAppEx::InitKeyboardManager
- AFXWINAPPEX/CWinAppEx::InitMouseManager
- AFXWINAPPEX/CWinAppEx::InitShellManager
- AFXWINAPPEX/CWinAppEx::InitTooltipManager
- AFXWINAPPEX/CWinAppEx::IsResourceSmartUpdate
- AFXWINAPPEX/CWinAppEx::IsStateExists
- AFXWINAPPEX/CWinAppEx::LoadState
- AFXWINAPPEX/CWinAppEx::OnAppContextHelp
- AFXWINAPPEX/CWinAppEx::OnViewDoubleClick
- AFXWINAPPEX/CWinAppEx::OnWorkspaceIdle
- AFXWINAPPEX/CWinAppEx::SaveState
- AFXWINAPPEX/CWinAppEx::SetRegistryBase
- AFXWINAPPEX/CWinAppEx::ShowPopupMenu
- AFXWINAPPEX/CWinAppEx::WriteBinary
- AFXWINAPPEX/CWinAppEx::WriteInt
- AFXWINAPPEX/CWinAppEx::WriteObject
- AFXWINAPPEX/CWinAppEx::WriteSectionBinary
- AFXWINAPPEX/CWinAppEx::WriteSectionInt
- AFXWINAPPEX/CWinAppEx::WriteSectionObject
- AFXWINAPPEX/CWinAppEx::WriteSectionString
- AFXWINAPPEX/CWinAppEx::WriteString
- AFXWINAPPEX/CWinAppEx::LoadCustomState
- AFXWINAPPEX/CWinAppEx::LoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::OnClosingMainFrame
- AFXWINAPPEX/CWinAppEx::PreLoadState
- AFXWINAPPEX/CWinAppEx::PreSaveState
- AFXWINAPPEX/CWinAppEx::ReloadWindowPlacement
- AFXWINAPPEX/CWinAppEx::SaveCustomState
- AFXWINAPPEX/CWinAppEx::StoreWindowPlacement
- AFXWINAPPEX/CWinAppEx::m_bForceImageReset
helpviewer_keywords:
- CWinAppEx [MFC], CWinAppEx
- CWinAppEx [MFC], CleanState
- CWinAppEx [MFC], EnableLoadWindowPlacement
- CWinAppEx [MFC], EnableTearOffMenus
- CWinAppEx [MFC], EnableUserTools
- CWinAppEx [MFC], ExitInstance
- CWinAppEx [MFC], GetBinary
- CWinAppEx [MFC], GetContextMenuManager
- CWinAppEx [MFC], GetDataVersion
- CWinAppEx [MFC], GetDataVersionMajor
- CWinAppEx [MFC], GetDataVersionMinor
- CWinAppEx [MFC], GetInt
- CWinAppEx [MFC], GetKeyboardManager
- CWinAppEx [MFC], GetMouseManager
- CWinAppEx [MFC], GetObject
- CWinAppEx [MFC], GetRegSectionPath
- CWinAppEx [MFC], GetRegistryBase
- CWinAppEx [MFC], GetSectionBinary
- CWinAppEx [MFC], GetSectionInt
- CWinAppEx [MFC], GetSectionObject
- CWinAppEx [MFC], GetSectionString
- CWinAppEx [MFC], GetShellManager
- CWinAppEx [MFC], GetString
- CWinAppEx [MFC], GetTooltipManager
- CWinAppEx [MFC], GetUserToolsManager
- CWinAppEx [MFC], InitContextMenuManager
- CWinAppEx [MFC], InitKeyboardManager
- CWinAppEx [MFC], InitMouseManager
- CWinAppEx [MFC], InitShellManager
- CWinAppEx [MFC], InitTooltipManager
- CWinAppEx [MFC], IsResourceSmartUpdate
- CWinAppEx [MFC], IsStateExists
- CWinAppEx [MFC], LoadState
- CWinAppEx [MFC], OnAppContextHelp
- CWinAppEx [MFC], OnViewDoubleClick
- CWinAppEx [MFC], OnWorkspaceIdle
- CWinAppEx [MFC], SaveState
- CWinAppEx [MFC], SetRegistryBase
- CWinAppEx [MFC], ShowPopupMenu
- CWinAppEx [MFC], WriteBinary
- CWinAppEx [MFC], WriteInt
- CWinAppEx [MFC], WriteObject
- CWinAppEx [MFC], WriteSectionBinary
- CWinAppEx [MFC], WriteSectionInt
- CWinAppEx [MFC], WriteSectionObject
- CWinAppEx [MFC], WriteSectionString
- CWinAppEx [MFC], WriteString
- CWinAppEx [MFC], LoadCustomState
- CWinAppEx [MFC], LoadWindowPlacement
- CWinAppEx [MFC], OnClosingMainFrame
- CWinAppEx [MFC], PreLoadState
- CWinAppEx [MFC], PreSaveState
- CWinAppEx [MFC], ReloadWindowPlacement
- CWinAppEx [MFC], SaveCustomState
- CWinAppEx [MFC], StoreWindowPlacement
- CWinAppEx [MFC], m_bForceImageReset
ms.assetid: a3d3e053-3e22-463f-9444-c73abb1bb9d7
ms.openlocfilehash: ebfe242d3b0f2b9c2c7941871ab57ba8da97d172
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/11/2020
ms.locfileid: "97318455"
---
# <a name="cwinappex-class"></a>Classe CWinAppEx

`CWinAppEx` gestisce lo stato dell'applicazione, Salva lo stato nel registro di sistema, carica lo stato dal registro di sistema, Inizializza i gestori applicazione e fornisce collegamenti a tali gestori di applicazioni.

Per informazioni dettagliate, vedere il codice sorgente disponibile nella **cartella \\ \\ \\ MFC atlmfc src di VC** per l'installazione di Visual Studio.

## <a name="syntax"></a>Sintassi

```
class CWinAppEx : public CWinApp
```

## <a name="members"></a>Members

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Description|
|----------|-----------------|
|[CWinAppEx:: CWinAppEx](#cwinappex)|Costruisce un oggetto `CWinAppEx`.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Description|
|----------|-----------------|
|[CWinAppEx:: CleanState](#cleanstate)|Rimuove le informazioni relative all'applicazione dal registro di sistema di Windows.|
|[CWinAppEx:: EnableLoadWindowPlacement](#enableloadwindowplacement)|Specifica se l'applicazione caricherà le dimensioni e il percorso iniziali della finestra cornice principale dal registro di sistema.|
|[CWinAppEx:: EnableTearOffMenus](#enabletearoffmenus)|Abilita i menu di strappo per l'applicazione.|
|[CWinAppEx:: EnableUserTools](#enableusertools)|Consente all'utente di creare comandi di menu personalizzati nell'applicazione.|
|[CWinAppEx:: ExitInstance](#exitinstance)|Chiamata eseguita dal Framework all'interno della `Run` funzione membro per uscire da questa istanza dell'applicazione. Esegue l'override di [CWinApp:: ExitInstance](../../mfc/reference/cwinapp-class.md#exitinstance).|
|[CWinAppEx:: GetBinary](#getbinary)|Legge i dati binari associati al valore del registro di sistema specificato.|
|[CWinAppEx:: GetContextMenuManager](#getcontextmenumanager)|Restituisce un puntatore all'oggetto [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) globale.|
|[CWinAppEx:: GetDataVersion](#getdataversion)||
|[CWinAppEx:: GetDataVersionMajor](#getdataversionmajor)|Restituisce la versione principale dell'applicazione salvata nel registro di sistema di Windows.|
|[CWinAppEx:: GetDataVersionMinor](#getdataversionminor)|Restituisce la versione secondaria dell'applicazione salvata nel registro di sistema di Windows.|
|[CWinAppEx:: GetInt](#getint)|Legge i dati numerici associati al valore specificato dal registro di sistema.|
|[CWinAppEx:: GetKeyboardManager](#getkeyboardmanager)|Restituisce un puntatore all'oggetto [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) globale.|
|[CWinAppEx:: GetMouseManager](#getmousemanager)|Restituisce un puntatore all'oggetto [CMouseManager](../../mfc/reference/cmousemanager-class.md) globale.|
|[CWinAppEx:: GetObject](#getobject)|Legge i `CObject` dati derivati associati al valore specificato dal registro di sistema.|
|[CWinAppEx:: GetRegSectionPath](#getregsectionpath)|Restituisce una stringa che rappresenta il percorso di una chiave del registro di sistema. Questo percorso concatena il percorso relativo fornito con il percorso dell'applicazione.|
|[CWinAppEx:: GetRegistryBase](#getregistrybase)|Restituisce il percorso del registro di sistema per l'applicazione.|
|[CWinAppEx:: GetSectionBinary](#getsectionbinary)|Legge i dati binari associati alla chiave e al valore specificati dal registro di sistema.|
|[CWinAppEx:: GetSectionInt](#getsectionint)|Legge i dati numerici dal registro di sistema associato alla chiave e al valore specificati.|
|[CWinAppEx:: GetSectionObject](#getsectionobject)|Legge i `CObject` dati associati alla chiave e al valore specificati dal registro di sistema.|
|[CWinAppEx:: GetSectionString](#getsectionstring)|Legge i dati stringa associati alla chiave e al valore specificati dal registro di sistema.|
|[CWinAppEx:: GetShellManager](#getshellmanager)|Restituisce un puntatore all'oggetto [CShellManager](../../mfc/reference/cshellmanager-class.md) globale.|
|[CWinAppEx:: GetString](#getstring)|Legge i dati stringa associati al valore specificato dal registro di sistema.|
|[CWinAppEx:: GetTooltipManager](#gettooltipmanager)|Restituisce un puntatore all'oggetto [CTooltipManager](../../mfc/reference/ctooltipmanager-class.md) globale.|
|[CWinAppEx:: GetUserToolsManager](#getusertoolsmanager)|Restituisce un puntatore all'oggetto [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md) globale.|
|[CWinAppEx:: InitContextMenuManager](#initcontextmenumanager)|Inizializza l'oggetto `CContextMenuManager`.|
|[CWinAppEx:: InitKeyboardManager](#initkeyboardmanager)|Inizializza l'oggetto `CKeyboardManager`.|
|[CWinAppEx:: InitMouseManager](#initmousemanager)|Inizializza l'oggetto `CMouseManager`.|
|[CWinAppEx:: InitShellManager](#initshellmanager)|Inizializza la `CShellManager` classe.|
|[CWinAppEx:: InitTooltipManager](#inittooltipmanager)|Inizializza la classe `CTooltipManager`.|
|[CWinAppEx:: IsResourceSmartUpdate](#isresourcesmartupdate)||
|[CWinAppEx:: IsStateExists](#isstateexists)|Indica se la chiave specificata si trova nel registro di sistema.|
|[CWinAppEx:: LoadState](#loadstate)|Carica lo stato dell'applicazione dal registro di sistema.|
|[CWinAppEx:: OnAppContextHelp](#onappcontexthelp)|Chiamata eseguita dal framework quando l'utente richiede la guida del contesto per la finestra di dialogo di **personalizzazione** .|
|[CWinAppEx:: OnViewDoubleClick](#onviewdoubleclick)|Chiama il comando definito dall'utente quando l'utente fa doppio clic in un punto qualsiasi dell'applicazione.|
|[CWinAppEx:: OnWorkspaceIdle](#onworkspaceidle)||
|[CWinAppEx:: SaveState](#savestate)|Scrive lo stato del Framework applicazione nel registro di sistema di Windows.|
|[CWinAppEx:: SetRegistryBase](#setregistrybase)|Imposta il percorso della chiave del registro di sistema predefinita. Questa chiave fungerà da radice per tutte le chiamate successive al registro di sistema.|
|[CWinAppEx:: ShowPopupMenu](#showpopupmenu)|Consente di visualizzare un menu di scelta rapida.|
|[CWinAppEx:: WriteBinary](#writebinary)|Scrive i dati binari nel valore del registro di sistema specificato.|
|[CWinAppEx:: WriteInt](#writeint)|Scrive i dati numerici nel valore del registro di sistema specificato.|
|[CWinAppEx:: WriteObject](#writeobject)|Scrive i dati derivati dalla [classe CObject](../../mfc/reference/cobject-class.md) nel valore del registro di sistema specificato.|
|[CWinAppEx:: WriteSectionBinary](#writesectionbinary)|Scrive i dati binari in un valore della chiave del registro di sistema specificata.|
|[CWinAppEx:: WriteSectionInt](#writesectionint)|Scrive i dati numerici in un valore della chiave del registro di sistema specificata.|
|[CWinAppEx:: WriteSectionObject](#writesectionobject)|Scrive i dati derivati dalla `CObject` classe in un valore della chiave del registro di sistema specificata.|
|[CWinAppEx:: WriteSectionString](#writesectionstring)|Scrive i dati stringa in un valore della chiave del registro di sistema specificata.|
|[CWinAppEx:: WriteString](#writestring)|Scrive i dati stringa nel valore del registro di sistema specificato.|

### <a name="protected-methods"></a>Metodi protetti

|Nome|Description|
|----------|-----------------|
|[CWinAppEx:: LoadCustomState](#loadcustomstate)|Chiamata eseguita dal framework quando è stato caricato lo stato dell'applicazione.|
|[CWinAppEx:: LoadWindowPlacement](#loadwindowplacement)|Chiamata eseguita dal framework quando carica le dimensioni e la posizione dell'applicazione dal registro di sistema. I dati caricati includono le dimensioni e la posizione del fotogramma principale al momento dell'ultima chiusura dell'applicazione.|
|[CWinAppEx:: OnClosingMainFrame](#onclosingmainframe)|Chiamata eseguita dal framework quando una finestra cornice principale viene elaborata WM_CLOSE.|
|[CWinAppEx::P reloadstate](#preloadstate)|Chiamata eseguita dal framework immediatamente prima del caricamento dello stato dell'applicazione.|
|[CWinAppEx::P reSaveState](#presavestate)|Chiamata eseguita dal framework immediatamente prima del salvataggio dello stato dell'applicazione.|
|[CWinAppEx:: ReloadWindowPlacement](#reloadwindowplacement)|Ricarica le dimensioni e la posizione della finestra fornita dal registro di sistema|
|[CWinAppEx:: SaveCustomState](#savecustomstate)|Chiamata eseguita dal Framework dopo la scrittura dello stato dell'applicazione nel registro di sistema.|
|[CWinAppEx:: StoreWindowPlacement](#storewindowplacement)|Chiamato dal Framework per scrivere la dimensione e la posizione del fotogramma principale nel registro di sistema.|

### <a name="data-members"></a>Membri dei dati

|Nome|Description|
|----------|-----------------|
|[CWinAppEx:: m_bForceImageReset](#m_bforceimagereset)|Consente di specificare se il Framework Reimposta tutte le immagini della barra degli strumenti quando viene caricata la finestra cornice che contiene la barra degli strumenti.|

## <a name="remarks"></a>Commenti

Gran parte delle funzionalità fornite dal framework MFC dipende dalla `CWinAppEx` classe. È possibile incorporare la `CWinAppEx` classe nell'applicazione in uno dei due modi seguenti:

- Costruire una `CWinAppEx` classe nel thread principale.

- Derivare la classe dell'applicazione principale da `CWinAppEx` .

Una volta incorporati `CWinAppEx` nell'applicazione, è possibile inizializzare uno qualsiasi dei responsabili dell'applicazione. Prima di usare un gestore di applicazioni, è necessario inizializzarlo chiamando il metodo Initialize appropriato. Per ottenere un puntatore a un gestore specifico, chiamare il metodo Get associato. La `CWinAppEx` classe gestisce i gestori di applicazioni seguenti: [classe CMouseManager](../../mfc/reference/cmousemanager-class.md), [classe CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md), [classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md), [classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)e [Classe CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md).

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWinThread](../../mfc/reference/cwinthread-class.md)

[CWinApp](../../mfc/reference/cwinapp-class.md)

[CWinAppEx](../../mfc/reference/cwinappex-class.md)

## <a name="requirements"></a>Requisiti

**Intestazione:** afxwinappex. h

## <a name="cwinappexcleanstate"></a><a name="cleanstate"></a> CWinAppEx:: CleanState

Rimuove tutte le informazioni sull'applicazione dal registro di sistema di Windows.

```
virtual BOOL CleanState(LPCTSTR lpszSectionName=NULL);
```

### <a name="parameters"></a>Parametri

*lpszSectionName*<br/>
in Stringa che contiene un percorso di una chiave del registro di sistema.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il metodo ha avuto esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Commenti

Questo metodo cancella i dati dell'applicazione da una sezione specifica del registro di sistema. È possibile specificare la sezione da cancellare usando il parametro *lpszSectionName*. Se *lpszSectionName* è null, questo metodo utilizzerà il percorso del registro di sistema predefinito archiviato nell' `CWinAppEx` oggetto. Per ottenere il percorso predefinito del registro di sistema, usare [CWinAppEx:: GetRegistryBase](#getregistrybase).

## <a name="cwinappexcwinappex"></a><a name="cwinappex"></a> CWinAppEx:: CWinAppEx

Costruisce un oggetto `CWinAppEx`.

```
CWinAppEx(BOOL bResourceSmartUpdate = FALSE);
```

### <a name="parameters"></a>Parametri

*bResourceSmartUpdate*<br/>
in Parametro booleano che specifica se l'oggetto dell'area di lavoro deve rilevare e gestire gli aggiornamenti delle risorse.

### <a name="remarks"></a>Commenti

La `CWinAppEx` classe dispone di metodi di inizializzazione, fornisce funzionalità per il salvataggio e il caricamento delle informazioni sull'applicazione nel registro di sistema e controlla le impostazioni globali dell'applicazione. Consente inoltre di utilizzare i gestori globali, ad esempio la [classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) e la [classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md). Ogni applicazione può avere una sola istanza della `CWinAppEx` classe.

## <a name="cwinappexenableloadwindowplacement"></a><a name="enableloadwindowplacement"></a> CWinAppEx:: EnableLoadWindowPlacement

Specifica se l'applicazione caricherà le dimensioni e il percorso iniziali della finestra cornice principale dal registro di sistema.

```cpp
void EnableLoadWindowPlacement(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Parametri

*bEnable*<br/>
in Specifica se l'applicazione carica le dimensioni e il percorso iniziali della finestra cornice principale dal registro di sistema.

### <a name="remarks"></a>Commenti

Per impostazione predefinita, le dimensioni e la posizione del fotogramma principale vengono caricate dal registro di sistema insieme ad altre impostazioni dell'applicazione. Questo errore si verifica durante [CWinAppEx:: LoadState](#loadstate). Se non si desidera caricare la posizione iniziale della finestra dal registro di sistema, chiamare questo metodo con *bEnable* impostato su false.

## <a name="cwinappexenabletearoffmenus"></a><a name="enabletearoffmenus"></a> CWinAppEx:: EnableTearOffMenus

Crea e Inizializza un oggetto [CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md) .

```
BOOL EnableTearOffMenus(
    LPCTSTR lpszRegEntry,
    const UINT uiCmdFirst,
    const UINT uiCmdLast);
```

### <a name="parameters"></a>Parametri

*lpszRegEntry*<br/>
in Stringa che contiene il percorso di una chiave del registro di sistema. L'applicazione usa questa chiave del registro di sistema per archiviare le informazioni per i menu di strappo.

*uiCmdFirst*<br/>
in Primo ID menu di strappo.

*uiCmdLast*<br/>
in ID del menu dell'ultimo strappo.

### <a name="return-value"></a>Valore restituito

TRUE se l'oggetto `CMenuTearOffManager` viene creato e inizializzato correttamente. FALSE se si verifica un errore o se l'oggetto `CMenuTearOffManager` esiste già.

### <a name="remarks"></a>Commenti

Usare questa funzione per abilitare i menu tear-off nell'applicazione. È necessario chiamare questa funzione da `InitInstance` .

## <a name="cwinappexenableusertools"></a><a name="enableusertools"></a> CWinAppEx:: EnableUserTools

Consente all'utente di creare comandi di menu personalizzati per ridurre le sequenze di tasti nell'applicazione. Questo metodo crea un oggetto [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md) .

```
BOOL EnableUserTools(
    const UINT uiCmdToolsDummy,
    const UINT uiCmdFirst,
    const UINT uiCmdLast,
    CRuntimeClass* pToolRTC = RUNTIME_CLASS(CUserTool),
    UINT uArgMenuID = 0,
    UINT uInitDirMenuID = 0);
```

### <a name="parameters"></a>Parametri

*uiCmdToolsDummy*<br/>
in Unsigned Integer utilizzato dal Framework come segnaposto per l'ID del comando del menu strumenti utente.

*uiCmdFirst*<br/>
in ID del comando per il primo strumento utente.

*uiCmdLast*<br/>
in ID del comando per l'ultimo strumento utente.

*pToolRTC*<br/>
in Classe `CUserToolsManager` utilizzata dall'oggetto per creare nuovi strumenti utente.

*uArgMenuID*<br/>
in ID del menu degli argomenti.

*uInitDirMenuID*<br/>
in ID del menu per la directory iniziale dello strumento.

### <a name="return-value"></a>Valore restituito

TRUE se il metodo crea e Inizializza un `CUserToolsManager` oggetto; FALSE se il metodo ha esito negativo o se un `CUserToolsManager` oggetto esiste già.

### <a name="remarks"></a>Commenti

Quando si abilitano gli strumenti definiti dall'utente, il Framework supporta automaticamente un menu dinamico che può essere esteso durante la personalizzazione. Il framework associa ogni nuovo elemento a un comando esterno. Il Framework richiama questi comandi quando l'utente seleziona l'elemento appropriato dal menu **strumenti** .

Ogni volta che l'utente aggiunge un nuovo elemento, il Framework crea un nuovo oggetto. Il tipo di classe per il nuovo oggetto è definito da *pToolRTC*. Il tipo della classe *pToolRTC* deve essere derivato dalla [Classe CUserTool](../../mfc/reference/cusertool-class.md).

Per ulteriori informazioni sugli strumenti utente e su come incorporarli nell'applicazione, vedere [strumenti definiti dall'utente](../../mfc/user-defined-tools.md).

## <a name="cwinappexexitinstance"></a><a name="exitinstance"></a> CWinAppEx:: ExitInstance

```
virtual int ExitInstance();
```

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cwinappexgetbinary"></a><a name="getbinary"></a> CWinAppEx:: GetBinary

Legge i dati binari da una chiave del registro di sistema specificata.

```
BOOL GetBinary(
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>Parametri

*lpszEntry*<br/>
in Stringa che contiene il nome di una chiave del registro di sistema.

*ppData*<br/>
out Puntatore al buffer che il metodo compila con i dati binari.

*pBytes*<br/>
out Puntatore a un Unsigned Integer utilizzato dal metodo per scrivere il numero di byte letti.

### <a name="return-value"></a>Valore restituito

TRUE in caso di esito positivo, FALSE in caso contrario.

### <a name="remarks"></a>Commenti

Questo metodo legge i dati binari scritti nel registro di sistema. Per scrivere i dati nel registro di sistema, usare i metodi [CWinAppEx:: WriteBinary](#writebinary) e [CWinAppEx:: WriteSectionBinary](#writesectionbinary).

Il parametro *lpszEntry* è il nome di una voce del registro di sistema che si trova sotto la chiave predefinita del registro di sistema per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

## <a name="cwinappexgetcontextmenumanager"></a><a name="getcontextmenumanager"></a> CWinAppEx:: GetContextMenuManager

Restituisce un puntatore all'oggetto [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) globale.

```
CContextMenuManager* GetContextMenuManager();
```

### <a name="return-value"></a>Valore restituito

Puntatore all' `CContextMenuManager` oggetto globale.

### <a name="remarks"></a>Commenti

Se l'oggetto CContextMenuManager non è inizializzato, questa funzione chiama [CWinAppEx:: InitContextMenuManager](#initcontextmenumanager) prima di restituire un puntatore.

## <a name="cwinappexgetdataversion"></a><a name="getdataversion"></a> CWinAppEx:: GetDataVersion

```
int GetDataVersion() const;
```

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cwinappexgetdataversionmajor"></a><a name="getdataversionmajor"></a> CWinAppEx:: GetDataVersionMajor

Restituisce la versione principale dell'applicazione salvata nel registro di sistema di Windows quando si chiama [CWinAppEx:: SaveState](#savestate).

```
int GetDataVersionMajor() const;
```

### <a name="return-value"></a>Valore restituito

Valore integer che contiene il numero di versione principale.

## <a name="cwinappexgetdataversionminor"></a><a name="getdataversionminor"></a> CWinAppEx:: GetDataVersionMinor

Restituisce la versione secondaria dell'applicazione salvata nel registro di sistema di Windows quando si chiama [CWinAppEx:: SaveState](#savestate).

```
int GetDataVersionMinor() const;
```

### <a name="return-value"></a>Valore restituito

Valore integer che contiene il numero di versione secondario.

## <a name="cwinappexgetint"></a><a name="getint"></a> CWinAppEx:: GetInt

Legge i dati integer da una chiave del registro di sistema specificata.

```
int GetInt(
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>Parametri

*lpszEntry*<br/>
in Stringa che contiene il nome di una voce del registro di sistema.

*nDefault*<br/>
in Valore predefinito restituito dal metodo se la voce del registro di sistema specificata non esiste.

### <a name="return-value"></a>Valore restituito

Dati del registro di sistema se il metodo ha avuto esito positivo; in caso contrario, *nDefault*.

### <a name="remarks"></a>Commenti

Questo metodo legge i dati Integer dal registro di sistema. Se non sono presenti dati integer associati alla chiave del registro di sistema indicata da *lpszEntry*, questo metodo restituisce *nDefault*. Per scrivere i dati nel registro di sistema, usare i metodi [CWinAppEx:: WriteSectionInt](#writesectionint) e [CWinAppEx:: WriteInt](#writeint).

Il parametro *lpszEntry* è il nome di una voce del registro di sistema che si trova sotto la chiave predefinita del registro di sistema per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

## <a name="cwinappexgetkeyboardmanager"></a><a name="getkeyboardmanager"></a> CWinAppEx:: GetKeyboardManager

Restituisce un puntatore all'oggetto [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) globale.

```
CKeyboardManager* GetKeyboardManager();
```

### <a name="return-value"></a>Valore restituito

Puntatore all' `CKeyboardManager` oggetto globale.

### <a name="remarks"></a>Commenti

Se il gestore della tastiera non è inizializzato, questa funzione chiama [CWinAppEx:: InitKeyboardManager](#initkeyboardmanager) prima di restituire un puntatore.

## <a name="cwinappexgetmousemanager"></a><a name="getmousemanager"></a> CWinAppEx:: GetMouseManager

Restituisce un puntatore all'oggetto [CMouseManager](../../mfc/reference/cmousemanager-class.md) globale.

```
CMouseManager* GetMouseManager();
```

### <a name="return-value"></a>Valore restituito

Puntatore all' `CMouseManager` oggetto globale.

### <a name="remarks"></a>Commenti

Se il gestore del mouse non è inizializzato, questa funzione chiama [CWinAppEx:: InitMouseManager](#initmousemanager) prima di restituire un puntatore.

## <a name="cwinappexgetobject"></a><a name="getobject"></a> CWinAppEx:: GetObject

Legge i dati [CObject](../../mfc/reference/cobject-class.md)-derivato dal registro di sistema.

```
BOOL GetObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parametri

*lpszEntry*<br/>
in Stringa che contiene il percorso relativo di una voce del registro di sistema.

*obj*<br/>
out Riferimento a un oggetto `CObject` . Il metodo utilizza questo riferimento per archiviare i dati del registro di sistema.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il metodo ha avuto esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Commenti

Questo metodo legge i dati dal registro di sistema derivato da `CObject` . Per scrivere i `CObject` dati nel registro di sistema, usare [CWinAppEx:: WriteObject](#writeobject) o [CWinAppEx:: WriteSectionObject](#writesectionobject).

Il parametro *lpszEntry* è il nome di una voce del registro di sistema che si trova sotto la chiave predefinita del registro di sistema per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

## <a name="cwinappexgetregistrybase"></a><a name="getregistrybase"></a> CWinAppEx:: GetRegistryBase

Recupera il percorso predefinito del registro di sistema per l'applicazione.

```
LPCTSTR GetRegistryBase();
```

### <a name="return-value"></a>Valore restituito

Stringa che contiene il percorso del percorso del registro di sistema predefinito.

### <a name="remarks"></a>Commenti

Tutti i metodi della [classe CWinAppEx](../../mfc/reference/cwinappex-class.md) che accedono al registro di sistema vengono avviati in un percorso predefinito. Utilizzare questo metodo per recuperare un percorso del percorso del registro di sistema predefinito. Usare [CWinAppEx:: SetRegistryBase](#setregistrybase) per modificare il percorso predefinito del registro di sistema.

## <a name="cwinappexgetregsectionpath"></a><a name="getregsectionpath"></a> CWinAppEx:: GetRegSectionPath

Crea e restituisce il percorso assoluto di una chiave del registro di sistema.

```
CString GetRegSectionPath(LPCTSTR szSectionAdd = _T(""));
```

### <a name="parameters"></a>Parametri

*szSectionAdd*<br/>
in Stringa che contiene il percorso relativo di una chiave del registro di sistema.

### <a name="return-value"></a>Valore restituito

Oggetto contenente `CString` il percorso assoluto di una chiave del registro di sistema.

### <a name="remarks"></a>Commenti

Questo metodo definisce il percorso assoluto della chiave del registro di sistema aggiungendo il percorso relativo in *szSectionAdd* al percorso predefinito del registro di sistema per l'applicazione. Per ottenere la chiave del registro di sistema predefinita, usare il metodo [CWinAppEx:: GetRegistryBase](#getregistrybase).

## <a name="cwinappexgetsectionbinary"></a><a name="getsectionbinary"></a> CWinAppEx:: GetSectionBinary

Legge i dati binari dal registro di sistema.

```
BOOL GetSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>Parametri

*lpszSubSection*<br/>
in Stringa che contiene il percorso relativo di una chiave del registro di sistema.

*lpszEntry*<br/>
in Stringa che contiene il valore da leggere.

*ppData*<br/>
out Puntatore al buffer in cui il metodo archivia i dati.

*pBytes*<br/>
out Puntatore a un Unsigned Integer. Il metodo scrive la dimensione di *ppData* in questo parametro.

### <a name="return-value"></a>Valore restituito

TRUE se l'operazione riesce; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Questo metodo legge i dati binari scritti nel registro di sistema utilizzando i metodi [CWinAppEx:: WriteBinary](#writebinary) e [CWinAppEx:: WriteSectionBinary](#writesectionbinary).

Il parametro *lpszSubSection* non è un percorso assoluto per una voce del registro di sistema. Si tratta di un percorso relativo aggiunto alla fine della chiave del registro di sistema predefinita per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

## <a name="cwinappexgetsectionint"></a><a name="getsectionint"></a> CWinAppEx:: GetSectionInt

Legge i dati Integer dal registro di sistema.

```
int GetSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>Parametri

*lpszSubSection*<br/>
in Stringa che contiene il percorso relativo di una chiave del registro di sistema.

*lpszEntry*<br/>
in Stringa che contiene il valore da leggere.

*nDefault*<br/>
in Valore predefinito da restituire se il valore specificato non esiste.

### <a name="return-value"></a>Valore restituito

Dati Integer archiviati nel valore del registro di sistema specificato; *nDefault* se i dati non esistono.

### <a name="remarks"></a>Commenti

Per scrivere dati integer nel registro di sistema, usare i metodi [CWinAppEx:: WriteInt](#writeint) e [CWinAppEx:: WriteSectionInt](#writesectionint) .

Il parametro *lpszSubSection* non è un percorso assoluto di una voce del registro di sistema. Si tratta di un percorso relativo aggiunto alla fine della chiave predefinita del registro di sistema per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

## <a name="cwinappexgetsectionobject"></a><a name="getsectionobject"></a> CWinAppEx:: GetSectionObject

Legge i dati del registro di sistema [CObject](../../mfc/reference/cobject-class.md) dal registro di sistema.

```
BOOL GetSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parametri

*lpszSubSection*<br/>
in Stringa che contiene il percorso relativo di una chiave del registro di sistema.

*lpszEntry*<br/>
in Stringa che contiene il valore da leggere.

*obj*<br/>
out Riferimento a un oggetto `CObject` . Il metodo usa questa operazione `CObject` per archiviare i dati del registro di sistema.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questo metodo legge i dati dal registro di sistema. I dati letti sono `CObject` dati o dati per una classe derivata da `CObject` . Per scrivere i `CObject` dati nel registro di sistema, usare [CWinAppEx:: WriteObject](#writeobject) o [CWinAppEx:: WriteSectionObject](#writesectionobject).

Il parametro *lpszSubSection* non è un percorso assoluto per una voce del registro di sistema. Si tratta di un percorso relativo aggiunto alla fine della chiave del registro di sistema predefinita per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

## <a name="cwinappexgetsectionstring"></a><a name="getsectionstring"></a> CWinAppEx:: GetSectionString

Legge i dati stringa dal registro di sistema.

```
CString GetSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszDefault = _T(""));
```

### <a name="parameters"></a>Parametri

*lpszSubSection*<br/>
in Stringa che contiene il percorso relativo di una chiave del registro di sistema.

*lpszEntry*<br/>
in Stringa che contiene il valore da leggere.

*lpszDefault*<br/>
in Valore predefinito da restituire se il valore specificato non esiste.

### <a name="return-value"></a>Valore restituito

Dati stringa archiviati nel valore del registro di sistema specificato se i dati esistono. in caso contrario, *lpszDefault*.

### <a name="remarks"></a>Commenti

Questo metodo legge i dati stringa scritti nel registro di sistema. Per scrivere dati di stringa nel registro di sistema, usare [CWinAppEx:: WriteString](#writestring) e [CWinAppEx:: WriteSectionString](#writesectionstring) .

Il parametro *lpszSubSection* non è un percorso assoluto per una voce del registro di sistema. Si tratta di un percorso relativo aggiunto alla fine della chiave del registro di sistema predefinita per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

## <a name="cwinappexgetshellmanager"></a><a name="getshellmanager"></a> CWinAppEx:: GetShellManager

Restituisce un puntatore all'oggetto [CShellManager](../../mfc/reference/cshellmanager-class.md) globale.

```
CShellManager* GetShellManager();
```

### <a name="return-value"></a>Valore restituito

Puntatore all' `CShellManager` oggetto globale.

### <a name="remarks"></a>Commenti

Se l' `CShellManager` oggetto non è inizializzato, questa funzione chiama [CWinAppEx:: InitShellManager](#initshellmanager) prima di restituire un puntatore.

## <a name="cwinappexgetstring"></a><a name="getstring"></a> CWinAppEx:: GetString

Legge i dati stringa da una chiave del registro di sistema specificata.

```
CString GetString(
    LPCTSTR lpszEntry,
    LPCTSTR lpzDefault= _T(""));
```

### <a name="parameters"></a>Parametri

*lpszEntry*<br/>
in Stringa che contiene il nome di una chiave del registro di sistema

*lpzDefault*<br/>
in Valore predefinito restituito dal metodo se la voce del registro di sistema specificata non esiste.

### <a name="return-value"></a>Valore restituito

Dati stringa archiviati nel registro di sistema in caso di esito positivo; *lpszDefault* in caso contrario.

### <a name="remarks"></a>Commenti

Questo metodo legge i dati stringa scritti nel registro di sistema. Per scrivere i dati nel registro di sistema, usare i metodi [CWinAppEx:: WriteString](#writestring) o [CWinAppEx:: WriteSectionString](#writesectionstring).

Il parametro *lpszEntry* è il nome di una voce del registro di sistema che si trova sotto la chiave predefinita del registro di sistema per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

## <a name="cwinappexgettooltipmanager"></a><a name="gettooltipmanager"></a> CWinAppEx:: GetTooltipManager

Restituisce un puntatore all'oggetto [CTooltipManager](../../mfc/reference/ctooltipmanager-class.md) globale.

```
CTooltipManager* GetTooltipManager();
```

### <a name="return-value"></a>Valore restituito

Puntatore all' `CTooltipManager` oggetto globale.

### <a name="remarks"></a>Commenti

Se l' `CTooltipManager` oggetto non è inizializzato, questa funzione chiama [CWinAppEx:: InitTooltipManager](#inittooltipmanager) prima di restituire un puntatore.

## <a name="cwinappexgetusertoolsmanager"></a><a name="getusertoolsmanager"></a> CWinAppEx:: GetUserToolsManager

Restituisce un puntatore all'oggetto [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md) globale.

```
CUserToolsManager* GetUserToolsManager();
```

### <a name="return-value"></a>Valore restituito

Puntatore all' `CUserToolsManager` oggetto globale; NULL se la gestione degli strumenti utente non è abilitata per l'applicazione.

### <a name="remarks"></a>Commenti

Prima di recuperare un puntatore all' `CUserToolsManager` oggetto, è necessario inizializzare il gestore chiamando [CWinAppEx:: EnableUserTools](#enableusertools).

## <a name="cwinappexinitcontextmenumanager"></a><a name="initcontextmenumanager"></a> CWinAppEx:: InitContextMenuManager

Inizializza l'oggetto [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) .

```
BOOL InitContextMenuManager();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il metodo crea l'oggetto CContextMenuManager; 0 se l' `CContextMenuManager` oggetto esiste già.

### <a name="remarks"></a>Commenti

Se si chiama [CWinAppEx:: GetContextMenuManager](#getcontextmenumanager), l'implementazione predefinita di tale metodo chiama `InitContextMenuManager` .

Se l'applicazione dispone già di un gestore di menu di scelta rapida e si chiama `InitContextMenuManager` , l'applicazione avrà un errore di [asserzione](diagnostic-services.md#assert) . Pertanto, non chiamare `InitContextMenuManager` se si crea `CContextMenuManager` direttamente un oggetto. Se non si utilizza un oggetto personalizzato `CContextMenuManager` , è necessario utilizzare `GetContextMenuManager` per creare un `CContextMenuManager` oggetto.

## <a name="cwinappexinitkeyboardmanager"></a><a name="initkeyboardmanager"></a> CWinAppEx:: InitKeyboardManager

Inizializza l'oggetto [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) .

```
BOOL InitKeyboardManager();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il metodo crea l' `CKeyboardManager` oggetto; 0 se l' `CKeyboardManager` oggetto esiste già.

### <a name="remarks"></a>Commenti

Se si chiama [CWinAppEx:: GetKeyboardManager](#getkeyboardmanager), l'implementazione predefinita di tale metodo chiama `InitKeyboardManager` .

Se l'applicazione dispone già di un gestore della tastiera e si chiama `InitKeyboardManager` , l'applicazione avrà un errore di [asserzione](diagnostic-services.md#assert) . Pertanto, non chiamare `InitKeyboardManager` se si crea `CKeyboardManager` direttamente un oggetto. Se non si utilizza un oggetto personalizzato `CKeyboardManager` , è necessario utilizzare `GetKeyboardManager` per creare un `CKeyboardManager` oggetto.

## <a name="cwinappexinitmousemanager"></a><a name="initmousemanager"></a> CWinAppEx:: InitMouseManager

Inizializza l'oggetto [CMouseManager](../../mfc/reference/cmousemanager-class.md) .

```
BOOL InitMouseManager();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il metodo crea l' `CMouseManager` oggetto; 0 se l' `CMouseManager` oggetto esiste già.

### <a name="remarks"></a>Commenti

Se si chiama [CWinAppEx:: GetMouseManager](#getmousemanager), l'implementazione predefinita di tale metodo chiama `InitMouseManager` .

Se l'applicazione dispone già di un gestore del mouse e si chiama `InitMouseManager` , l'applicazione avrà un errore di [asserzione](diagnostic-services.md#assert) . Pertanto, non è necessario chiamare `InitMouseManager` se si crea `CMouseManager` direttamente un oggetto. Se non si utilizza un oggetto personalizzato `CMouseManager` , è necessario utilizzare `GetMouseManager` per creare un `CMouseManager` oggetto.

## <a name="cwinappexinitshellmanager"></a><a name="initshellmanager"></a> CWinAppEx:: InitShellManager

Inizializza l'oggetto [CShellManager](../../mfc/reference/cshellmanager-class.md) .

```
BOOL InitShellManager();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il metodo crea l' `CShellManager` oggetto; 0 se l' `CShellManager` oggetto esiste già.

### <a name="remarks"></a>Commenti

Se si chiama [CWinAppEx:: GetShellManager](#getshellmanager), l'implementazione predefinita di tale metodo chiama `InitShellManager` .

Se l'applicazione dispone già di una gestione Shell e si chiama `InitShellManager` , l'applicazione genera un errore di [asserzione](diagnostic-services.md#assert) . Pertanto, non chiamare `InitShellManager` se si crea direttamente un `CShellManager` oggetto. Se non si utilizza un oggetto personalizzato `CShellManager` , utilizzare `GetShellManager` per creare un `CShellManager` oggetto.

## <a name="cwinappexinittooltipmanager"></a><a name="inittooltipmanager"></a> CWinAppEx:: InitTooltipManager

Inizializza l'oggetto [CTooltipManager](../../mfc/reference/ctooltipmanager-class.md) .

```
BOOL InitTooltipManager();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il metodo crea l' `CTooltipManager` oggetto; 0 se l' `CTooltipManager` oggetto esiste già.

### <a name="remarks"></a>Commenti

Se si chiama [CWinAppEx:: GetTooltipManager](#gettooltipmanager), l'implementazione predefinita di tale metodo chiama `InitTooltipManager` .

Se l'applicazione dispone già di una gestione descrizioni comandi e si chiama `InitTooltipManager` , l'applicazione avrà un errore di [asserzione](diagnostic-services.md#assert) . Pertanto, non chiamare `InitTooltipManager` se si crea `CTooltipManager` direttamente un oggetto. Se non si utilizza un oggetto personalizzato `CTooltipManager` , è necessario utilizzare `GetTooltipManager` per creare un `CTooltipManager` oggetto.

## <a name="cwinappexisresourcesmartupdate"></a><a name="isresourcesmartupdate"></a> CWinAppEx:: IsResourceSmartUpdate

```
BOOL IsResourceSmartUpdate() const;
```

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cwinappexisstateexists"></a><a name="isstateexists"></a> CWinAppEx:: IsStateExists

Indica se la chiave specificata si trova nel registro di sistema.

```
BOOL IsStateExists(LPCTSTR lpszSectionName);
```

### <a name="parameters"></a>Parametri

*lpszSectionName*<br/>
in Stringa che contiene un percorso di una chiave del registro di sistema.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiave si trova nel registro di sistema; in caso contrario, 0.

## <a name="cwinappexloadcustomstate"></a><a name="loadcustomstate"></a> CWinAppEx:: LoadCustomState

Il Framework chiama questo metodo dopo aver caricato lo stato dell'applicazione dal registro di sistema.

```
virtual void LoadCustomState();
```

### <a name="remarks"></a>Commenti

Eseguire l'override di questo metodo se si desidera eseguire un'elaborazione dopo che l'applicazione carica lo stato dal registro di sistema. Per impostazione predefinita, questo metodo non effettua alcuna operazione.

Per caricare le informazioni sullo stato personalizzate dal registro di sistema, è necessario innanzitutto salvare le informazioni utilizzando [CWinAppEx:: SaveCustomState](#savecustomstate).

## <a name="cwinappexloadstate"></a><a name="loadstate"></a> CWinAppEx:: LoadState

Legge lo stato dell'applicazione dal registro di sistema di Windows.

```
BOOL LoadState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

virtual BOOL LoadState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);
```

### <a name="parameters"></a>Parametri

*pFrame*<br/>
in Puntatore a un oggetto finestra cornice. Il metodo applica le informazioni sullo stato nel registro di sistema a questa finestra cornice.

*lpszSectionName*<br/>
in Stringa che contiene il percorso relativo di una chiave del registro di sistema.

*pFrameImpl*<br/>
in Puntatore a un `CFrameImpl` oggetto. Il metodo applica le informazioni sullo stato nel registro di sistema a questa finestra cornice.

### <a name="return-value"></a>Valore restituito

Valore diverso da zero in caso di esito positivo, 0 in caso contrario.

### <a name="remarks"></a>Commenti

Questo metodo carica lo stato dell'applicazione e qualsiasi informazione sullo stato per una finestra cornice. Le informazioni caricate per la finestra cornice vengono applicate alla finestra cornice fornita. Se non si specifica una finestra cornice, vengono caricate solo le informazioni sullo stato dell'applicazione. Le informazioni sull'applicazione includono lo stato della [classe CMouseManager](../../mfc/reference/cmousemanager-class.md), della classe [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md), della [classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)e della [classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md).

L'implementazione predefinita di `CFrameImpl::OnLoadFrame` chiama `LoadState` .

Il parametro *lpszSectionName* non è il percorso assoluto di una voce del registro di sistema. Si tratta di un percorso relativo aggiunto alla fine della chiave predefinita del registro di sistema per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

## <a name="cwinappexloadwindowplacement"></a><a name="loadwindowplacement"></a> CWinAppEx:: LoadWindowPlacement

Chiamata eseguita dal Framework durante il caricamento delle dimensioni e della posizione della finestra cornice principale dal registro di sistema.

```
virtual BOOL LoadWindowPlacement(
    CRect& rectNormalPosition,
    int& nFlags,
    int& nShowCmd);
```

### <a name="parameters"></a>Parametri

*rectNormalPosition*<br/>
out Rettangolo che contiene le coordinate della finestra cornice principale quando si trova nella posizione ripristinata.

*nFlags*<br/>
out Flag che controllano la posizione della finestra ridotta a icona e il modo in cui il sistema operativo passa tra una finestra ridotta a icona e una finestra ripristinata.

*nShowCmd*<br/>
out Intero che specifica lo stato di visualizzazione della finestra. Per ulteriori informazioni sui valori possibili, vedere [CWnd:: ShowWindow](../../mfc/reference/cwnd-class.md#showwindow).

### <a name="return-value"></a>Valore restituito

Valore diverso da zero in caso di esito positivo, 0 in caso contrario.

### <a name="remarks"></a>Commenti

Per impostazione predefinita, MFC carica automaticamente la posizione e lo stato precedenti della finestra cornice principale all'avvio dell'applicazione. Per ulteriori informazioni sul modo in cui queste informazioni vengono archiviate nel registro di sistema, vedere [CWinAppEx:: StoreWindowPlacement](#storewindowplacement).

Eseguire l'override di questo metodo se si desidera caricare informazioni aggiuntive sulla finestra cornice principale.

## <a name="cwinappexm_bforceimagereset"></a><a name="m_bforceimagereset"></a> CWinAppEx:: m_bForceImageReset

Specifica se il Framework Reimposta tutte le immagini della barra degli strumenti quando ricarica la finestra cornice che contiene la barra degli strumenti.

```
BOOL m_bForceImageReset;
```

### <a name="remarks"></a>Commenti

Il `m_bForceImageReset` membro dati è una variabile protetta.

## <a name="cwinappexonappcontexthelp"></a><a name="onappcontexthelp"></a> CWinAppEx:: OnAppContextHelp

Il Framework chiama questo metodo quando l'utente richiede la guida del contesto per la finestra di dialogo di **personalizzazione** .

```
virtual void OnAppContextHelp(
    CWnd* pWndControl,
    const DWORD dwHelpIDArray[]);
```

### <a name="parameters"></a>Parametri

*pWndControl*<br/>
in Puntatore a un oggetto finestra per il quale l'utente ha richiamato la guida del contesto.

*dwHelpIDArray[]*<br/>
in Valore riservato.

### <a name="remarks"></a>Commenti

Questo metodo è attualmente riservato per un utilizzo futuro. L'implementazione predefinita non esegue alcuna operazione e non è attualmente chiamata dal Framework.

## <a name="cwinappexonclosingmainframe"></a><a name="onclosingmainframe"></a> CWinAppEx:: OnClosingMainFrame

Il Framework chiama questo metodo quando una finestra cornice sta elaborando WM_CLOSE.

```
virtual void OnClosingMainFrame(CFrameImpl* pFrameImpl);
```

### <a name="parameters"></a>Parametri

*pFrameImpl*<br/>
in Puntatore a un `CFrameImpl` oggetto.

### <a name="remarks"></a>Commenti

L'implementazione predefinita di questo metodo salva lo stato di *pFrameImpl*.

## <a name="cwinappexonviewdoubleclick"></a><a name="onviewdoubleclick"></a> CWinAppEx:: OnViewDoubleClick

Chiama il comando definito dall'utente associato a una visualizzazione quando l'utente fa doppio clic in un punto qualsiasi all'interno di tale visualizzazione.

```
virtual BOOL OnViewDoubleClick(
    CWnd* pWnd,
    int iViewId);
```

### <a name="parameters"></a>Parametri

*pWnd*<br/>
in Puntatore a un oggetto derivato dalla [classe CView](../../mfc/reference/cview-class.md).

*iViewId*<br/>
in ID della vista.

### <a name="return-value"></a>Valore restituito

TRUE se il Framework trova un comando. in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Per supportare il comportamento del mouse personalizzato, è necessario chiamare questa funzione quando si elabora il messaggio di WM_LBUTTONDBLCLK. Questo metodo eseguirà il comando associato all'ID visualizzazione fornito da *iViewId*. Per ulteriori informazioni sul comportamento del mouse personalizzato, vedere [personalizzazione della tastiera e del mouse](../../mfc/keyboard-and-mouse-customization.md).

## <a name="cwinappexonworkspaceidle"></a><a name="onworkspaceidle"></a> CWinAppEx:: OnWorkspaceIdle

```
virtual BOOL OnWorkspaceIdle(CWnd*);
```

### <a name="parameters"></a>Parametri

in *&#38;CWnd*<br/>

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cwinappexpreloadstate"></a><a name="preloadstate"></a> CWinAppEx::P reloadstate

Il Framework chiama questo metodo immediatamente prima di caricare lo stato dell'applicazione dal registro di sistema.

```
virtual void PreLoadState();
```

### <a name="remarks"></a>Commenti

Eseguire l'override di questo metodo se si desidera eseguire un'elaborazione immediatamente prima che il Framework carica lo stato dell'applicazione.

## <a name="cwinappexpresavestate"></a><a name="presavestate"></a> CWinAppEx::P reSaveState

Il Framework chiama questo metodo immediatamente prima di salvare lo stato dell'applicazione.

```
virtual void PreSaveState();
```

### <a name="remarks"></a>Commenti

Eseguire l'override di questo metodo se si desidera eseguire un'elaborazione immediatamente prima che il Framework salvi lo stato dell'applicazione.

## <a name="cwinappexreloadwindowplacement"></a><a name="reloadwindowplacement"></a> CWinAppEx:: ReloadWindowPlacement

Ricarica le dimensioni e la posizione di una finestra dal registro di sistema.

```
virtual BOOL ReloadWindowPlacement(CFrameWnd* pFrame);
```

### <a name="parameters"></a>Parametri

*pFrame*<br/>
in Puntatore a una finestra cornice.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il metodo ha avuto esito positivo; 0 se il caricamento non è riuscito o non sono presenti dati da caricare.

### <a name="remarks"></a>Commenti

Usare la funzione [CWinAppEx:: StoreWindowPlacement](#storewindowplacement) per scrivere le dimensioni e la posizione di una finestra nel registro di sistema.

## <a name="cwinappexsavecustomstate"></a><a name="savecustomstate"></a> CWinAppEx:: SaveCustomState

Il Framework chiama questo metodo dopo il salvataggio dello stato dell'applicazione nel registro di sistema.

```
virtual void SaveCustomState();
```

### <a name="remarks"></a>Commenti

Eseguire l'override di questo metodo se si desidera eseguire un'elaborazione dopo che l'applicazione salva lo stato nel registro di sistema. Per impostazione predefinita, questo metodo non effettua alcuna operazione.

## <a name="cwinappexsavestate"></a><a name="savestate"></a> CWinAppEx:: SaveState

Scrive lo stato dell'applicazione nel registro di sistema di Windows.

```
virtual BOOL SaveState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);

BOOL SaveState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>Parametri

*lpszSectionName*<br/>
in Stringa che contiene il percorso relativo di una chiave del registro di sistema.

*pFrameImpl*<br/>
in Puntatore a un `CFrameImpl` oggetto. Questo frame viene salvato nel registro di sistema di Windows.

*pFrame*<br/>
in Puntatore a un oggetto finestra cornice. Questo frame viene salvato nel registro di sistema di Windows.

### <a name="return-value"></a>Valore restituito

TRUE in caso di esito positivo, FALSE in caso contrario.

### <a name="remarks"></a>Commenti

Questo metodo salva lo stato dell'applicazione e qualsiasi informazione sullo stato per la finestra cornice fornita. Se non si specifica una finestra cornice, il metodo salva solo lo stato dell'applicazione. Le informazioni sull'applicazione includono lo stato della [classe CMouseManager](../../mfc/reference/cmousemanager-class.md), della classe [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md), della [classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)e della [classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md).

Il parametro *lpszSectionName* non è il percorso assoluto di una voce del registro di sistema. Si tratta di un percorso relativo aggiunto alla fine della chiave del registro di sistema predefinita per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

## <a name="cwinappexsetregistrybase"></a><a name="setregistrybase"></a> CWinAppEx:: SetRegistryBase

Imposta il percorso predefinito del registro di sistema per l'applicazione.

```
LPCTSTR SetRegistryBase(LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>Parametri

*lpszSectionName*<br/>
in Stringa che contiene il percorso di una chiave del registro di sistema.

### <a name="return-value"></a>Valore restituito

Stringa che contiene il percorso del percorso del registro di sistema predefinito.

### <a name="remarks"></a>Commenti

Tutti i metodi della [classe CWinAppEx](../../mfc/reference/cwinappex-class.md) che accedono al registro di sistema vengono avviati in un percorso predefinito. Utilizzare questo metodo per modificare il percorso predefinito del registro di sistema. Usare [CWinAppEx:: GetRegistryBase](#getregistrybase) per recuperare il percorso predefinito del registro di sistema.

## <a name="cwinappexshowpopupmenu"></a><a name="showpopupmenu"></a> CWinAppEx:: ShowPopupMenu

Consente di visualizzare un menu di scelta rapida.

```
virtual BOOL ShowPopupMenu(
    UINT uiMenuResId,
    const CPoint& point,
    CWnd* pWnd);
```

### <a name="parameters"></a>Parametri

*uiMenuResId*<br/>
in ID della risorsa di menu.

*punto*<br/>
in Oggetto [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) che specifica la posizione del menu nelle coordinate dello schermo.

*pWnd*<br/>
in Puntatore alla finestra proprietaria del menu popup.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il menu popup viene visualizzato correttamente; 0 in caso contrario.

### <a name="remarks"></a>Commenti

Questo metodo consente di visualizzare il menu associato a *uiMenuResId*.

Per supportare i menu popup, è necessario disporre di un oggetto [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) . Se l'oggetto non è stato inizializzato `CContextMenuManager` , `ShowPopupMenu` avrà esito negativo.

## <a name="cwinappexstorewindowplacement"></a><a name="storewindowplacement"></a> CWinAppEx:: StoreWindowPlacement

Chiamato dal Framework per scrivere la dimensione e la posizione della finestra cornice principale nel registro di sistema.

```
virtual BOOL StoreWindowPlacement(
    const CRect& rectNormalPosition,
    int nFlags,
    int nShowCmd);
```

### <a name="parameters"></a>Parametri

*nFlags*<br/>
in Flag che controllano la posizione della finestra ridotta a icona e il modo in cui il sistema operativo passa tra una finestra ridotta a icona e una finestra ripristinata.

*nShowCmd*<br/>
in Intero che specifica lo stato di visualizzazione della finestra. Per ulteriori informazioni sui valori possibili, vedere [CWnd:: ShowWindow](../../mfc/reference/cwnd-class.md#showwindow).

*rectNormalPosition*<br/>
in Rettangolo che contiene le coordinate della finestra cornice principale quando si trova nello stato ripristinato.

### <a name="return-value"></a>Valore restituito

Valore diverso da zero in caso di esito positivo, 0 in caso contrario.

### <a name="remarks"></a>Commenti

Per impostazione predefinita, in MFC il percorso e lo stato della finestra cornice principale vengono salvati automaticamente prima della chiusura dell'applicazione. Queste informazioni vengono archiviate nel registro di sistema di Windows sotto la chiave WindowPlacement nel percorso predefinito del registro di sistema per l'applicazione. Per ulteriori informazioni sul percorso predefinito del registro di sistema dell'applicazione, vedere [CWinAppEx:: GetRegistryBase](#getregistrybase).

Eseguire l'override di questo metodo se si desidera archiviare informazioni aggiuntive sulla finestra cornice principale.

## <a name="cwinappexwritebinary"></a><a name="writebinary"></a> CWinAppEx:: WriteBinary

Scrive i dati binari nel registro di sistema.

```
BOOL WriteBinary(
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>Parametri

*lpszEntry*<br/>
in Stringa che contiene il nome di una chiave del registro di sistema.

*pData*<br/>
in Dati da archiviare.

*nBytes*<br/>
in Dimensioni in byte di *pData* .

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Il parametro *lpszEntry* è il nome di una voce del registro di sistema che si trova sotto la chiave predefinita del registro di sistema per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

Se la chiave specificata da *lpszEntry* non esiste, questo metodo lo creerà.

## <a name="cwinappexwriteint"></a><a name="writeint"></a> CWinAppEx:: WriteInt

Scrive dati numerici nel registro di sistema.

```
BOOL WriteInt(
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>Parametri

*lpszEntry*<br/>
in Stringa che contiene il nome di una chiave del registro di sistema.

*nValue*<br/>
in Dati da archiviare.

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Il parametro *lpszEntry* è il nome di una voce del registro di sistema che si trova sotto la chiave predefinita del registro di sistema per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

Se la chiave specificata da *lpszEntry* non esiste, questo metodo lo creerà.

## <a name="cwinappexwriteobject"></a><a name="writeobject"></a> CWinAppEx:: WriteObject

Scrive i dati derivati dalla [classe CObject](../../mfc/reference/cobject-class.md) nel registro di sistema.

```
BOOL WriteObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parametri

*lpszEntry*<br/>
in Stringa che contiene il valore da impostare.

*obj*<br/>
in Riferimento ai `CObject` dati che vengono archiviati dal metodo.

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Questo metodo scrive i dati *obj* nel valore specificato sotto la chiave del registro di sistema predefinita. Usare [CWinAppEx:: GetRegistryBase](#getregistrybase) per determinare la chiave del registro di sistema corrente.

## <a name="cwinappexwritesectionbinary"></a><a name="writesectionbinary"></a> CWinAppEx:: WriteSectionBinary

Scrive i dati binari in un valore nel registro di sistema.

```
BOOL WriteSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>Parametri

*lpszSubSection*<br/>
in Stringa che contiene il nome di una chiave del registro di sistema

*lpszEntry*<br/>
in Stringa che contiene il valore da impostare.

*pData*<br/>
in Dati da scrivere nel registro di sistema.

*nBytes*<br/>
in Dimensioni in byte di *pData* .

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Il parametro *lpszSubSection* non è il percorso assoluto di una voce del registro di sistema. Si tratta di un percorso relativo aggiunto alla fine della chiave del registro di sistema predefinita per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

Se la chiave specificata da *lpszEntry* non esiste, questo metodo lo creerà.

## <a name="cwinappexwritesectionint"></a><a name="writesectionint"></a> CWinAppEx:: WriteSectionInt

Scrive dati numerici nel registro di sistema.

```
BOOL WriteSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>Parametri

*lpszSubSection*<br/>
in Stringa che contiene il percorso relativo di una chiave del registro di sistema.

*lpszEntry*<br/>
in Stringa che contiene il valore da impostare.

*nValue*<br/>
in Dati da scrivere nel registro di sistema.

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Il parametro *lpszSubSection* non è un percorso assoluto per una voce del registro di sistema. Si tratta di un percorso relativo aggiunto alla chiave predefinita del registro di sistema per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

Se la chiave specificata da *lpszEntry* non esiste, questo metodo lo creerà.

## <a name="cwinappexwritesectionobject"></a><a name="writesectionobject"></a> CWinAppEx:: WriteSectionObject

Scrive i dati derivati dalla [classe CObject](../../mfc/reference/cobject-class.md) in un valore del registro di sistema specifico.

```
BOOL WriteSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parametri

*lpszSubSection*<br/>
in Stringa che contiene il nome di una chiave del registro di sistema.

*lpszEntry*<br/>
in Stringa che contiene il nome del valore da impostare.

*obj*<br/>
in Dati da archiviare.

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Il parametro *lpszSubSection* non è un percorso assoluto per una voce del registro di sistema. Si tratta di un percorso relativo aggiunto alla fine della chiave del registro di sistema predefinita per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase), rispettivamente.

Se il valore specificato da *lpszEntry* non esiste nella chiave del registro di sistema specificata da *lpszSubSection*, questo metodo creerà tale valore.

## <a name="cwinappexwritesectionstring"></a><a name="writesectionstring"></a> CWinAppEx:: WriteSectionString

Scrive i dati stringa in un valore nel registro di sistema.

```
BOOL WriteSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>Parametri

*lpszSubSection*<br/>
in Stringa che contiene il nome di una chiave del registro di sistema.

*lpszEntry*<br/>
in Stringa che contiene il valore da impostare.

*lpszValue*<br/>
in Dati stringa da scrivere nel registro di sistema.

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Il parametro *lpszSubSection* non è un percorso assoluto per una voce del registro di sistema. Si tratta di un percorso relativo aggiunto alla fine della chiave del registro di sistema predefinita per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase), rispettivamente.

Se il valore specificato da *lpszEntry* non esiste in *lpszSubSection*, questo metodo lo creerà.

## <a name="cwinappexwritestring"></a><a name="writestring"></a> CWinAppEx:: WriteString

Scrive i dati stringa nel registro di sistema.

```
BOOL WriteString(
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>Parametri

*lpszEntry*<br/>
in Stringa che contiene il nome di una chiave del registro di sistema.

*lpszValue*<br/>
in Dati da archiviare.

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Il parametro *lpszEntry* è il nome di una voce del registro di sistema che si trova sotto la chiave predefinita del registro di sistema per l'applicazione. Per ottenere o impostare la chiave del registro di sistema predefinita, usare i metodi [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) rispettivamente.

Se la chiave specificata da *lspzEntry* non esiste, questo metodo lo creerà.

## <a name="see-also"></a>Vedi anche

[Grafico delle gerarchie](../../mfc/hierarchy-chart.md)<br/>
[Classi](../../mfc/reference/mfc-classes.md)<br/>
[Classe CWinApp](../../mfc/reference/cwinapp-class.md)<br/>
[Classe CMouseManager](../../mfc/reference/cmousemanager-class.md)<br/>
[Classe CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)<br/>
[Classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)<br/>
[Classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)
