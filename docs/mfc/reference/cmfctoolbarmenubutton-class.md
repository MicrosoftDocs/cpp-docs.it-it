---
description: 'Altre informazioni su: Classe CMFCToolBarMenuButton'
title: Classe CMFCToolBarMenuButton
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CompareWith
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CopyFrom
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateFromMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::EnableQuickCustomize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetCommands
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetImageRect
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPaletteRows
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HasButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HaveHotBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsClickedOnMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsDroppedDown
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsEmptyMenuAllowed
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsExclusive
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsQuickMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsTearOffMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnAfterCreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnBeforeDrag
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCalculateSize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCancelMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnChangeParentWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClick
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClickMenuItem
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnContextHelp
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDraw
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDrawOnCustomizeList
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OpenPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::ResetImageToDefault
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SaveBarState
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::Serialize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetACCData
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuOnly
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMessageWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetRadio
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetTearOff
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::DrawDocumentIcon
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw
helpviewer_keywords:
- CMFCToolBarMenuButton [MFC], CMFCToolBarMenuButton
- CMFCToolBarMenuButton [MFC], CompareWith
- CMFCToolBarMenuButton [MFC], CopyFrom
- CMFCToolBarMenuButton [MFC], CreateFromMenu
- CMFCToolBarMenuButton [MFC], CreateMenu
- CMFCToolBarMenuButton [MFC], CreatePopupMenu
- CMFCToolBarMenuButton [MFC], EnableQuickCustomize
- CMFCToolBarMenuButton [MFC], GetCommands
- CMFCToolBarMenuButton [MFC], GetImageRect
- CMFCToolBarMenuButton [MFC], GetPaletteRows
- CMFCToolBarMenuButton [MFC], GetPopupMenu
- CMFCToolBarMenuButton [MFC], HasButton
- CMFCToolBarMenuButton [MFC], HaveHotBorder
- CMFCToolBarMenuButton [MFC], IsBorder
- CMFCToolBarMenuButton [MFC], IsClickedOnMenu
- CMFCToolBarMenuButton [MFC], IsDroppedDown
- CMFCToolBarMenuButton [MFC], IsEmptyMenuAllowed
- CMFCToolBarMenuButton [MFC], IsExclusive
- CMFCToolBarMenuButton [MFC], IsMenuPaletteMode
- CMFCToolBarMenuButton [MFC], IsQuickMode
- CMFCToolBarMenuButton [MFC], IsTearOffMenu
- CMFCToolBarMenuButton [MFC], OnAfterCreatePopupMenu
- CMFCToolBarMenuButton [MFC], OnBeforeDrag
- CMFCToolBarMenuButton [MFC], OnCalculateSize
- CMFCToolBarMenuButton [MFC], OnCancelMode
- CMFCToolBarMenuButton [MFC], OnChangeParentWnd
- CMFCToolBarMenuButton [MFC], OnClick
- CMFCToolBarMenuButton [MFC], OnClickMenuItem
- CMFCToolBarMenuButton [MFC], OnContextHelp
- CMFCToolBarMenuButton [MFC], OnDraw
- CMFCToolBarMenuButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarMenuButton [MFC], OpenPopupMenu
- CMFCToolBarMenuButton [MFC], ResetImageToDefault
- CMFCToolBarMenuButton [MFC], SaveBarState
- CMFCToolBarMenuButton [MFC], Serialize
- CMFCToolBarMenuButton [MFC], SetACCData
- CMFCToolBarMenuButton [MFC], SetMenuOnly
- CMFCToolBarMenuButton [MFC], SetMenuPaletteMode
- CMFCToolBarMenuButton [MFC], SetMessageWnd
- CMFCToolBarMenuButton [MFC], SetRadio
- CMFCToolBarMenuButton [MFC], SetTearOff
- CMFCToolBarMenuButton [MFC], DrawDocumentIcon
- CMFCToolBarMenuButton [MFC], m_bAlwaysCallOwnerDraw
ms.assetid: cfa50176-7e4b-4527-9904-86a1b48fc1bc
ms.openlocfilehash: 84ab09d78863d72c26c62fdcb4e9cf5656d8418f
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/11/2020
ms.locfileid: "97331718"
---
# <a name="cmfctoolbarmenubutton-class"></a>Classe CMFCToolBarMenuButton

Pulsante della barra degli strumenti contenente un menu di scelta rapida.
Per informazioni dettagliate, vedere il codice sorgente disponibile nella **cartella \\ \\ \\ MFC atlmfc src di VC** per l'installazione di Visual Studio.

## <a name="syntax"></a>Sintassi

```
class CMFCToolBarMenuButton : public CMFCToolBarButton
```

## <a name="members"></a>Members

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Description|
|----------|-----------------|
|[CMFCToolBarMenuButton:: CMFCToolBarMenuButton](#cmfctoolbarmenubutton)|Costruisce un oggetto `CMFCToolBarMenuButton`.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Description|
|----------|-----------------|
|[CMFCToolBarMenuButton:: CompareWith](#comparewith)|Confronta questa istanza con l'oggetto fornito `CMFCToolBarButton` . Esegue l'override di [CMFCToolBarButton:: compareWith](../../mfc/reference/cmfctoolbarbutton-class.md#comparewith).|
|[CMFCToolBarMenuButton:: CopyFrom](#copyfrom)|Copia le proprietà di un altro pulsante della barra degli strumenti nel pulsante corrente. Esegue l'override di [CMFCToolBarButton:: CopyFrom](../../mfc/reference/cmfctoolbarbutton-class.md#copyfrom).|
|[CMFCToolBarMenuButton:: CreateFromMenu](#createfrommenu)|Inizializza il menu della barra degli strumenti da un handle di menu di Windows.|
|[CMFCToolBarMenuButton:: CreateMenu](#createmenu)|Consente di creare un menu di Windows costituito dai comandi del menu della barra degli strumenti. Restituisce un handle per il menu di Windows.|
|[CMFCToolBarMenuButton:: CreatePopupMenu](#createpopupmenu)|Consente di creare un oggetto menu popup ( [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)) per visualizzare il menu della barra degli strumenti.|
|[CMFCToolBarMenuButton:: EnableQuickCustomize](#enablequickcustomize)||
|[CMFCToolBarMenuButton:: GetCommands](#getcommands)|Consente l'accesso in sola lettura all'elenco di comandi nel menu della barra degli strumenti.|
|[CMFCToolBarMenuButton:: GetImageRect](#getimagerect)|Recupera il rettangolo di delimitazione per l'immagine del pulsante.|
|[CMFCToolBarMenuButton:: GetPaletteRows](#getpaletterows)|Restituisce il numero di righe nel menu a comparsa quando il menu è in modalità tavolozza.|
|[CMFCToolBarMenuButton:: GetPopupMenu](#getpopupmenu)|Restituisce un puntatore all'oggetto menu popup associato al pulsante.|
|[CMFCToolBarMenuButton:: HasButton](#hasbutton)||
|[CMFCToolBarMenuButton:: HaveHotBorder](#havehotborder)|Determina se un bordo del pulsante viene visualizzato quando un utente seleziona il pulsante. Esegue l'override di [CMFCToolBarButton:: HaveHotBorder](../../mfc/reference/cmfctoolbarbutton-class.md#havehotborder).|
|[CMFCToolBarMenuButton:: Transborder](#isborder)||
|[CMFCToolBarMenuButton:: IsClickedOnMenu](#isclickedonmenu)||
|[CMFCToolBarMenuButton:: IsDroppedDown](#isdroppeddown)|Determina se viene visualizzato il menu di scelta rapida.|
|[CMFCToolBarMenuButton:: IsEmptyMenuAllowed](#isemptymenuallowed)|Chiamata eseguita dal Framework per determinare se un utente può aprire un sottomenu dalla voce di menu selezionata.|
|[CMFCToolBarMenuButton:: unexclusive](#isexclusive)|Determina se il pulsante è in modalità esclusiva, ovvero se il menu di scelta rapida rimane aperto anche quando il puntatore del mouse viene spostato su un'altra barra degli strumenti o un pulsante.|
|[CMFCToolBarMenuButton:: IsMenuPaletteMode](#ismenupalettemode)|Determina se il menu di scelta rapida è in modalità tavolozza.|
|[CMFCToolBarMenuButton:: IsQuickMode](#isquickmode)||
|[CMFCToolBarMenuButton:: IsTearOffMenu](#istearoffmenu)|Determina se nel menu popup è presente una barra di strappo.|
|[CMFCToolBarMenuButton:: OnAfterCreatePopupMenu](#onaftercreatepopupmenu)||
|[CMFCToolBarMenuButton:: OnBeforeDrag](#onbeforedrag)|Specifica se il pulsante può essere trascinato. Esegue l'override di [CMFCToolBarButton:: OnBeforeDrag](../../mfc/reference/cmfctoolbarbutton-class.md#onbeforedrag).|
|[CMFCToolBarMenuButton:: OnCalculateSize](#oncalculatesize)|Chiamata eseguita dal Framework per calcolare le dimensioni del pulsante per il contesto di dispositivo e lo stato di ancoraggio specificati. Esegue l'override di [CMFCToolBarButton:: OnCalculateSize](../../mfc/reference/cmfctoolbarbutton-class.md#oncalculatesize).|
|[CMFCToolBarMenuButton:: OnCancelMode](#oncancelmode)|Chiamata eseguita dal Framework per gestire il messaggio di [WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode) . Esegue l'override di [CMFCToolBarButton:: OnCancelMode](../../mfc/reference/cmfctoolbarbutton-class.md#oncancelmode).|
|[CMFCToolBarMenuButton:: OnChangeParentWnd](#onchangeparentwnd)|Chiamata eseguita dal framework quando il pulsante viene inserito in una nuova barra degli strumenti. Esegue l'override di [CMFCToolBarButton:: OnChangeParentWnd](cmfctoolbarbutton-class.md#onchangeparentwnd).|
|[CMFCToolBarMenuButton:: OnClick](#onclick)|Chiamata eseguita dal framework quando l'utente fa clic con il pulsante del mouse. Esegue l'override di [CMFCToolBarButton:: OnClick](../../mfc/reference/cmfctoolbarbutton-class.md#onclick).|
|[CMFCToolBarMenuButton:: OnClickMenuItem](#onclickmenuitem)|Chiamata eseguita dal framework quando l'utente seleziona un elemento nel menu a comparsa.|
|[CMFCToolBarMenuButton:: OnContextHelp](#oncontexthelp)|Chiamata eseguita dal framework quando la barra degli strumenti padre gestisce un messaggio di WM_HELPHITTEST. Esegue l'override di [CMFCToolBarButton:: OnContextHelp](../../mfc/reference/cmfctoolbarbutton-class.md#oncontexthelp).|
|[CMFCToolBarMenuButton:: onpare](#ondraw)|Chiamato dal Framework per disegnare il pulsante usando gli stili e le opzioni specificati. Esegue l'override di [CMFCToolBarButton:: onpare](../../mfc/reference/cmfctoolbarbutton-class.md#ondraw).|
|[CMFCToolBarMenuButton:: OnDrawOnCustomizeList](#ondrawoncustomizelist)|Viene chiamato dal Framework per creare il pulsante nel riquadro **comandi** della finestra di dialogo **Personalizza** . Esegue l'override di [CMFCToolBarButton:: OnDrawOnCustomizeList](../../mfc/reference/cmfctoolbarbutton-class.md#ondrawoncustomizelist).|
|[CMFCToolBarMenuButton:: OpenPopupMenu](#openpopupmenu)|Chiamata eseguita dal framework quando l'utente apre il menu di scelta rapida.|
|[CMFCToolBarMenuButton:: ResetImageToDefault](#resetimagetodefault)|Imposta sul valore predefinito l'immagine associata al pulsante. Esegue l'override di [CMFCToolBarButton:: ResetImageToDefault](../../mfc/reference/cmfctoolbarbutton-class.md#resetimagetodefault).|
|[CMFCToolBarMenuButton:: SaveBarState](#savebarstate)|Salva lo stato del pulsante della barra degli strumenti. Esegue l'override di [CMFCToolBarButton:: SaveBarState](../../mfc/reference/cmfctoolbarbutton-class.md#savebarstate).|
|[CMFCToolBarMenuButton:: Serialize](#serialize)|Legge questo oggetto da un archivio o lo scrive in un archivio. Esegue l'override di [CMFCToolBarButton:: Serialize](../../mfc/reference/cmfctoolbarbutton-class.md#serialize).|
|[CMFCToolBarMenuButton:: SetACCData](#setaccdata)|Popola l'oggetto fornito `CAccessibilityData` con i dati di accessibilità dal pulsante della barra degli strumenti. Esegue l'override di [CMFCToolBarButton:: SetACCData](../../mfc/reference/cmfctoolbarbutton-class.md#setaccdata).|
|[CMFCToolBarMenuButton:: SetMenuOnly](#setmenuonly)|Specifica se il pulsante può essere aggiunto a una barra degli strumenti.|
|[CMFCToolBarMenuButton:: SetMenuPaletteMode](#setmenupalettemode)|Specifica se il menu di scelta rapida è in modalità tavolozza.|
|[CMFCToolBarMenuButton:: SetMessageWnd](#setmessagewnd)||
|[CMFCToolBarMenuButton:: seradio](#setradio)|Forza il pulsante di menu della barra degli strumenti per visualizzare un'icona che indica che è selezionata.|
|[CMFCToolBarMenuButton:: SetTearOff](#settearoff)|Consente di specificare un ID barra di strappo per il menu di scelta rapida.|

### <a name="protected-methods"></a>Metodi protetti

|Nome|Description|
|----------|-----------------|
|[CMFCToolBarMenuButton::D rawDocumentIcon](#drawdocumenticon)|Disegna un'icona sul pulsante di menu.|

### <a name="data-members"></a>Membri dei dati

|Nome|Description|
|----------|-----------------|
|[CMFCToolBarMenuButton:: m_bAlwaysCallOwnerDraw](#m_balwayscallownerdraw)|Se TRUE, il Framework chiama sempre [CFrameWndEx:: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) quando viene disegnato un pulsante.|

## <a name="remarks"></a>Commenti

Un oggetto `CMFCToolBarMenuButton` può essere visualizzato come menu, una voce di menu che include un sottomenu, un pulsante che esegue un comando o Visualizza un menu o un pulsante che visualizza solo un menu. Per determinare il comportamento e l'aspetto del pulsante di menu, è necessario specificare i parametri, ad esempio l'immagine, il testo, l'handle di menu e l'ID di comando associati al pulsante nel costruttore `CMFCToolbarMenuButton::CMFCToolbarMenuButton` .

Una classe personalizzata derivata dalla `CMFCToolbarMenuButton` classe deve usare la macro [DECLARE_SERIAL](run-time-object-model-services.md#declare_serial) . La macro [DECLARE_DYNCREATE](run-time-object-model-services.md#declare_dyncreate) genera un errore quando l'applicazione viene chiusa.

## <a name="example"></a>Esempio

Nell'esempio seguente viene illustrato come configurare un `CMFCToolBarMenuButton` oggetto. Nel codice viene illustrato come specificare che il menu a discesa è in modalità tavolozza e specificare l'ID per la barra di strappo creata quando l'utente trascina il pulsante di menu da una barra dei menu. Questo frammento di codice fa parte dell' [esempio di Word Pad](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_WordPad#10](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

[CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md)

## <a name="requirements"></a>Requisiti

**Intestazione:** afxtoolbarmenubutton.h

## <a name="cmfctoolbarmenubuttoncmfctoolbarmenubutton"></a><a name="cmfctoolbarmenubutton"></a> CMFCToolBarMenuButton:: CMFCToolBarMenuButton

Costruisce un oggetto `CMFCToolBarMenuButton`.

```
CMFCToolBarMenuButton();
CMFCToolBarMenuButton(const CMFCToolBarMenuButton& src);

CMFCToolBarMenuButton(
    UINT uiID,
    HMENU hMenu,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE);
```

### <a name="parameters"></a>Parametri

*src*<br/>
in Oggetto esistente `CMFCToolBarMenuButton` da copiare in questo `CMFCToolBarMenuButton` oggetto.

*uiID*<br/>
in ID del comando da eseguire quando un utente fa clic sul pulsante; oppure (UINT)-1 per un pulsante di menu che non esegue direttamente un comando.

*hMenu*<br/>
in Handle per un menu; o NULL se il pulsante non dispone di un menu.

*iImage*<br/>
in Indice dell'immagine per il pulsante; oppure-1 se questo pulsante non dispone di un'icona o utilizza l'icona del comando specificato da *uiID*. L'indice è lo stesso per ogni `CMFCToolBarImages` oggetto nell'applicazione.

*lpszText*<br/>
in Testo del pulsante di menu della barra degli strumenti.

*bUserButton*<br/>
in TRUE se il pulsante Visualizza un'immagine definita dall'utente; FALSE se il pulsante Visualizza un'immagine predefinita associata al comando specificato da *uiID*.

### <a name="remarks"></a>Commenti

Se *uiID* è un ID di comando valido, il pulsante esegue tale comando quando l'utente fa clic su di esso. Se *HMENU* è un handle di menu valido, il pulsante fornisce un menu a discesa quando viene visualizzato in una barra degli strumenti o in un sottomenu quando viene visualizzato in un menu. Se *uiID* e *HMENU* sono entrambi validi, il pulsante è costituito da un pulsante di menu combinato con una parte che eseguirà il comando quando l'utente fa clic su di esso e una parte con una freccia rivolta verso il basso che a discesa di un menu quando l'utente fa clic su di essa. Tuttavia, se *HMENU* è valido, un utente non sarà in grado di fare clic sul pulsante per eseguire un comando quando il pulsante viene inserito in un menu.

### <a name="example"></a>Esempio

Nell'esempio seguente viene illustrato come costruire un oggetto della `CMFCToolBarMenuButton` classe. Questo frammento di codice fa parte dell' [esempio di Word Pad](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_WordPad#9](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_2.cpp)]

## <a name="cmfctoolbarmenubuttoncomparewith"></a><a name="comparewith"></a> CMFCToolBarMenuButton:: CompareWith

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>Parametri

in *altro*<br/>

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttoncopyfrom"></a><a name="copyfrom"></a> CMFCToolBarMenuButton:: CopyFrom

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>Parametri

in *src*<br/>

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttoncreatefrommenu"></a><a name="createfrommenu"></a> CMFCToolBarMenuButton:: CreateFromMenu

Inizializza il menu della barra degli strumenti da un handle di menu di Windows.

```
virtual void CreateFromMenu(HMENU hMenu);
```

### <a name="parameters"></a>Parametri

*hMenu*<br/>
in Handle per un menu.

### <a name="remarks"></a>Commenti

Un pulsante di menu della barra degli strumenti può visualizzare un sottomenu a discesa.

Il Framework chiama questo metodo per inizializzare i comandi nel sottomenu da un menu.

## <a name="cmfctoolbarmenubuttoncreatemenu"></a><a name="createmenu"></a> CMFCToolBarMenuButton:: CreateMenu

Consente di creare un menu costituito dai comandi nel menu della barra degli strumenti. Restituisce un handle per il menu.

```
virtual HMENU CreateMenu() const;
```

### <a name="return-value"></a>Valore restituito

Handle per il menu se l'operazione ha esito positivo. NULL se l'elenco di comandi associato al pulsante di menu della barra degli strumenti è vuoto.

### <a name="remarks"></a>Commenti

È possibile eseguire l'override di questo metodo in una classe derivata per personalizzare la modalità di generazione del menu.

## <a name="cmfctoolbarmenubuttoncreatepopupmenu"></a><a name="createpopupmenu"></a> CMFCToolBarMenuButton:: CreatePopupMenu

Crea un `CMFCPopupMenu` oggetto per visualizzare il menu della barra degli strumenti.

```
virtual CMFCPopupMenu* CreatePopupMenu();
```

### <a name="return-value"></a>Valore restituito

Puntatore a un `CMFCPopupMenu` oggetto che Visualizza il menu a discesa associato al pulsante di menu della barra degli strumenti.

### <a name="remarks"></a>Commenti

Questo metodo viene chiamato dal Framework per preparare la visualizzazione del menu a discesa associato al pulsante.

L'implementazione predefinita crea e restituisce un nuovo `CMFCPopupMenu` oggetto. Eseguire l'override di questo metodo se si desidera utilizzare un tipo derivato della [classe CMFCPopupMenu](cmfcpopupmenu-class.md) o per eseguire un'inizializzazione aggiuntiva.

## <a name="cmfctoolbarmenubuttondrawdocumenticon"></a><a name="drawdocumenticon"></a> CMFCToolBarMenuButton::D rawDocumentIcon

Disegna un'icona del documento nel pulsante di menu.

```cpp
void DrawDocumentIcon(
    CDC* pDC,
    const CRect& rectImage,
    HICON hIcon);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
in Puntatore al contesto di dispositivo.

*rectImage*<br/>
in Coordinate del rettangolo di delimitazione dell'immagine.

*hIcon*<br/>
in Handle per l'icona.

### <a name="remarks"></a>Commenti

Questo metodo accetta un'icona di documento e la disegna sul pulsante di menu, centrato nell'area specificata da *rectImage*.

## <a name="cmfctoolbarmenubuttonenablequickcustomize"></a><a name="enablequickcustomize"></a> CMFCToolBarMenuButton:: EnableQuickCustomize

```cpp
void EnableQuickCustomize();
```

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttonhasbutton"></a><a name="hasbutton"></a> CMFCToolBarMenuButton:: HasButton

```
virtual BOOL HasButton() const;
```

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttonhavehotborder"></a><a name="havehotborder"></a> CMFCToolBarMenuButton:: HaveHotBorder

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttonisborder"></a><a name="isborder"></a> CMFCToolBarMenuButton:: Transborder

```
virtual BOOL IsBorder() const;
```

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttonisclickedonmenu"></a><a name="isclickedonmenu"></a> CMFCToolBarMenuButton:: IsClickedOnMenu

```
BOOL IsClickedOnMenu() const;
```

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttonisquickmode"></a><a name="isquickmode"></a> CMFCToolBarMenuButton:: IsQuickMode

```
BOOL IsQuickMode();
```

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttongetcommands"></a><a name="getcommands"></a> CMFCToolBarMenuButton:: GetCommands

Consente l'accesso in sola lettura all'elenco di comandi nel menu della barra degli strumenti.

```
const CObList& GetCommands() const;
```

### <a name="return-value"></a>Valore restituito

Un riferimento const a un oggetto di [classe CObList](../../mfc/reference/coblist-class.md) , che contiene una raccolta di oggetti della [classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) .

### <a name="remarks"></a>Commenti

Un pulsante di menu della barra degli strumenti può visualizzare un sottomenu. È possibile specificare l'elenco di comandi nel sottomenu nel costruttore o in [CMFCToolBarMenuButton:: CreateFromMenu](#createfrommenu) come handle per un menu (HMENU). Il menu viene convertito in un elenco di oggetti derivati dalla [classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) e archiviati nell'oggetto interno `CObList` . È possibile accedere a questo elenco chiamando questo metodo.

## <a name="cmfctoolbarmenubuttongetimagerect"></a><a name="getimagerect"></a> CMFCToolBarMenuButton:: GetImageRect

Recupera il rettangolo di delimitazione per l'immagine del pulsante.

```cpp
void GetImageRect(CRect& rectImage);
```

### <a name="parameters"></a>Parametri

*rectImage*<br/>
out Riferimento a un `CRect` oggetto che riceve le coordinate del rettangolo di delimitazione dell'immagine.

## <a name="cmfctoolbarmenubuttongetpaletterows"></a><a name="getpaletterows"></a> CMFCToolBarMenuButton:: GetPaletteRows

Restituisce il numero di righe nel menu a discesa quando il menu è in modalità tavolozza.

```
int GetPaletteRows() const;
```

### <a name="return-value"></a>Valore restituito

Numero di righe nella tavolozza.

### <a name="remarks"></a>Commenti

Quando il pulsante di menu è impostato sulla modalità tavolozza, le voci di menu verranno visualizzate in più colonne con solo un numero limitato di righe. Chiamare questo metodo per ottenere il numero di righe. È possibile abilitare o disabilitare la modalità tavolozza e specificare il numero di righe usando [CMFCToolBarMenuButton:: SetMenuPaletteMode](#setmenupalettemode).

## <a name="cmfctoolbarmenubuttongetpopupmenu"></a><a name="getpopupmenu"></a> CMFCToolBarMenuButton:: GetPopupMenu

Restituisce un puntatore all'oggetto della [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) che rappresenta il menu a discesa del pulsante.

```
CMFCPopupMenu* GetPopupMenu() const;
```

### <a name="return-value"></a>Valore restituito

Puntatore a un oggetto della [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) creato quando il framework disegna il sottomenu del pulsante di menu della barra degli strumenti; NULL se non viene visualizzato alcun sottomenu.

### <a name="remarks"></a>Commenti

Quando un pulsante di menu della barra degli strumenti Visualizza un menu a discesa, il pulsante Crea un oggetto della [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) per rappresentare il menu. Chiamare questo metodo per ottenere un puntatore all' `CMFCPopupMenu` oggetto. Non è consigliabile archiviare il puntatore restituito perché è temporaneo e diventa non valido quando l'utente chiude il menu a discesa.

## <a name="cmfctoolbarmenubuttonisdroppeddown"></a><a name="isdroppeddown"></a> CMFCToolBarMenuButton:: IsDroppedDown

Indica se il menu popup è attualmente visualizzato.

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>Valore restituito

TRUE se il pulsante di menu della barra degli strumenti Visualizza il sottomenu; in caso contrario, FALSE.

## <a name="cmfctoolbarmenubuttonisemptymenuallowed"></a><a name="isemptymenuallowed"></a> CMFCToolBarMenuButton:: IsEmptyMenuAllowed

Specifica se le voci di menu visualizzano sottomenu vuoti.

```
virtual BOOL IsEmptyMenuAllowed() const;
```

### <a name="return-value"></a>Valore restituito

TRUE se il Framework apre un sottomenu dalla voce di menu attualmente selezionata anche quando il sottomenu è vuoto; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Il Framework chiama questo metodo quando un utente tenta di aprire il sottomenu dalla voce di menu attualmente selezionata. Se il sottomenu è vuoto e `IsEmptyMenuAllowed` restituisce false, il sottomenu non verrà aperto.

L'implementazione predefinita restituisce FALSE. Eseguire l'override di questo metodo per personalizzare questo comportamento.

## <a name="cmfctoolbarmenubuttonisexclusive"></a><a name="isexclusive"></a> CMFCToolBarMenuButton:: unexclusive

Indica se il pulsante è in modalità esclusiva.

```
virtual BOOL IsExclusive() const;
```

### <a name="return-value"></a>Valore restituito

TRUE se il pulsante funziona in modalità esclusiva; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Quando un utente apre un menu popup per un pulsante e quindi sposta il puntatore del mouse su un'altra barra degli strumenti o sul pulsante di menu, il menu popup si chiude, a meno che il pulsante non sia in modalità esclusiva.

L'implementazione predefinita restituisce sempre FALSE. Eseguire l'override di questo metodo in una classe derivata se si desidera attivare la modalità esclusiva.

## <a name="cmfctoolbarmenubuttonismenupalettemode"></a><a name="ismenupalettemode"></a> CMFCToolBarMenuButton:: IsMenuPaletteMode

Determina se il menu a discesa è in modalità tavolozza.

```
BOOL IsMenuPaletteMode() const;
```

### <a name="return-value"></a>Valore restituito

TRUE se la modalità tavolozza è abilitata, in caso contrario FALSE.

### <a name="remarks"></a>Commenti

Quando il pulsante di menu è impostato sulla modalità tavolozza, le voci di menu vengono visualizzate in più colonne con solo un numero limitato di righe. Chiamare questo metodo per ottenere il numero di righe. È possibile abilitare o disabilitare la modalità tavolozza chiamando [CMFCToolBarMenuButton:: SetMenuPaletteMode](#setmenupalettemode).

## <a name="cmfctoolbarmenubuttonistearoffmenu"></a><a name="istearoffmenu"></a> CMFCToolBarMenuButton:: IsTearOffMenu

Indica se il menu a discesa dispone di una barra di strappo.

```
virtual BOOL IsTearOffMenu() const;
```

### <a name="return-value"></a>Valore restituito

TRUE se il pulsante del menu della barra degli strumenti ha una barra di strappo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Per abilitare la funzionalità di strappo e impostare l'ID della barra di strappo, chiamare [CMFCToolBarMenuButton:: SetTearOff](#settearoff).

## <a name="cmfctoolbarmenubuttonm_balwayscallownerdraw"></a><a name="m_balwayscallownerdraw"></a> CMFCToolBarMenuButton:: m_bAlwaysCallOwnerDraw

Specifica se il Framework chiama sempre [CFrameWndEx:: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) quando viene disegnato un pulsante.

```
static BOOL m_bAlwaysCallOwnerDraw;
```

### <a name="remarks"></a>Commenti

Quando questa variabile membro è impostata su TRUE, il pulsante chiama sempre il metodo [CFrameWndEx:: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) per visualizzare l'immagine sul pulsante. Quando `m_bAlwaysCallOwnerDraw` è false, il pulsante stesso disegna l'immagine se l'immagine è predefinita. In caso contrario, chiama `OnDrawMenuImage` .

## <a name="cmfctoolbarmenubuttononaftercreatepopupmenu"></a><a name="onaftercreatepopupmenu"></a> CMFCToolBarMenuButton:: OnAfterCreatePopupMenu

```
virtual void OnAfterCreatePopupMenu();
```

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttononbeforedrag"></a><a name="onbeforedrag"></a> CMFCToolBarMenuButton:: OnBeforeDrag

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttononcalculatesize"></a><a name="oncalculatesize"></a> CMFCToolBarMenuButton:: OnCalculateSize

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>Parametri

in *PDC*<br/>
in *sizeDefault*<br/>
in *bHorz*<br/>

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttononcancelmode"></a><a name="oncancelmode"></a> CMFCToolBarMenuButton:: OnCancelMode

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttononchangeparentwnd"></a><a name="onchangeparentwnd"></a> CMFCToolBarMenuButton:: OnChangeParentWnd

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>Parametri

in *pWndParent*<br/>

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttononclick"></a><a name="onclick"></a> CMFCToolBarMenuButton:: OnClick

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay = TRUE);
```

### <a name="parameters"></a>Parametri

in *pWnd*<br/>
in *bDelay*<br/>

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttononclickmenuitem"></a><a name="onclickmenuitem"></a> CMFCToolBarMenuButton:: OnClickMenuItem

Chiamata eseguita dal framework quando l'utente seleziona un elemento nel menu a discesa.

```
virtual BOOL OnClickMenuItem();
```

### <a name="return-value"></a>Valore restituito

FALSE se il Framework deve continuare l'elaborazione della voce di menu predefinita; in caso contrario, TRUE. L'implementazione predefinita restituisce sempre FALSE.

### <a name="remarks"></a>Commenti

Quando l'utente fa clic su una voce di menu, il Framework esegue un comando associato a tale elemento.

Per personalizzare l'elaborazione della voce di menu, eseguire l'override `OnClickMenuItem` di in una classe derivata dalla `CMFCToolBarMenuButton` classe. È inoltre necessario eseguire l'override di [CFrameWndEx:: OnShowPopupMenu](../../mfc/reference/cframewndex-class.md#onshowpopupmenu) e sostituire i pulsanti di menu che richiedono un'elaborazione speciale con istanze della classe derivata.

## <a name="cmfctoolbarmenubuttononcontexthelp"></a><a name="oncontexthelp"></a> CMFCToolBarMenuButton:: OnContextHelp

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>Parametri

in *pWnd*<br/>

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttonondraw"></a><a name="ondraw"></a> CMFCToolBarMenuButton:: onpare

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz = TRUE,
    BOOL bCustomizeMode = FALSE,
    BOOL bHighlight = FALSE,
    BOOL bDrawBorder = TRUE,
    BOOL bGrayDisabledButtons = TRUE);
```

### <a name="parameters"></a>Parametri

in *PDC*<br/>
[in] *rect*<br/>
in *pImages*<br/>
in *bHorz*<br/>
in *bCustomizeMode*<br/>
in *bHighlight*<br/>
in *bDrawBorder*<br/>
in *bGrayDisabledButtons*<br/>

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttonondrawoncustomizelist"></a><a name="ondrawoncustomizelist"></a> CMFCToolBarMenuButton:: OnDrawOnCustomizeList

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>Parametri

in *PDC*<br/>
[in] *rect*<br/>
in *bSelected*<br/>

### <a name="return-value"></a>Valore restituito

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttonopenpopupmenu"></a><a name="openpopupmenu"></a> CMFCToolBarMenuButton:: OpenPopupMenu

Chiamata eseguita dal framework quando l'utente apre il menu a discesa di un pulsante di menu della barra degli strumenti.

```
virtual BOOL OpenPopupMenu(CWnd* pWnd=NULL);
```

### <a name="parameters"></a>Parametri

*pWnd*<br/>
in Specifica la finestra che riceve i comandi del menu a discesa. Può essere NULL solo se il pulsante di menu della barra degli strumenti ha una finestra padre.

### <a name="return-value"></a>Valore restituito

TRUE quando un oggetto della [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) è stato creato e aperto correttamente; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Questa funzione viene chiamata dal framework quando l'utente apre un menu a discesa da un pulsante del menu della barra degli strumenti.

## <a name="cmfctoolbarmenubuttonresetimagetodefault"></a><a name="resetimagetodefault"></a> CMFCToolBarMenuButton:: ResetImageToDefault

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttonsavebarstate"></a><a name="savebarstate"></a> CMFCToolBarMenuButton:: SaveBarState

```
virtual void SaveBarState();
```

### <a name="remarks"></a>Commenti

Il Framework chiama questo metodo quando crea un pulsante della barra degli strumenti come risultato di un'operazione di trascinamento della selezione. Questo metodo chiama il metodo [CMFCPopupMenu:: SaveState](../../mfc/reference/cmfcpopupmenu-class.md#savestate) del menu a comparsa di primo livello, che fa in modo che il pulsante padre del menu popup ricrei il proprio menu.

## <a name="cmfctoolbarmenubuttonserialize"></a><a name="serialize"></a> CMFCToolBarMenuButton:: Serialize

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>Parametri

[in] *ar*<br/>

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttonsetaccdata"></a><a name="setaccdata"></a> CMFCToolBarMenuButton:: SetACCData

Imposta i dati di accessibilità per l'elemento della barra multifunzione.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Parametri

*pParent*<br/>
Finestra padre per l'elemento della barra multifunzione.

*data*<br/>
Dati di accessibilità per l'elemento della barra multifunzione.

### <a name="return-value"></a>Valore restituito

Restituisce sempre TRUE.

### <a name="remarks"></a>Commenti

Per impostazione predefinita, questo metodo imposta i dati di accessibilità per l'elemento della barra multifunzione e restituisce sempre TRUE. Eseguire l'override di questo metodo per impostare i dati di accessibilità e restituire un valore che indica l'esito positivo o negativo.

## <a name="cmfctoolbarmenubuttonsetmenuonly"></a><a name="setmenuonly"></a> CMFCToolBarMenuButton:: SetMenuOnly

Specifica se il pulsante viene disegnato come un pulsante di menu o un pulsante di menu combinato quando dispone di un ID comando valido e di un sottomenu.

```cpp
void SetMenuOnly(BOOL bMenuOnly);
```

### <a name="parameters"></a>Parametri

*bMenuOnly*<br/>
in TRUE per visualizzare questo pulsante come pulsante di menu quando dispone di un ID comando valido e di un sottomenu, FALSE per visualizzare questo pulsante come pulsante di menu combinato quando dispone di un ID comando valido e di un sottomenu.

### <a name="remarks"></a>Commenti

In genere, quando un pulsante di menu della barra degli strumenti dispone di un sottomenu e di un ID di comando, il menu sembra essere un pulsante combinato con un pulsante principale e un pulsante freccia giù associato. Se si chiama questo metodo e *bMenuOnly* è true, il pulsante viene invece visualizzato come un singolo pulsante di menu con una freccia rivolta verso il basso nel pulsante. Quando l'utente fa clic sulla freccia in una delle due modalità, viene aperto il sottomenu e quando l'utente fa clic sulla parte non freccia del pulsante in una delle due modalità, il Framework esegue il comando.

## <a name="cmfctoolbarmenubuttonsetmenupalettemode"></a><a name="setmenupalettemode"></a> CMFCToolBarMenuButton:: SetMenuPaletteMode

Specifica se il menu a discesa è in modalità tavolozza.

```cpp
void SetMenuPaletteMode(
    BOOL bMenuPaletteMode=TRUE,
    int nPaletteRows=1);
```

### <a name="parameters"></a>Parametri

*bMenuPaletteMode*<br/>
in Specifica se il menu a discesa è in modalità tavolozza.

*nPaletteRows*<br/>
in Numero di righe nella tavolozza.

### <a name="remarks"></a>Commenti

In modalità tavolozza tutte le voci di menu vengono visualizzate come tavolozza a più colonne. Per specificare il numero di righe, usare *nPaletteRows*.

## <a name="cmfctoolbarmenubuttonsetmessagewnd"></a><a name="setmessagewnd"></a> CMFCToolBarMenuButton:: SetMessageWnd

```cpp
void SetMessageWnd(CWnd* pWndMessage);
```

### <a name="parameters"></a>Parametri

in *pWndMessage*<br/>

### <a name="remarks"></a>Commenti

## <a name="cmfctoolbarmenubuttonsetradio"></a><a name="setradio"></a> CMFCToolBarMenuButton:: seradio

Imposta il pulsante di menu della barra degli strumenti per visualizzare un'icona di stile del pulsante di opzione quando viene selezionata.

```
virtual void SetRadio();
```

### <a name="remarks"></a>Commenti

Quando il pulsante di menu viene disegnato mentre è selezionato, viene chiamato [CMFCVisualManager:: OnDrawMenuCheck](../../mfc/reference/cmfcvisualmanager-class.md#ondrawmenucheck) per disegnare un'icona di segno di spunta. Per impostazione predefinita, `OnDrawMenuCheck` richiede che il gestore di visualizzazione corrente disegni un segno di spunta dello stile del CheckBox sul pulsante di menu. Dopo aver chiamato questo metodo, il gestore di visualizzazione corrente disegna invece un segno di spunta dello stile di un pulsante di opzione sul pulsante di menu. Questa modifica non può essere annullata.

Quando si chiama questo metodo e il pulsante di menu è attualmente visualizzato, verrà aggiornato.

## <a name="cmfctoolbarmenubuttonsettearoff"></a><a name="settearoff"></a> CMFCToolBarMenuButton:: SetTearOff

Specifica l'ID della barra di strappo per il menu a discesa.

```
virtual void SetTearOff(UINT uiBarID);
```

### <a name="parameters"></a>Parametri

*uiBarID*<br/>
in Specifica un nuovo ID della barra tear-off.

### <a name="remarks"></a>Commenti

Chiamare questo metodo per specificare l'ID per la barra di strappo creata quando l'utente trascina il pulsante di menu da una barra dei menu. Se il parametro *uiBarID* è 0, l'utente non può eliminare il pulsante di menu.

Chiamare [CWinAppEx:: EnableTearOffMenus](../../mfc/reference/cwinappex-class.md#enabletearoffmenus) per abilitare la funzionalità del menu di strappo nell'applicazione.

## <a name="see-also"></a>Vedi anche

[Grafico delle gerarchie](../../mfc/hierarchy-chart.md)<br/>
[Classi](../../mfc/reference/mfc-classes.md)<br/>
[Classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)<br/>
[Classe CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)<br/>
[Classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)
