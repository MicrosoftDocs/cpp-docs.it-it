---
title: Classe CMFCToolBarButton
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeDropped
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStored
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStretched
- AFXTOOLBARBUTTON/CMFCToolBarButton::CompareWith
- AFXTOOLBARBUTTON/CMFCToolBarButton::CopyFrom
- AFXTOOLBARBUTTON/CMFCToolBarButton::CreateFromOleData
- AFXTOOLBARBUTTON/CMFCToolBarButton::EnableWindow
- AFXTOOLBARBUTTON/CMFCToolBarButton::ExportToMenuButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetClipboardFormat
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetHwnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetInvalidateRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetTextSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::HasFocus
- AFXTOOLBARBUTTON/CMFCToolBarButton::HaveHotBorder
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawText
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDroppedDown
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsEditable
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsExtraSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsFirstInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHidden
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHorizontal
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLastInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLocked
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsOwnerOf
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsWindowVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::NotifyCommand
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnAddToCustomizePage
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrop
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCalculateSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCancelMode
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnChangeParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClick
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClickUp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnContextHelp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCtlColor
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCustomizeMenu
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDblClk
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDraw
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDrawOnCustomizeList
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGetCustomToolTipText
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGlobalFontsChanged
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnMove
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnShow
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnToolHitTest
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnUpdateToolTip
- AFXTOOLBARBUTTON/CMFCToolBarButton::PrepareDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::Rect
- AFXTOOLBARBUTTON/CMFCToolBarButton::ResetImageToDefault
- AFXTOOLBARBUTTON/CMFCToolBarButton::SaveBarState
- AFXTOOLBARBUTTON/CMFCToolBarButton::Serialize
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetACCData
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetClipboardFormatName
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRadio
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::Show
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bTextBelow
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bUserButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWholeText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrap
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrapText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nID
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_strText
helpviewer_keywords:
- CMFCToolBarButton [MFC], CMFCToolBarButton
- CMFCToolBarButton [MFC], CanBeDropped
- CMFCToolBarButton [MFC], CanBeStored
- CMFCToolBarButton [MFC], CanBeStretched
- CMFCToolBarButton [MFC], CompareWith
- CMFCToolBarButton [MFC], CopyFrom
- CMFCToolBarButton [MFC], CreateFromOleData
- CMFCToolBarButton [MFC], EnableWindow
- CMFCToolBarButton [MFC], ExportToMenuButton
- CMFCToolBarButton [MFC], GetClipboardFormat
- CMFCToolBarButton [MFC], GetHwnd
- CMFCToolBarButton [MFC], GetImage
- CMFCToolBarButton [MFC], GetInvalidateRect
- CMFCToolBarButton [MFC], GetParentWnd
- CMFCToolBarButton [MFC], GetProtectedCommands
- CMFCToolBarButton [MFC], GetTextSize
- CMFCToolBarButton [MFC], HasFocus
- CMFCToolBarButton [MFC], HaveHotBorder
- CMFCToolBarButton [MFC], IsDrawImage
- CMFCToolBarButton [MFC], IsDrawText
- CMFCToolBarButton [MFC], IsDroppedDown
- CMFCToolBarButton [MFC], IsEditable
- CMFCToolBarButton [MFC], IsExtraSize
- CMFCToolBarButton [MFC], IsFirstInGroup
- CMFCToolBarButton [MFC], IsHidden
- CMFCToolBarButton [MFC], IsHorizontal
- CMFCToolBarButton [MFC], IsLastInGroup
- CMFCToolBarButton [MFC], IsLocked
- CMFCToolBarButton [MFC], IsOwnerOf
- CMFCToolBarButton [MFC], IsVisible
- CMFCToolBarButton [MFC], IsWindowVisible
- CMFCToolBarButton [MFC], NotifyCommand
- CMFCToolBarButton [MFC], OnAddToCustomizePage
- CMFCToolBarButton [MFC], OnBeforeDrag
- CMFCToolBarButton [MFC], OnBeforeDrop
- CMFCToolBarButton [MFC], OnCalculateSize
- CMFCToolBarButton [MFC], OnCancelMode
- CMFCToolBarButton [MFC], OnChangeParentWnd
- CMFCToolBarButton [MFC], OnClick
- CMFCToolBarButton [MFC], OnClickUp
- CMFCToolBarButton [MFC], OnContextHelp
- CMFCToolBarButton [MFC], OnCtlColor
- CMFCToolBarButton [MFC], OnCustomizeMenu
- CMFCToolBarButton [MFC], OnDblClk
- CMFCToolBarButton [MFC], OnDraw
- CMFCToolBarButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarButton [MFC], OnGetCustomToolTipText
- CMFCToolBarButton [MFC], OnGlobalFontsChanged
- CMFCToolBarButton [MFC], OnMove
- CMFCToolBarButton [MFC], OnShow
- CMFCToolBarButton [MFC], OnSize
- CMFCToolBarButton [MFC], OnToolHitTest
- CMFCToolBarButton [MFC], OnUpdateToolTip
- CMFCToolBarButton [MFC], PrepareDrag
- CMFCToolBarButton [MFC], Rect
- CMFCToolBarButton [MFC], ResetImageToDefault
- CMFCToolBarButton [MFC], SaveBarState
- CMFCToolBarButton [MFC], Serialize
- CMFCToolBarButton [MFC], SetACCData
- CMFCToolBarButton [MFC], SetClipboardFormatName
- CMFCToolBarButton [MFC], SetImage
- CMFCToolBarButton [MFC], SetProtectedCommands
- CMFCToolBarButton [MFC], SetRadio
- CMFCToolBarButton [MFC], SetRect
- CMFCToolBarButton [MFC], SetStyle
- CMFCToolBarButton [MFC], SetVisible
- CMFCToolBarButton [MFC], Show
- CMFCToolBarButton [MFC], m_bImage
- CMFCToolBarButton [MFC], m_bText
- CMFCToolBarButton [MFC], m_bTextBelow
- CMFCToolBarButton [MFC], m_bUserButton
- CMFCToolBarButton [MFC], m_bWholeText
- CMFCToolBarButton [MFC], m_bWrap
- CMFCToolBarButton [MFC], m_bWrapText
- CMFCToolBarButton [MFC], m_nID
- CMFCToolBarButton [MFC], m_nStyle
- CMFCToolBarButton [MFC], m_strText
ms.assetid: 8a6ecffb-86b0-4f5c-8211-a9146b463efd
ms.openlocfilehash: cfdde6aea42ff96957c18ef73f62a4e4f49292ff
ms.sourcegitcommit: a8ef52ff4a4944a1a257bdaba1a3331607fb8d0f
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/11/2020
ms.locfileid: "77127444"
---
# <a name="cmfctoolbarbutton-class"></a>Classe CMFCToolBarButton

Fornisce la funzionalità del pulsante per le barre degli strumenti.

## <a name="syntax"></a>Sintassi

```
class CMFCToolBarButton : public CObject
```

## <a name="members"></a>Members

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CMFCToolBarButton:: CMFCToolBarButton](#cmfctoolbarbutton)|Costruisce e inizializza un oggetto `CMFCToolBarButton`.|
|`CMFCToolBarButton::~CMFCToolBarButton`|Distruttore.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CMFCToolBarButton:: CanBeDropped](#canbedropped)|Specifica se un utente può posizionare un pulsante su una barra degli strumenti o un menu durante la personalizzazione.|
|[CMFCToolBarButton:: CanBeStored](#canbestored)|Specifica se il pulsante può essere archiviato.|
|[CMFCToolBarButton:: CanBeStretched](#canbestretched)|Specifica se un utente può estendere il pulsante durante la personalizzazione.|
|[CMFCToolBarButton:: CompareWith](#comparewith)|Confronta questa istanza con l'oggetto `CMFCToolBarButton` fornito.|
|[CMFCToolBarButton:: CopyFrom](#copyfrom)|Copia le proprietà di un altro pulsante della barra degli strumenti nel pulsante corrente.|
|[CMFCToolBarButton:: CreateFromOleData](#createfromoledata)|Crea un oggetto `CMFCToolBarButton` dall'oggetto `COleDataObject` fornito.|
|`CMFCToolBarButton::CreateObject`|Usato dal framework per creare un'istanza dinamica di questo tipo di classe.|
|[CMFCToolBarButton:: EnableWindow](#enablewindow)|Abilita o disabilita l'input da mouse e tastiera.|
|[CMFCToolBarButton:: ExportToMenuButton](#exporttomenubutton)|Copia il testo dal pulsante della barra degli strumenti in un menu.|
|[CMFCToolBarButton:: GetClipboardFormat](#getclipboardformat)|Recupera il formato degli Appunti globale per l'applicazione.|
|[CMFCToolBarButton:: GetHwnd](#gethwnd)|Recupera l'handle di finestra associato al pulsante della barra degli strumenti.|
|[CMFCToolBarButton:: GetImage](#getimage)|Recupera l'indice dell'immagine del pulsante.|
|[CMFCToolBarButton:: GetInvalidateRect](#getinvalidaterect)|Recupera l'area dell'area client del pulsante che deve essere ridisegnato.|
|[CMFCToolBarButton:: GetParentWnd](#getparentwnd)|Recupera la finestra padre del pulsante.|
|[CMFCToolBarButton:: GetProtectedCommands](#getprotectedcommands)|Recupera l'elenco di comandi che l'utente non è in grado di personalizzare.|
|[CMFCToolBarButton:: GetTextSize](#gettextsize)|Recupera la dimensione del testo del pulsante.|
|[CMFCToolBarButton:: HasFocus](#hasfocus)|Determina se il pulsante ha lo stato attivo per l'input corrente.|
|[CMFCToolBarButton:: HaveHotBorder](#havehotborder)|Determina se un bordo del pulsante viene visualizzato quando un utente seleziona il pulsante.|
|[CMFCToolBarButton:: IsDrawImage](#isdrawimage)|Determina se un'immagine viene visualizzata sul pulsante.|
|[CMFCToolBarButton:: IsDrawText](#isdrawtext)|Determina se sul pulsante viene visualizzata un'etichetta di testo.|
|[CMFCToolBarButton:: IsDroppedDown](#isdroppeddown)|Determina se il pulsante Visualizza un sottomenu.|
|[CMFCToolBarButton:: è modificabile](#iseditable)|Determina se il pulsante può essere personalizzato.|
|[CMFCToolBarButton:: IsExtraSize](#isextrasize)|Determina se il pulsante può essere visualizzato con un bordo esteso.|
|[CMFCToolBarButton:: IsFirstInGroup](#isfirstingroup)|Determina se il pulsante si trova nella prima posizione del gruppo di pulsanti.|
|[CMFCToolBarButton:: Hidden](#ishidden)|Determina se il pulsante è nascosto.|
|[CMFCToolBarButton:: Horizontal](#ishorizontal)|Determina se il pulsante si trova su una barra degli strumenti orizzontale.|
|[CMFCToolBarButton:: IsLastInGroup](#islastingroup)|Specifica se il pulsante si trova nell'ultima posizione del gruppo di pulsanti.|
|[CMFCToolBarButton:: è bloccato](#islocked)|Determina se il pulsante si trova su una barra degli strumenti bloccata (non personalizzabile).|
|[CMFCToolBarButton:: IsOwnerOf](#isownerof)|Determina se il pulsante è il proprietario dell'handle della finestra fornito.|
|[CMFCToolBarButton:: IsVisible](#isvisible)|Determina se il pulsante della barra degli strumenti è visibile.|
|[CMFCToolBarButton:: IsWindowVisible](#iswindowvisible)|Determina se l'handle di finestra sottostante del pulsante è visibile.|
|[CMFCToolBarButton:: NotifyCommand](#notifycommand)|Specifica se il pulsante elabora il messaggio di [WM_COMMAND](/windows/win32/menurc/wm-command) .|
|[CMFCToolBarButton:: OnAddToCustomizePage](#onaddtocustomizepage)|Chiamata eseguita dal framework quando il pulsante viene aggiunto a una finestra di dialogo di **personalizzazione** .|
|[CMFCToolBarButton:: OnBeforeDrag](#onbeforedrag)|Specifica se il pulsante può essere trascinato.|
|[CMFCToolBarButton:: OnBeforeDrop](#onbeforedrop)|Specifica se un utente può rilasciare il pulsante sulla barra degli strumenti di destinazione.|
|[CMFCToolBarButton:: OnCalculateSize](#oncalculatesize)|Chiamata eseguita dal Framework per calcolare le dimensioni del pulsante per il contesto di dispositivo e lo stato di ancoraggio specificati.|
|[CMFCToolBarButton:: OnCancelMode](#oncancelmode)|Chiamata eseguita dal Framework per gestire il messaggio di [WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode) .|
|[CMFCToolBarButton:: OnChangeParentWnd](#onchangeparentwnd)|Chiamata eseguita dal framework quando il pulsante viene inserito in una nuova barra degli strumenti.|
|[CMFCToolBarButton:: OnClick](#onclick)|Chiamata eseguita dal framework quando l'utente fa clic con il pulsante del mouse.|
|[CMFCToolBarButton:: OnClickUp](#onclickup)|Chiamata eseguita dal framework quando l'utente rilascia il pulsante del mouse.|
|[CMFCToolBarButton:: OnContextHelp](#oncontexthelp)|Chiamata eseguita dal framework quando la barra degli strumenti padre gestisce un messaggio di WM_HELPHITTEST.|
|[CMFCToolBarButton:: OnCtlColor](#onctlcolor)|Chiamata eseguita dal framework quando la barra degli strumenti padre gestisce un messaggio di WM_CTLCOLOR.|
|[CMFCToolBarButton:: OnCustomizeMenu](#oncustomizemenu)|Consente al pulsante di modificare il menu fornito quando l'applicazione visualizza un menu di scelta rapida sulla barra degli strumenti padre.|
|[CMFCToolBarButton:: OnDblClk](#ondblclk)|Chiamata eseguita dal framework quando la barra degli strumenti padre gestisce un messaggio di [WM_LBUTTONDBLCLK](/windows/win32/inputdev/wm-lbuttondblclk) .|
|[CMFCToolBarButton:: onpare](#ondraw)|Chiamato dal Framework per disegnare il pulsante usando gli stili e le opzioni specificati.|
|[CMFCToolBarButton:: OnDrawOnCustomizeList](#ondrawoncustomizelist)|Viene chiamato dal Framework per creare il pulsante nel riquadro **comandi** della finestra di dialogo **Personalizza** .|
|[CMFCToolBarButton:: OnGetCustomToolTipText](#ongetcustomtooltiptext)|Chiamata eseguita dal Framework per recuperare il testo della descrizione comando personalizzato per il pulsante.|
|[CMFCToolBarButton:: OnGlobalFontsChanged](#onglobalfontschanged)|Chiamata eseguita dal framework quando il tipo di carattere globale è stato modificato.|
|[CMFCToolBarButton:: OnMove](#onmove)|Chiamata eseguita dal framework quando la barra degli strumenti padre viene spostata.|
|[CMFCToolBarButton:: OnShow](#onshow)|Chiamata eseguita dal framework quando il pulsante diventa visibile o invisibile.|
|[CMFCToolBarButton:: OnSize](#onsize)|Chiamata eseguita dal framework quando la barra degli strumenti padre ne modifica la dimensione o la posizione e la modifica richiede la modifica delle dimensioni del pulsante.|
|[CMFCToolBarButton:: OnToolHitTest](#ontoolhittest)|Chiamata eseguita dal framework quando la barra degli strumenti padre deve determinare se un punto si trova nel rettangolo di delimitazione del pulsante.|
|[CMFCToolBarButton:: OnUpdateToolTip](#onupdatetooltip)|Chiamata eseguita dal framework quando la barra degli strumenti padre aggiorna il testo della descrizione comando.|
|[CMFCToolBarButton::P repareDrag](#preparedrag)|Chiamato dal framework quando il pulsante sta per eseguire un'operazione di trascinamento della selezione.|
|[CMFCToolBarButton:: Rect](#rect)|Recupera il rettangolo di delimitazione del pulsante.|
|[CMFCToolBarButton:: ResetImageToDefault](#resetimagetodefault)|Imposta sul valore predefinito l'immagine associata al pulsante.|
|[CMFCToolBarButton:: SaveBarState](#savebarstate)|Salva lo stato del pulsante della barra degli strumenti.|
|[CMFCToolBarButton:: Serialize](#serialize)|Legge questo oggetto da un archivio o lo scrive in un archivio. Esegue l'override di [CObject::Serialize](../../mfc/reference/cobject-class.md#serialize).|
|[CMFCToolBarButton:: SetACCData](#setaccdata)|Popola l'oggetto `CAccessibilityData` fornito con i dati di accessibilità dal pulsante della barra degli strumenti.|
|[CMFCToolBarButton:: SetClipboardFormatName](#setclipboardformatname)|Rinomina il formato degli Appunti globale.|
|[CMFCToolBarButton:: seimagine](#setimage)|Imposta l'indice dell'immagine del pulsante.|
|[CMFCToolBarButton:: SetProtectedCommands](#setprotectedcommands)|Imposta l'elenco di comandi che l'utente non è in grado di personalizzare.|
|[CMFCToolBarButton:: seradio](#setradio)|Chiamata eseguita dal framework quando viene modificato lo stato di selezione di un pulsante.|
|[CMFCToolBarButton:: serect](#setrect)|Imposta il rettangolo di delimitazione del pulsante.|
|[CMFCToolBarButton:: Sestyle](#setstyle)|Imposta lo stile del pulsante.|
|[CMFCToolBarButton:: sevisible](#setvisible)|Specifica se il pulsante è visibile.|
|[CMFCToolBarButton:: Show](#show)|Consente di visualizzare o nascondere il pulsante.|

### <a name="data-members"></a>Membri dei dati

|Nome|Descrizione|
|----------|-----------------|
|[CMFCToolBarButton:: m_bImage](#m_bimage)|Specifica se un'immagine viene visualizzata sul pulsante.|
|[CMFCToolBarButton:: m_bText](#m_btext)|Specifica se sul pulsante viene visualizzata un'etichetta di testo.|
|[CMFCToolBarButton:: m_bTextBelow](#m_btextbelow)|Specifica se l'etichetta di testo viene visualizzata sotto l'immagine del pulsante.|
|[CMFCToolBarButton:: m_bUserButton](#m_buserbutton)|Specifica se il pulsante ha un'immagine definita dall'utente.|
|[CMFCToolBarButton:: m_bWholeText](#m_bwholetext)|Specifica se il pulsante Visualizza l'etichetta full-text anche se non rientra nel rettangolo di delimitazione.|
|[CMFCToolBarButton:: m_bWrap](#m_bwrap)|Specifica se il pulsante accanto a un separatore verrà inserito nella riga successiva.|
|[CMFCToolBarButton:: m_bWrapText](#m_bwraptext)|Specifica se le etichette di testo a più righe sono abilitate.|
|[CMFCToolBarButton:: m_nID](#m_nid)|ID di comando del pulsante.|
|[CMFCToolBarButton:: m_nStyle](#m_nstyle)|Stile del pulsante.|
|[CMFCToolBarButton:: m_strText](#m_strtext)|Etichetta di testo del pulsante.|

## <a name="remarks"></a>Osservazioni

Un oggetto `CMFCToolbarButton` è un controllo che risiede su una barra degli strumenti. Il comportamento è simile a quello di un pulsante normale. È possibile assegnare un'immagine e un'etichetta di testo a questo oggetto. Un pulsante della barra degli strumenti può anche avere un ID di comando. Quando l'utente fa clic sul pulsante della barra degli strumenti, il Framework esegue il comando specificato dall'ID.

In genere, è possibile personalizzare i pulsanti della barra degli strumenti: l'utente può trascinare i pulsanti da una barra degli strumenti a un'altra e copiare, incollare, eliminare e modificare etichette e immagini di testo. Per impedire all'utente di personalizzare la barra degli strumenti, è possibile bloccare la barra degli strumenti in uno dei due modi seguenti. Impostare il flag di `bLocked` su TRUE quando si chiama [CMFCToolBar:: LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar)o aggiungere l'ID di comando di un singolo pulsante all'elenco globale di comandi protetti usando il metodo [CMFCToolBarButton:: SetProtectedCommands](#setprotectedcommands) .

`CMFCToolBarButton` oggetti visualizzano immagini dalle raccolte globali di immagini della barra degli strumenti nell'applicazione. Queste raccolte vengono gestite dalla barra degli strumenti padre, [Classe CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md). Per ulteriori informazioni, vedere la [classe CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md).

Quando l'utente fa clic su un pulsante della barra degli strumenti, la barra degli strumenti padre elabora il messaggio del mouse e comunica le azioni appropriate al pulsante. Se il pulsante ha un ID di comando valido, la barra degli strumenti padre invia il messaggio di WM_COMMAND al frame padre.

La classe `CMFCToolBarButton` è la classe base per altre classi di pulsanti della barra degli strumenti, ad esempio la classe [CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md), la [classe CMFCToolBarEditBoxButton](../../mfc/reference/cmfctoolbareditboxbutton-class.md)e la [Classe CMFCToolBarComboBoxButton](../../mfc/reference/cmfctoolbarcomboboxbutton-class.md).

## <a name="example"></a>Esempio

Nell'esempio seguente viene illustrato come configurare un oggetto `CMFCToolBarButton` usando vari metodi nella classe `CMFCToolBarButton`. Nell'esempio viene illustrato come abilitare l'input del mouse e della tastiera, impostare l'indice dell'immagine del pulsante, impostare il rettangolo delimitatore del pulsante e rendere visibile il pulsante. Questo frammento di codice fa parte dell' [esempio di controllo Tab](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_TabControl#1](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_1.cpp)]
[!code-cpp[NVC_MFC_TabControl#2](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_2.cpp)]

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

## <a name="requirements"></a>Requisiti

**Intestazione:** afxtoolbarbutton. h

##  <a name="canbedropped"></a>CMFCToolBarButton:: CanBeDropped

Specifica se un utente può posizionare un pulsante su una barra degli strumenti o un menu durante la personalizzazione.

```
virtual BOOL CanBeDropped(CMFCToolBar* pToolbar);
```

### <a name="parameters"></a>Parametri

*pToolbar*<br/>
[in] Non utilizzato.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Osservazioni

Per impostazione predefinita, è possibile eliminare un pulsante della barra degli strumenti in ogni barra degli strumenti personalizzabile (ovvero non bloccata).

L'implementazione predefinita di questo metodo restituisce TRUE. Eseguire l'override di questo metodo e restituire FALSE se si desidera impedire all'utente di riposizionare il pulsante.

##  <a name="canbestored"></a>CMFCToolBarButton:: CanBeStored

Determina se il pulsante può essere archiviato.

```
virtual BOOL CanBeStored() const;
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Osservazioni

Il Framework usa questo metodo per determinare se il pulsante può partecipare a un'operazione di trascinamento della selezione.

L'implementazione predefinita restituisce TRUE. Eseguire l'override di questo metodo se il pulsante non può essere archiviato come parte di un'operazione di trascinamento della selezione. Per altre informazioni sulle operazioni di trascinamento della selezione, vedere [trascinamento della selezione OLE](../../mfc/drag-and-drop-ole.md).

##  <a name="canbestretched"></a>CMFCToolBarButton:: CanBeStretched

Specifica se un utente può estendere il pulsante durante la personalizzazione.

```
virtual BOOL CanBeStretched() const;
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

Questo metodo viene utilizzato dal Framework per determinare se il pulsante può essere allungato in modalità di personalizzazione.

L'implementazione predefinita di questo metodo restituisce FALSE. Eseguire l'override di questo metodo per restituire TRUE per un controllo a larghezza variabile, ad esempio una casella combinata o un dispositivo di scorrimento.

Per ulteriori informazioni sulla modalità di personalizzazione, vedere [CMFCToolBar:: SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode).

##  <a name="cmfctoolbarbutton"></a>CMFCToolBarButton:: CMFCToolBarButton

Costruisce e inizializza un oggetto `CMFCToolBarButton`.

```
CMFCToolBarButton(
    UINT uiID,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>Parametri

*uiID*<br/>
in ID di comando del pulsante.

*iImage*<br/>
in Indice immagine del pulsante nella raccolta di immagini.

*lpszText*<br/>
in Etichetta di testo del pulsante. Può essere NULL.

*bUserButton*<br/>
in Valore booleano che determina se il pulsante è definito dall'utente. Se questo parametro è TRUE, il pulsante è definito dall'utente. In caso contrario, l'immagine del pulsante viene caricata da una risorsa.

*Bloccato*<br/>
in Valore booleano che determina se il pulsante può essere personalizzato. Se questo parametro è TRUE, il pulsante non può essere personalizzato. In caso contrario, il pulsante può essere personalizzato.

##  <a name="comparewith"></a>CMFCToolBarButton:: CompareWith

Confronta questa istanza con l'oggetto `CMFCToolBarButton` fornito.

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>Parametri

*other*<br/>
in Riferimento all'oggetto da confrontare con questa istanza.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'oggetto specificato è uguale al valore di questa istanza. in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita determina se l'ID di comando dell'oggetto specificato è uguale all'ID di comando di questa istanza. Eseguire l'override di questo metodo se è necessario eseguire un'elaborazione aggiuntiva per determinare se due oggetti `CMFCToolBarButton` sono uguali.

##  <a name="copyfrom"></a>CMFCToolBarButton:: CopyFrom

Copia le proprietà di un altro pulsante della barra degli strumenti nel pulsante corrente.

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>Parametri

*src*<br/>
in Riferimento al pulsante di origine da cui eseguire la copia.

### <a name="remarks"></a>Osservazioni

Chiamare questo metodo per copiare un altro pulsante della barra degli strumenti in questo pulsante della barra degli strumenti.

##  <a name="createfromoledata"></a>CMFCToolBarButton:: CreateFromOleData

Crea un oggetto `CMFCToolBarButton` dall'oggetto `COleDataObject` fornito.

```
static CMFCToolBarButton* __stdcall CreateFromOleData(COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametri

*pDataObject*<br/>
in Oggetto dati OLE di origine.

### <a name="return-value"></a>Valore restituito

L'oggetto `CMFCToolBarButton` creato.

### <a name="remarks"></a>Osservazioni

Questo metodo viene utilizzato dal Framework per eseguire il trasferimento dei dati in vari formati. Ad esempio, il metodo `CMFCOutlookBarPane::OnDragOver` usa questo metodo per eseguire operazioni di trascinamento della selezione.

##  <a name="enablewindow"></a>CMFCToolBarButton:: EnableWindow

Abilita o disabilita l'input da mouse e tastiera.

```
virtual void EnableWindow(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Parametri

*bEnable*<br/>
in Impostare questo parametro su TRUE per abilitare l'input o su FALSE per disabilitare l'input.

### <a name="remarks"></a>Osservazioni

Questo metodo chiama la funzione `EnableWindow` per abilitare o disabilitare l'input. Per ulteriori informazioni, vedere [EnableWindow](/windows/win32/api/winuser/nf-winuser-enablewindow) nel Windows SDK.

##  <a name="exporttomenubutton"></a>CMFCToolBarButton:: ExportToMenuButton

Copia il testo dal pulsante della barra degli strumenti in un menu.

```
virtual BOOL ExportToMenuButton(CMFCToolBarMenuButton& menuButton) const;
```

### <a name="parameters"></a>Parametri

*menuButton*<br/>
in Riferimento al pulsante di menu di destinazione.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo per copiare il testo da un pulsante della barra degli strumenti in un pulsante di menu. L'implementazione predefinita copia l'etichetta di testo del pulsante. Se l'etichetta di testo è vuota, questo metodo copia il testo della descrizione comando del pulsante.

L'implementazione predefinita di questo metodo restituisce TRUE. Eseguire l'override di questo metodo se si desidera eseguire azioni aggiuntive quando il Framework converte un oggetto derivato da [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) in un pulsante di menu.

##  <a name="getclipboardformat"></a>CMFCToolBarButton:: GetClipboardFormat

Recupera il formato degli Appunti globale per l'applicazione.

```
static CLIPFORMAT __stdcall GetClipboardFormat();
```

### <a name="return-value"></a>Valore restituito

Valore CLIPFORMAT globale per l'applicazione.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo per recuperare il formato degli Appunti per le operazioni di trasferimento dei dati OLE. Ad esempio, il metodo [CMFCToolBarButton:: CreateFromOleData](#createfromoledata) utilizza questo metodo per copiare dati da un oggetto dati OLE di origine.

Questo metodo imposta il valore CLIPFORMAT globale la prima volta che questo metodo viene chiamato. Tutte le chiamate successive a questo metodo restituiscono questo valore.

Per consentire l'esecuzione di operazioni di trascinamento della selezione tra le applicazioni, chiamare il metodo [CMFCToolBarButton:: SetClipboardFormatName](#setclipboardformatname) .

Per ulteriori informazioni sugli Appunti in MFC, vedere gli [Appunti](../../mfc/clipboard.md).

##  <a name="gethwnd"></a>CMFCToolBarButton:: GetHwnd

Recupera l'handle di finestra associato al pulsante della barra degli strumenti.

```
virtual HWND GetHwnd();
```

### <a name="return-value"></a>Valore restituito

Handle della finestra associato al pulsante della barra degli strumenti o NULL se al pulsante della barra degli strumenti non è associato un handle di finestra.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo restituisce NULL. Eseguire l'override di questo metodo per restituire l'handle della finestra del controllo specifico.

##  <a name="getimage"></a>CMFCToolBarButton:: GetImage

Recupera l'indice dell'immagine del pulsante.

```
int GetImage() const;
```

### <a name="return-value"></a>Valore restituito

Indice dell'immagine associata a questo pulsante.

### <a name="remarks"></a>Osservazioni

Se il pulsante ha un'immagine definita dall'utente, ovvero se *bUserButton* è true nel costruttore, l'indice restituito specifica un'immagine nella raccolta di immagini definite dall'utente (vedere [CMFCToolBar:: GetUserImages](../../mfc/reference/cmfctoolbar-class.md#getuserimages)). In caso contrario, l'indice specifica un'immagine nella raccolta di immagini caricate da un file di risorse (vedere [CMFCToolBar:: GetImages](../../mfc/reference/cmfctoolbar-class.md#getimages)). Per altre informazioni sui file di risorse, vedere [uso dei file di risorse](../../windows/working-with-resource-files.md).

##  <a name="getinvalidaterect"></a>CMFCToolBarButton:: GetInvalidateRect

Recupera l'area dell'area client del pulsante che deve essere ridisegnato.

```
virtual const CRect GetInvalidateRect() const;
```

### <a name="return-value"></a>Valore restituito

Oggetto `CRect` che specifica l'area che deve essere ridisegnato.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo restituisce l'intera area client. Eseguire l'override di questo metodo se si desidera che un'area diversa venga ridisegnato.

##  <a name="getparentwnd"></a>CMFCToolBarButton:: GetParentWnd

Recupera la finestra padre del pulsante.

```
CWnd* GetParentWnd() const;
```

### <a name="return-value"></a>Valore restituito

Finestra padre del pulsante.

##  <a name="getprotectedcommands"></a>CMFCToolBarButton:: GetProtectedCommands

Recupera l'elenco di comandi che l'utente non è in grado di personalizzare.

```
static const CList<UINT,UINT>& GetProtectedCommands();
```

### <a name="return-value"></a>Valore restituito

Elenco di comandi protetti.

### <a name="remarks"></a>Osservazioni

In modalità personalizzazione, il Framework Disabilita i comandi dei pulsanti della barra degli strumenti protetti. L'utente non può eseguire operazioni di trascinamento della selezione e di modifica sui pulsanti della barra degli strumenti disabilitati.

Usare il metodo [CMFCToolBarButton:: SetProtectedCommands](#setprotectedcommands) per definire l'elenco di comandi protetti.

##  <a name="gettextsize"></a>CMFCToolBarButton:: GetTextSize

Recupera la dimensione del testo del pulsante.

```
SIZE GetTextSize() const;
```

### <a name="return-value"></a>Valore restituito

Oggetto SIZE che contiene le dimensioni, in pixel, del testo del pulsante.

##  <a name="hasfocus"></a>CMFCToolBarButton:: HasFocus

Determina se il pulsante ha lo stato attivo per l'input corrente.

```
virtual BOOL HasFocus() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante ha lo stato attivo per l'input; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo restituisce un valore diverso da zero se il pulsante ha lo stato attivo per l'input o è una finestra figlio o discendente della finestra con lo stato attivo per l'input. È possibile eseguire l'override di questa funzione per personalizzare questo comportamento.

##  <a name="havehotborder"></a>CMFCToolBarButton:: HaveHotBorder

Determina se un bordo del pulsante viene visualizzato quando un utente seleziona il pulsante.

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo per determinare se il pulsante della barra degli strumenti deve visualizzarne il bordo quando viene selezionato da un utente.

L'implementazione predefinita restituisce TRUE. È possibile eseguire l'override di questo metodo per personalizzare questo comportamento.

##  <a name="isdrawimage"></a>CMFCToolBarButton:: IsDrawImage

Determina se un'immagine viene visualizzata sul pulsante.

```
BOOL IsDrawImage() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se sul pulsante viene visualizzata un'immagine; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Questo metodo restituisce FALSE se al pulsante della barra degli strumenti non è associata alcuna immagine ( [CMFCToolBarButton:: GetImage](#getimage) restituisce-1) o se [CMFCToolBarButton:: m_bImage](#m_bimage) è impostato su false.

##  <a name="isdrawtext"></a>CMFCToolBarButton:: IsDrawText

Determina se sul pulsante viene visualizzata un'etichetta di testo.

```
BOOL IsDrawText() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se viene visualizzata un'etichetta di testo; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Questo metodo restituisce FALSE se al pulsante della barra degli strumenti non è associata alcuna etichetta di testo ( [CMFCToolBarButton:: m_strText](#m_strtext) è vuoto) o [cmfctoolbarbutton:: m_bText](#m_btext) è impostato su false.

##  <a name="isdroppeddown"></a>CMFCToolBarButton:: IsDroppedDown

Determina se il pulsante Visualizza un sottomenu.

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo restituisce FALSE. Eseguire l'override di questo metodo per restituire TRUE se il controllo Visualizza un sottomenu.

##  <a name="iseditable"></a>CMFCToolBarButton:: è modificabile

Determina se il pulsante può essere personalizzato.

```
virtual BOOL IsEditable() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se un pulsante può essere personalizzato dall'utente; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo per determinare se l'utente può personalizzare il pulsante della barra degli strumenti usando le operazioni di trascinamento della selezione o di modifica.

L'implementazione predefinita restituisce FALSE se l'ID di comando del pulsante è un comando standard (è possibile determinare questo problema chiamando la funzione `IsStandardCommand`) o se l'ID del comando è nell'elenco dei comandi protetti. Per ulteriori informazioni sui comandi protetti, vedere [CMFCToolBarButton:: GetProtectedCommands](#getprotectedcommands) e [CMFCToolBarButton:: SetProtectedCommands](#setprotectedcommands).

Eseguire l'override di questo metodo per personalizzarne il comportamento.

##  <a name="isextrasize"></a>CMFCToolBarButton:: IsExtraSize

Determina se il pulsante può essere visualizzato con un bordo esteso.

```
virtual BOOL IsExtraSize() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante della barra degli strumenti può essere visualizzato con un bordo esteso; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Diverse interfacce utilizzano dimensioni aggiuntive per i bordi dei pulsanti della barra degli strumenti, ad esempio i pulsanti round.

Se l'utente sposta questo pulsante da una barra degli strumenti a un'altra, il Framework chiama il metodo [CMFCToolBarButton:: OnChangeParentWnd](#onchangeparentwnd) . Il metodo [CMFCToolBarButton:: OnChangeParentWnd](#onchangeparentwnd) imposta il flag di dimensione aggiuntiva su quello della nuova barra degli strumenti padre (per altre informazioni, vedere [CMFCToolBar:: IsButtonExtraSizeAvailable](../../mfc/reference/cmfctoolbar-class.md#isbuttonextrasizeavailable)).

##  <a name="isfirstingroup"></a>CMFCToolBarButton:: IsFirstInGroup

Determina se il pulsante si trova nella prima posizione del gruppo di pulsanti.

```
virtual BOOL IsFirstInGroup() const;
```

### <a name="return-value"></a>Valore restituito

TRUE se il pulsante è il primo pulsante nel gruppo di pulsanti; in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Questo metodo definisce un *gruppo* di pulsanti come set di pulsanti adiacenti posizionati sulla stessa riga e delimitati da separatori o dal bordo della barra degli strumenti. Questo metodo restituisce FALSE se il pulsante della barra degli strumenti fa riferimento al pulsante **Personalizza** . Per ulteriori informazioni sul pulsante **Personalizza** , vedere [CMFCToolBar:: GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).

Chiamare il metodo [CMFCToolBarButton:: IsLastInGroup](#islastingroup) per determinare se il pulsante si trova nell'ultima posizione del relativo gruppo di pulsanti.

##  <a name="ishidden"></a>CMFCToolBarButton:: Hidden

Determina se il pulsante è nascosto.

```
BOOL IsHidden() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante è nascosto (invisibile); in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo quando la barra degli strumenti padre viene estesa per determinare se il pulsante della barra degli strumenti è visibile.

Se si imposta il pulsante come invisibile usando il metodo [CMFCToolBarButton:: sevisible](#setvisible) , usare [CMFCToolBarButton:: IsVisible](#isvisible) per determinare se il pulsante della barra degli strumenti è visibile.

Per impostazione predefinita, sono visibili tutti i pulsanti della barra degli strumenti. Usare il metodo [CMFCToolBarButton:: Show](#show) per nascondere o visualizzare i pulsanti della barra degli strumenti.

##  <a name="ishorizontal"></a>CMFCToolBarButton:: Horizontal

Determina se il pulsante si trova su una barra degli strumenti orizzontale.

```
BOOL IsHorizontal() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se un pulsante della barra degli strumenti si trova su una barra degli strumenti orizzontale; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo per determinare il layout dei pulsanti della barra degli strumenti.

Questo metodo restituisce il membro dati `m_bHorz`. Il valore predefinito del membro dati `m_bHorz` è TRUE; viene reimpostato a ogni chiamata al metodo [CMFCToolBarButton:: onpare](#ondraw) .

##  <a name="islastingroup"></a>CMFCToolBarButton:: IsLastInGroup

Specifica se il pulsante si trova nell'ultima posizione del gruppo di pulsanti.

```
virtual BOOL IsLastInGroup() const;
```

### <a name="return-value"></a>Valore restituito

TRUE se il pulsante è l'ultimo pulsante nel gruppo di pulsanti; in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Questo metodo definisce un *gruppo* di pulsanti come set di pulsanti adiacenti posizionati sulla stessa riga e delimitati da separatori o dal bordo della barra degli strumenti. questo metodo restituisce false se il pulsante della barra degli strumenti non dispone della barra degli strumenti padre o se il pulsante della barra degli strumenti fa riferimento al pulsante **Personalizza** . Per ulteriori informazioni sul pulsante **Personalizza** , vedere [CMFCToolBar:: GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).

Chiamare il metodo [CMFCToolBarButton:: IsFirstInGroup](#isfirstingroup) per determinare se il pulsante si trova nella prima posizione del relativo gruppo di pulsanti.

##  <a name="islocked"></a>CMFCToolBarButton:: è bloccato

Determina se il pulsante si trova su una barra degli strumenti bloccata (non personalizzabile).

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante si trova su una barra degli strumenti bloccata; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo per determinare se l'utente può personalizzare il pulsante della barra degli strumenti usando le operazioni di trascinamento della selezione o di modifica. Impostare l'attributo Locked sulla barra degli strumenti padre utilizzando il metodo [CMFCToolBar:: LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar) . Il Framework passa il valore di questo attributo al costruttore di ogni pulsante della barra degli strumenti ( [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)) che inserisce nella barra degli strumenti padre.

##  <a name="isownerof"></a>CMFCToolBarButton:: IsOwnerOf

Determina se il pulsante è il proprietario dell'handle della finestra fornito.

```
virtual BOOL IsOwnerOf(HWND hwnd);
```

### <a name="parameters"></a>Parametri

*hwnd*<br/>
in Handle di finestra.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante è il proprietario dell'handle della finestra fornito; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Questo metodo restituisce un valore diverso da zero se *HWND* si riferisce all'handle della finestra diretta o è un elemento figlio dell'handle di finestra associato al pulsante. Questo metodo restituisce 0 se *HWND* è null.

##  <a name="isvisible"></a>CMFCToolBarButton:: IsVisible

Determina se il pulsante della barra degli strumenti è visibile.

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante della barra degli strumenti è visibile; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

È possibile mostrare o nascondere il pulsante della barra degli strumenti usando il metodo [CMFCToolBarButton:: sevisible](#setvisible) . Chiamare il metodo [CPane:: AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) sulla barra degli strumenti padre dopo aver chiamato [CMFCToolBarButton:: sevisible](#setvisible) per ricalcolare il layout di una barra degli strumenti padre.

##  <a name="iswindowvisible"></a>CMFCToolBarButton:: IsWindowVisible

Determina se l'handle di finestra sottostante del pulsante è visibile.

```
virtual BOOL IsWindowVisible();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'handle di finestra sottostante del pulsante è visibile; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Questo metodo restituisce un valore diverso da zero se l'attributo Styles dell'handle della finestra sottostante contiene lo stile WS_VISIBLE. Questo metodo restituisce FALSE se l'handle di finestra sottostante del pulsante è NULL.

##  <a name="m_bimage"></a>CMFCToolBarButton:: m_bImage

Specifica se un'immagine viene visualizzata sul pulsante.

```
BOOL m_bImage;
```

### <a name="remarks"></a>Osservazioni

Se questo membro dati è impostato su TRUE, nel Framework viene visualizzata l'immagine associata al pulsante della barra degli strumenti; in caso contrario, l'immagine non viene visualizzata dal Framework. Questo membro influiscono sul valore restituito del metodo [CMFCToolBarButton:: m_bImage](#m_bimage) .

##  <a name="m_btext"></a>CMFCToolBarButton:: m_bText

Specifica se sul pulsante viene visualizzata un'etichetta di testo.

```
BOOL m_bText;
```

### <a name="remarks"></a>Osservazioni

Se questo membro dati è impostato su TRUE, il Framework Visualizza l'etichetta di testo del pulsante della barra degli strumenti; in caso contrario, il Framework non Visualizza l'etichetta di testo. Questo membro influiscono sul valore restituito del metodo [CMFCToolBarButton:: m_bText](#m_btext) .

##  <a name="m_btextbelow"></a>CMFCToolBarButton:: m_bTextBelow

Specifica se l'etichetta di testo viene visualizzata sotto l'immagine del pulsante.

```
BOOL m_bTextBelow;
```

### <a name="remarks"></a>Osservazioni

Se questa variabile membro è impostata su TRUE, il Framework Visualizza il testo del pulsante sotto l'immagine. Il valore predefinito di questo membro è FALSE.

##  <a name="m_buserbutton"></a>CMFCToolBarButton:: m_bUserButton

Specifica se il pulsante ha un'immagine definita dall'utente

```
BOOL m_bUserButton;
```

### <a name="remarks"></a>Osservazioni

Questo membro dati è impostato su TRUE quando al pulsante è associata un'immagine definita dall'utente.

##  <a name="m_bwholetext"></a>CMFCToolBarButton:: m_bWholeText

Specifica se il pulsante Visualizza l'etichetta full-text anche se non rientra nel rettangolo di delimitazione.

```
BOOL m_bWholeText;
```

### <a name="remarks"></a>Osservazioni

Se questo membro dati è impostato su TRUE, il Framework Visualizza l'etichetta full-text ingrandindo il pulsante. In caso contrario, il Framework tronca e accoda i puntini di sospensione ( **...**) all'etichetta di testo.

##  <a name="m_bwrap"></a>CMFCToolBarButton:: m_bWrap

Specifica se il pulsante accanto a un separatore verrà inserito nella riga successiva.

```
BOOL m_bWrap;
```

### <a name="remarks"></a>Osservazioni

Il Framework imposta questo membro dati su TRUE quando il pulsante della barra degli strumenti non rientra nella riga corrente o quando si specifica un layout (ad esempio, un numero specifico di pulsanti della barra degli strumenti per riga).

Il Framework posiziona questo pulsante nella riga successiva se il membro dati è impostato su TRUE e la barra degli strumenti è ancorata orizzontalmente o a virgola mobile.

Il valore predefinito di questo membro dati è FALSE.

##  <a name="m_bwraptext"></a>CMFCToolBarButton:: m_bWrapText

Specifica se le etichette di testo a più righe sono abilitate.

```
AFX_IMPORT_DATA static BOOL m_bWrapText;
```

### <a name="remarks"></a>Osservazioni

Se questa variabile membro statica è TRUE, il Framework consente a tutte le barre degli strumenti di visualizzare le etichette di testo su più righe sui pulsanti della barra degli strumenti.

Il valore predefinito di questo membro dati è FALSE.

##  <a name="m_nid"></a>CMFCToolBarButton:: m_nID

ID di comando del pulsante.

```
UINT m_nID;
```

### <a name="remarks"></a>Osservazioni

Un ID di comando-1 indica che il pulsante è un separatore. Tutti i separatori di pulsanti hanno lo stile TBBS_SEPARATOR. Per ulteriori informazioni sugli stili dei pulsanti, vedere [CMFCToolBarButton:: m_nStyle](#m_nstyle) .

##  <a name="m_nstyle"></a>CMFCToolBarButton:: m_nStyle

Stile del pulsante.

```
UINT m_nStyle;
```

### <a name="remarks"></a>Osservazioni

Vedere [stili di controllo della barra degli strumenti](../../mfc/reference/toolbar-control-styles.md) per l'elenco degli stili dei pulsanti della barra degli strumenti disponibili.

##  <a name="m_strtext"></a>CMFCToolBarButton:: m_strText

Etichetta di testo del pulsante.

```
CString m_strText;
```

### <a name="remarks"></a>Osservazioni

Questo membro dati contiene l'etichetta di testo del pulsante. L'etichetta di testo può essere vuota.

##  <a name="notifycommand"></a>CMFCToolBarButton:: NotifyCommand

Specifica se il pulsante elabora il messaggio di [WM_COMMAND](/windows/win32/menurc/wm-command) .

```
virtual BOOL NotifyCommand(int iNotifyCode);
```

### <a name="parameters"></a>Parametri

*iNotifyCode*<br/>
in Messaggio di notifica associato al comando.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo quando sta per inviare un messaggio di [WM_COMMAND](/windows/win32/menurc/wm-command) alla finestra padre.

Per impostazione predefinita, questo metodo restituisce FALSE. Eseguire l'override di questo metodo per restituire TRUE se si desidera elaborare il messaggio di WM_COMMAND o FALSE per indicare che la barra degli strumenti padre deve gestire il messaggio.

##  <a name="onaddtocustomizepage"></a>CMFCToolBarButton:: OnAddToCustomizePage

Chiamata eseguita dal framework quando il pulsante viene aggiunto a una finestra di dialogo di **personalizzazione** .

```
virtual void OnAddToCustomizePage();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo se si desidera eseguire un'azione quando si aggiunge il pulsante a una finestra di dialogo **Personalizza** .

##  <a name="onbeforedrag"></a>CMFCToolBarButton:: OnBeforeDrag

Specifica se il pulsante può essere trascinato.

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>Valore restituito

TRUE se il pulsante può essere trascinato; in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo prima che l'utente inizi a trascinare il pulsante.

L'implementazione predefinita di questo metodo restituisce TRUE. Eseguire l'override di questo metodo per restituire FALSE per disabilitare il trascinamento del pulsante.

##  <a name="onbeforedrop"></a>CMFCToolBarButton:: OnBeforeDrop

Specifica se un utente può rilasciare il pulsante sulla barra degli strumenti di destinazione.

```
virtual BOOL OnBeforeDrop(CMFCToolBar* pTarget);
```

### <a name="parameters"></a>Parametri

*pTarget*<br/>
in Destinazione dell'operazione di trascinamento della selezione.

### <a name="return-value"></a>Valore restituito

TRUE se il pulsante può essere rilasciato sulla barra degli strumenti di destinazione specificata. in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo prima che il pulsante venga rilasciato su una barra degli strumenti.

L'implementazione predefinita di questo metodo restituisce TRUE. Eseguire l'override di questo metodo per restituire FALSE per disabilitare l'operazione drop nella destinazione specificata.

##  <a name="oncalculatesize"></a>CMFCToolBarButton:: OnCalculateSize

Chiamata eseguita dal Framework per calcolare le dimensioni del pulsante per il contesto di dispositivo e lo stato di ancoraggio specificati.

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
in Contesto di dispositivo in cui viene visualizzato il pulsante.

*sizeDefault*<br/>
in Dimensioni predefinite del pulsante.

*bHorz*<br/>
in Stato di ancoraggio della barra degli strumenti padre. Questo parametro è TRUE se la barra degli strumenti è ancorata orizzontalmente o è mobile oppure FALSE se la barra degli strumenti è ancorata verticalmente.

### <a name="return-value"></a>Valore restituito

Struttura `SIZE` che contiene le dimensioni del pulsante, in pixel.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo per determinare le dimensioni del pulsante della barra degli strumenti per il contesto di dispositivo e lo stato di ancoraggio specificati.

L'implementazione predefinita prende in considerazione le dimensioni di testo e immagine (se visualizzate), le posizioni del testo e dell'immagine (il testo sotto o sul lato destro dell'immagine) e lo stato di ancoraggio della barra degli strumenti.

Eseguire l'override di questo metodo se si desidera specificare la dimensione di un pulsante non standard, ad esempio un pulsante della casella di modifica.

##  <a name="oncancelmode"></a>CMFCToolBarButton:: OnCancelMode

Chiamata eseguita dal Framework per gestire il messaggio di [WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode) .

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo se si desidera gestire il messaggio di [WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode) .

##  <a name="onchangeparentwnd"></a>CMFCToolBarButton:: OnChangeParentWnd

Chiamata eseguita dal framework quando il pulsante viene inserito in una nuova barra degli strumenti.

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>Parametri

*pWndParent*<br/>
in Nuova finestra padre.

### <a name="remarks"></a>Osservazioni

Il pulsante viene inserito in una barra degli strumenti, ad esempio quando l'utente lo trascina da una barra degli strumenti a un'altra.

L'implementazione predefinita di questo metodo non esegue alcuna operazione.

##  <a name="onclick"></a>CMFCToolBarButton:: OnClick

Chiamata eseguita dal framework quando l'utente fa clic con il pulsante del mouse.

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay=TRUE);
```

### <a name="parameters"></a>Parametri

*pWnd*<br/>
in La finestra padre del pulsante della barra degli strumenti.

*bDelay*<br/>
in TRUE se il messaggio deve essere gestito con un ritardo.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo quando l'utente fa clic sul pulsante della barra degli strumenti.

L'implementazione predefinita non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo per restituire un valore diverso da zero se il pulsante elabora il messaggio di clic.

##  <a name="onclickup"></a>CMFCToolBarButton:: OnClickUp

Chiamata eseguita dal framework quando l'utente rilascia il pulsante del mouse.

```
virtual BOOL OnClickUp();
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo quando l'utente rilascia il pulsante della barra degli strumenti.

L'implementazione predefinita non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo per restituire un valore diverso da zero se il pulsante elabora il messaggio di clic.

##  <a name="oncontexthelp"></a>CMFCToolBarButton:: OnContextHelp

Chiamata eseguita dal framework quando la barra degli strumenti padre gestisce un messaggio di WM_HELPHITTEST.

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>Parametri

*pWnd*<br/>
in La finestra padre del pulsante della barra degli strumenti.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo per restituire un valore diverso da zero se il pulsante elabora il messaggio della guida.

Per ulteriori informazioni sul messaggio di WM_HELPHITTEST, vedere [TN028: supporto della Guida sensibile al contesto](../../mfc/tn028-context-sensitive-help-support.md).

##  <a name="onctlcolor"></a>CMFCToolBarButton:: OnCtlColor

Chiamata eseguita dal framework quando la barra degli strumenti padre gestisce un messaggio di WM_CTLCOLOR.

```
virtual HBRUSH OnCtlColor(
    CDC* pDC,
    UINT nCtlColor);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
in Contesto di dispositivo in cui viene visualizzato il pulsante.

*nCtlColor*<br/>
in Notifica di colore specifica.

### <a name="return-value"></a>Valore restituito

Handle per l'oggetto Brush utilizzato dal Framework per disegnare lo sfondo del pulsante.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo quando la barra degli strumenti padre elabora il messaggio di WM_CTLCOLOR per un pulsante della barra degli strumenti che contiene un controllo Windows. Il Framework non chiama questo metodo se il pulsante della barra degli strumenti è privo di finestra.

Il Framework chiama questo metodo quando il Framework della barra degli strumenti è in modalità di personalizzazione e il pulsante della barra degli strumenti è sbloccato. Per ulteriori informazioni sulla modalità di personalizzazione, vedere [CMFCToolBar:: SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode). Per ulteriori informazioni sui pulsanti della barra degli strumenti di blocco, vedere [CMFCToolBarButton:: locked](#islocked).

L'implementazione predefinita non esegue alcuna operazione e restituisce NULL.

##  <a name="oncustomizemenu"></a>CMFCToolBarButton:: OnCustomizeMenu

Consente al pulsante di modificare il menu fornito quando l'applicazione visualizza un menu di scelta rapida sulla barra degli strumenti padre.

```
virtual BOOL OnCustomizeMenu(CMenu* pMenu);
```

### <a name="parameters"></a>Parametri

*pMenu*<br/>
in Menu da personalizzare.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo e restituire un valore diverso da zero se si desidera modificare il contenuto del menu fornito.

##  <a name="ondblclk"></a>CMFCToolBarButton:: OnDblClk

Chiamata eseguita dal framework quando la barra degli strumenti padre gestisce un messaggio di [WM_LBUTTONDBLCLK](/windows/win32/inputdev/wm-lbuttondblclk) .

```
virtual void OnDblClk(CWnd* pWnd);
```

### <a name="parameters"></a>Parametri

*pWnd*<br/>
[in]-la finestra padre del pulsante.

### <a name="remarks"></a>Osservazioni

Questo metodo viene chiamato dal metodo `CMFCToolBar::OnLButtonDblClk` quando la barra degli strumenti padre gestisce un messaggio di [WM_LBUTTONDBLCLK](/windows/win32/inputdev/wm-lbuttondblclk) .

L'implementazione predefinita di questo metodo non esegue alcuna operazione.

##  <a name="ondraw"></a>CMFCToolBarButton:: onpare

Chiamato dal Framework per disegnare il pulsante usando gli stili e le opzioni specificati.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz=TRUE,
    BOOL bCustomizeMode=FALSE,
    BOOL bHighlight=FALSE,
    BOOL bDrawBorder=TRUE,
    BOOL bGrayDisabledButtons=TRUE);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
in Contesto di dispositivo in cui viene visualizzato il pulsante.

*rect*<br/>
in Rettangolo delimitatore del pulsante.

*pImages*<br/>
in Raccolta di immagini della barra degli strumenti associata al pulsante.

*bHorz*<br/>
in Stato di ancoraggio della barra degli strumenti padre. Questo parametro è TRUE quando il pulsante è ancorato orizzontalmente e FALSE quando il pulsante è ancorato verticalmente.

*bCustomizeMode*<br/>
in Specifica se la barra degli strumenti è in modalità di personalizzazione. Questo parametro è TRUE se la barra degli strumenti è in modalità di personalizzazione e FALSE quando la barra degli strumenti non è in modalità di personalizzazione.

*bHighlight*<br/>
in Specifica se il pulsante è evidenziato. Questo parametro è TRUE quando il pulsante è evidenziato e FALSE quando il pulsante non è evidenziato.

*bDrawBorder*<br/>
in Specifica se il pulsante deve visualizzare il bordo. Questo parametro è TRUE quando il pulsante deve visualizzare il bordo e FALSE quando il pulsante non deve visualizzarne il bordo.

*bGrayDisabledButtons*<br/>
in Specifica se ombreggiare i pulsanti disabilitati o usare la raccolta di immagini disabilitate. Questo parametro è TRUE quando i pulsanti disabilitati devono essere ombreggiati e FALSE quando il metodo deve usare la raccolta di immagini disabilitate.

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questo metodo per personalizzare il disegno pulsante della barra degli strumenti.

##  <a name="ondrawoncustomizelist"></a>CMFCToolBarButton:: OnDrawOnCustomizeList

Viene chiamato dal Framework per creare il pulsante nel riquadro **comandi** della finestra di dialogo **Personalizza** .

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
in Contesto di dispositivo in cui viene visualizzato il pulsante.

*rect*<br/>
in Rettangolo delimitatore del pulsante.

*bSelected*<br/>
in Specifica se il pulsante è selezionato. Se questo parametro è TRUE, il pulsante è selezionato. Se questo parametro è FALSE, il pulsante non è selezionato.

### <a name="return-value"></a>Valore restituito

Larghezza, in pixel, del pulsante nel contesto di dispositivo specificato.

### <a name="remarks"></a>Osservazioni

Questo metodo viene chiamato dalla finestra di dialogo di personalizzazione (scheda **comandi** ) quando il pulsante sta per essere visualizzato nella casella di riepilogo creata dal proprietario.

L'implementazione predefinita di questo metodo consente di visualizzare l'immagine e l'etichetta di testo del pulsante se sono disponibili. Se l'etichetta di testo del pulsante non è disponibile, il metodo Visualizza il testo della descrizione comando.

Eseguire l'override di questo metodo per eseguire il disegno personalizzato.

##  <a name="ongetcustomtooltiptext"></a>CMFCToolBarButton:: OnGetCustomToolTipText

Chiamata eseguita dal Framework per recuperare il testo della descrizione comando personalizzato per il pulsante.

```
virtual BOOL OnGetCustomToolTipText(CString& strToolTip);
```

### <a name="parameters"></a>Parametri

*strToolTip*<br/>
out Oggetto `CString` che riceve il testo della descrizione comando personalizzato.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo quando Visualizza la descrizione comando per il pulsante della barra degli strumenti. Se questo metodo restituisce FALSE, il Framework usa una descrizione comando predefinita.

L'implementazione predefinita non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo e restituire un valore diverso da zero per fornire testo della descrizione comando personalizzato per il pulsante della barra degli strumenti.

##  <a name="onglobalfontschanged"></a>CMFCToolBarButton:: OnGlobalFontsChanged

Chiamata eseguita dal framework quando il tipo di carattere globale è stato modificato.

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per aggiornare il tipo di carattere utilizzato per visualizzare il testo del pulsante.

##  <a name="onmove"></a>CMFCToolBarButton:: OnMove

Chiamata eseguita dal framework quando la barra degli strumenti padre viene spostata.

```
virtual void OnMove();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per riposizionare il pulsante quando la barra degli strumenti padre viene spostata.

##  <a name="onshow"></a>CMFCToolBarButton:: OnShow

Chiamata eseguita dal framework quando il pulsante diventa visibile o invisibile.

```
virtual void OnShow(BOOL bShow);
```

### <a name="parameters"></a>Parametri

*bShow*<br/>
in Specifica se il pulsante è visibile. Se questo parametro è TRUE, il pulsante è visibile. In caso contrario, il pulsante non è visibile.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per aggiornare la visibilità del pulsante.

##  <a name="onsize"></a>CMFCToolBarButton:: OnSize

Chiamata eseguita dal framework quando la barra degli strumenti padre ne modifica la dimensione o la posizione e questa modifica determina la modifica delle dimensioni del pulsante.

```
virtual void OnSize(int iSize);
```

### <a name="parameters"></a>Parametri

*iSize*<br/>
in Nuova larghezza del pulsante.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per ridimensionare il pulsante quando viene modificata la dimensione o la posizione della barra degli strumenti padre.

##  <a name="ontoolhittest"></a>CMFCToolBarButton:: OnToolHitTest

Chiamata eseguita dal framework quando la barra degli strumenti padre deve determinare se un punto si trova nel rettangolo di delimitazione del pulsante.

```
virtual BOOL OnToolHitTest(
    const CWnd* pWnd,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>Parametri

*pWnd*<br/>
in Finestra padre del pulsante. Può essere NULL.

*pTI*<br/>
in Struttura `TOOLINFO` che contiene informazioni su uno strumento in un controllo ToolTip.

### <a name="return-value"></a>Valore restituito

Risultato di `OnMenuButtonToolHitTest` se il pulsante può recuperare un puntatore alla finestra cornice padre; in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Questo metodo chiama uno dei metodi seguenti se può convertire la finestra padre in un oggetto frame valido:

- [CMDIFrameWndEx:: OnMenuButtonToolHitTest](../../mfc/reference/cmdiframewndex-class.md#onmenubuttontoolhittest)

- [CFrameWndEx:: OnMenuButtonToolHitTest](../../mfc/reference/cframewndex-class.md#onmenubuttontoolhittest)

- [COleIPFrameWndEx:: OnMenuButtonToolHitTest](../../mfc/reference/coleipframewndex-class.md#onmenubuttontoolhittest)

##  <a name="onupdatetooltip"></a>CMFCToolBarButton:: OnUpdateToolTip

Chiamata eseguita dal framework quando la barra degli strumenti padre aggiorna il testo della descrizione comando.

```
virtual BOOL OnUpdateToolTip(
    CWnd* pWndParent,
    int iButtonIndex,
    CToolTipCtrl& wndToolTip,
    CString& str);
```

### <a name="parameters"></a>Parametri

*pWndParent*<br/>
in Finestra padre.

*iButtonIndex*<br/>
in Indice in base zero del pulsante nell'insieme di pulsanti padre.

*wndToolTip*<br/>
in Controllo che Visualizza il testo della descrizione comando.

*str*<br/>
out Oggetto `CString` che riceve il testo della descrizione comando aggiornato.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo per restituire un valore diverso da zero se si fornisce una stringa di testo della descrizione comando.

##  <a name="preparedrag"></a>CMFCToolBarButton::P repareDrag

Chiamato dal framework quando il pulsante sta per eseguire un'operazione di trascinamento della selezione.

```
virtual BOOL PrepareDrag(COleDataSource& srcItem);
```

### <a name="parameters"></a>Parametri

*srcItem*<br/>
in Oggetto `COleDataSource` che archivia le informazioni sullo stato relative all'operazione di trascinamento della selezione.

### <a name="return-value"></a>Valore restituito

TRUE se l'operazione ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo per preparare il pulsante della barra degli strumenti per archiviare lo stato nell'oggetto `COleDataSource` fornito. Questo metodo archivia lo stato eseguendo la serializzazione in un file condiviso e quindi passando il file al metodo [COleDataSource:: CacheGlobalData](../../mfc/reference/coledatasource-class.md#cacheglobaldata) . Per ulteriori informazioni sulla serializzazione dei pulsanti della barra degli strumenti, vedere [CMFCToolBarButton:: Serialize](#serialize).

Questo metodo non esegue alcuna operazione e restituisce TRUE se il pulsante non può essere archiviato (il metodo [CMFCToolBarButton:: CanBeStored](#canbestored) restituisce false). Restituisce FALSE se si verifica un'eccezione durante la serializzazione dell'oggetto.

Per altre informazioni sulle operazioni di trascinamento della selezione OLE, vedere [trascinamento](../../mfc/drag-and-drop-ole.md)della selezione OLE.

##  <a name="rect"></a>CMFCToolBarButton:: Rect

Recupera il rettangolo di delimitazione del pulsante.

```
const CRect& Rect() const;
```

### <a name="return-value"></a>Valore restituito

Oggetto `CRect` contenente il rettangolo di delimitazione di un pulsante.

##  <a name="resetimagetodefault"></a>CMFCToolBarButton:: ResetImageToDefault

Imposta sul valore predefinito l'immagine associata al pulsante.

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>Osservazioni

Questo metodo recupera l'immagine predefinita dalla barra degli strumenti padre usando il metodo [CMFCToolBar:: GetDefaultImage](../../mfc/reference/cmfctoolbar-class.md#getdefaultimage) . Se al pulsante non è associata un'immagine predefinita, questo metodo imposta l'etichetta di testo del pulsante in base alla relativa risorsa di stringa usando il metodo [CStringT:: LoadString](../../atl-mfc-shared/reference/cstringt-class.md#loadstring) . Per altre informazioni sulle risorse di stringa, vedere [uso dei file di risorse](../../windows/working-with-resource-files.md).

Questo metodo non esegue alcuna operazione se il pulsante ha un'immagine definita dall'utente.

##  <a name="savebarstate"></a>CMFCToolBarButton:: SaveBarState

Salva lo stato del pulsante della barra degli strumenti.

```
virtual void SaveBarState();
```

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo quando crea un oggetto `CMFCToolBarButton` come risultato di un'operazione di trascinamento della selezione.

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per salvare lo stato del pulsante della barra degli strumenti in un'origine dati esterna.

##  <a name="serialize"></a>CMFCToolBarButton:: Serialize

Legge questo oggetto da un archivio o lo scrive in un archivio.

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>Parametri

*AR*<br/>
in Oggetto `CArchive` da cui o da serializzare.

### <a name="remarks"></a>Osservazioni

Questo metodo supporta i processi di trasferimento dei dati, ad esempio gli Appunti o le operazioni di trascinamento della selezione. Legge o scrive le proprietà del pulsante, ad esempio l'ID, l'etichetta di testo e l'ID immagine da o all'oggetto `CArchive` fornito.

Per esempi di serializzazione, vedere [serializzazione: serializzazione di un oggetto](../../mfc/serialization-serializing-an-object.md).

##  <a name="setaccdata"></a>CMFCToolBarButton:: SetACCData

Popola l'oggetto `CAccessibilityData` fornito con i dati di accessibilità dal pulsante della barra degli strumenti.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Parametri

*pParent*<br/>
in La finestra padre del pulsante della barra degli strumenti.

*data*<br/>
in Oggetto `CAccessibilityData` popolato con i dati di accessibilità del pulsante della barra degli strumenti.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questo metodo per restituire FALSE se il pulsante della barra degli strumenti non fornisce dati di accessibilità.

##  <a name="setclipboardformatname"></a>CMFCToolBarButton:: SetClipboardFormatName

Rinomina il formato degli Appunti globale.

```
static void __stdcall SetClipboardFormatName(LPCTSTR lpszName);
```

### <a name="parameters"></a>Parametri

*lpszName*<br/>
in Nuovo nome del formato degli Appunti globale. Non può essere NULL.

### <a name="remarks"></a>Osservazioni

Questo metodo consente di eseguire le operazioni di trascinamento della selezione tra più applicazioni. Ogni applicazione deve fornire lo stesso nome di formato degli Appunti.

È necessario chiamare questo metodo prima che il Framework chiami [CMFCToolBarButton:: GetClipboardFormat](#getclipboardformat).

##  <a name="setimage"></a>CMFCToolBarButton:: seimagine

Imposta l'indice dell'immagine del pulsante.

```
virtual void SetImage(int iImage);
```

### <a name="parameters"></a>Parametri

*iImage*<br/>
in Indice dell'immagine nella raccolta di immagini della barra degli strumenti.

### <a name="remarks"></a>Osservazioni

Se il pulsante della barra degli strumenti è un separatore, *IImage* fa riferimento alla nuova larghezza del pulsante separatore.

Se *IImage* è minore di zero, questo metodo Disabilita il disegno dell'immagine e Abilita il disegno dell'etichetta di testo del pulsante.

##  <a name="setprotectedcommands"></a>CMFCToolBarButton:: SetProtectedCommands

Imposta l'elenco di comandi che l'utente non è in grado di personalizzare.

```
static void SetProtectedCommands(const CList<UINT,UINT>& lstCmds);
```

### <a name="parameters"></a>Parametri

*lstCmds*<br/>
in Elenco di comandi protetti.

### <a name="remarks"></a>Osservazioni

In modalità personalizzazione, il Framework Disabilita i comandi dei pulsanti della barra degli strumenti protetti. L'utente non può eseguire operazioni di trascinamento della selezione e di modifica sui pulsanti della barra degli strumenti disabilitati.

Usare il metodo [CMFCToolBarButton:: GetProtectedCommands](#getprotectedcommands) per recuperare l'elenco dei comandi protetti.

##  <a name="setradio"></a>CMFCToolBarButton:: seradio

Chiamata eseguita dal framework quando viene modificato lo stato di selezione di un pulsante.

```
virtual void SetRadio();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per eseguire un'azione personalizzata quando il pulsante modifica lo stato di selezione.

##  <a name="setrect"></a>CMFCToolBarButton:: serect

Imposta il rettangolo di delimitazione del pulsante.

```
void SetRect(const CRect rect);
```

### <a name="parameters"></a>Parametri

*rect*<br/>
in Nuovo rettangolo di delimitazione del pulsante.

### <a name="remarks"></a>Osservazioni

Questo metodo chiama il metodo [CMFCToolBarButton:: OnMove](#onmove) dopo l'impostazione del nuovo rettangolo di delimitazione.

##  <a name="setstyle"></a>CMFCToolBarButton:: Sestyle

Imposta lo stile del pulsante.

```
virtual void SetStyle(UINT nStyle);
```

### <a name="parameters"></a>Parametri

*nStyle*<br/>
in Nuovo stile del pulsante.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita imposta il membro dati [CMFCToolBarButton:: m_nStyle](#m_nstyle) su *nStyle*. Eseguire l'override di questo metodo se si desidera eseguire un'elaborazione aggiuntiva per gestire la modifica dello stile. Vedere [stili di controllo della barra degli strumenti](toolbar-control-styles.md) per un elenco di flag di stile validi.

##  <a name="setvisible"></a>CMFCToolBarButton:: sevisible

Specifica se il pulsante è visibile.

```
void SetVisible(BOOL bShow=TRUE);
```

### <a name="parameters"></a>Parametri

*bShow*<br/>
in Valore booleano che specifica se visualizzare o nascondere il pulsante. Se questo parametro è TRUE, viene visualizzato il pulsante. Se il parametro è FALSE, il pulsante è nascosto.

### <a name="remarks"></a>Osservazioni

Usare questa funzione per nascondere o mostrare un particolare pulsante della barra degli strumenti. Chiamare il metodo [CPane:: AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) dopo aver chiamato questo metodo.

##  <a name="show"></a>CMFCToolBarButton:: Show

Consente di visualizzare o nascondere il pulsante.

```
void Show(BOOL bShow);
```

### <a name="parameters"></a>Parametri

*bShow*<br/>
in Valore booleano che specifica se visualizzare o nascondere il pulsante. Se questo parametro è TRUE, viene visualizzato il pulsante. Se il parametro è FALSE, il pulsante è nascosto.

### <a name="remarks"></a>Osservazioni

Il Framework chiama questo metodo per aggiornare la visibilità dei pulsanti della barra degli strumenti quando la barra degli strumenti padre viene ridimensionata. Il Framework chiama questo metodo con *bShow* impostato su false quando il pulsante non rientra più nei limiti della barra degli strumenti. Il Framework chiama questo metodo con *bShow* impostato su true quando il ridimensionamento del pulsante si adatta nuovamente all'interno dei limiti della barra degli strumenti.

Usare il metodo [CMFCToolBarButton:: sevisible](#setvisible) per impostare la visibilità generale del pulsante.

Questo metodo chiama il metodo [CMFCToolBarButton:: OnShow](#onshow) dopo l'aggiornamento dello stato di visibilità del pulsante.

## <a name="see-also"></a>Vedere anche

[Grafico della gerarchia](../../mfc/hierarchy-chart.md)<br/>
[Classi](../../mfc/reference/mfc-classes.md)<br/>
[Classe CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)<br/>
[Classe CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md)
