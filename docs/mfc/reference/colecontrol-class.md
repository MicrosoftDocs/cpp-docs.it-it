---
title: COleControl (classe)
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 7d75ec6fa111c8c26b4390ac0ac62160d71c185b
ms.sourcegitcommit: 13f42c339fb7af935e3a93ac80e350d5e784c9f1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/31/2020
ms.locfileid: "87470919"
---
# <a name="colecontrol-class"></a>COleControl (classe)

Classe di base avanzata per lo sviluppo di controlli OLE.

## <a name="syntax"></a>Sintassi

```
class COleControl : public CWnd
```

## <a name="members"></a>Membri

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Descrizione|
|----------|-----------------|
|[COleControl:: COleControl](#colecontrol)|Crea un oggetto `COleControl`.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Descrizione|
|----------|-----------------|
|[COleControl:: AmbientAppearance](#ambientappearance)|Recupera l'aspetto corrente del controllo.|
|[COleControl:: AmbientBackColor](#ambientbackcolor)|Restituisce il valore della proprietà BackColor dell'ambiente.|
|[COleControl:: AmbientDisplayName](#ambientdisplayname)|Restituisce il nome del controllo come specificato dal contenitore.|
|[COleControl:: AmbientFont](#ambientfont)|Restituisce il valore della proprietà del tipo di carattere ambiente.|
|[COleControl:: AmbientForeColor](#ambientforecolor)|Restituisce il valore della proprietà ForeColor di ambiente.|
|[COleControl:: AmbientLocaleID](#ambientlocaleid)|Restituisce l'ID delle impostazioni locali del contenitore.|
|[COleControl:: AmbientScaleUnits](#ambientscaleunits)|Restituisce il tipo di unità utilizzate dal contenitore.|
|[COleControl:: AmbientShowGrabHandles](#ambientshowgrabhandles)|Determina se devono essere visualizzati i punti di manipolazione.|
|[COleControl:: AmbientShowHatching](#ambientshowhatching)|Determina se deve essere visualizzato il tratteggio.|
|[COleControl:: AmbientTextAlign](#ambienttextalign)|Restituisce il tipo di allineamento del testo specificato dal contenitore.|
|[COleControl:: AmbientUIDead](#ambientuidead)|Determina se il controllo deve rispondere alle azioni dell'interfaccia utente.|
|[COleControl:: AmbientUserMode](#ambientusermode)|Determina la modalità del contenitore.|
|[COleControl:: BoundPropertyChanged](#boundpropertychanged)|Notifica al contenitore che una proprietà associata è stata modificata.|
|[COleControl:: BoundPropertyRequestEdit](#boundpropertyrequestedit)|Richiede l'autorizzazione per modificare il valore della proprietà.|
|[COleControl:: ClientToParent](#clienttoparent)|Trasla un punto rispetto all'origine del controllo in un punto relativo all'origine del contenitore.|
|[COleControl:: ClipCaretRect](#clipcaretrect)|Regola un rettangolo del cursore se è sovrapposto da un controllo.|
|[COleControl:: ControlInfoChanged](#controlinfochanged)|Chiamare questa funzione dopo che il set di tasti di scelta rapida gestiti dal controllo è stato modificato.|
|[COleControl::D isplayError](#displayerror)|Visualizza gli eventi di errore di azione per l'utente del controllo.|
|[COleControl::D oClick](#doclick)|Implementazione del metodo azionario `DoClick` .|
|[COleControl::D oPropExchange](#dopropexchange)|Serializza le proprietà di un `COleControl` oggetto.|
|[COleControl::D oSuperclassPaint](#dosuperclasspaint)|Ridisegnato un controllo OLE che è stato sottoclassato da un controllo Windows.|
|[COleControl:: EnableSimpleFrame](#enablesimpleframe)|Abilita il supporto semplice per i frame per un controllo.|
|[COleControl:: ExchangeExtent](#exchangeextent)|Serializza la larghezza e l'altezza del controllo.|
|[COleControl:: ExchangeStockProps](#exchangestockprops)|Serializza le proprietà predefinite del controllo.|
|[COleControl:: ExchangeVersion](#exchangeversion)|Serializza il numero di versione del controllo.|
|[COleControl:: FireClick](#fireclick)|Genera l'evento azionario `Click` .|
|[COleControl:: FireDblClick](#firedblclick)|Genera l'evento azionario `DblClick` .|
|[COleControl:: FireError (](#fireerror)|Genera l'evento azionario `Error` .|
|[COleControl:: FireEvent](#fireevent)|Genera un evento personalizzato.|
|[COleControl:: FireKeyDown](#firekeydown)|Genera l'evento azionario `KeyDown` .|
|[COleControl:: FireKeyPress](#firekeypress)|Genera l'evento azionario `KeyPress` .|
|[COleControl:: FireKeyUp](#firekeyup)|Genera l'evento azionario `KeyUp` .|
|[COleControl:: FireMouseDown](#firemousedown)|Genera l'evento azionario `MouseDown` .|
|[COleControl:: FireMouseMove](#firemousemove)|Genera l'evento azionario `MouseMove` .|
|[COleControl:: FireMouseUp](#firemouseup)|Genera l'evento azionario `MouseUp` .|
|[COleControl:: FireReadyStateChange](#firereadystatechange)|Genera un evento quando viene modificato lo stato pronto del controllo.|
|[COleControl:: GetActivationPolicy](#getactivationpolicy)|Modifica il comportamento di attivazione predefinito di un controllo che supporta l' `IPointerInactive` interfaccia.|
|[COleControl:: GetAmbientProperty](#getambientproperty)|Restituisce il valore della proprietà di ambiente specificata.|
|[COleControl:: getapparence](#getappearance)|Restituisce il valore della proprietà relativa all'aspetto delle scorte.|
|[COleControl:: GetBackColor](#getbackcolor)|Restituisce il valore della proprietà BackColor Stock.|
|[COleControl:: getborderstyle](#getborderstyle)|Restituisce il valore della proprietà della proprietà BorderStyle azionaria.|
|[COleControl:: GetCapture](#getcapture)|Determina se un oggetto controllo attivato senza finestra dispone del mouse capture.|
|[COleControl:: GetClassID](#getclassid)|Recupera l'ID della classe OLE del controllo.|
|[COleControl:: GetClientOffset](#getclientoffset)|Recupera la differenza tra l'angolo superiore sinistro dell'area rettangolare del controllo e l'angolo superiore sinistro della relativa area client.|
|[COleControl:: GetClientRect](#getclientrect)|Recupera le dimensioni dell'area client del controllo.|
|[COleControl:: GetClientSite](#getclientsite)|Esegue una query su un oggetto per il puntatore al relativo sito client corrente all'interno del relativo contenitore.|
|[COleControl:: GetControlFlags](#getcontrolflags)|Recupera le impostazioni del flag di controllo.|
|[COleControl:: GetControlSize](#getcontrolsize)|Restituisce la posizione e le dimensioni del controllo OLE.|
|[COleControl:: GetDC](#getdc)|Fornisce un metodo per un controllo senza finestra per ottenere un contesto di dispositivo dal relativo contenitore.|
|[COleControl:: GetEnabled](#getenabled)|Restituisce il valore della proprietà abilitata per l'azione.|
|[COleControl:: GetExtendedControl](#getextendedcontrol)|Recupera un puntatore a un oggetto controllo esteso che appartiene al contenitore.|
|[COleControl:: GetFocus](#getfocus)|Determina se il controllo ha lo stato attivo.|
|[COleControl:: GetFont](#getfont)|Restituisce il valore della proprietà del tipo di carattere del titolo.|
|[COleControl:: GetFontTextMetrics](#getfonttextmetrics)|Restituisce le metriche di un `CFontHolder` oggetto.|
|[COleControl:: GetForeColor](#getforecolor)|Restituisce il valore della proprietà ForeColor predefinita.|
|[COleControl:: GetHwnd](#gethwnd)|Restituisce il valore della proprietà hWnd di inventario.|
|[COleControl:: GetMessageString](#getmessagestring)|Fornisce il testo della barra di stato per una voce di menu.|
|[COleControl:: GetNotSupported](#getnotsupported)|Impedisce l'accesso al valore della proprietà di un controllo da parte dell'utente.|
|[COleControl:: GetReadyState](#getreadystate)|Restituisce lo stato di conformità del controllo.|
|[COleControl:: GetRectInContainer](#getrectincontainer)|Restituisce il rettangolo del controllo relativo al relativo contenitore.|
|[COleControl:: GetStockTextMetrics](#getstocktextmetrics)|Restituisce le metriche della proprietà del tipo di carattere del titolo.|
|[COleControl:: GetText](#gettext)|Restituisce il valore della proprietà del testo o della didascalia del titolo.|
|[COleControl:: GetWindowlessDropTarget](#getwindowlessdroptarget)|Eseguire l'override di per consentire a un controllo senza finestra di essere la destinazione delle operazioni di trascinamento della selezione.|
|[COleControl:: InitializeIIDs](#initializeiids)|Informa la classe di base del IID che il controllo utilizzerà.|
|[COleControl:: InternalGetFont](#internalgetfont)|Restituisce un `CFontHolder` oggetto per la proprietà del tipo di carattere del titolo.|
|[COleControl:: InternalGetText](#internalgettext)|Recupera la didascalia azionaria o la proprietà Text.|
|[COleControl:: InternalSetReadyState](#internalsetreadystate)|Imposta lo stato di conformità del controllo e genera l'evento di modifica dello stato di pronto.|
|[COleControl:: InvalidateControl](#invalidatecontrol)|Invalida un'area del controllo visualizzato, facendo in modo che venga ridisegnato.|
|[COleControl:: InvalidateRgn](#invalidatergn)|Invalida l'area client della finestra del contenitore all'interno dell'area specificata. Può essere usato per ricreare i controlli privi di finestra nell'area.|
|[COleControl:: IsConvertingVBX](#isconvertingvbx)|Consente il caricamento specializzato di un controllo OLE.|
|[COleControl:: modified](#ismodified)|Determina se lo stato del controllo è stato modificato.|
|[COleControl:: IsOptimizedDraw](#isoptimizeddraw)|Indica se il contenitore supporta il disegno ottimizzato per l'operazione di disegno corrente.|
|[COleControl:: IsSubclassedControl](#issubclassedcontrol)|Chiamata eseguita per determinare se il controllo è sottoclasse di un controllo Windows.|
|[COleControl:: Load](#load)|Reimposta i dati asincroni precedenti e avvia un nuovo carico della proprietà asincrona del controllo.|
|[COleControl:: LockInPlaceActive](#lockinplaceactive)|Determina se il controllo può essere disattivato dal contenitore.|
|[COleControl:: OnAmbientPropertyChange](#onambientpropertychange)|Chiamato quando viene modificata una proprietà di ambiente.|
|[COleControl:: OnAppearanceChanged](#onappearancechanged)|Chiamato quando viene modificata la proprietà relativa all'aspetto delle scorte.|
|[COleControl:: OnBackColorChanged](#onbackcolorchanged)|Chiamato quando viene modificata la proprietà BackColor Stock.|
|[COleControl:: OnBorderStyleChanged](#onborderstylechanged)|Chiamato quando viene modificata la proprietà di BorderStyle di stock.|
|[COleControl:: OnClick](#onclick)|Chiamata eseguita per generare l'evento Click della borsa.|
|[COleControl:: OnClose](#onclose)|Notifica al controllo che `IOleControl::Close` è stato chiamato.|
|[COleControl:: OnDoVerb](#ondoverb)|Chiamato dopo l'esecuzione di un verbo di controllo.|
|[COleControl:: onpare](#ondraw)|Chiamato quando viene richiesto un controllo per ridisegnarlo.|
|[COleControl:: OnDrawMetafile](#ondrawmetafile)|Chiamata eseguita dal contenitore quando viene richiesto di ricreare un controllo utilizzando un contesto di dispositivo metafile.|
|[COleControl:: OnEdit](#onedit)|Chiamata eseguita dal contenitore all'interfaccia utente per attivare un controllo OLE.|
|[COleControl:: OnEnabledChanged](#onenabledchanged)|Chiamato quando viene modificata la proprietà Stock Enabled.|
|[COleControl:: OnEnumVerbs](#onenumverbs)|Chiamato dal contenitore per enumerare i verbi di un controllo.|
|[COleControl:: OnEventAdvise](#oneventadvise)|Chiamato quando i gestori eventi sono connessi o disconnessi da un controllo.|
|[COleControl:: OnFontChanged](#onfontchanged)|Chiamato quando viene modificata la proprietà del tipo di carattere del titolo.|
|[COleControl:: OnForeColorChanged](#onforecolorchanged)|Chiamato quando viene modificata la proprietà predefinita di ForeColor.|
|[COleControl:: OnFreezeEvents](#onfreezeevents)|Chiamato quando gli eventi di un controllo vengono bloccati o sbloccati.|
|[COleControl:: OnGetColorSet](#ongetcolorset)|Notifica al controllo che `IOleObject::GetColorSet` è stato chiamato.|
|[COleControl:: OnGetControlInfo](#ongetcontrolinfo)|Fornisce informazioni sui tasti di scelta per il contenitore.|
|[COleControl:: OnGetDisplayString](#ongetdisplaystring)|Chiamato per ottenere una stringa per rappresentare un valore della proprietà.|
|[COleControl:: OnGetInPlaceMenu](#ongetinplacemenu)|Richiede l'handle del menu del controllo che verrà unito al menu del contenitore.|
|[COleControl:: OnGetNaturalExtent](#ongetnaturalextent)|Eseguire l'override per recuperare le dimensioni di visualizzazione del controllo più vicine alle dimensioni proposte e alla modalità extent.|
|[COleControl:: OnGetPredefinedStrings](#ongetpredefinedstrings)|Restituisce stringhe che rappresentano i valori possibili per una proprietà.|
|[COleControl:: OnGetPredefinedValue](#ongetpredefinedvalue)|Restituisce il valore corrispondente a una stringa predefinita.|
|[COleControl:: OnGetViewExtent](#ongetviewextent)|Eseguire l'override per recuperare le dimensioni delle aree di visualizzazione del controllo (può essere usato per abilitare il disegno a due passaggi).|
|[COleControl:: OnGetViewRect](#ongetviewrect)|Eseguire l'override di per convertire le dimensioni del controllo in un rettangolo a partire da una posizione specifica.|
|[COleControl:: OnGetViewStatus](#ongetviewstatus)|Eseguire l'override per recuperare lo stato di visualizzazione del controllo.|
|[COleControl:: OnHideToolBars](#onhidetoolbars)|Chiamata eseguita dal contenitore quando il controllo è interfaccia utente disattivata.|
|[COleControl:: OnInactiveMouseMove](#oninactivemousemove)|Eseguire l'override di per fare in modo che il contenitore per il controllo inattivo sotto il puntatore del mouse invii WM_MOUSEMOVE messaggi al controllo.|
|[COleControl:: OnInactiveSetCursor](#oninactivesetcursor)|Eseguire l'override di per fare in modo che il contenitore per il controllo inattivo sotto il puntatore del mouse invii WM_SETCURSOR messaggi al controllo.|
|[COleControl:: OnKeyDownEvent](#onkeydownevent)|Chiamato dopo che è stato generato l'evento KeyDown di magazzino.|
|[COleControl:: OnKeyPressEvent](#onkeypressevent)|Chiamato dopo che è stato generato l'evento di pressione del tasto azionario.|
|[COleControl:: OnKeyUpEvent](#onkeyupevent)|Chiamato dopo che è stato generato l'evento di stock KeyUp.|
|[COleControl:: OnMapPropertyToPage](#onmappropertytopage)|Indica la pagina delle proprietà da utilizzare per la modifica di una proprietà.|
|[COleControl:: onmnemonico](#onmnemonic)|Chiamato quando viene premuto un tasto mnemonico del controllo.|
|[COleControl:: OnProperties](#onproperties)|Chiamato quando il verbo "Properties" del controllo è stato richiamato.|
|[COleControl:: OnQueryHitPoint](#onqueryhitpoint)|Eseguire l'override di per eseguire una query se la visualizzazione di un controllo si sovrappone a un punto specificato.|
|[COleControl:: OnQueryHitRect](#onqueryhitrect)|Eseguire l'override di per eseguire una query se la visualizzazione di un controllo si sovrappone a un punto qualsiasi di un rettangolo specificato.|
|[COleControl:: OnRenderData](#onrenderdata)|Chiamato dal Framework per recuperare i dati nel formato specificato.|
|[COleControl:: OnRenderFileData](#onrenderfiledata)|Chiamato dal Framework per recuperare i dati da un file nel formato specificato.|
|[COleControl:: OnRenderGlobalData](#onrenderglobaldata)|Chiamato dal Framework per recuperare i dati dalla memoria globale nel formato specificato.|
|[COleControl:: OnResetState](#onresetstate)|Reimposta le proprietà di un controllo sui valori predefiniti.|
|[COleControl:: OnSetClientSite](#onsetclientsite)|Notifica al controllo che `IOleControl::SetClientSite` è stato chiamato.|
|[COleControl:: OnSetData](#onsetdata)|Sostituisce i dati del controllo con un altro valore.|
|[COleControl:: OnSetExtent](#onsetextent)|Chiamato dopo la modifica dell'extent del controllo.|
|[COleControl:: OnSetObjectRects](#onsetobjectrects)|Chiamato dopo la modifica delle dimensioni del controllo.|
|[COleControl:: OnShowToolBars](#onshowtoolbars)|Chiamato quando il controllo è stato attivato dall'interfaccia utente.|
|[COleControl:: OnTextChanged](#ontextchanged)|Chiamato quando viene modificata la proprietà del testo o della didascalia del titolo.|
|[COleControl:: OnWindowlessMessage](#onwindowlessmessage)|Elabora i messaggi della finestra (oltre ai messaggi del mouse e della tastiera) per i controlli privi di finestra.|
|[COleControl::P arentToClient](#parenttoclient)|Trasla un punto rispetto all'origine del contenitore in un punto relativo all'origine del controllo.|
|[COleControl::P ostModalDialog](#postmodaldialog)|Notifica al contenitore che una finestra di dialogo modale è stata chiusa.|
|[COleControl::P reModalDialog](#premodaldialog)|Notifica al contenitore che sta per essere visualizzata una finestra di dialogo modale.|
|[COleControl:: RecreateControlWindow](#recreatecontrolwindow)|Elimina e ricrea la finestra del controllo.|
|[COleControl:: Refresh](#refresh)|Impone un ridisegno dell'aspetto di un controllo.|
|[COleControl:: ReleaseCapture](#releasecapture)|Rilascia il mouse capture.|
|[COleControl:: ReleaseDC](#releasedc)|Rilascia il contesto del dispositivo di visualizzazione di un contenitore di un controllo senza finestra.|
|[COleControl:: ReparentControlWindow](#reparentcontrolwindow)|Reimposta l'elemento padre della finestra del controllo.|
|[COleControl:: ResetStockProps](#resetstockprops)|Inizializza `COleControl` le proprietà predefinite sui rispettivi valori predefiniti.|
|[COleControl:: ResetVersion](#resetversion)|Inizializza il numero di versione di un valore specificato.|
|[COleControl:: ScrollWindow](#scrollwindow)|Consente a un controllo senza finestra di scorrere un'area all'interno dell'immagine attiva sul posto sullo schermo.|
|[COleControl:: SelectFontObject](#selectfontobject)|Seleziona una proprietà del tipo di carattere personalizzata in un contesto di dispositivo.|
|[COleControl:: SelectStockFont](#selectstockfont)|Seleziona la proprietà del tipo di carattere azionario in un contesto di dispositivo.|
|[COleControl:: SerializeExtente](#serializeextent)|Serializza o Inizializza lo spazio di visualizzazione per il controllo.|
|[COleControl:: SerializeStockProps](#serializestockprops)|Serializza o Inizializza le `COleControl` proprietà predefinite.|
|[COleControl:: SerializeVersion](#serializeversion)|Serializza o Inizializza le informazioni sulla versione del controllo.|
|[COleControl:: separity](#setappearance)|Imposta il valore della proprietà relativa all'aspetto delle scorte.|
|[COleControl:: SetBackColor](#setbackcolor)|Imposta il valore della proprietà BackColor Stock.|
|[COleControl:: seborderstyle](#setborderstyle)|Imposta il valore della proprietà della proprietà BorderStyle predefinita.|
|[COleControl:: secapture](#setcapture)|Fa in modo che la finestra del contenitore del controllo abbia il possesso dell'acquisizione del mouse per conto dell'utente.|
|[COleControl:: SetControlSize](#setcontrolsize)|Imposta la posizione e le dimensioni del controllo OLE.|
|[COleControl:: seenabled](#setenabled)|Imposta il valore della proprietà Stock Enabled.|
|[COleControl:: SetFocus](#setfocus)|Fa in modo che la finestra del contenitore del controllo prenda il possesso dello stato attivo per l'input per conto del controllo.|
|[COleControl:: sefont](#setfont)|Imposta il valore della proprietà del tipo di carattere del titolo.|
|[COleControl:: ForeColor](#setforecolor)|Imposta il valore della proprietà ForeColor di inventario.|
|[COleControl:: SetInitialSize](#setinitialsize)|Imposta la dimensione di un controllo OLE quando viene visualizzata per la prima volta in un contenitore.|
|[COleControl:: SetModifiedFlag](#setmodifiedflag)|Modifica lo stato modificato di un controllo.|
|[COleControl:: SetNotPermitted](#setnotpermitted)|Indica che una richiesta di modifica non è riuscita.|
|[COleControl:: SetNotSupported](#setnotsupported)|Impedisce la modifica del valore della proprietà di un controllo da parte dell'utente.|
|[COleControl:: SetRectInContainer](#setrectincontainer)|Imposta il rettangolo del controllo in relazione al relativo contenitore.|
|[COleControl:: SetText](#settext)|Imposta il valore della proprietà del testo o della didascalia del titolo.|
|[COleControl:: ThrowError](#throwerror)|Segnala che si è verificato un errore in un controllo OLE.|
|[COleControl:: TransformCoords](#transformcoords)|Trasforma i valori delle coordinate tra un contenitore e il controllo.|
|[COleControl:: TranslateColor](#translatecolor)|Converte un valore OLE_COLOR in un valore COLORREF.|
|[COleControl:: WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Determina se le proprietà di ambiente saranno disponibili la volta successiva che il controllo verrà caricato.|
|[COleControl:: WindowProc](#windowproc)|Fornisce una procedura di Windows per un `COleControl` oggetto.|

### <a name="protected-methods"></a>Metodi protetti

|Nome|Descrizione|
|----------|-----------------|
|[COleControl::D rawContent](#drawcontent)|Chiamata eseguita dal framework quando è necessario aggiornare l'aspetto del controllo.|
|[COleControl::D rawMetafile](#drawmetafile)|Chiamato dal framework quando viene utilizzato il contesto di dispositivo metafile.|
|[COleControl:: IsInvokeAllowed](#isinvokeallowed)|Abilita la chiamata al metodo di automazione.|
|[COleControl:: SetInitialDataFormats](#setinitialdataformats)|Chiamata eseguita dal Framework per inizializzare l'elenco dei formati di dati supportati dal controllo.|

## <a name="remarks"></a>Osservazioni

Derivata da `CWnd` , questa classe eredita tutte le funzionalità di un oggetto finestra di Windows, oltre a funzionalità aggiuntive specifiche di OLE, ad esempio la generazione di eventi e la possibilità di supportare metodi e proprietà.

I controlli OLE possono essere inseriti in applicazioni contenitore OLE e comunicano con il contenitore utilizzando un sistema bidirezionale di generazione di eventi e l'esposizione di metodi e proprietà al contenitore. Si noti che i contenitori OLE standard supportano solo le funzionalità di base di un controllo OLE. Non sono in grado di supportare le funzionalità estese di un controllo OLE. La generazione di eventi si verifica quando gli eventi vengono inviati al contenitore in seguito ad alcune azioni eseguite nel controllo. A sua volta, il contenitore comunica con il controllo usando un set esposto di metodi e proprietà analoghi alle funzioni membro e ai membri dati di una classe C++. Questo approccio consente allo sviluppatore di controllare l'aspetto del controllo e inviare una notifica al contenitore quando si verificano determinate azioni.

## <a name="windowless-controls"></a>Controlli senza finestra

I controlli OLE possono essere usati sul posto attivo senza una finestra. I controlli senza finestra presentano vantaggi significativi:

- I controlli privi di finestra possono essere trasparenti e non rettangolari

- I controlli privi di finestra riducono le dimensioni dell'istanza e la data di creazione dell'oggetto

I controlli non necessitano di una finestra. I servizi offerti da una finestra possono essere facilmente forniti tramite un'unica finestra condivisa (in genere il contenitore) e un po' di codice di invio. La presenza di una finestra è essenzialmente una complicazione non necessaria per l'oggetto.

Quando viene usata l'attivazione senza finestra, il contenitore, che ha una finestra, è responsabile di fornire servizi che verrebbero altrimenti forniti dalla finestra del controllo. Se, ad esempio, il controllo deve eseguire una query sullo stato attivo della tastiera, eseguire una query sull'acquisizione del mouse o ottenere un contesto di dispositivo, queste operazioni vengono gestite dal contenitore. Le `COleControl` funzioni membro di operazione senza finestra richiamano queste operazioni nel contenitore.

Quando è abilitata l'attivazione senza finestra, il contenitore delega i messaggi di input all'interfaccia del controllo `IOleInPlaceObjectWindowless` (un'estensione di [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) per il supporto senza finestra). `COleControl`l'implementazione di questa interfaccia invierà questi messaggi tramite la mappa messaggi del controllo, dopo aver modificato le coordinate del mouse in modo appropriato. È possibile elaborare questi messaggi come i normali messaggi della finestra, aggiungendo le voci corrispondenti alla mappa messaggi.

In un controllo senza finestra è consigliabile usare sempre le `COleControl` funzioni membro anziché le `CWnd` funzioni membro corrispondenti o le funzioni API Windows correlate.

Gli oggetti di controllo OLE possono anche creare una finestra solo quando diventano attivi, ma la quantità di lavoro necessaria per la transizione inattiva-attiva aumenta e la velocità della transizione diventa inattiva. In alcuni casi si tratta di un problema: ad esempio, si consideri una griglia di caselle di testo. Quando si esegue il cursore verso l'alto e verso il basso nella colonna, ogni controllo deve essere attivato sul posto e quindi disattivato. La velocità della transizione inattiva/attiva influirà direttamente sulla velocità di scorrimento.

Per ulteriori informazioni sullo sviluppo di un Framework di controllo OLE, vedere gli articoli [controlli ActiveX MFC](../../mfc/mfc-activex-controls.md) e [Panoramica: creazione di un programma di controllo ActiveX MFC](../../mfc/reference/mfc-activex-control-wizard.md). Per informazioni sull'ottimizzazione dei controlli OLE, inclusi i controlli privi di finestra e di sfarfallio, vedere [controlli ActiveX MFC: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Requisiti

**Intestazione:** afxctl. h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a>COleControl:: AmbientBackColor

Restituisce il valore della proprietà BackColor dell'ambiente.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Valore restituito

Valore corrente della proprietà di sfondo dell'ambiente del contenitore, se disponibile. Se la proprietà non è supportata, questa funzione restituisce il colore di sfondo Windows definito dal sistema.

### <a name="remarks"></a>Osservazioni

La proprietà BackColor di ambiente è disponibile per tutti i controlli ed è definita dal contenitore. Si noti che il contenitore non è necessario per supportare questa proprietà.

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a>COleControl:: AmbientDisplayName

Il nome che il contenitore ha assegnato al controllo può essere usato nei messaggi di errore visualizzati dall'utente.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Valore restituito

Nome del controllo OLE. Il valore predefinito è una stringa di lunghezza zero.

### <a name="remarks"></a>Osservazioni

Si noti che il contenitore non è necessario per supportare questa proprietà.

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a>COleControl:: AmbientFont

Restituisce il valore della proprietà del tipo di carattere ambiente.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Valore restituito

Puntatore all'interfaccia di invio del tipo di carattere dell'ambiente del contenitore. Il valore predefinito è NULL. Se il valore restituito non è uguale a NULL, si è responsabili del rilascio del tipo di carattere chiamando la relativa funzione membro [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) .

### <a name="remarks"></a>Osservazioni

La proprietà del tipo di carattere di ambiente è definita dal contenitore e disponibile per tutti i controlli. Si noti che il contenitore non è necessario per supportare questa proprietà.

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a>COleControl:: AmbientForeColor

Restituisce il valore della proprietà ForeColor di ambiente.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Valore restituito

Valore corrente della proprietà ForeColor dell'ambiente del contenitore, se disponibile. Se non è supportato, questa funzione restituisce il colore del testo di Windows definito dal sistema.

### <a name="remarks"></a>Osservazioni

La proprietà di ambiente ForeColor è disponibile per tutti i controlli ed è definita dal contenitore. Si noti che il contenitore non è necessario per supportare questa proprietà.

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a>COleControl:: AmbientLocaleID

Restituisce l'ID delle impostazioni locali del contenitore.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Valore restituito

Valore della proprietà LocaleID del contenitore, se disponibile. Se questa proprietà non è supportata, questa funzione restituisce 0.

### <a name="remarks"></a>Osservazioni

Il controllo può utilizzare il LocaleID per adattare l'interfaccia utente per impostazioni locali specifiche. Si noti che il contenitore non è necessario per supportare questa proprietà.

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a>COleControl:: AmbientAppearance

Recupera l'impostazione dell'aspetto corrente per l'oggetto controllo.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Valore restituito

Aspetto del controllo:

- **0** aspetto Flat

- **1** aspetto 3D

### <a name="remarks"></a>Osservazioni

Chiamare questa funzione per recuperare il valore corrente della proprietà DISPID_AMBIENT_APPEARANCE per il controllo.

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a>COleControl:: AmbientScaleUnits

Restituisce il tipo di unità utilizzate dal contenitore.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Valore restituito

Stringa che contiene la ScaleUnits di ambiente del contenitore. Se questa proprietà non è supportata, questa funzione restituisce una stringa di lunghezza zero.

### <a name="remarks"></a>Osservazioni

La proprietà ScaleUnits di ambiente del contenitore può essere usata per visualizzare posizioni o dimensioni, etichettate con l'unità scelta, ad esempio twip o centimetri. Si noti che il contenitore non è necessario per supportare questa proprietà.

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a>COleControl:: AmbientShowGrabHandles

Determina se il contenitore consente al controllo di visualizzare i quadratini di controllo per se stesso quando è attivo.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se gli handle di ridimensionamento devono essere visualizzati; in caso contrario, 0. Se questa proprietà non è supportata, questa funzione restituisce un valore diverso da zero.

### <a name="remarks"></a>Osservazioni

Si noti che il contenitore non è necessario per supportare questa proprietà.

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a>COleControl:: AmbientShowHatching

Determina se il contenitore consente al controllo di essere visualizzato con un motivo tratteggiato quando l'interfaccia utente è attiva.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pattern tratteggiato deve essere visualizzato; in caso contrario, 0. Se questa proprietà non è supportata, questa funzione restituisce un valore diverso da zero.

### <a name="remarks"></a>Osservazioni

Si noti che il contenitore non è necessario per supportare questa proprietà.

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a>COleControl:: AmbientTextAlign

Determina l'allineamento del testo di ambiente preferito dal contenitore di controlli.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Valore restituito

Stato della proprietà TextAlign dell'ambiente del contenitore. Se questa proprietà non è supportata, questa funzione restituisce 0.

Di seguito è riportato un elenco di valori restituiti validi:

|Valore restituito|Significato|
|------------------|-------------|
|0|Allineamento generale (numeri a destra, testo a sinistra).|
|1|Giustificazione a sinistra|
|2|Center|
|3|Giustifica diritto|

### <a name="remarks"></a>Osservazioni

Questa proprietà è disponibile per tutti i controlli incorporati ed è definita dal contenitore. Si noti che il contenitore non è necessario per supportare questa proprietà.

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a>COleControl:: AmbientUIDead

Determina se il contenitore vuole che il controllo risponda alle azioni dell'interfaccia utente.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il controllo deve rispondere alle azioni dell'interfaccia utente; in caso contrario, 0. Se questa proprietà non è supportata, questa funzione restituisce 0.

### <a name="remarks"></a>Osservazioni

Ad esempio, un contenitore può impostare questa impostazione su TRUE in modalità progettazione.

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a>COleControl:: AmbientUserMode

Determina se il contenitore è in modalità progettazione o utente.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il contenitore è in modalità utente; in caso contrario, 0 (in modalità di progettazione). Se questa proprietà non è supportata, questa funzione restituisce TRUE.

### <a name="remarks"></a>Osservazioni

Ad esempio, un contenitore può impostare questa impostazione su FALSE in modalità progettazione.

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a>COleControl:: BoundPropertyChanged

Segnala che il valore della proprietà associata è stato modificato.

```cpp
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
ID di invio di una proprietà associata del controllo.

### <a name="remarks"></a>Osservazioni

Questa operazione deve essere chiamata ogni volta che il valore della proprietà viene modificato, anche nei casi in cui la modifica non è stata apportata tramite il metodo del set di proprietà. Essere particolarmente consapevoli delle proprietà associate di cui è stato eseguito il mapping a variabili membro. Ogni volta che una variabile membro viene modificata, `BoundPropertyChanged` deve essere chiamato.

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a>COleControl:: BoundPropertyRequestEdit

Richiede l'autorizzazione dall' `IPropertyNotifySink` interfaccia per modificare un valore della proprietà associata fornito dal controllo.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
ID di invio di una proprietà associata del controllo.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la modifica è consentita; in caso contrario, 0. Il valore predefinito è diverso da zero.

### <a name="remarks"></a>Osservazioni

Se l'autorizzazione viene negata, il controllo non deve consentire la modifica del valore della proprietà. Questa operazione può essere eseguita ignorando o riuscendo l'azione che ha tentato di modificare il valore della proprietà.

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a>COleControl:: ClientToParent

Converte le coordinate di *pPoint* in coordinate padre.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Parametri

*lprcBounds*<br/>
Puntatore ai limiti del controllo OLE all'interno del contenitore. Non l'area client, ma l'area dell'intero controllo, inclusi i bordi e le barre di scorrimento.

*pPoint*<br/>
Puntatore al punto dell'area client OLE da convertire nelle coordinate del padre (contenitore).

### <a name="remarks"></a>Osservazioni

On input *pPoint* è relativo all'origine dell'area client del controllo OLE (angolo superiore sinistro dell'area client del controllo). Nell'output *pPoint* è relativo all'origine dell'elemento padre (angolo superiore sinistro del contenitore).

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a>COleControl:: ClipCaretRect

Regola un rettangolo del cursore se è interamente o parzialmente coperto da oggetti opachi sovrapposti.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Parametri

*lpRect*<br/>
In input, puntatore a una struttura [Rect](/windows/win32/api/windef/ns-windef-rect) che contiene l'area del cursore da regolare. Nell'output, l'area del cursore regolata o NULL se il rettangolo del cursore è completamente coperto.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Un accento circonflesso è una linea, un blocco o una bitmap lampeggiante che in genere indica la posizione in cui verranno inseriti il testo o la grafica.

Un oggetto senza finestra non può visualizzare in modo sicuro un accento circonflesso senza prima controllare se il punto di inserimento è parzialmente o completamente nascosto da oggetti sovrapposti. Per ottenere questo possibile, un oggetto può usare per impostare `ClipCaretRect` il punto di inserimento (ridotto) per assicurarsi che si adatta all'area di ridimensionamento.

Gli oggetti che creano un cursore devono inviare il rettangolo del cursore a `ClipCaretRect` e utilizzare il rettangolo modificato per il punto di inserimento. Se il punto di inserimento è completamente nascosto, questo metodo restituirà FALSE e il punto di inserimento non verrà visualizzato in questo caso.

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a>COleControl:: COleControl

Costruisce un oggetto `COleControl`.

```
COleControl();
```

### <a name="remarks"></a>Osservazioni

Questa funzione non viene in genere chiamata direttamente. Il controllo OLE, invece, viene in genere creato dal relativo class factory.

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a>COleControl:: ControlInfoChanged

Chiamare questa funzione quando il set di tasti di scelta rapida supportato dal controllo è stato modificato.

```cpp
void ControlInfoChanged();
```

### <a name="remarks"></a>Osservazioni

Alla ricezione di questa notifica, il contenitore del controllo ottiene il nuovo set di tasti di scelta effettuando una chiamata a [IOleControl:: GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Si noti che il contenitore non è necessario per rispondere a questa notifica.

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a>COleControl::D isplayError

Chiamata eseguita dal Framework dopo che l'evento di errore di stock è stato gestito, a meno che il gestore eventi non abbia eliminato la visualizzazione dell'errore.

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Parametri

*SCODE*<br/>
Valore del codice di stato da segnalare. Per un elenco completo dei codici possibili, vedere l'articolo [controlli ActiveX: argomenti avanzati](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Descrizione dell'errore segnalato.

*lpszSource*<br/>
Nome del modulo che genera l'errore, in genere il nome del modulo di controllo OLE.

*lpszHelpFile*<br/>
Nome del file della Guida contenente una descrizione dell'errore.

*nHelpID*<br/>
ID del contesto della Guida dell'errore segnalato.

### <a name="remarks"></a>Osservazioni

Il comportamento predefinito Visualizza una finestra di messaggio contenente la descrizione dell'errore, contenuto in *lpszDescription*.

Eseguire l'override di questa funzione per personalizzare la modalità di visualizzazione degli errori.

## <a name="colecontroldoclick"></a><a name="doclick"></a>COleControl::D oClick

Simula un'azione di clic del mouse sul controllo.

```cpp
void DoClick();
```

### <a name="remarks"></a>Osservazioni

`COleControl::OnClick`Verrà chiamata la funzione membro sottoponibile a override e verrà generato un evento Click di stock, se supportato dal controllo.

Questa funzione è supportata dalla `COleControl` classe base come metodo azionario, denominato DoClick. Per ulteriori informazioni, vedere l'articolo [controlli ActiveX: Methods](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a>COleControl::D oPropExchange

Chiamata eseguita dal Framework durante il caricamento o l'archiviazione di un controllo da una rappresentazione di archiviazione persistente, ad esempio un flusso o un set di proprietà.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametri

*pPX*<br/>
Puntatore a un oggetto `CPropExchange`. Il Framework fornisce questo oggetto per stabilire il contesto dello scambio di proprietà, inclusa la relativa direzione.

### <a name="remarks"></a>Osservazioni

Questa funzione esegue in genere chiamate alla famiglia di funzioni **PX_** per caricare o archiviare proprietà specifiche definite dall'utente di un controllo OLE.

Se è stata usata la procedura guidata per creare il progetto di controllo OLE, la versione sottoposta a override di questa funzione determinerà la serializzazione delle proprietà predefinite supportate da `COleControl` con una chiamata alla funzione della classe base, `COleControl::DoPropExchange` . Quando si aggiungono proprietà definite dall'utente al controllo OLE, sarà necessario modificare questa funzione per serializzare le nuove proprietà. Per ulteriori informazioni sulla serializzazione, vedere l'articolo [controlli ActiveX: serializzazione](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a>COleControl::D oSuperclassPaint

Ridisegnato un controllo OLE che è stato sottoclassato da un controllo Windows.

```cpp
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Puntatore al contesto di dispositivo del contenitore del controllo.

*rcBounds*<br/>
Area in cui deve essere disegnato il controllo.

### <a name="remarks"></a>Osservazioni

Chiamare questa funzione per gestire correttamente il disegno di un controllo OLE non attivo. Questa funzione deve essere utilizzata solo se il controllo OLE sottoclasse un controllo Windows e deve essere chiamato nella `OnDraw` funzione del controllo.

Per ulteriori informazioni su questa funzione e sulla sottoclasse di un controllo Windows, vedere l'articolo [controlli ActiveX: sottoclasse di un controllo Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a>COleControl::D rawContent

Chiamata eseguita dal framework quando è necessario aggiornare l'aspetto del controllo.

```cpp
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Puntatore al contesto di dispositivo.

*RC*<br/>
Area rettangolare da disegnare in.

### <a name="remarks"></a>Osservazioni

Questa funzione chiama direttamente la funzione sottoponibile a override `OnDraw` .

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a>COleControl::D rawMetafile

Chiamato dal framework quando viene utilizzato il contesto di dispositivo metafile.

```cpp
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Puntatore al contesto di dispositivo metafile.

*RC*<br/>
Area rettangolare da disegnare in.

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a>COleControl:: EnableSimpleFrame

Abilita la caratteristica semplice del frame per un controllo OLE.

```cpp
void EnableSimpleFrame();
```

### <a name="remarks"></a>Osservazioni

Questa caratteristica consente a un controllo di supportare il contenimento visivo di altri controlli, ma non il vero contenuto OLE. Un esempio è costituito da una casella di gruppo con diversi controlli all'interno di. Questi controlli non sono contenuti OLE, ma si trovano nella stessa casella di gruppo.

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a>COleControl:: ExchangeExtent

Serializza o Inizializza lo stato dell'extent del controllo (le dimensioni in unità HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametri

*pPX*<br/>
Puntatore a un oggetto [CPropExchange](../../mfc/reference/cpropexchange-class.md) . Il Framework fornisce questo oggetto per stabilire il contesto dello scambio di proprietà, inclusa la relativa direzione.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la funzione ha esito positivo; 0 in caso contrario.

### <a name="remarks"></a>Osservazioni

Questa funzione viene in genere chiamata dall'implementazione predefinita di `COleControl::DoPropExchange` .

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a>COleControl:: ExchangeStockProps

Serializza o Inizializza lo stato delle proprietà predefinite del controllo.

```cpp
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametri

*pPX*<br/>
Puntatore a un oggetto [CPropExchange](../../mfc/reference/cpropexchange-class.md) . Il Framework fornisce questo oggetto per stabilire il contesto dello scambio di proprietà, inclusa la relativa direzione.

### <a name="remarks"></a>Osservazioni

Questa funzione viene in genere chiamata dall'implementazione predefinita di `COleControl::DoPropExchange` .

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a>COleControl:: ExchangeVersion

Serializza o Inizializza lo stato delle informazioni sulla versione di un controllo.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametri

*pPX*<br/>
Puntatore a un oggetto `CPropExchange`. Il Framework fornisce questo oggetto per stabilire il contesto dello scambio di proprietà, inclusa la relativa direzione.

*dwVersionDefault*<br/>
Numero di versione corrente del controllo.

*bConvert*<br/>
Indica se i dati permanenti devono essere convertiti nel formato più recente quando vengono salvati o mantenuti nello stesso formato caricato.

### <a name="return-value"></a>Valore restituito

Valore diverso da zero della funzione completata. 0 in caso contrario.

### <a name="remarks"></a>Osservazioni

In genere, questa sarà la prima funzione chiamata dall'override di un controllo di `COleControl::DoPropExchange` . Durante il caricamento, questa funzione legge il numero di versione dei dati persistenti e imposta di conseguenza l'attributo Version dell'oggetto [CPropExchange](../../mfc/reference/cpropexchange-class.md) . Quando si salva, questa funzione scrive il numero di versione dei dati persistenti.

Per ulteriori informazioni sulla persistenza e sul controllo delle versioni, vedere l'articolo [controlli ActiveX: serializzazione](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontrolfireclick"></a><a name="fireclick"></a>COleControl:: FireClick

Chiamata eseguita dal framework quando si fa clic con il mouse su un controllo attivo.

```cpp
void FireClick();
```

### <a name="remarks"></a>Osservazioni

Se questo evento viene definito come un evento personalizzato, si determina quando viene generato l'evento.

Per la generazione automatica di un evento click in modo che si verifichi, per la mappa eventi del controllo deve essere definito un evento Click di stock.

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a>COleControl:: FireDblClick

Chiamata eseguita dal framework quando si fa doppio clic con il mouse su un controllo attivo.

```cpp
void FireDblClick();
```

### <a name="remarks"></a>Osservazioni

Se questo evento viene definito come un evento personalizzato, si determina quando viene generato l'evento.

Per la generazione automatica di un evento DblClick, è necessario che la mappa eventi del controllo disponga di un evento DblClick di azione definito.

## <a name="colecontrolfireerror"></a><a name="fireerror"></a>COleControl:: FireError (

Genera l'evento di errore di azione.

```cpp
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametri

*SCODE*<br/>
Valore del codice di stato da segnalare. Per un elenco completo dei codici possibili, vedere l'articolo [controlli ActiveX: argomenti avanzati](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Descrizione dell'errore segnalato.

*nHelpID*<br/>
ID della Guida dell'errore segnalato.

### <a name="remarks"></a>Osservazioni

Questo evento fornisce un modo per segnalare, in corrispondenza delle posizioni appropriate nel codice, che si è verificato un errore all'interno del controllo. A differenza di altri eventi azionari, ad esempio click o MouseMove, l'errore non viene mai generato dal Framework.

Per segnalare un errore che si verifica durante una funzione Get della proprietà, una funzione del set di proprietà o un metodo di automazione, chiamare [COleControl:: ThrowError](#throwerror).

L'implementazione di un evento di errore di azione di un controllo OLE usa un valore SCODE. Se il controllo utilizza questo evento e deve essere utilizzato nel Visual Basic 4,0, si riceveranno degli errori perché il valore SCODE non è supportato in Visual Basic.

Per risolvere questo problema, modificare manualmente il parametro SCODE nell'oggetto del controllo. File di FAD a **`long`** . Inoltre, qualsiasi evento personalizzato, metodo o proprietà che usa un parametro SCODE causa anche lo stesso problema.

## <a name="colecontrolfireevent"></a><a name="fireevent"></a>COleControl:: FireEvent

Genera un evento definito dall'utente dal controllo con un numero qualsiasi di argomenti facoltativi,.

```cpp
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
ID dispatch dell'evento da generare.

*pbParams*<br/>
Descrittore per i tipi di parametro dell'evento.

### <a name="remarks"></a>Osservazioni

In genere questa funzione non deve essere chiamata direttamente. Al contrario, le funzioni di generazione di eventi vengono chiamate nella sezione della mappa eventi della dichiarazione di classe del controllo.

L'argomento *pbParams* è un elenco di **VTS_** separato da spazi. Uno o più di questi valori, separati da spazi (non virgole), specificano l'elenco dei parametri della funzione. I possibili valori sono i seguenti:

|Simbolo|Tipo di parametro|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE *|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> Sono state definite altre costanti Variant per tutti i tipi Variant, ad eccezione di VTS_FONT e VTS_PICTURE, che forniscono un puntatore alla costante di dati Variant. Queste costanti vengono denominate usando la convenzione **VTS_P** `constantname` . Ad esempio, VTS_PCOLOR è un puntatore a una costante VTS_COLOR.

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a>COleControl:: FireKeyDown

Chiamata eseguita dal framework quando viene premuto un tasto mentre il controllo è un'interfaccia utente attiva.

```cpp
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametri

*pnChar*<br/>
Puntatore al valore del codice della chiave virtuale del tasto premuto. Per un elenco di codici chiave virtuali standard, vedere Winuser. h

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- SHIFT_MASK il tasto MAIUSC è stato premuto durante l'azione.

- CTRL_MASK il tasto CTRL è stato premuto durante l'azione.

- ALT_MASK il tasto ALT è stato premuto durante l'azione.

### <a name="remarks"></a>Osservazioni

Se questo evento viene definito come un evento personalizzato, si determina quando viene generato l'evento.

Per la generazione automatica di un evento KeyDown, è necessario che la mappa eventi del controllo disponga di un evento KeyDown di magazzino definito.

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a>COleControl:: FireKeyPress

Chiamata eseguita dal framework quando si preme e si rilascia un tasto mentre il controllo personalizzato è un'interfaccia utente attiva all'interno del contenitore.

```cpp
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Parametri

*pnChar*<br/>
Puntatore al valore del carattere del tasto premuto.

### <a name="remarks"></a>Osservazioni

Se questo evento viene definito come un evento personalizzato, si determina quando viene generato l'evento.

Il destinatario dell'evento può modificare *pnChar*, ad esempio, convertire tutti i caratteri minuscoli in maiuscolo. Se si desidera esaminare il carattere modificato, eseguire l'override di `OnKeyPressEvent` .

Per la generazione automatica di un evento KeyPress, è necessario che la mappa eventi del controllo disponga di un evento KeyPress azionario definito.

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a>COleControl:: FireKeyUp

Chiamata eseguita dal framework quando viene rilasciato un tasto mentre il controllo personalizzato è un'interfaccia utente attiva all'interno del contenitore.

```cpp
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametri

*pnChar*<br/>
Puntatore al valore del codice della chiave virtuale della chiave rilasciata. Per un elenco di codici chiave virtuali standard, vedere Winuser. h

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- SHIFT_MASK il tasto MAIUSC è stato premuto durante l'azione.

- CTRL_MASK il tasto CTRL è stato premuto durante l'azione.

- ALT_MASK il tasto ALT è stato premuto durante l'azione.

### <a name="remarks"></a>Osservazioni

Se questo evento viene definito come un evento personalizzato, si determina quando viene generato l'evento.

Per la generazione automatica di un evento KeyUp, è necessario che la mappa eventi del controllo disponga di un evento KeyUp di azione definito.

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a>COleControl:: FireMouseDown

Chiamata eseguita dal framework quando viene premuto un pulsante del mouse su un controllo personalizzato attivo.

```cpp
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametri

*Npulsante*<br/>
Valore numerico del pulsante del mouse premuto. Può contenere uno dei valori seguenti:

- LEFT_BUTTON è stato premuto il pulsante sinistro del mouse.

- MIDDLE_BUTTON premuto il pulsante centrale del mouse.

- RIGHT_BUTTON è stato premuto il pulsante destro del mouse.

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- SHIFT_MASK il tasto MAIUSC è stato premuto durante l'azione.

- CTRL_MASK il tasto CTRL è stato premuto durante l'azione.

- ALT_MASK il tasto ALT è stato premuto durante l'azione.

*x*<br/>
Coordinata x del cursore quando si preme un pulsante del mouse. La coordinata è relativa all'angolo superiore sinistro della finestra del controllo.

*y*<br/>
Coordinata y del cursore quando è stato premuto un pulsante del mouse. La coordinata è relativa all'angolo superiore sinistro della finestra del controllo.

### <a name="remarks"></a>Osservazioni

Se questo evento viene definito come un evento personalizzato, si determina quando viene generato l'evento.

Per la generazione automatica di un evento MouseDown, è necessario che la mappa eventi del controllo disponga di un evento MouseDown di azione definito.

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a>COleControl:: FireMouseMove

Chiamata eseguita dal framework quando il cursore viene spostato su un controllo personalizzato attivo.

```cpp
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametri

*Npulsante*<br/>
Valore numerico dei pulsanti del mouse premuti. Contiene una combinazione dei valori seguenti:

- LEFT_BUTTON il pulsante sinistro del mouse è stato premuto durante l'azione.

- MIDDLE_BUTTON il pulsante centrale del mouse è stato premuto durante l'azione.

- RIGHT_BUTTON il pulsante destro del mouse è stato premuto durante l'azione.

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- SHIFT_MASK il tasto MAIUSC è stato premuto durante l'azione.

- CTRL_MASK il tasto CTRL è stato premuto durante l'azione.

- ALT_MASK il tasto ALT è stato premuto durante l'azione.

*x*<br/>
Coordinata x del cursore. La coordinata è relativa all'angolo superiore sinistro della finestra del controllo.

*y*<br/>
Coordinata y del cursore. La coordinata è relativa all'angolo superiore sinistro della finestra del controllo.

### <a name="remarks"></a>Osservazioni

Se questo evento viene definito come un evento personalizzato, si determina quando viene generato l'evento.

Per la generazione automatica di un evento MouseMove, è necessario che la mappa eventi del controllo disponga di un evento MouseMove di magazzino definito.

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a>COleControl:: FireMouseUp

Chiamata eseguita dal framework quando viene rilasciato un pulsante del mouse su un controllo personalizzato attivo.

```cpp
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametri

*Npulsante*<br/>
Valore numerico del pulsante del mouse rilasciato. Può avere uno dei valori seguenti:

- LEFT_BUTTON è stato rilasciato il pulsante sinistro del mouse.

- MIDDLE_BUTTON è stato rilasciato il pulsante centrale del mouse.

- RIGHT_BUTTON è stato rilasciato il pulsante destro del mouse.

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- SHIFT_MASK il tasto MAIUSC è stato premuto durante l'azione.

- CTRL_MASK il tasto CTRL è stato premuto durante l'azione.

- ALT_MASK il tasto ALT è stato premuto durante l'azione.

*x*<br/>
Coordinata x del cursore quando è stato rilasciato un pulsante del mouse. La coordinata è relativa all'angolo superiore sinistro della finestra del controllo.

*y*<br/>
Coordinata y di un cursore quando è stato rilasciato un pulsante del mouse. La coordinata è relativa all'angolo superiore sinistro della finestra del controllo.

### <a name="remarks"></a>Osservazioni

Se questo evento viene definito come un evento personalizzato, si determina quando viene generato l'evento.

Per la generazione automatica di un evento MouseUp, è necessario che la mappa eventi del controllo disponga di un evento MouseUp di magazzino definito.

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a>COleControl:: FireReadyStateChange

Genera un evento con il valore corrente dello stato pronto del controllo.

```cpp
void FireReadyStateChange();
```

### <a name="remarks"></a>Osservazioni

Lo stato Ready può essere uno dei valori seguenti:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Stato di inizializzazione predefinito|
|READYSTATE_LOADING|Il controllo sta attualmente caricando le proprietà|
|READYSTATE_LOADED|Il controllo è stato inizializzato|
|READYSTATE_INTERACTIVE|Il controllo dispone di dati sufficienti per essere interattivi ma non tutti i dati asincroni sono ancora caricati|
|READYSTATE_COMPLETE|Il controllo ha tutti i dati|

Usare [GetReadyState](#getreadystate) per determinare la conformità corrente del controllo.

[InternalSetReadyState](#internalsetreadystate) imposta lo stato Ready sul valore fornito, quindi chiama `FireReadyStateChange` .

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a>COleControl:: GetActivationPolicy

Modifica il comportamento di attivazione predefinito di un controllo che supporta l' `IPointerInactive` interfaccia.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Valore restituito

Combinazione di flag dell'enumerazione POINTERINACTIVE. I flag possibili sono:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|L'oggetto deve essere attivato sul posto quando il mouse lo immette durante un'operazione di spostamento del mouse.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|L'oggetto deve essere disattivato quando il mouse esce dall'oggetto durante un'operazione di spostamento del mouse.|
|POINTERINACTIVE_ACTIVATEONDRAG|L'oggetto deve essere attivato sul posto quando il mouse viene trascinato durante un'operazione di trascinamento della selezione.|

### <a name="remarks"></a>Osservazioni

Quando l' `IPointerInactive` interfaccia è abilitata, il contenitore delega WM_SETCURSOR e WM_MOUSEMOVE messaggi. `COleControl`l'implementazione di questa interfaccia invierà questi messaggi tramite la mappa messaggi del controllo, dopo aver modificato le coordinate del mouse in modo appropriato.

Ogni volta che il contenitore riceve un WM_SETCURSOR o WM_MOUSEMOVE messaggio con il puntatore del mouse su un oggetto `IPointerInactive` non attivo che supporta, deve chiamare `GetActivationPolicy` sull'interfaccia e restituire i flag dall'enumerazione POINTERINACTIVE.

È possibile elaborare questi messaggi esattamente come i normali messaggi della finestra, aggiungendo le voci corrispondenti alla mappa messaggi. Nei gestori, evitare di usare la `m_hWnd` variabile membro (o qualsiasi funzione membro che lo USA) senza prima verificare che il relativo valore sia diverso da null.

Qualsiasi oggetto progettato per eseguire più di impostare il cursore del mouse e/o generare un evento di spostamento del mouse, ad esempio fornire un feedback visivo speciale, deve restituire il flag di POINTERINACTIVE_ACTIVATEONENTRY e tracciare il feedback solo quando è attivo. Se l'oggetto restituisce questo flag, il contenitore deve attivarlo immediatamente sul posto e quindi procedere con lo stesso messaggio che ha attivato la chiamata a `GetActivationPolicy` .

Se vengono restituiti entrambi i flag POINTERINACTIVE_ACTIVATEONENTRY e POINTERINACTIVE_DEACTIVATEONLEAVE, l'oggetto verrà attivato solo quando il mouse è posizionato sull'oggetto. Se viene restituito solo il flag di POINTERINACTIVE_ACTIVATEONENTRY, l'oggetto verrà attivato solo una volta quando il mouse entra per la prima volta nell'oggetto.

Potrebbe anche essere necessario che un controllo inattivo sia la destinazione di un'operazione di trascinamento e rilascio OLE. Questa operazione richiede l'attivazione del controllo nel momento in cui l'utente trascina un oggetto su di esso, in modo che la finestra del controllo possa essere registrata come destinazione di rilascio. Per far sì che si verifichi l'attivazione durante un trascinamento, restituire il flag di POINTERINACTIVE_ACTIVATEONDRAG:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Le informazioni comunicate da `GetActivationPolicy` non devono essere memorizzate nella cache da un contenitore. Al contrario, questo metodo deve essere chiamato ogni volta che il mouse entra in un oggetto inattivo.

Se un oggetto inattivo non richiede l'attivazione sul posto quando il mouse lo immette, il relativo contenitore deve inviare i messaggi di WM_SETCURSOR successivi a questo oggetto chiamando [OnInactiveSetCursor](#oninactivesetcursor) , purché il puntatore del mouse rimanga sull'oggetto.

L'abilitazione dell' `IPointerInactive` interfaccia in genere significa che si desidera che il controllo sia in grado di elaborare i messaggi del mouse in qualsiasi momento. Per ottenere questo comportamento in un contenitore che non supporta l' `IPointerInactive` interfaccia, è necessario che il controllo venga sempre attivato quando è visibile, il che significa che il controllo deve avere il flag di OLEMISC_ACTIVATEWHENVISIBLE tra i flag varie. Tuttavia, per impedire che questo flag venga applicato in un contenitore che supporta `IPointerInactive` , è anche possibile specificare il flag di OLEMISC_IGNOREACTIVATEWHENVISIBLE:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a>COleControl:: GetAmbientProperty

Ottiene il valore di una proprietà di ambiente del contenitore.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Parametri

*dwDispid*<br/>
ID dispatch della proprietà di ambiente desiderata.

*vtProp*<br/>
Tag di tipo Variant che specifica il tipo di valore da restituire in *pvProp*.

*pvProp*<br/>
Puntatore all'indirizzo della variabile che riceverà il valore della proprietà o il valore restituito. Il tipo effettivo del puntatore deve corrispondere al tipo specificato da *vtProp*.

|vtProp|Tipo di pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Valore restituito

Diverso da zero se la proprietà di ambiente è supportata. in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Se si usa `GetAmbientProperty` per recuperare le proprietà DisplayName e ScaleUnits di ambiente, impostare *vtProp* su VT_BSTR e *pvProp* su `CString*` . Se si sta recuperando la proprietà del tipo di carattere ambiente, impostare *vtProp* su VT_FONT e *pvProp* su LPFONTDISP *.

Si noti che le funzioni sono già state fornite per le proprietà di ambiente comuni, ad esempio [AmbientBackColor](#ambientbackcolor) e [AmbientFont](#ambientfont).

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a>COleControl:: getapparence

Implementa la funzione Get della proprietà dell'aspetto azionario del controllo.

```
short GetAppearance ();
```

### <a name="return-value"></a>Valore restituito

Il valore restituito specifica l'impostazione dell'aspetto corrente come **`short`** valore (VT_I2), se ha esito positivo. Questo valore è zero se l'aspetto del controllo è flat e 1 se l'aspetto del controllo è 3D.

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a>COleControl:: GetBackColor

Implementa la funzione Get della proprietà BackColor delle scorte del controllo.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Valore restituito

Il valore restituito specifica il colore di sfondo corrente come valore di OLE_COLOR, se ha esito positivo. Questo valore può essere convertito in un valore COLORREF con una chiamata a `TranslateColor` .

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a>COleControl:: getborderstyle

Implementa la funzione Get della proprietà BorderStyle della proprietà del controllo.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Valore restituito

1 se il controllo ha un bordo normale; 0 se il controllo non dispone di un bordo.

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a>COleControl:: GetCapture

Determina se l' `COleControl` oggetto ha lo stato mouse capture.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Valore restituito

Se il controllo è attivato e senza finestra, restituisce **`this`** se il controllo dispone attualmente dell'acquisizione del mouse (come determinato dal contenitore del controllo) o null se non dispone dell'acquisizione.

In caso contrario, restituisce l' `CWnd` oggetto con il mouse capture (uguale a `CWnd::GetCapture` ).

### <a name="remarks"></a>Osservazioni

Un controllo senza finestra attivato riceve l'acquisizione del mouse quando viene chiamato il metodo [secapture](#setcapture) .

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a>COleControl:: GetClassID

Chiamata eseguita dal Framework per recuperare l'ID della classe OLE del controllo.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Parametri

*pCLSID*<br/>
Puntatore alla posizione dell'ID di classe.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiamata non ha avuto esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Viene in genere implementato dal [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a>COleControl:: GetClientOffset

Recupera la differenza tra l'angolo superiore sinistro dell'area rettangolare del controllo e l'angolo superiore sinistro della relativa area client.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Parametri

*pdxOffset*<br/>
Puntatore all'offset orizzontale dell'area client del controllo OLE.

*pdyOffset*<br/>
Puntatore all'offset verticale dell'area client del controllo OLE.

### <a name="remarks"></a>Osservazioni

Il controllo OLE dispone di un'area rettangolare all'interno del relativo contenitore. L'area client del controllo è l'area di controllo, esclusi i bordi e le barre di scorrimento. L'offset recuperato da `GetClientOffset` è la differenza tra l'angolo superiore sinistro dell'area rettangolare del controllo e l'angolo superiore sinistro della relativa area client. Se il controllo contiene elementi non client diversi dai bordi e dalle barre di scorrimento standard, eseguire l'override di questa funzione membro per specificare l'offset.

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a>COleControl:: GetClientRect

Recupera le dimensioni dell'area client del controllo.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Parametri

*lpRect*<br/>
Puntatore a una `RECT` struttura contenente le dimensioni dell'area client del controllo senza finestra, ovvero le dimensioni del controllo meno i bordi della finestra, i frame, le barre di scorrimento e così via. Il parametro *lpRect* indica le dimensioni del rettangolo client del controllo, non la relativa posizione.

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a>COleControl:: GetClientSite

Esegue una query su un oggetto per il puntatore al relativo sito client corrente all'interno del relativo contenitore.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Valore restituito

Puntatore al sito client corrente del controllo nel relativo contenitore.

### <a name="remarks"></a>Osservazioni

Il puntatore restituito punta a un'istanza di `IOleClientSite` . L' `IOleClientSite` interfaccia, implementata dai contenitori, è la visualizzazione dell'oggetto del relativo contesto, ovvero la posizione in cui è ancorata nel documento, dove ottiene le risorse di archiviazione, l'interfaccia utente e altre risorse.

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a>COleControl:: GetControlFlags

Recupera le impostazioni del flag di controllo.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Valore restituito

Una combinazione ORed dei flag nell'enumerazione ControlFlags:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Osservazioni

Per impostazione predefinita, il metodo `GetControlFlags` restituisce `fastBeginPaint | clipPaintDC`.

|||
|-|-|
|`fastBeginPaint`|Se impostato, usa una funzione begin-Paint personalizzata per i controlli OLE anziché l'API [BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) (impostata per impostazione predefinita).|
|`clipPaintDC`|Se non è impostato, Disabilita la chiamata a `IntersectClipRect` eseguita da `COleControl` e ottiene un vantaggio di piccola velocità. Se si usa l'attivazione senza finestra, il flag non ha alcun effetto.|
|`pointerInactive`|Se impostato, fornisce l'interazione del mouse mentre il controllo è inattivo abilitando `COleControl` l'implementazione dell' `IPointerInactive` interfaccia, che è disabilitata per impostazione predefinita.|
|`noFlickerActivate`|Se impostato, Elimina ulteriori operazioni di disegno e lo sfarfallio visivo associato. Usare quando il controllo si disegna in modo identico negli stati inattivi e inattivi. Se si usa l'attivazione senza finestra, il flag non ha alcun effetto.|
|`windowlessActivate`|Se impostato, indica che il controllo utilizza l'attivazione senza finestra.|
|`canOptimizeDraw`|Se impostato, indica che il controllo eseguirà il disegno ottimizzato, se il contenitore lo supporta.|

Per ulteriori informazioni su `GetControlFlags` e altre ottimizzazioni dei controlli OLE, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a>COleControl:: GetControlSize

Recupera le dimensioni della finestra di controllo OLE.

```cpp
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Parametri

*PCX*<br/>
Specifica la larghezza del controllo in pixel.

*pcy*<br/>
Specifica l'altezza del controllo in pixel.

### <a name="remarks"></a>Osservazioni

Si noti che tutte le coordinate per le finestre di controllo sono relative all'angolo superiore sinistro del controllo.

## <a name="colecontrolgetdc"></a><a name="getdc"></a>COleControl:: GetDC

Fornisce un oggetto senza finestra per ottenere un contesto di dispositivo schermato (o compatibile) dal relativo contenitore.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Parametri

*lprcRect*<br/>
Puntatore al rettangolo che il controllo senza finestra desidera ricreare in coordinate client del controllo. NULL indica l'extent completo dell'oggetto.

*dwFlags*<br/>
Attributi di disegno del contesto di dispositivo. Sono disponibili le opzioni seguenti:

- OLEDC_NODRAW indica che l'oggetto non userà il contesto di dispositivo per eseguire qualsiasi disegno, ma solo per ottenere informazioni sul dispositivo di visualizzazione. Il contenitore deve semplicemente passare il controller di dominio della finestra senza ulteriori elaborazioni.

- OLEDC_PAINTBKGND richiede che il contenitore disegni lo sfondo prima di restituire il controller di dominio. Un oggetto deve usare questo flag se richiede un controller di dominio per ridisegnare un'area con sfondo trasparente.

- OLEDC_OFFSCREEN informa il contenitore che l'oggetto desidera eseguire il rendering in una bitmap fuori schermo che deve quindi essere copiata sullo schermo. Un oggetto deve usare questo flag quando l'operazione di disegno che sta per essere eseguita genera molto sfarfallio. Il contenitore è libero di rispettare la richiesta. Tuttavia, se questo flag non è impostato, il contenitore deve restituire un controller di dominio su schermo. Ciò consente agli oggetti di eseguire operazioni dirette sullo schermo, ad esempio la visualizzazione di una selezione (tramite un'operazione **Xor** ).

### <a name="return-value"></a>Valore restituito

Puntatore al contesto del dispositivo di visualizzazione per l' `CWnd` area client del contenitore in caso di esito positivo; in caso contrario, il valore restituito è null. Il contesto del dispositivo di visualizzazione può essere utilizzato nelle funzioni GDI successive per creare l'area client della finestra del contenitore.

### <a name="remarks"></a>Osservazioni

La funzione membro [ReleaseDC](#releasedc) deve essere chiamata per rilasciare il contesto dopo il disegno. Quando `GetDC` si chiama, gli oggetti passano il rettangolo in cui si desidera creare le proprie coordinate client. `GetDC`converte questi oggetto in coordinate dell'area client del contenitore. L'oggetto non deve richiedere un rettangolo di disegno desiderato più grande del rettangolo dell'area client, la cui dimensione può essere recuperata con [GetClientRect](#getclientrect). In questo modo si impedisce agli oggetti di disegnare inavvertitamente la posizione in cui non sono considerati.

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a>COleControl:: GetEnabled

Implementa la funzione Get della proprietà abilitata per l'azione del controllo.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il controllo è abilitato; in caso contrario, 0.

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a>COleControl:: GetExtendedControl

Ottiene un puntatore a un oggetto gestito dal contenitore che rappresenta il controllo con un set esteso di proprietà.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Valore restituito

Puntatore all'oggetto controllo esteso del contenitore. Se non è disponibile alcun oggetto, il valore è NULL.

Questo oggetto può essere modificato tramite la relativa `IDispatch` interfaccia. È inoltre possibile utilizzare `QueryInterface` per ottenere altre interfacce disponibili fornite dall'oggetto. Tuttavia, l'oggetto non è necessario per supportare un set specifico di interfacce. Si noti che basarsi sulle funzionalità specifiche dell'oggetto controllo esteso di un contenitore limita la portabilità del controllo ad altri contenitori arbitrari.

### <a name="remarks"></a>Osservazioni

La funzione che chiama questa funzione è responsabile del rilascio del puntatore al termine dell'oggetto. Si noti che il contenitore non è necessario per supportare questo oggetto.

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a>COleControl:: GetFocus

Determina se l' `COleControl` oggetto ha lo stato attivo.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Valore restituito

Se il controllo è attivato e senza finestra, restituisce **`this`** se il controllo dispone attualmente dello stato attivo della tastiera (come determinato dal contenitore del controllo) o null se non ha lo stato attivo.

In caso contrario, restituisce l' `CWnd` oggetto con lo stato attivo (uguale a `CWnd::GetFocus` ).

### <a name="remarks"></a>Osservazioni

Un controllo senza finestra attivato riceve lo stato attivo [quando viene chiamato SetFocus.](#setfocus)

## <a name="colecontrolgetfont"></a><a name="getfont"></a>COleControl:: GetFont

Implementa la funzione Get della proprietà del tipo di carattere del titolo.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Valore restituito

Puntatore all'interfaccia di invio del tipo di carattere della proprietà del tipo di carattere di azione del controllo.

### <a name="remarks"></a>Osservazioni

Si noti che il chiamante deve rilasciare l'oggetto al termine dell'operazione. All'interno dell'implementazione del controllo, utilizzare `InternalGetFont` per accedere all'oggetto del tipo di carattere di azione del controllo. Per ulteriori informazioni sull'utilizzo dei tipi di carattere nel controllo, vedere l'articolo [controlli ActiveX: utilizzo di tipi di carattere in un controllo ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a>COleControl:: GetFontTextMetrics

Misura la metrica di testo per qualsiasi `CFontHolder` oggetto di proprietà del controllo.

```cpp
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametri

*lptm*<br/>
Puntatore a una struttura [TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw) .

*fontHolder*<br/>
Riferimento a un oggetto [CFontHolder](../../mfc/reference/cfontholder-class.md) .

### <a name="remarks"></a>Osservazioni

Tale tipo di carattere può essere selezionato con la funzione [COleControl:: SelectFontObject](#selectfontobject) . `GetFontTextMetrics`Inizializza la `TEXTMETRIC` struttura a cui punta *lptm* con le informazioni di metrica valide relative al `fontHolder` tipo di carattere in caso di esito positivo o riempie la struttura con zeri in caso di esito negativo. Usare questa funzione invece di [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) quando si dipinge il controllo perché i controlli, come qualsiasi oggetto OLE incorporato, possono essere necessari per eseguire il rendering in un metafile.

La `TEXTMETRIC` struttura per il tipo di carattere predefinito viene aggiornata quando viene chiamata la funzione [SelectFontObject](#selectfontobject) . È consigliabile chiamare `GetFontTextMetrics` solo dopo aver selezionato la proprietà del tipo di carattere di azione per garantire che le informazioni fornite siano valide.

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a>COleControl:: GetForeColor

Implementa la funzione Get della proprietà ForeColor di inventario.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Valore restituito

Il valore restituito specifica il colore di primo piano corrente come valore di OLE_COLOR, se ha esito positivo. Questo valore può essere convertito in un valore [COLORREF](/windows/win32/gdi/colorref) con una chiamata a `TranslateColor` .

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a>COleControl:: GetHwnd

Implementa la funzione Get della proprietà hWnd delle scorte.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Valore restituito

Handle della finestra del controllo OLE, se disponibile. in caso contrario, NULL.

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a>COleControl:: GetMessageString

Chiamata eseguita dal Framework per ottenere una stringa breve che descrive lo scopo della voce di menu identificata da *NID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Parametri

*nID*<br/>
ID di una voce di menu.

*rMessage*<br/>
Riferimento a un oggetto [CString](../../atl-mfc-shared/reference/cstringt-class.md) tramite il quale verrà restituita una stringa.

### <a name="remarks"></a>Osservazioni

Questa operazione può essere utilizzata per ottenere un messaggio da visualizzare in una barra di stato mentre la voce di menu è evidenziata. L'implementazione predefinita tenta di caricare una risorsa di stringa identificata da *NID*.

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a>COleControl:: GetNotSupported

Impedisce l'accesso al valore della proprietà di un controllo da parte dell'utente.

```cpp
void GetNotSupported();
```

### <a name="remarks"></a>Osservazioni

Chiamare questa funzione al posto della funzione Get di qualsiasi proprietà in cui il recupero della proprietà da parte dell'utente del controllo non è supportato. Un esempio potrebbe essere una proprietà di sola scrittura.

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a>COleControl:: GetReadyState

Restituisce lo stato di conformità del controllo.

```
long GetReadyState();
```

### <a name="return-value"></a>Valore restituito

Stato di conformità del controllo, uno dei valori seguenti:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Stato di inizializzazione predefinito|
|READYSTATE_LOADING|Il controllo sta attualmente caricando le proprietà|
|READYSTATE_LOADED|Il controllo è stato inizializzato|
|READYSTATE_INTERACTIVE|Il controllo dispone di dati sufficienti per essere interattivi ma non tutti i dati asincroni sono ancora caricati|
|READYSTATE_COMPLETE|Il controllo ha tutti i dati|

### <a name="remarks"></a>Osservazioni

Per la maggior parte dei controlli semplici non è mai necessario distinguere tra LOADed e Interactive. Tuttavia, i controlli che supportano le proprietà del percorso dati potrebbero non essere pronti per essere interattivi fino a quando non vengono ricevuti in modo asincrono almeno alcuni dati. Un controllo deve tentare di diventare interattivo il prima possibile.

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a>COleControl:: GetRectInContainer

Ottiene le coordinate del rettangolo del controllo rispetto al contenitore espresso in unità di dispositivo.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Parametri

*lpRect*<br/>
Puntatore alla struttura del rettangolo in cui verranno copiate le coordinate del controllo.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il controllo è attivo sul posto. in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Il rettangolo è valido solo se il controllo è attivo sul posto.

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a>COleControl:: GetStockTextMetrics

Misura la metrica del testo per la proprietà del tipo di carattere di azione del controllo, che può essere selezionata con la funzione [SelectStockFont](#selectstockfont) .

```cpp
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Parametri

*lptm*<br/>
Puntatore a una struttura [TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw) .

### <a name="remarks"></a>Osservazioni

La `GetStockTextMetrics` funzione Inizializza la `TEXTMETRIC` struttura a cui punta *lptm* con le informazioni di metrica valide se ha esito positivo o riempie la struttura con zeri in caso di esito negativo. Usare questa funzione invece di [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) quando si dipinge il controllo perché i controlli, come qualsiasi oggetto OLE incorporato, possono essere necessari per eseguire il rendering in un metafile.

La `TEXTMETRIC` struttura per il tipo di carattere predefinito viene aggiornata quando `SelectStockFont` viene chiamata la funzione. Questa funzione deve essere chiamata solo dopo aver selezionato il tipo di carattere di magazzino per garantire che le informazioni fornite siano valide.

## <a name="colecontrolgettext"></a><a name="gettext"></a>COleControl:: GetText

Implementa la funzione Get della proprietà Text o Caption.

```
BSTR GetText();
```

### <a name="return-value"></a>Valore restituito

Valore corrente della stringa di testo del controllo o di una stringa di lunghezza zero se non è presente alcuna stringa.

> [!NOTE]
> Per ulteriori informazioni sul tipo di dati BSTR, vedere [tipi di dati](../../mfc/reference/data-types-mfc.md) nella sezione macro e globali.

### <a name="remarks"></a>Osservazioni

Si noti che il chiamante di questa funzione deve chiamare `SysFreeString` sulla stringa restituita per liberare la risorsa. All'interno dell'implementazione del controllo, usare `InternalGetText` per accedere al testo di titolo o alla proprietà didascalia del controllo.

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a>COleControl:: GetWindowlessDropTarget

Eseguire l'override di `GetWindowlessDropTarget` quando si desidera che un controllo senza finestra sia la destinazione di un'operazione di trascinamento della selezione OLE.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Valore restituito

Puntatore all'interfaccia dell'oggetto `IDropTarget` . Poiché non dispone di una finestra, un oggetto senza finestra non può registrare un' `IDropTarget` interfaccia. Tuttavia, per partecipare al trascinamento della selezione, un oggetto senza finestra può comunque implementare l'interfaccia e restituirla `GetWindowlessDropTarget` .

### <a name="remarks"></a>Osservazioni

In genere, ciò richiede che la finestra del controllo sia stata registrata come obiettivo di rilascio. Tuttavia, poiché il controllo non ha una finestra propria, il contenitore utilizzerà la propria finestra come destinazione di rilascio. Il controllo deve semplicemente fornire un'implementazione dell' `IDropTarget` interfaccia a cui il contenitore può delegare le chiamate al momento appropriato. Ad esempio:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a>COleControl:: InitializeIIDs

Informa la classe di base del IID che il controllo utilizzerà.

```cpp
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Parametri

*piidPrimary*<br/>
Puntatore all'ID di interfaccia dell'interfaccia di invio principale del controllo.

*piidEvents*<br/>
Puntatore all'ID di interfaccia dell'interfaccia eventi del controllo.

### <a name="remarks"></a>Osservazioni

Chiamare questa funzione nel costruttore del controllo per informare la classe di base degli ID di interfaccia che verranno utilizzati dal controllo.

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a>COleControl:: InternalGetFont

Accede alla proprietà del tipo di carattere del titolo del controllo

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Valore restituito

Riferimento a un oggetto [CFontHolder](../../mfc/reference/cfontholder-class.md) che contiene l'oggetto del tipo di carattere del titolo.

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a>COleControl:: InternalGetText

Accede alla proprietà Text o Caption del titolo del controllo.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Valore restituito

Riferimento alla stringa di testo del controllo.

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a>COleControl:: InternalSetReadyState

Imposta lo stato di conformità del controllo.

```cpp
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Parametri

*lNewReadyState*<br/>
Stato di conformità da impostare per il controllo, uno dei valori seguenti:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Stato di inizializzazione predefinito|
|READYSTATE_LOADING|Il controllo sta attualmente caricando le proprietà|
|READYSTATE_LOADED|Il controllo è stato inizializzato|
|READYSTATE_INTERACTIVE|Il controllo dispone di dati sufficienti per essere interattivi ma non tutti i dati asincroni sono ancora caricati|
|READYSTATE_COMPLETE|Il controllo ha tutti i dati|

### <a name="remarks"></a>Osservazioni

Per la maggior parte dei controlli semplici non è mai necessario distinguere tra LOADed e Interactive. Tuttavia, i controlli che supportano le proprietà del percorso dati potrebbero non essere pronti per essere interattivi fino a quando non vengono ricevuti in modo asincrono almeno alcuni dati. Un controllo deve tentare di diventare interattivo il prima possibile.

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a>COleControl:: InvalidateControl

Impone il ridisegnamento del controllo.

```cpp
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametri

*lpRect*<br/>
Puntatore all'area del controllo da invalidare.

*bErase*<br/>
Specifica se lo sfondo all'interno dell'area di aggiornamento deve essere cancellato quando l'area di aggiornamento viene elaborata.

### <a name="remarks"></a>Osservazioni

Se *lpRect* ha un valore null, verrà ridisegnato l'intero controllo. Se *lpRect* non è null, indica la parte del rettangolo del controllo da invalidare. Nei casi in cui il controllo non dispone di una finestra o non è attualmente attivo, il rettangolo viene ignorato e viene eseguita una chiamata alla funzione membro [IAdviseSink:: OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) del sito client. Usare questa funzione invece di `CWnd::InvalidateRect` o `InvalidateRect` .

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a>COleControl:: InvalidateRgn

Invalida l'area client della finestra del contenitore all'interno dell'area specificata.

```cpp
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametri

*pRgn*<br/>
Puntatore a un oggetto [CRgn](../../mfc/reference/crgn-class.md) che identifica l'area di visualizzazione dell'oggetto OLE da invalidare, nelle coordinate client della finestra che lo contiene. Se questo parametro è NULL, l'extent è l'intero oggetto.

*bErase*<br/>
Specifica se lo sfondo all'interno dell'area invalidata deve essere cancellato. Se TRUE, lo sfondo viene cancellato. Se FALSE, lo sfondo rimane invariato.

### <a name="remarks"></a>Osservazioni

Questa operazione può essere utilizzata per ricreare i controlli privi di finestra all'interno del contenitore. L'area invalidata, insieme a tutte le altre aree nell'area di aggiornamento, viene contrassegnata per il disegno quando viene inviato il messaggio di [WM_PAINT](/windows/win32/gdi/wm-paint) successivo.

Se *bErase* è true per qualsiasi parte dell'area di aggiornamento, lo sfondo nell'intera area, non solo nella parte specificata, viene cancellato.

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a>COleControl:: IsConvertingVBX

Consente il caricamento specializzato di un controllo OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il controllo viene convertito; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Quando si converte un modulo che usa i controlli VBX in uno che usa i controlli OLE, potrebbe essere necessario un codice di caricamento speciale per i controlli OLE. Ad esempio, se si sta caricando un'istanza del controllo OLE, potrebbe essere presente una chiamata a [PX_Font](persistence-of-ole-controls.md#px_font) in `DoPropExchange` :

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Tuttavia, i controlli VBX non hanno un oggetto Font; ogni proprietà font è stata salvata singolarmente. In questo caso, si utilizzerà `IsConvertingVBX` per distinguere tra i due casi seguenti:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Un altro caso sarebbe se il controllo VBX salvava i dati binari proprietari (nel gestore di messaggi VBM_SAVEPROPERTY) e il controllo OLE Salva i dati binari in un formato diverso. Se si vuole che il controllo OLE sia compatibile con le versioni precedenti del controllo VBX, è possibile leggere sia i vecchi che i nuovi formati usando la `IsConvertingVBX` funzione, distinguendo se il controllo VBX o il controllo OLE è stato caricato.

Nella funzione del controllo `DoPropExchange` è possibile verificare la presenza di questa condizione e, se true, eseguire il codice di caricamento specifico per questa conversione, ad esempio gli esempi precedenti. Se il controllo non viene convertito, è possibile eseguire il normale codice di caricamento. Questa possibilità è applicabile solo ai controlli convertiti da controparti VBX.

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a>COleControl:: IsInvokeAllowed

Abilita la chiamata al metodo di automazione.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il controllo è stato inizializzato. in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

L'implementazione del Framework di `IDispatch::Invoke` chiama `IsInvokeAllowed` per determinare se una determinata funzione (identificata da `dispid` ) può essere richiamata. Il comportamento predefinito di un controllo OLE consente di richiamare i metodi di automazione solo se il controllo è stato inizializzato. Tuttavia, `IsInvokeAllowed` è una funzione virtuale e può essere sottoposta a override, se necessario (ad esempio, quando il controllo viene usato come server di automazione).

## <a name="colecontrolismodified"></a><a name="ismodified"></a>COleControl:: modified

Determina se lo stato del controllo è stato modificato.

```
BOOL IsModified();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se lo stato del controllo è stato modificato dopo l'ultimo salvataggio. in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Lo stato di un controllo viene modificato quando una proprietà cambia valore.

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a>COleControl:: IsOptimizedDraw

Determina se il contenitore supporta il disegno ottimizzato per l'operazione di disegno corrente.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Valore restituito

TRUE se il contenitore supporta il disegno ottimizzato per l'operazione di disegno corrente. in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Se il disegno ottimizzato è supportato, il controllo non deve selezionare gli oggetti obsoleti (penne, pennelli, tipi di carattere e così via) nel contesto del dispositivo al termine del disegno.

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a>COleControl:: IsSubclassedControl

Chiamata eseguita dal Framework per determinare se il controllo sottoclasse un controllo Windows.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il controllo è sottoclassato; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

È necessario eseguire l'override di questa funzione e restituire TRUE se il controllo OLE esegue una sottoclasse di un controllo Windows.

## <a name="colecontrolload"></a><a name="load"></a>COleControl:: Load

Reimposta i dati precedenti caricati in modo asincrono e avvia un nuovo caricamento della proprietà asincrona del controllo.

```cpp
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Parametri

*strNewPath*<br/>
Puntatore a una stringa contenente il percorso che fa riferimento al percorso assoluto della proprietà del controllo asincrono.

*prop*<br/>
Oggetto [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) che implementa una proprietà del controllo asincrono.

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a>COleControl:: LockInPlaceActive

Impedisce al contenitore di disattivare il controllo.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Parametri

*Blocco*<br/>
TRUE se lo stato attivo sul posto del controllo deve essere bloccato. FALSE se deve essere sbloccato.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il blocco ha avuto esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Si noti che, al termine, ogni blocco del controllo deve essere associato a uno sblocco del controllo. È necessario bloccare il controllo solo per brevi periodi, ad esempio durante la generazione di un evento.

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a>COleControl:: OnAmbientPropertyChange

Chiamata eseguita dal framework quando viene modificato il valore di una proprietà di ambiente del contenitore.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Parametri

*dispID*<br/>
ID dispatch della proprietà di ambiente modificata o DISPID_UNKNOWN se sono state modificate più proprietà.

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a>COleControl:: OnAppearanceChanged

Chiamata eseguita dal framework quando viene modificato il valore della proprietà relativa all'aspetto delle scorte.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questa funzione se si desidera una notifica dopo la modifica di questa proprietà. L'implementazione predefinita chiama `InvalidateControl` .

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a>COleControl:: OnBackColorChanged

Chiamata eseguita dal framework quando viene modificato il valore della proprietà Stock BackColor.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questa funzione se si desidera una notifica dopo la modifica di questa proprietà. L'implementazione predefinita chiama `InvalidateControl` .

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a>COleControl:: OnBorderStyleChanged

Chiamata eseguita dal framework quando viene modificato il valore della proprietà della proprietà BorderStyle azionaria.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita chiama `InvalidateControl` .

Eseguire l'override di questa funzione se si desidera una notifica dopo la modifica di questa proprietà.

## <a name="colecontrolonclick"></a><a name="onclick"></a>COleControl:: OnClick

Chiamata eseguita dal framework quando è stato fatto clic su un pulsante del mouse oppure è stato richiamato il metodo di azione DoClick.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Parametri

*iButton*<br/>
Indice di un pulsante del mouse. I valori consentiti sono i seguenti:

- LEFT_BUTTON è stato fatto clic sul pulsante sinistro del mouse.

- MIDDLE_BUTTON è stato fatto clic sul pulsante centrale del mouse.

- RIGHT_BUTTON è stato fatto clic con il pulsante destro del mouse.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita chiama `COleControl::FireClick` .

Eseguire l'override di questa funzione membro per modificare o estendere la gestione predefinita.

## <a name="colecontrolonclose"></a><a name="onclose"></a>COleControl:: OnClose

Chiamata eseguita dal framework quando il contenitore ha chiamato la funzione del controllo `IOleControl::Close` .

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Parametri

*dwSaveOption*<br/>
Flag che indica se l'oggetto deve essere salvato prima del caricamento. I valori validi sono:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Osservazioni

Per impostazione predefinita, `OnClose` Salva l'oggetto controllo se è stato modificato e *dwSaveOption* è OLECLOSE_SAVEIFDIRTY o OLECLOSE_PROMPTSAVE.

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a>COleControl:: OnDoVerb

Chiamata eseguita dal framework quando il contenitore chiama la `IOleObject::DoVerb` funzione membro.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametri

*iVerb*<br/>
Indice del verbo di controllo da richiamare.

*lpMsg*<br/>
Puntatore al messaggio di Windows che ha causato la chiamata del verbo.

*hWndParent*<br/>
Handle per la finestra padre del controllo. Se l'esecuzione del verbo crea una finestra (o Windows), *hwndParent* deve essere usato come padre.

*lpRect*<br/>
Puntatore a una struttura RECT in cui verranno copiate le coordinate del controllo, relative al contenitore.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiamata ha avuto esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita usa le voci della mappa messaggi ON_OLEVERB e ON_STDOLEVERB per determinare la funzione corretta da richiamare.

Eseguire l'override di questa funzione per modificare la gestione predefinita del verbo.

## <a name="colecontrolondraw"></a><a name="ondraw"></a>COleControl:: onpare

Chiamato dal Framework per creare il controllo OLE nel rettangolo di delimitazione specificato utilizzando il contesto di dispositivo specificato.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Contesto di dispositivo in cui si verifica il disegno.

*rcBounds*<br/>
Area rettangolare del controllo, incluso il bordo.

*rcInvalid*<br/>
Area rettangolare del controllo che non è valida.

### <a name="remarks"></a>Osservazioni

`OnDraw`viene in genere chiamato per la visualizzazione dello schermo, passando un contesto di dispositivo della schermata come *PDC*. Il parametro *rcBounds* identifica il rettangolo nel contesto di dispositivo di destinazione (relativo alla modalità di mapping corrente). Il parametro *rcInvalid* è il rettangolo effettivo non valido. In alcuni casi si tratta di un'area più piccola rispetto a *rcBounds*.

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a>COleControl:: OnDrawMetafile

Chiamato dal Framework per creare il controllo OLE nel rettangolo di delimitazione specificato utilizzando il contesto di dispositivo metafile specificato.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Contesto di dispositivo in cui si verifica il disegno.

*rcBounds*<br/>
Area rettangolare del controllo, incluso il bordo.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita chiama la funzione [onpare](#ondraw) .

## <a name="colecontrolonedit"></a><a name="onedit"></a>COleControl:: OnEdit

Determina l'attivazione dell'interfaccia utente del controllo.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametri

*lpMsg*<br/>
Puntatore al messaggio di Windows che ha richiamato il verbo.

*hWndParent*<br/>
Handle per la finestra padre del controllo.

*lpRect*<br/>
Puntatore al rettangolo utilizzato dal controllo nel contenitore.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiamata ha esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Questo ha lo stesso effetto di richiamare il verbo di OLEIVERB_UIACTIVATE del controllo.

Questa funzione viene in genere utilizzata come funzione di gestione per una voce della mappa messaggi ON_OLEVERB. In questo modo viene reso disponibile un verbo "Edit" nel menu "Object" del controllo. Ad esempio:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a>COleControl:: OnEnabledChanged

Chiamata eseguita dal framework quando viene modificato il valore della proprietà Stock Enabled.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questa funzione se si desidera una notifica dopo la modifica di questa proprietà. L'implementazione predefinita chiama [InvalidateControl](#invalidatecontrol).

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a>COleControl:: OnEnumVerbs

Chiamata eseguita dal framework quando il contenitore chiama la `IOleObject::EnumVerbs` funzione membro.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Parametri

*ppenumOleVerb*<br/>
Puntatore all' `IEnumOLEVERB` oggetto che enumera i verbi del controllo.

### <a name="return-value"></a>Valore restituito

Non zero se i verbi sono disponibili. in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita enumera le voci ON_OLEVERB nella mappa messaggi.

Eseguire l'override di questa funzione per modificare la modalità predefinita di enumerazione dei verbi.

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a>COleControl:: OnEventAdvise

Chiamata eseguita dal framework quando un gestore eventi è connesso o disconnesso da un controllo OLE.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Parametri

*bAdvise*<br/>
TRUE indica che un gestore eventi è stato connesso al controllo. FALSE indica che un gestore eventi è stato disconnesso dal controllo.

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a>COleControl:: OnFontChanged

Chiamata eseguita dal framework quando viene modificato il valore della proprietà del tipo di carattere del titolo.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita chiama `COleControl::InvalidateControl` . Se il controllo è una sottoclasse di un controllo Windows, l'implementazione predefinita invia anche un messaggio di WM_SETFONT alla finestra del controllo.

Eseguire l'override di questa funzione se si desidera una notifica dopo la modifica di questa proprietà.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a>COleControl:: OnForeColorChanged

Chiamata eseguita dal framework quando viene modificato il valore della proprietà predefinita di ForeColor.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita chiama `InvalidateControl` .

Eseguire l'override di questa funzione se si desidera una notifica dopo la modifica di questa proprietà.

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a>COleControl:: OnFreezeEvents

Chiamata eseguita dal Framework dopo che il contenitore chiama `IOleControl::FreezeEvents` .

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Parametri

*bFreeze*<br/>
TRUE se la gestione degli eventi del controllo è bloccata; in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita non esegue alcuna operazione.

Eseguire l'override di questa funzione se si desidera un comportamento aggiuntivo quando la gestione degli eventi è bloccata o sbloccata.

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a>COleControl:: OnGetColorSet

Chiamata eseguita dal framework quando il contenitore chiama la `IViewObject::GetColorSet` funzione membro.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Parametri

*PTD*<br/>
Punta al dispositivo di destinazione per il quale deve essere eseguito il rendering dell'immagine. Se questo valore è NULL, è necessario eseguire il rendering dell'immagine per un dispositivo di destinazione predefinito, in genere un dispositivo di visualizzazione.

*hicTargetDev*<br/>
Specifica il contesto delle informazioni sul dispositivo di destinazione indicato da *PTD*. Questo parametro può essere un contesto di dispositivo, ma non ne è necessariamente uno. Se *PTD* è null, *hicTargetDev* deve anche essere null.

*ppColorSet*<br/>
Puntatore alla posizione in cui deve essere copiato il set di colori da usare. Se la funzione non restituisce il set di colori, viene restituito NULL.

### <a name="return-value"></a>Valore restituito

Diverso da zero se viene restituito un set di colori valido; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Il contenitore chiama questa funzione per ottenere tutti i colori necessari per creare il controllo OLE. Il contenitore può usare i set di colori ottenuti insieme ai colori necessari per impostare la tavolozza dei colori complessiva. L'implementazione predefinita restituisce FALSE.

Eseguire l'override di questa funzione per eseguire un'elaborazione speciale della richiesta.

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a>COleControl:: OnGetControlInfo

Chiamata eseguita dal framework quando il contenitore del controllo ha richiesto informazioni sul controllo.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Parametri

*pControlInfo*<br/>
Puntatore a una struttura [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) da compilare.

### <a name="remarks"></a>Osservazioni

Queste informazioni sono costituite principalmente da una descrizione dei tasti di scelta del controllo. L'implementazione predefinita Compila *pControlInfo* con le informazioni predefinite.

Eseguire l'override di questa funzione se il controllo deve elaborare chiavi mnemonico.

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a>COleControl:: OnGetDisplayString

Chiamato dal Framework per ottenere una stringa che rappresenta il valore corrente della proprietà identificata da *DISPID*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
L'ID di invio di una proprietà del controllo.

*strValue*<br/>
Riferimento a un oggetto [CString](../../atl-mfc-shared/reference/cstringt-class.md) tramite il quale verrà restituita una stringa.

### <a name="return-value"></a>Valore restituito

Diverso da zero se è stata restituita una stringa in *strValue;* in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questa funzione se il controllo ha una proprietà il cui valore non può essere convertito direttamente in una stringa e si desidera che il valore della proprietà venga visualizzato in un visualizzatore proprietà fornito dal contenitore.

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a>COleControl:: OnGetInPlaceMenu

Chiamata eseguita dal framework quando il controllo è attivato dall'interfaccia utente per ottenere il menu da unire nel menu esistente del contenitore.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Valore restituito

Handle del menu del controllo o NULL se il controllo non dispone di alcun oggetto. L'implementazione predefinita restituisce NULL.

### <a name="remarks"></a>Osservazioni

Per ulteriori informazioni sull'Unione di risorse OLE, vedere l'articolo [menu e risorse (OLE)](../../mfc/menus-and-resources-ole.md).

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a>COleControl:: OnGetNaturalExtent

Chiamata eseguita dal Framework in risposta alla richiesta di un contenitore `IViewObjectEx::GetNaturalExtent` .

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Parametri

*dwAspect*<br/>
Specifica la modalità con cui l'oggetto deve essere rappresentato. Le rappresentazioni includono contenuto, un'icona, un'anteprima o un documento stampato. I valori validi sono ricavati dall'enumerazione [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2.

*Lindex*<br/>
Parte dell'oggetto di interesse. Attualmente solo-1 è valido.

*PTD*<br/>
Punta alla struttura [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) che definisce il dispositivo di destinazione per il quale devono essere restituite le dimensioni dell'oggetto.

*hicTargetDev*<br/>
Specifica il contesto delle informazioni per il dispositivo di destinazione indicato dal parametro *PTD* da cui l'oggetto può estrarre le metriche del dispositivo e testare le funzionalità del dispositivo. Se *PTD* è null, l'oggetto deve ignorare il valore nel parametro *hicTargetDev* .

*pExtentInfo*<br/>
Punta alla `DVEXTENTINFO` struttura che specifica i dati di ridimensionamento. La `DVEXTENTINFO` struttura è:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Il membro della struttura `dwExtentMode` può assumere uno dei due valori seguenti:

- DVEXTENT_CONTENT sapere quanto è grande il controllo deve adattarsi esattamente al contenuto (snap-to-size)

- DVEXTENT_INTEGRAL durante il ridimensionamento, passare le dimensioni proposte al controllo

*psizel*<br/>
Punta ai dati di ridimensionamento restituiti dal controllo. I dati di ridimensionamento restituiti sono impostati su-1 per qualsiasi dimensione non modificata.

### <a name="return-value"></a>Valore restituito

Diverso da zero se restituisce o regola correttamente le dimensioni; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questa funzione per restituire le dimensioni di visualizzazione dell'oggetto più vicine alle dimensioni proposte e alla modalità extent nella `DVEXTENTINFO` struttura. L'implementazione predefinita restituisce FALSE e non apporta alcuna modifica alle dimensioni.

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a>COleControl:: OnGetPredefinedStrings

Chiamata eseguita dal Framework per ottenere un set di stringhe predefinite che rappresentano i valori possibili per una proprietà.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
L'ID di invio di una proprietà del controllo.

*pStringArray*<br/>
Matrice di stringhe da compilare con i valori restituiti.

*pCookieArray*<br/>
Matrice DWORD da compilare con i valori restituiti.

### <a name="return-value"></a>Valore restituito

Diverso da zero se gli elementi sono stati aggiunti a *pStringArray* e *pCookieArray*.

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questa funzione se il controllo ha una proprietà con un set di valori possibili che possono essere rappresentati da stringhe. Per ogni elemento aggiunto a *pStringArray*, è necessario aggiungere un elemento "cookie" corrispondente a *pCookieArray.* Questi valori "cookie" possono essere passati in un secondo momento dal Framework alla `COleControl::OnGetPredefinedValue` funzione.

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a>COleControl:: OnGetPredefinedValue

Chiamato dal Framework per ottenere il valore corrispondente a una delle stringhe predefinite restituite in precedenza da un override di `COleControl::OnGetPredefinedStrings` .

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
L'ID di invio di una proprietà del controllo.

*dwCookie*<br/>
Valore del cookie restituito in precedenza da un override di `COleControl::OnGetPredefinedStrings` .

*lpvarOut*<br/>
Puntatore a una `VARIANT` struttura tramite la quale verrà restituito un valore della proprietà.

### <a name="return-value"></a>Valore restituito

Diverso da zero se è stato restituito un valore in *lpvarOut*; in caso contrario, 0.

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a>COleControl:: OnGetViewExtent

Chiamata eseguita dal Framework in risposta alla richiesta [IViewObject2:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) di un contenitore.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Parametri

*dwDrawAspect*<br/>
DWORD che descrive il form, o aspetto, di un oggetto che deve essere visualizzato. I valori validi sono ricavati dall'enumerazione [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2.

*Lindex*<br/>
Parte dell'oggetto di interesse. Attualmente solo-1 è valido.

*PTD*<br/>
Punta alla struttura [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) che definisce il dispositivo di destinazione per il quale devono essere restituite le dimensioni dell'oggetto.

*lpsizel*<br/>
Punta alla posizione in cui vengono restituite le dimensioni dell'oggetto.

### <a name="return-value"></a>Valore restituito

Diverso da zero se le informazioni sull'extent vengono restituite correttamente; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questa funzione se il controllo utilizza il disegno a due passaggi e le relative parti opaco e trasparente hanno dimensioni diverse.

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a>COleControl:: OnGetViewRect

Chiamata eseguita dal Framework in risposta alla richiesta di un contenitore `IViewObjectEx::GetRect` .

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Parametri

*dwAspect*<br/>
DWORD che descrive il form, o aspetto, di un oggetto che deve essere visualizzato. I valori validi sono ricavati dall'enumerazione [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2:

- DVASPECT_CONTENT rettangolo di delimitazione dell'intero oggetto. Angolo superiore sinistro in corrispondenza dell'origine e della dimensione dell'oggetto pari all'extent restituito da `GetViewExtent` *.*

- DVASPECT_OPAQUE oggetti con un'area opaca rettangolare restituiscono il rettangolo. Altri errori.

- DVASPECT_TRANSPARENT rettangolo che copre tutte le parti trasparenti o irregolari.

*pRect*<br/>
Punta alla struttura [RECTL](/windows/win32/api/windef/ns-windef-rectl) che specifica il rettangolo in cui l'oggetto deve essere disegnato. Questo parametro controlla il posizionamento e l'allungamento dell'oggetto.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il rettangolo ridimensionato all'oggetto viene restituito correttamente. in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Le dimensioni dell'oggetto vengono convertite `OnGetViewRect` in un rettangolo a partire da una posizione specifica (il valore predefinito è l'angolo superiore sinistro dello schermo). Eseguire l'override di questa funzione se il controllo utilizza il disegno a due passaggi e le relative parti opaco e trasparente hanno dimensioni diverse.

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a>COleControl:: OnGetViewStatus

Chiamata eseguita dal Framework in risposta alla richiesta di un contenitore `IViewObjectEx::GetViewStatus` .

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Valore restituito

Uno dei valori dell'enumerazione VIEWSTATUS se ha esito positivo; in caso contrario, 0. I valori possibili sono qualsiasi combinazione dei seguenti elementi:

|||
|-|-|
|VIEWSTATUS_OPAQUE|L'oggetto è completamente opaco. Se questo bit non è impostato, l'oggetto contiene parti trasparenti. Questo bit si applica solo agli aspetti correlati al contenuto e non DVASPECT_ICON o DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|L'oggetto ha uno sfondo a tinta unita (costituito da un colore a tinta unita, non da un modello di pennello). Questo bit è significativo solo se VIEWSTATUS_OPAQUE è impostato e si applica solo agli aspetti correlati al contenuto e non DVASPECT_ICON o DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|L'oggetto supporta DVASPECT_OPAQUE. Tutti i metodi IViewObjectEx che accettano un aspetto del disegno come parametro possono essere chiamati con questo aspetto.|
|VIEWSTATUS_DVASPECTTRANSPARENT|L'oggetto supporta DVASPECT_TRANSPARENT. Tutti i `IViewObjectEx` metodi che accettano un aspetto del disegno come parametro possono essere chiamati con questo aspetto.|

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questa funzione se il controllo Usa il disegno a due passaggi. L'implementazione predefinita restituisce VIEWSTATUS_OPAQUE.

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a>COleControl:: OnHideToolBars

Chiamata eseguita dal framework quando il controllo è interfaccia utente disattivata.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Osservazioni

L'implementazione deve nascondere tutte le barre degli strumenti visualizzate da `OnShowToolbars` .

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a>COleControl:: OnInactiveMouseMove

Chiamata eseguita dal contenitore per l'oggetto inattivo sotto il puntatore del mouse alla ricezione di un messaggio di WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Parametri

*lprcBounds*<br/>
Rettangolo di delimitazione dell'oggetto, in coordinate client della finestra che lo contiene. Indica all'oggetto la posizione e le dimensioni esatte sullo schermo quando è stato ricevuto il messaggio di WM_MOUSEMOVE.

*x*<br/>
Coordinata x della posizione del mouse in coordinate client della finestra che lo contiene.

*y*<br/>
Coordinata y della posizione del mouse in coordinate client della finestra che lo contiene.

*dwKeyState*<br/>
Identifica lo stato corrente dei tasti di modifica della tastiera sulla tastiera. I valori validi possono essere costituiti da una combinazione di tutti i flag MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON e MK_RBUTTON.

### <a name="remarks"></a>Osservazioni

Si noti che le coordinate del client della finestra (pixel) vengono utilizzate per passare la posizione del cursore del mouse. Questa operazione è possibile passando anche il rettangolo delimitatore dell'oggetto nello stesso sistema di coordinate.

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a>COleControl:: OnInactiveSetCursor

Chiamata eseguita dal contenitore per l'oggetto inattivo sotto il puntatore del mouse alla ricezione di un messaggio di WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Parametri

*lprcBounds*<br/>
Rettangolo di delimitazione dell'oggetto, in coordinate client della finestra che lo contiene. Indica all'oggetto la posizione e le dimensioni esatte sullo schermo quando è stato ricevuto il messaggio di WM_SETCURSOR.

*x*<br/>
Coordinata x della posizione del mouse in coordinate client della finestra che lo contiene.

*y*<br/>
Coordinata y della posizione del mouse in coordinate client della finestra che lo contiene.

*dwMouseMsg*<br/>
Identificatore del messaggio del mouse per il quale si è verificata una WM_SETCURSOR.

*bSetAlways*<br/>
Specifica se l'oggetto deve impostare il cursore. Se TRUE, l'oggetto deve impostare il cursore; Se FALSE, il cursore non è obbligato a impostare il cursore e deve restituire S_FALSE in tale caso.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Si noti che le coordinate del client della finestra (pixel) vengono utilizzate per passare la posizione del cursore del mouse. Questa operazione è possibile passando anche il rettangolo delimitatore dell'oggetto nello stesso sistema di coordinate.

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a>COleControl:: OnKeyDownEvent

Chiamata eseguita dal Framework dopo l'elaborazione di un evento KeyDown di inventario.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametri

*nChar*<br/>
Valore del codice della chiave virtuale del tasto premuto. Per un elenco di codici chiave virtuali standard, vedere Winuser. h

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- SHIFT_MASK il tasto MAIUSC è stato premuto durante l'azione.

- CTRL_MASK il tasto CTRL è stato premuto durante l'azione.

- ALT_MASK il tasto ALT è stato premuto durante l'azione.

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questa funzione se il controllo deve accedere alle informazioni sulla chiave dopo che l'evento è stato generato.

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a>COleControl:: OnKeyPressEvent

Chiamata eseguita dal Framework dopo che è stato generato l'evento di pressione del titolo azionario.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Parametri

*nChar*<br/>
Contiene il valore del codice della chiave virtuale premuto. Per un elenco di codici chiave virtuali standard, vedere Winuser. h

### <a name="remarks"></a>Osservazioni

Si noti che il valore *nchar* potrebbe essere stato modificato dal contenitore.

Eseguire l'override di questa funzione se si desidera una notifica dopo che si è verificato questo evento.

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a>COleControl:: OnKeyUpEvent

Chiamata eseguita dal Framework dopo l'elaborazione di un evento KeyDown di inventario.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametri

*nChar*<br/>
Valore del codice della chiave virtuale del tasto premuto. Per un elenco di codici chiave virtuali standard, vedere Winuser. h

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- SHIFT_MASK il tasto MAIUSC è stato premuto durante l'azione.

- CTRL_MASK il tasto CTRL è stato premuto durante l'azione.

- ALT_MASK il tasto ALT è stato premuto durante l'azione.

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questa funzione se il controllo deve accedere alle informazioni sulla chiave dopo che l'evento è stato generato.

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a>COleControl:: OnMapPropertyToPage

Chiamata eseguita dal Framework per ottenere l'ID di classe di una pagina delle proprietà che implementa la modifica della proprietà specificata.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
L'ID di invio di una proprietà del controllo.

*lpclsid*<br/>
Puntatore a una `CLSID` struttura tramite la quale verrà restituito un ID di classe.

*pbPageOptional*<br/>
Restituisce un indicatore che indica se l'utilizzo della pagina delle proprietà specificata è facoltativo.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'ID di classe è stato restituito in *lpclsid*; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questa funzione per fornire un modo per richiamare le pagine delle proprietà del controllo dal Visualizzatore proprietà del contenitore.

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a>COleControl:: onmnemonico

Chiamata eseguita dal framework quando il contenitore ha rilevato che è stato premuto un tasto mnemonico del controllo OLE.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Parametri

*pMsg*<br/>
Puntatore al messaggio di Windows generato dalla pressione di un tasto mnemonico.

## <a name="colecontrolonproperties"></a><a name="onproperties"></a>COleControl:: OnProperties

Chiamata eseguita dal framework quando il verbo delle proprietà del controllo è stato richiamato dal contenitore.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametri

*lpMsg*<br/>
Puntatore al messaggio di Windows che ha richiamato il verbo.

*hWndParent*<br/>
Handle per la finestra padre del controllo.

*lpRect*<br/>
Puntatore al rettangolo utilizzato dal controllo nel contenitore.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiamata ha esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Nell'implementazione predefinita viene visualizzata una finestra di dialogo proprietà modale.

È anche possibile usare questa funzione per provocare la visualizzazione delle pagine delle proprietà del controllo. Effettuare una chiamata alla `OnProperties` funzione, passando l'handle dell'elemento padre del controllo nel parametro *hwndParent* . In questo caso, i valori dei parametri *lpMsg* e *lpRect* vengono ignorati.

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a>COleControl:: OnQueryHitPoint

Chiamata eseguita dal Framework in risposta alla richiesta di un contenitore `IViewObjectEx::QueryHitPoint` .

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametri

*dwAspect*<br/>
Specifica la modalità di rappresentazione dell'oggetto. I valori validi sono ricavati dall'enumerazione [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2.

*pRectBounds*<br/>
Puntatore a una `RECT` struttura che specifica il rettangolo di delimitazione dell'area client del controllo OLE.

*ptlLoc*<br/>
Puntatore alla `POINT` struttura che specifica il punto in cui verificare la presenza di un riscontro. Il punto viene specificato nelle coordinate dell'area client OLE.

*lCloseHint*<br/>
Distanza che definisce "close" fino al punto selezionato per un riscontro.

*pHitResult*<br/>
Puntatore al risultato della query di hit. Uno dei valori seguenti:

- HITRESULT_OUTSIDE *ptlLoc* non è compreso nell'oggetto OLE e non si chiude.

- HITRESULT_TRANSPARENT *ptlLoc* si trova all'interno dei limiti dell'oggetto OLE, ma non vicino all'immagine. Ad esempio, un punto nel mezzo di un cerchio trasparente potrebbe essere HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* si trova all'interno o all'esterno dell'oggetto OLE ma sufficientemente vicino all'oggetto da considerare all'interno. Questo valore può essere utilizzato da oggetti piccoli, sottili o dettagliati. Anche se un punto si trova all'esterno del rettangolo delimitatore di un oggetto, può essere ancora chiuso (necessario per la selezione di oggetti piccoli).

- HITRESULT_HIT *ptlLoc* si trova all'interno dell'immagine dell'oggetto.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il risultato di un hit viene restituito correttamente. in caso contrario, 0. Un hit è una sovrapposizione con l'area di visualizzazione del controllo OLE.

### <a name="remarks"></a>Osservazioni

Esegue una query se il rettangolo di visualizzazione di un oggetto si sovrappone al punto specificato (raggiunge il punto). `QueryHitPoint`può essere sottoposto a override per i test riscontri per oggetti non rettangolari.

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a>COleControl:: OnQueryHitRect

Chiamata eseguita dal Framework in risposta alla richiesta di un contenitore `IViewObjectEx::QueryHitRect` .

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametri

*dwAspect*<br/>
Specifica la modalità con cui l'oggetto deve essere rappresentato. I valori validi sono ricavati dall'enumerazione [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2.

*pRectBounds*<br/>
Puntatore a una `RECT` struttura che specifica il rettangolo di delimitazione dell'area client del controllo OLE.

*prcLoc*<br/>
Puntatore alla `RECT` struttura che specifica il rettangolo da controllare per un hit (si sovrappone al rettangolo dell'oggetto), relativo all'angolo superiore sinistro dell'oggetto.

*lCloseHint*<br/>
Non usato.

*pHitResult*<br/>
Puntatore al risultato della query di hit. Uno dei valori seguenti:

- HITRESULT_OUTSIDE nessun punto nel rettangolo viene raggiunto dall'oggetto OLE.

- HITRESULT_HIT almeno un punto nel rettangolo potrebbe essere un hit sull'oggetto.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il risultato di un hit viene restituito correttamente. in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Esegue una query se il rettangolo di visualizzazione di un oggetto si sovrappone a qualsiasi punto nel rettangolo specificato (raggiunge il rettangolo). `QueryHitRect`può essere sottoposto a override per i test riscontri per oggetti non rettangolari.

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a>COleControl:: OnRenderData

Chiamato dal Framework per recuperare i dati nel formato specificato.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Parametri

*lpFormatEtc*<br/>
Punta alla struttura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) che specifica il formato in cui vengono richieste le informazioni.

*lpStgMedium*<br/>
Punta a una struttura [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) in cui devono essere restituiti i dati.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Il formato specificato è quello precedentemente inserito nell'oggetto controllo utilizzando le funzioni membro [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) o [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) per il rendering ritardato. L'implementazione predefinita di questa funzione chiama `OnRenderFileData` o `OnRenderGlobalData` , rispettivamente, se il supporto di archiviazione fornito è un file o una memoria. Se il formato richiesto è CF_METAFILEPICT o il formato del set di proprietà persistente, l'implementazione predefinita esegue il rendering dei dati appropriati e restituisce un valore diverso da zero. In caso contrario, restituisce 0 e non esegue alcuna operazione.

Se *lpStgMedium->TYMED* è TYMED_NULL, STGMEDIUM deve essere allocato e compilato come specificato da *lpFormatEtc->TYMED*. Se non TYMED_NULL, il STGMEDIUM deve essere compilato con i dati.

Eseguire l'override di questa funzione per fornire i dati nel formato e nel supporto richiesti. A seconda dei dati, potrebbe essere necessario eseguire l'override di una delle altre versioni di questa funzione. Se i dati sono di dimensioni ridotte e di dimensioni fisse, eseguire l'override di `OnRenderGlobalData` . Se i dati sono in un file o sono di dimensioni variabili, eseguire l'override di `OnRenderFileData` .

Per ulteriori informazioni, vedere le `FORMATETC` `STGMEDIUM` strutture e nel Windows SDK.

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a>COleControl:: OnRenderFileData

Chiamata eseguita dal Framework per recuperare i dati nel formato specificato quando il supporto di archiviazione è un file.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Parametri

*lpFormatEtc*<br/>
Punta alla struttura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) che specifica il formato in cui vengono richieste le informazioni.

*pFile*<br/>
Punta a un oggetto [CFile](../../mfc/reference/cfile-class.md) in cui è necessario eseguire il rendering dei dati.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Il formato specificato è quello precedentemente inserito nell'oggetto controllo utilizzando la funzione membro [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) per il rendering ritardato. L'implementazione predefinita di questa funzione restituisce semplicemente FALSE.

Eseguire l'override di questa funzione per fornire i dati nel formato e nel supporto richiesti. A seconda dei dati, potrebbe essere necessario eseguire l'override di una delle altre versioni di questa funzione. Se si desidera gestire più supporti di archiviazione, eseguire l'override di `OnRenderData` . Se i dati sono in un file o sono di dimensioni variabili, eseguire l'override di `OnRenderFileData` .

Per ulteriori informazioni, vedere la `FORMATETC` struttura nella Windows SDK.

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a>COleControl:: OnRenderGlobalData

Chiamata eseguita dal Framework per recuperare i dati nel formato specificato quando il supporto di archiviazione specificato è memoria globale.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Parametri

*lpFormatEtc*<br/>
Punta alla struttura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) che specifica il formato in cui vengono richieste le informazioni.

*phGlobal*<br/>
Punta a un handle per la memoria globale in cui devono essere restituiti i dati. Se non è stata allocata alcuna memoria, questo parametro può essere NULL.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Il formato specificato è quello precedentemente inserito nell'oggetto controllo utilizzando la funzione membro [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) per il rendering ritardato. L'implementazione predefinita di questa funzione restituisce semplicemente FALSE.

Se *phGlobal* è null, è necessario allocare e restituire un nuovo HGLOBAL in *phGlobal*. In caso contrario, il HGLOBAL specificato da *phGlobal* deve essere riempito con i dati. La quantità di dati inseriti in HGLOBAL non deve superare la dimensione corrente del blocco di memoria. Inoltre, il blocco non può essere riallocato a dimensioni maggiori.

Eseguire l'override di questa funzione per fornire i dati nel formato e nel supporto richiesti. A seconda dei dati, potrebbe essere necessario eseguire l'override di una delle altre versioni di questa funzione. Se si desidera gestire più supporti di archiviazione, eseguire l'override di `OnRenderData` . Se i dati sono in un file o sono di dimensioni variabili, eseguire l'override di `OnRenderFileData` .

Per ulteriori informazioni, vedere la `FORMATETC` struttura nella Windows SDK.

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a>COleControl:: OnResetState

Chiamata eseguita dal framework quando le proprietà del controllo devono essere impostate sui valori predefiniti.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita chiama [DoPropExchange](#dopropexchange), passando un `CPropExchange` oggetto che determina l'impostazione delle proprietà sui valori predefiniti.

Il writer del controllo può inserire il codice di inizializzazione per il controllo OLE in questo oggetto sottoponibile a override. Questa funzione viene chiamata quando [IPersistStream:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) o [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) ha esito negativo o [IPersistStreamInit:: InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) o [IPersistStorage:: InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) viene chiamato senza prima chiamare `IPersistStream::Load` o `IPersistStorage::Load` .

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a>COleControl:: OnSetClientSite

Chiamata eseguita dal framework quando il contenitore ha chiamato la funzione del controllo `IOleControl::SetClientSite` .

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Osservazioni

Per impostazione predefinita, `OnSetClientSite` Controlla se le proprietà del percorso dati vengono caricate e, in caso affermativo, chiama `DoDataPathPropExchange` .

Eseguire l'override di questa funzione per eseguire un'elaborazione speciale della notifica. In particolare, le sostituzioni di questa funzione devono chiamare la classe di base.

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a>COleControl:: OnSetData

Chiamato dal Framework per sostituire i dati del controllo con i dati specificati.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Parametri

*lpFormatEtc*<br/>
Puntatore a una struttura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) che specifica il formato dei dati.

*lpStgMedium*<br/>
Puntatore a una struttura [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) in cui risiedono i dati.

*bRelease*<br/>
TRUE se il controllo deve liberare il supporto di archiviazione; FALSE se il controllo non deve liberare il supporto di archiviazione.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Se i dati sono nel formato del set di proprietà persistente, l'implementazione predefinita modifica lo stato del controllo di conseguenza. In caso contrario, l'implementazione predefinita non esegue alcuna operazione. Se *bRelease* è true, viene eseguita una chiamata a `ReleaseStgMedium` ; in caso contrario,.

Eseguire l'override di questa funzione per sostituire i dati del controllo con i dati specificati.

Per ulteriori informazioni, vedere le `FORMATETC` `STGMEDIUM` strutture e nel Windows SDK.

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a>COleControl:: OnSetExtent

Chiamata eseguita dal framework quando è necessario modificare l'extent del controllo, in seguito a una chiamata a [IOleObject:: seextent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Parametri

*lpSizeL*<br/>
Puntatore alla `SIZEL` struttura che utilizza valori long integer per rappresentare la larghezza e l'altezza del controllo, espressa in unità HIMETRIC.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la modifica delle dimensioni è stata accettata; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita gestisce il ridimensionamento dell'extent del controllo. Se il controllo è attivo sul posto, viene eseguita una chiamata al contenitore `OnPosRectChanged` .

Eseguire l'override di questa funzione per modificare il ridimensionamento predefinito del controllo.

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a>COleControl:: OnSetObjectRects

Chiamata eseguita dal Framework per implementare una chiamata a [IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Parametri

*lpRectPos*<br/>
Puntatore a una `RECT` struttura che indica la nuova posizione e le dimensioni del controllo rispetto al contenitore.

*lpRectClip*<br/>
Puntatore a una `RECT` struttura che indica un'area rettangolare in cui il controllo deve essere ritagliato.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il riposizionamento è stato accettato. in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita gestisce automaticamente il riposizionamento e il ridimensionamento della finestra del controllo e restituisce TRUE.

Eseguire l'override di questa funzione per modificare il comportamento predefinito di questa funzione.

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a>COleControl:: OnShowToolBars

Chiamata eseguita dal framework quando il controllo è stato attivato dall'interfaccia utente.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita non esegue alcuna operazione.

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a>COleControl:: OnTextChanged

Chiamata eseguita dal framework quando viene modificato il valore della proprietà Text o didascalia azionaria.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita chiama `InvalidateControl` .

Eseguire l'override di questa funzione se si desidera una notifica dopo la modifica di questa proprietà.

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a>COleControl:: OnWindowlessMessage

Chiamata eseguita dal Framework in risposta alla richiesta di un contenitore `IOleInPlaceObjectWindowless::OnWindowMessage` .

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Parametri

*msg*<br/>
Identificatore del messaggio passato da Windows.

*wParam*<br/>
Come passato da Windows. Specifica informazioni aggiuntive specifiche del messaggio. Il contenuto di questo parametro dipende dal valore del parametro *msg* .

*lParam*<br/>
Come passato da Windows. Specifica informazioni aggiuntive specifiche del messaggio. Il contenuto di questo parametro dipende dal valore del parametro *msg* .

*plResult*<br/>
Codice risultato di Windows. Specifica il risultato dell'elaborazione del messaggio e dipende dal messaggio inviato.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Elabora i messaggi della finestra per i controlli privi di finestra. `COleControl`è `OnWindowlessMessage` consigliabile utilizzare per i messaggi di finestra diversi dai messaggi del mouse e dai messaggi della tastiera. `COleControl`fornisce l' [acquisizione](#setcapture) e lo [stato attivo in modo specifico per](#setfocus) ottenere l'acquisizione del mouse e lo stato attivo della tastiera per oggetti OLE senza finestra.

Poiché gli oggetti senza finestra non dispongono di una finestra, devono disporre di un meccanismo per consentire al contenitore di inviare messaggi a tali oggetti. Un oggetto OLE senza finestra ottiene i messaggi dal relativo contenitore, tramite il `OnWindowMessage` metodo sull' `IOleInPlaceObjectWindowless` interfaccia (un'estensione di [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) per il supporto senza finestra). `OnWindowMessage`non accetta un `HWND` parametro.

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a>COleControl::P arentToClient

Converte le coordinate di *pPoint* in coordinate client.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Parametri

*lprcBounds*<br/>
Puntatore ai limiti del controllo OLE all'interno del contenitore. Non l'area client, ma l'area dell'intero controllo, inclusi i bordi e le barre di scorrimento.

*pPoint*<br/>
Puntatore al punto padre (contenitore) da convertire nelle coordinate dell'area client del controllo.

*bHitTest*<br/>
Specifica se eseguire o meno l'hit testing nel punto.

### <a name="return-value"></a>Valore restituito

Se *bHitTest* è false, restituisce HTNOWHERE. Se *bHitTest* è true, restituisce il percorso in cui il punto padre (contenitore) è stato sbarcato nell'area client del controllo OLE e è uno dei seguenti valori di hit test del mouse:

- HTBORDER al bordo di una finestra che non dispone di un bordo di ridimensionamento.

- HTBOTTOM nel bordo orizzontale inferiore della finestra.

- HTBOTTOMLEFT nell'angolo inferiore sinistro del bordo della finestra.

- HTBOTTOMRIGHT nell'angolo inferiore destro del bordo della finestra.

- HTCAPTION in un'area della barra del titolo.

- HTCLIENT in un'area client.

- HTERROR sullo sfondo dello schermo o su una linea di divisione tra le finestre (uguale a HTNOWHERE, ad eccezione del fatto che la `DefWndProc` funzione Windows genera un segnale acustico di sistema per indicare un errore).

- HTGROWBOX in una casella delle dimensioni.

- HTHSCROLL sulla barra di scorrimento orizzontale.

- HTLEFT nel bordo sinistro della finestra.

- HTMAXBUTTON in un pulsante Ingrandisci.

- HTMENU in un'area di menu.

- HTMINBUTTON in un pulsante Riduci a icona.

- HTNOWHERE sullo sfondo dello schermo o su una linea di divisione tra le finestre.

- HTREDUCE in un pulsante Riduci a icona.

- HTRIGHT nel bordo destro della finestra.

- HTSIZE in una casella delle dimensioni (uguale a HTGROWBOX).

- HTSYSMENU in un menu di controllo o in un pulsante Chiudi in una finestra figlio.

- HTTOP nel bordo superiore orizzontale della finestra.

- HTTOPLEFT nell'angolo superiore sinistro del bordo della finestra.

- HTTOPRIGHT nell'angolo superiore destro del bordo della finestra.

- HTTRANSPARENT in una finestra attualmente coperta da un'altra finestra.

- HTVSCROLL sulla barra di scorrimento verticale.

- HTZOOM in un pulsante Ingrandisci.

### <a name="remarks"></a>Osservazioni

L'input *pPoint* è relativo all'origine dell'elemento padre (angolo superiore sinistro del contenitore). Nell'output *pPoint* è relativo all'origine dell'area client del controllo OLE (angolo superiore sinistro dell'area client del controllo).

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a>COleControl::P ostModalDialog

Notifica al contenitore che una finestra di dialogo modale è stata chiusa.

```cpp
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametri

*hWndParent*<br/>
Handle per la finestra padre della finestra di dialogo modale.

### <a name="remarks"></a>Osservazioni

Chiamare questa funzione dopo aver visualizzato una finestra di dialogo modale. È necessario chiamare questa funzione in modo che il contenitore possa abilitare tutte le finestre di primo livello disabilitate da `PreModalDialog` . Questa funzione deve essere abbinata a una chiamata a `PreModalDialog` .

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a>COleControl::P reModalDialog

Notifica al contenitore che sta per essere visualizzata una finestra di dialogo modale.

```cpp
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametri

*hWndParent*<br/>
Handle per la finestra padre della finestra di dialogo modale.

### <a name="remarks"></a>Osservazioni

Chiamare questa funzione prima di visualizzare qualsiasi finestra di dialogo modale. È necessario chiamare questa funzione in modo che il contenitore possa disabilitare tutte le finestre di primo livello. Una volta visualizzata la finestra di dialogo modale, è necessario chiamare `PostModalDialog` .

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a>COleControl:: RecreateControlWindow

Elimina e ricrea la finestra del controllo.

```cpp
void RecreateControlWindow();
```

### <a name="remarks"></a>Osservazioni

Questa operazione può essere necessaria se è necessario modificare i bit di stile della finestra.

## <a name="colecontrolrefresh"></a><a name="refresh"></a>COleControl:: Refresh

Impone un ridisegno del controllo OLE.

```cpp
void Refresh();
```

### <a name="remarks"></a>Osservazioni

Questa funzione è supportata dalla `COleControl` classe base come metodo azionario, denominato Refresh. Ciò consente agli utenti del controllo OLE di ridisegnare il controllo in un momento specifico. Per ulteriori informazioni su questo metodo, vedere l'articolo [controlli ActiveX: Methods](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a>COleControl:: ReleaseCapture

Rilascia il mouse capture.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Se il controllo ha attualmente lo stato mouse capture, l'acquisizione viene rilasciata. In caso contrario, questa funzione non ha alcun effetto.

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a>COleControl:: ReleaseDC

Rilascia il contesto del dispositivo di visualizzazione di un contenitore di un controllo privo di finestra, liberando il contesto di dispositivo per l'uso da parte di altre applicazioni.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Identifica il contesto di dispositivo del contenitore da rilasciare.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

L'applicazione deve chiamare `ReleaseDC` per ogni chiamata a [GetDC](#getdc).

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a>COleControl:: ReparentControlWindow

Imposta l'elemento padre del controllo.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Parametri

*hWndOuter*<br/>
Handle della finestra del controllo.

*hWndParent*<br/>
Handle della nuova finestra padre.

### <a name="remarks"></a>Osservazioni

Chiamare questa funzione per reimpostare l'elemento padre della finestra del controllo.

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a>COleControl:: ResetStockProps

Inizializza lo stato delle `COleControl` proprietà predefinite sui rispettivi valori predefiniti.

```cpp
void ResetStockProps();
```

### <a name="remarks"></a>Osservazioni

Le proprietà sono: Appearance, BackColor, BorderStyle, Caption, Enabled, font, ForeColor, hWnd e Text. Per una descrizione delle proprietà predefinite, vedere [controlli ActiveX: aggiunta di proprietà predefinite](../../mfc/mfc-activex-controls-adding-stock-properties.md).

È possibile migliorare le prestazioni di inizializzazione binaria di un controllo utilizzando `ResetStockProps` e `ResetVersion` per eseguire l'override di `COleControl::OnResetState` . Vedere l'esempio seguente. Per ulteriori informazioni sull'ottimizzazione dell'inizializzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a>COleControl:: ResetVersion

Inizializza il numero di versione sul valore specificato.

```cpp
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Parametri

*dwVersionDefault*<br/>
Numero di versione da assegnare al controllo.

### <a name="remarks"></a>Osservazioni

È possibile migliorare le prestazioni di inizializzazione binaria di un controllo utilizzando `ResetVersion` e `ResetStockProps` per eseguire l'override di `COleControl::OnResetState` . Vedere l'esempio in [ResetStockProps](#resetstockprops). Per ulteriori informazioni sull'ottimizzazione dell'inizializzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a>COleControl:: ScrollWindow

Consente a un oggetto OLE senza finestra di scorrere un'area all'interno dell'immagine attiva sul posto sullo schermo.

```cpp
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametri

*xAmount*<br/>
Specifica la quantità, in unità di dispositivo, dello scorrimento orizzontale. Questo parametro deve essere un valore negativo per scorrere verso sinistra.

*yAmount*<br/>
Specifica la quantità, in unità di dispositivo, dello scorrimento verticale. Questo parametro deve essere un valore negativo per scorrere verso l'alto.

*lpRect*<br/>
Punta a un oggetto [CRect](../../atl-mfc-shared/reference/crect-class.md) o a una struttura Rect che specifica la parte dell'area client dell'oggetto OLE da scorrere, nelle coordinate client della finestra che lo contiene. Se *lpRect* è null, viene eseguito lo scorrimento dell'intera area client dell'oggetto OLE.

*lpClipRect*<br/>
Punta a un `CRect` oggetto o a una `RECT` struttura che specifica il rettangolo in cui ritagliare. Viene eseguito lo scorrimento solo dei pixel all'interno del rettangolo. I bit esterni al rettangolo non sono interessati anche se sono nel rettangolo *lpRect* . Se *lpClipRect* è null, non viene eseguito alcun ritaglio sul rettangolo di scorrimento.

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a>COleControl:: SelectFontObject

Seleziona un tipo di carattere in un contesto di dispositivo.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Puntatore a un oggetto di contesto di dispositivo.

*fontHolder*<br/>
Riferimento all'oggetto [CFontHolder](../../mfc/reference/cfontholder-class.md) che rappresenta il tipo di carattere da selezionare.

### <a name="return-value"></a>Valore restituito

Puntatore al tipo di carattere selezionato in precedenza. Al termine di tutte le operazioni di disegno che usano *fontHolder,* il chiamante deve selezionare nuovamente il tipo di carattere selezionato in precedenza passandolo come parametro a [CDC:: SelezionaOggetto](../../mfc/reference/cdc-class.md#selectobject).

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a>COleControl:: SelectStockFont

Seleziona la proprietà del tipo di carattere azionario in un contesto di dispositivo.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Il contesto di dispositivo in cui verrà selezionato il tipo di carattere.

### <a name="return-value"></a>Valore restituito

Puntatore all'oggetto selezionato in precedenza `CFont` . Al termine, è necessario usare [CDC:: SelezionaOggetto](../../mfc/reference/cdc-class.md#selectobject) per selezionare nuovamente questo tipo di carattere nel contesto del dispositivo.

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a>COleControl:: SerializeExtente

Serializza o Inizializza lo stato dello spazio di visualizzazione assegnato al controllo.

```cpp
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Parametri

*AR*<br/>
`CArchive`Oggetto da serializzare in o da.

### <a name="remarks"></a>Osservazioni

Per migliorare le prestazioni di persistenza binaria di un controllo, è possibile utilizzare `SerializeExtent` , `SerializeStockProps` e `SerializeVersion` per eseguire l'override di `COleControl::Serialize` . Vedere l'esempio seguente. Per ulteriori informazioni sull'ottimizzazione dell'inizializzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a>COleControl:: SerializeStockProps

Serializza o Inizializza lo stato delle `COleControl` proprietà predefinite: aspetto, BackColor, BorderStyle, Caption, Enabled, font, ForeColor e Text.

```cpp
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Parametri

*AR*<br/>
`CArchive`Oggetto da serializzare in o da.

### <a name="remarks"></a>Osservazioni

Per una descrizione delle proprietà predefinite, vedere [controlli ActiveX: aggiunta di proprietà predefinite](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Per migliorare le prestazioni di persistenza binaria di un controllo, è possibile utilizzare `SerializeStockProps` , `SerializeExtent` e `SerializeVersion` per eseguire l'override di `COleControl::Serialize` . Per un esempio, vedere il codice in [SerializeExtente](#serializeextent). Per ulteriori informazioni sull'ottimizzazione dell'inizializzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a>COleControl:: SerializeVersion

Serializza o Inizializza lo stato delle informazioni sulla versione di un controllo.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametri

*AR*<br/>
`CArchive`Oggetto da serializzare in o da.

*dwVersionDefault*<br/>
Numero di versione corrente del controllo.

*bConvert*<br/>
Indica se i dati permanenti devono essere convertiti nel formato più recente quando vengono salvati o mantenuti nello stesso formato in cui sono stati caricati.

### <a name="return-value"></a>Valore restituito

Numero di versione del controllo. Se è in corso il caricamento dell'archivio specificato, `SerializeVersion` restituisce la versione caricata dall'archivio. In caso contrario, restituisce la versione attualmente caricata.

### <a name="remarks"></a>Osservazioni

Per migliorare le prestazioni di persistenza binaria di un controllo, è possibile utilizzare `SerializeVersion` , `SerializeExtent` e `SerializeStockProps` per eseguire l'override di `COleControl::Serialize` . Per un esempio, vedere il codice in [SerializeExtente](#serializeextent). Per ulteriori informazioni sull'ottimizzazione dell'inizializzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a>COleControl:: separity

Imposta il valore della proprietà dell'aspetto azionario del controllo.

```cpp
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Parametri

*sAppearance*<br/>
**`short`** Valore (VT_I2) da utilizzare per l'aspetto del controllo. Il valore zero imposta l'aspetto del controllo su flat e il valore 1 imposta l'aspetto del controllo su 3D.

### <a name="remarks"></a>Osservazioni

Per altre informazioni sulle proprietà predefinite, vedere [controlli ActiveX: Proprietà](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a>COleControl:: SetBackColor

Imposta il valore della proprietà BackColor del controllo.

```cpp
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Parametri

*dwBackColor*<br/>
Valore OLE_COLOR da utilizzare per il disegno in background del controllo.

### <a name="remarks"></a>Osservazioni

Per ulteriori informazioni sull'utilizzo di questa proprietà e di altre proprietà correlate, vedere l'articolo [controlli ActiveX: Proprietà](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a>COleControl:: seborderstyle

Imposta il valore della proprietà della proprietà BorderStyle predefinita del controllo.

```cpp
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Parametri

*sBorderStyle*<br/>
Nuovo stile del bordo per il controllo; 0 indica nessun bordo e 1 indica un bordo normale.

### <a name="remarks"></a>Osservazioni

La finestra di controllo sarà quindi ricreata e `OnBorderStyleChanged` chiamata.

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a>COleControl:: secapture

Fa in modo che la finestra del contenitore del controllo abbia il possesso dell'acquisizione del mouse per conto dell'utente.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Valore restituito

Puntatore all' `CWnd` oggetto finestra che in precedenza ha ricevuto l'input del mouse.

### <a name="remarks"></a>Osservazioni

Se il controllo è attivato e senza finestra, questa funzione fa sì che la finestra del contenitore del controllo acquisisca il possesso dell'acquisizione del mouse, per conto del controllo. In caso contrario, questa funzione fa in modo che il controllo stesso prenda il possesso dell'acquisizione del mouse (uguale a `CWnd::SetCapture` ).

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a>COleControl:: SetControlSize

Imposta la dimensione della finestra di controllo OLE e notifica al contenitore che il sito del controllo sta cambiando.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Parametri

*CX*<br/>
Specifica la nuova larghezza del controllo in pixel.

*CY*<br/>
Specifica la nuova altezza del controllo in pixel.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiamata ha avuto esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Questa funzione non deve essere usata nel costruttore del controllo.

Si noti che tutte le coordinate per le finestre di controllo sono relative all'angolo superiore sinistro del controllo.

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a>COleControl:: seenabled

Imposta il valore della proprietà Stock Enabled del controllo.

```cpp
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Parametri

*bEnabled*<br/>
TRUE se il controllo deve essere abilitato. in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Dopo aver impostato questa proprietà, `OnEnabledChange` viene chiamato il metodo.

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a>COleControl:: SetFocus

Fa in modo che la finestra del contenitore del controllo prenda il possesso dello stato attivo per l'input per conto del controllo.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Valore restituito

Puntatore all' `CWnd` oggetto finestra che in precedenza aveva lo stato attivo per l'input o null se non esiste tale finestra.

### <a name="remarks"></a>Osservazioni

Se il controllo è attivato e senza finestra, questa funzione fa sì che la finestra del contenitore del controllo abbia il possesso dello stato attivo per l'input, per conto del controllo. Lo stato attivo per l'input indirizza l'input da tastiera alla finestra del contenitore e il contenitore Invia tutti i messaggi della tastiera successivi all'oggetto OLE che chiama `SetFocus` . Qualsiasi finestra che in precedenza aveva lo stato attivo per l'input lo perde.

Se il controllo non è privo di finestra, questa funzione induce il controllo stesso a prendere possesso dello stato attivo per l'input (uguale a `CWnd::SetFocus` ).

## <a name="colecontrolsetfont"></a><a name="setfont"></a>COleControl:: sefont

Imposta la proprietà del tipo di carattere del titolo del controllo.

```cpp
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Parametri

*pFontDisp*<br/>
Puntatore a un'interfaccia di invio del tipo di carattere.

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a>COleControl:: ForeColor

Imposta il valore della proprietà ForeColor del controllo.

```cpp
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Parametri

*dwForeColor*<br/>
Valore OLE_COLOR da utilizzare per il disegno in primo piano del controllo.

### <a name="remarks"></a>Osservazioni

Per ulteriori informazioni sull'utilizzo di questa proprietà e di altre proprietà correlate, vedere l'articolo [controlli ActiveX: Proprietà](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a>COleControl:: SetInitialDataFormats

Chiamata eseguita dal Framework per inizializzare l'elenco dei formati di dati supportati dal controllo.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita specifica due formati: CF_METAFILEPICT e il set di proprietà permanenti.

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a>COleControl:: SetInitialSize

Imposta la dimensione di un controllo OLE quando viene visualizzata per la prima volta in un contenitore.

```cpp
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Parametri

*CX*<br/>
Larghezza iniziale del controllo OLE in pixel.

*CY*<br/>
Altezza iniziale del controllo OLE in pixel.

### <a name="remarks"></a>Osservazioni

Chiamare questa funzione nel costruttore per impostare la dimensione iniziale del controllo. La dimensione iniziale viene misurata in unità di dispositivo o pixel. È consigliabile che questa chiamata venga eseguita nel costruttore del controllo.

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a>COleControl:: SetModifiedFlag

Modifica lo stato modificato di un controllo.

```cpp
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Parametri

*bModified*<br/>
Nuovo valore per il flag modificato del controllo. TRUE indica che lo stato del controllo è stato modificato. FALSE indica che lo stato del controllo è stato appena salvato.

### <a name="remarks"></a>Osservazioni

Chiamare questa funzione ogni volta che si verifica una modifica che influisce sullo stato persistente del controllo. Se, ad esempio, il valore di una proprietà persistente viene modificato, chiamare questa funzione con *bModified* **true**.

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a>COleControl:: SetNotPermitted

Indica che una richiesta di modifica non è riuscita.

```cpp
void SetNotPermitted();
```

### <a name="remarks"></a>Osservazioni

Chiamare questa funzione quando ha `BoundPropertyRequestEdit` esito negativo. Questa funzione genera un'eccezione di tipo `COleDispScodeException` per indicare che l'operazione di impostazione non è consentita.

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a>COleControl:: SetNotSupported

Impedisce la modifica del valore della proprietà di un controllo da parte dell'utente.

```cpp
void SetNotSupported();
```

### <a name="remarks"></a>Osservazioni

Chiamare questa funzione al posto della funzione set di qualsiasi proprietà in cui non è supportata la modifica del valore della proprietà da parte dell'utente del controllo. Un esempio potrebbe essere una proprietà di sola lettura.

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a>COleControl:: SetRectInContainer

Imposta le coordinate del rettangolo del controllo rispetto al contenitore espresso in unità di dispositivo.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Parametri

*lpRect*<br/>
Puntatore a un rettangolo contenente le nuove coordinate del controllo relative al contenitore.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiamata ha avuto esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

Se il controllo è aperto, viene ridimensionato; in caso contrario `OnPosRectChanged` , viene chiamata la funzione del contenitore.

## <a name="colecontrolsettext"></a><a name="settext"></a>COleControl:: SetText

Imposta il valore della didascalia o della proprietà del testo del controllo.

```cpp
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Parametri

*pszText*<br/>
Puntatore a una stringa di caratteri.

### <a name="remarks"></a>Osservazioni

Si noti che le proprietà didascalia e testo Stock sono entrambe mappate allo stesso valore. Ciò significa che tutte le modifiche apportate a una delle due proprietà modificheranno automaticamente entrambe le proprietà. In generale, un controllo deve supportare la didascalia stock o la proprietà Text, ma non entrambi.

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a>COleControl:: ThrowError

Segnala l'occorrenza di un errore nel controllo.

```cpp
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametri

*SC*<br/>
Valore del codice di stato da segnalare. Per un elenco completo dei codici possibili, vedere l'articolo [controlli ActiveX: argomenti avanzati](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
ID della risorsa di stringa dell'eccezione da segnalare.

*nHelpID*<br/>
ID della Guida dell'argomento da segnalare.

*pszDescription*<br/>
Stringa contenente una spiegazione dell'eccezione da segnalare.

### <a name="remarks"></a>Osservazioni

Questa funzione deve essere chiamata solo dall'interno di una funzione Get o set per una proprietà OLE o dell'implementazione di un metodo di automazione OLE. Se è necessario segnalare gli errori che si verificano in altri momenti, è necessario generare l'evento di errore di azione.

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a>COleControl:: TransformCoords

Trasforma i valori delle coordinate tra le unità HIMETRIC e le unità native del contenitore.

```cpp
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Parametri

*lpptlHimetric*<br/>
Puntatore a una `POINTL` struttura contenente le coordinate in unità HIMETRIC.

*lpptfContainer*<br/>
Puntatore a una `POINTF` struttura contenente le coordinate nelle dimensioni dell'unità del contenitore.

*flags*<br/>
Una combinazione dei valori seguenti:

- XFORMCOORDS_POSITION una posizione nel contenitore.

- XFORMCOORDS_SIZE una dimensione nel contenitore.

- XFORMCOORDS_HIMETRICTOCONTAINER trasformare le unità HIMETRIC nelle unità del contenitore.

- XFORMCOORDS_CONTAINERTOHIMETRIC trasformare le unità del contenitore in unità HIMETRIC.

### <a name="remarks"></a>Osservazioni

I primi due flag, XFORMCOORDS_POSITION e XFORMCOORDS_SIZE, indicano se le coordinate devono essere considerate come una posizione o una dimensione. I due flag rimanenti indicano la direzione della trasformazione.

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a>COleControl:: TranslateColor

Converte un valore di colore dal tipo di dati OLE_COLOR al tipo di dati [COLORREF](/windows/win32/gdi/colorref) .

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Parametri

*clrColor*<br/>
Tipo di dati OLE_COLOR. Per ulteriori informazioni, vedere la funzione [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) di Windows.

*hpal*<br/>
Handle per una tavolozza facoltativa. può essere NULL.

### <a name="return-value"></a>Valore restituito

Valore di colore a 32 bit RGB (rosso, verde, blu) che definisce il colore a tinta unita più vicino al valore *clrColor* che il dispositivo può rappresentare.

### <a name="remarks"></a>Osservazioni

Questa funzione è utile per tradurre le proprietà di tipo ForeColor e BackColor Stock in tipi COLORREF utilizzati dalle funzioni membro [CDC](../../mfc/reference/cdc-class.md) .

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a>COleControl:: WillAmbientsBeValidDuringLoad

Determina se il controllo deve utilizzare i valori delle proprietà di ambiente come valori predefiniti, quando viene successivamente caricato dallo stato persistente.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero indica che le proprietà di ambiente saranno valide. in caso contrario, le proprietà di ambiente non saranno valide.

### <a name="remarks"></a>Osservazioni

In alcuni contenitori, il controllo potrebbe non avere accesso alle proprietà di ambiente durante la chiamata iniziale all'override di `COleControl::DoPropExchange` . Questa situazione si verifica se il contenitore chiama [IPersistStreamInit:: Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) o [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) prima di chiamare [IOleObject:: SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) (ovvero se non rispetta il bit di stato OLEMISC_SETCLIENTSITEFIRST).

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a>COleControl:: WindowProc

Fornisce una procedura di Windows per un `COleControl` oggetto.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Parametri

*message*<br/>
Specifica il messaggio di Windows da elaborare.

*wParam*<br/>
Fornisce informazioni aggiuntive sull'elaborazione del messaggio. Il valore del parametro dipende dal messaggio.

*lParam*<br/>
Fornisce informazioni aggiuntive sull'elaborazione del messaggio. Il valore del parametro dipende dal messaggio.

### <a name="return-value"></a>Valore restituito

Valore restituito del messaggio inviato.

### <a name="remarks"></a>Osservazioni

Chiamare questa funzione per inviare messaggi specifici tramite la mappa messaggi del controllo.

## <a name="see-also"></a>Vedere anche

[CIRC3 di esempio MFC](../../overview/visual-cpp-samples.md)<br/>
[TESTHELP di esempio MFC](../../overview/visual-cpp-samples.md)<br/>
[Classe COlePropertyPage](../../mfc/reference/colepropertypage-class.md)<br/>
[Classe CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Grafico delle gerarchie](../../mfc/hierarchy-chart.md)<br/>
[Classe CFontHolder](../../mfc/reference/cfontholder-class.md)<br/>
[Classe CPictureHolder](../../mfc/reference/cpictureholder-class.md)<br/>
