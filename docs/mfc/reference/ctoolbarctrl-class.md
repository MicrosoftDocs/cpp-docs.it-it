---
description: 'Altre informazioni su: classe CToolBarCtrl'
title: Classe CToolBarCtrl
ms.date: 11/04/2016
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
ms.openlocfilehash: 769403be6e4015df1de04d41fcb0a1b2721ee434
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/11/2020
ms.locfileid: "97318559"
---
# <a name="ctoolbarctrl-class"></a>Classe CToolBarCtrl

Fornisce la funzionalità del controllo barra degli strumenti comune di Windows.

## <a name="syntax"></a>Sintassi

```
class CToolBarCtrl : public CWnd
```

## <a name="members"></a>Members

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Description|
|----------|-----------------|
|[CToolBarCtrl:: CToolBarCtrl](#ctoolbarctrl)|Costruisce un oggetto `CToolBarCtrl`.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Description|
|----------|-----------------|
|[CToolBarCtrl:: AddBitmap](#addbitmap)|Aggiunge una o più immagini dei pulsanti bitmap all'elenco di immagini dei pulsanti disponibili per un controllo Toolbar.|
|[CToolBarCtrl:: AddButtons](#addbuttons)|Aggiunge uno o più pulsanti a un controllo Toolbar.|
|[CToolBarCtrl:: AddString](#addstring)|Aggiunge una nuova stringa, passata come ID di risorsa, all'elenco interno di stringhe della barra degli strumenti.|
|[CToolBarCtrl:: AddStrings](#addstrings)|Aggiunge una nuova stringa o stringhe, passata come puntatore a un buffer di stringhe delimitate da null, all'elenco interno di stringhe della barra degli strumenti.|
|[CToolBarCtrl:: AutoSize](#autosize)|Ridimensiona un controllo della barra degli strumenti.|
|[CToolBarCtrl:: ChangeBitmap](#changebitmap)|Modifica la bitmap per un pulsante nel controllo toolbar corrente.|
|[CToolBarCtrl:: CheckButton](#checkbutton)|Controlla o cancella un pulsante specificato in un controllo Toolbar.|
|[CToolBarCtrl:: CommandToIndex](#commandtoindex)|Recupera l'indice in base zero per il pulsante associato all'identificatore di comando specificato.|
|[CToolBarCtrl:: create](#create)|Crea un controllo barra degli strumenti e lo collega a un `CToolBarCtrl` oggetto.|
|[CToolBarCtrl:: CreateEx](#createex)|Crea un controllo Toolbar con gli stili estesi di Windows specificati e lo collega a un `CToolBarCtrl` oggetto.|
|[CToolBarCtrl:: Customize](#customize)|Consente di visualizzare la finestra di dialogo Personalizza barra degli strumenti.|
|[CToolBarCtrl::D eleteButton](#deletebutton)|Elimina un pulsante dal controllo Toolbar.|
|[CToolBarCtrl:: EnableButton](#enablebutton)|Abilita o Disabilita il pulsante specificato in un controllo Toolbar.|
|[CToolBarCtrl:: GetAnchorHighlight](#getanchorhighlight)|Recupera l'impostazione dell'evidenziazione dell'ancoraggio per una barra degli strumenti.|
|[CToolBarCtrl:: GetBitmap](#getbitmap)|Recupera l'indice della bitmap associata a un pulsante in una barra degli strumenti.|
|[CToolBarCtrl:: GetBitmapFlags](#getbitmapflags)|Ottiene i flag associati alla bitmap della barra degli strumenti.|
|[CToolBarCtrl:: GetButton](#getbutton)|Recupera le informazioni sul pulsante specificato in un controllo Toolbar.|
|[CToolBarCtrl:: GetButtonCount](#getbuttoncount)|Recupera un conteggio dei pulsanti attualmente presenti nel controllo Toolbar.|
|[CToolBarCtrl:: GetButtonInfo](#getbuttoninfo)|Recupera le informazioni per un pulsante in una barra degli strumenti.|
|[CToolBarCtrl:: GetButtonSize](#getbuttonsize)|Recupera la larghezza e l'altezza correnti dei pulsanti della barra degli strumenti, in pixel.|
|[CToolBarCtrl:: GetColorScheme](#getcolorscheme)|Recupera la combinazione di colori del controllo toolbar corrente.|
|[CToolBarCtrl:: GetDisabledImageList](#getdisabledimagelist)|Recupera l'elenco di immagini utilizzato da un controllo Toolbar per visualizzare i pulsanti disabilitati.|
|[CToolBarCtrl:: GetDropTarget](#getdroptarget)|Recupera l'interfaccia [IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) per un controllo Toolbar.|
|[CToolBarCtrl:: GetExtendedStyle](#getextendedstyle)|Recupera gli stili estesi per un controllo Toolbar.|
|[CToolBarCtrl:: GetHotImageList](#gethotimagelist)|Recupera l'elenco di immagini utilizzato da un controllo Toolbar per visualizzare i pulsanti "Hot". Un pulsante attivo appare evidenziato quando il puntatore del mouse si trova sopra di esso.|
|[CToolBarCtrl:: GetHotItem](#gethotitem)|Recupera l'indice dell'elemento attivo in una barra degli strumenti.|
|[CToolBarCtrl:: GetImages](#getimagelist)|Recupera l'elenco di immagini utilizzato da un controllo Toolbar per visualizzare i pulsanti nello stato predefinito.|
|[CToolBarCtrl:: GetInsertMark](#getinsertmark)|Recupera il segno di inserimento corrente per la barra degli strumenti.|
|[CToolBarCtrl:: GetInsertMarkColor](#getinsertmarkcolor)|Recupera il colore utilizzato per tracciare il segno di inserimento per la barra degli strumenti.|
|[CToolBarCtrl:: GetItemRect](#getitemrect)|Recupera il rettangolo di delimitazione di un pulsante in un controllo Toolbar.|
|[CToolBarCtrl:: GetMaxSize](#getmaxsize)|Recupera la dimensione totale di tutti i pulsanti e i separatori visibili nella barra degli strumenti.|
|[CToolBarCtrl:: GetMaxTextRows](#getmaxtextrows)|Recupera il numero massimo di righe di testo visualizzate su un pulsante della barra degli strumenti.|
|[CToolBarCtrl:: GetMetrics](#getmetrics)|Recupera le metriche di un controllo della barra degli strumenti.|
|[CToolBarCtrl:: getpadding](#getpadding)|Recupera la spaziatura interna orizzontale e verticale del controllo toolbar corrente.|
|[CToolBarCtrl:: GetPressedImageList](#getpressedimagelist)|Recupera l'elenco di immagini utilizzato dal controllo toolbar corrente per rappresentare i pulsanti nello stato premuto.|
|[CToolBarCtrl:: GetRect](#getrect)|Recupera il rettangolo di delimitazione per un pulsante della barra degli strumenti specificato.|
|[CToolBarCtrl:: GetRows](#getrows)|Recupera il numero di righe di pulsanti attualmente visualizzati nella barra degli strumenti.|
|[CToolBarCtrl:: GetState](#getstate)|Recupera le informazioni sullo stato del pulsante specificato in un controllo Toolbar, ad esempio se è abilitato, premuto o selezionato.|
|[CToolBarCtrl:: GetString](#getstring)|Recupera una stringa della barra degli strumenti.|
|[CToolBarCtrl:: GetStyle](#getstyle)|Recupera gli stili attualmente in uso per un controllo Toolbar.|
|[CToolBarCtrl:: GetToolTips](#gettooltips)|Recupera l'handle del controllo ToolTip, se presente, associato al controllo Toolbar.|
|[CToolBarCtrl:: HideButton](#hidebutton)|Nasconde o Mostra il pulsante specificato in un controllo Toolbar.|
|[CToolBarCtrl:: HitTest](#hittest)|Determina se un punto si trova in un controllo Toolbar.|
|[CToolBarCtrl:: indeterminato](#indeterminate)|Imposta o cancella lo stato indeterminato (grigio) del pulsante specificato in un controllo Toolbar.|
|[CToolBarCtrl:: InsertButton](#insertbutton)|Inserisce un pulsante in un controllo Toolbar.|
|[CToolBarCtrl:: InsertMarkHitTest](#insertmarkhittest)|Recupera le informazioni sul segno di inserimento per un punto in una barra degli strumenti.|
|[CToolBarCtrl:: IsButtonChecked](#isbuttonchecked)|Indica se il pulsante specificato in un controllo Toolbar è selezionato.|
|[CToolBarCtrl:: IsButtonEnabled](#isbuttonenabled)|Indica se il pulsante specificato in un controllo Toolbar è abilitato.|
|[CToolBarCtrl:: IsButtonHidden](#isbuttonhidden)|Indica se il pulsante specificato in un controllo Toolbar è nascosto.|
|[CToolBarCtrl:: IsButtonHighlighted](#isbuttonhighlighted)|Controlla lo stato di evidenziazione del pulsante della barra degli strumenti.|
|[CToolBarCtrl:: IsButtonIndeterminate](#isbuttonindeterminate)|Indica se lo stato del pulsante specificato in un controllo Toolbar è indeterminato (grigio).|
|[CToolBarCtrl:: IsButtonPressed](#isbuttonpressed)|Indica se il pulsante specificato in un controllo Toolbar è premuto.|
|[CToolBarCtrl:: LoadImages](#loadimages)|Carica le bitmap nell'elenco immagini di un controllo Toolbar.|
|[CToolBarCtrl:: MapAccelerator](#mapaccelerator)|Esegue il mapping di un carattere acceleratore a un pulsante della barra degli strumenti.|
|[CToolBarCtrl:: MarkButton](#markbutton)|Imposta lo stato di evidenziazione di un pulsante specificato in un controllo Toolbar.|
|[CToolBarCtrl:: MoveButton](#movebutton)|Sposta un pulsante da un indice a un altro.|
|[CToolBarCtrl::P ressButton](#pressbutton)|Preme o rilascia il pulsante specificato in un controllo Toolbar.|
|[CToolBarCtrl:: ReplaceBitmap](#replacebitmap)|Sostituisce la bitmap esistente nel controllo toolbar corrente con una nuova bitmap.|
|[CToolBarCtrl:: RestoreState](#restorestate)|Ripristina lo stato del controllo Toolbar.|
|[CToolBarCtrl:: SaveState](#savestate)|Salva lo stato del controllo Toolbar.|
|[CToolBarCtrl:: SetAnchorHighlight](#setanchorhighlight)|Imposta l'impostazione dell'evidenziazione di ancoraggio per una barra degli strumenti.|
|[CToolBarCtrl:: SetBitmapSize](#setbitmapsize)|Imposta la dimensione delle immagini bitmap da aggiungere a un controllo Toolbar.|
|[CToolBarCtrl:: SetButtonInfo](#setbuttoninfo)|Imposta le informazioni per un pulsante esistente in una barra degli strumenti.|
|[CToolBarCtrl:: SetButtonSize](#setbuttonsize)|Imposta la dimensione dei pulsanti da aggiungere a un controllo Toolbar.|
|[CToolBarCtrl:: SetButtonStructSize](#setbuttonstructsize)|Specifica le dimensioni della `TBBUTTON` struttura.|
|[CToolBarCtrl:: SetButtonWidth](#setbuttonwidth)|Imposta le larghezze minime e massime del pulsante nel controllo Toolbar.|
|[CToolBarCtrl:: SetCmdID](#setcmdid)|Imposta l'identificatore del comando da inviare alla finestra proprietaria quando viene premuto il pulsante specificato.|
|[CToolBarCtrl:: SetColorScheme](#setcolorscheme)|Imposta la combinazione di colori del controllo toolbar corrente.|
|[CToolBarCtrl:: SetDisabledImageList](#setdisabledimagelist)|Imposta l'elenco di immagini che il controllo toolbar utilizzerà per visualizzare i pulsanti disabilitati.|
|[CToolBarCtrl:: SetDrawTextFlags](#setdrawtextflags)|Imposta i flag nella funzione Win32 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext), che viene utilizzata per creare il testo nel rettangolo specificato, formattato in base alla modalità di impostazione dei flag.|
|[CToolBarCtrl:: SetExtendedStyle](#setextendedstyle)|Imposta gli stili estesi per un controllo Toolbar.|
|[CToolBarCtrl:: SetHotImageList](#sethotimagelist)|Imposta l'elenco di immagini che il controllo toolbar utilizzerà per visualizzare i pulsanti "Hot".|
|[CToolBarCtrl:: SetHotItem](#sethotitem)|Imposta l'elemento attivo in una barra degli strumenti.|
|[CToolBarCtrl:: seimagine](#setimagelist)|Imposta l'elenco di immagini che verrà utilizzato dalla barra degli strumenti per visualizzare i pulsanti che si trovano nello stato predefinito.|
|[CToolBarCtrl:: sedent](#setindent)|Imposta il rientro per il primo pulsante in un controllo Toolbar.|
|[CToolBarCtrl:: SetInsertMark](#setinsertmark)|Imposta il segno di inserimento corrente per la barra degli strumenti.|
|[CToolBarCtrl:: SetInsertMarkColor](#setinsertmarkcolor)|Imposta il colore utilizzato per creare il segno di inserimento per la barra degli strumenti.|
|[CToolBarCtrl:: SetMaxTextRows](#setmaxtextrows)|Imposta il numero massimo di righe di testo visualizzate su un pulsante della barra degli strumenti.|
|[CToolBarCtrl:: semetrics](#setmetrics)|Imposta la metrica di un controllo della barra degli strumenti.|
|[CToolBarCtrl:: SetOwner](#setowner)|Imposta la finestra per la ricezione di messaggi di notifica dal controllo Toolbar.|
|[CToolBarCtrl:: sepadding](#setpadding)|Imposta la spaziatura interna orizzontale e verticale del controllo toolbar corrente.|
|[CToolBarCtrl:: SetPressedImageList](#setpressedimagelist)|Imposta l'elenco di immagini utilizzato dal controllo toolbar corrente per rappresentare i pulsanti nello stato premuto.|
|[CToolBarCtrl:: GetRows](#setrows)|Imposta il numero di righe di pulsanti visualizzati nella barra degli strumenti.|
|[CToolBarCtrl:: sestate](#setstate)|Imposta lo stato del pulsante specificato in un controllo Toolbar.|
|[CToolBarCtrl:: Sestyle](#setstyle)|Imposta gli stili per un controllo Toolbar.|
|[CToolBarCtrl:: setooltips](#settooltips)|Associa un controllo descrizione comando al controllo Toolbar.|
|[CToolBarCtrl:: SetWindowTheme](#setwindowtheme)|Imposta lo stile di visualizzazione di un controllo Toolbar.|

## <a name="remarks"></a>Commenti

Questo controllo (e pertanto la `CToolBarCtrl` classe) è disponibile solo per i programmi in esecuzione in windows 95/98 e Windows NT versione 3,51 e successive.

Un controllo comune della barra degli strumenti di Windows è una finestra figlio rettangolare che contiene uno o più pulsanti. Questi pulsanti possono visualizzare un'immagine bitmap, una stringa o entrambi. Quando l'utente sceglie un pulsante, invia un messaggio di comando alla finestra proprietaria della barra degli strumenti. In genere, i pulsanti di una barra degli strumenti corrispondono agli elementi nel menu dell'applicazione. forniscono agli utenti un modo più diretto per accedere ai comandi di un'applicazione.

`CToolBarCtrl` gli oggetti contengono diverse strutture di dati interne importanti: un elenco di bitmap dell'immagine del pulsante o un elenco di immagini, un elenco di stringhe di etichette di pulsanti e un elenco di `TBBUTTON` strutture che associano un'immagine e/o una stringa con la posizione, lo stile, lo stato e l'ID del comando del pulsante. Ogni elemento di queste strutture di dati viene definito da un indice in base zero. Prima di poter utilizzare un `CToolBarCtrl` oggetto, è necessario impostare queste strutture di dati. L'elenco di stringhe può essere utilizzato solo per le etichette dei pulsanti; non è possibile recuperare le stringhe dalla barra degli strumenti.

Per utilizzare un oggetto `CToolBarCtrl`, in genere vengono effettuate le seguenti operazioni:

1. Costruire l'oggetto `CToolBarCtrl`.

1. Chiamare [create](#create) per creare il controllo comune della barra degli strumenti di Windows e collegarlo all' `CToolBarCtrl` oggetto. Indicare lo stile della barra degli strumenti utilizzando gli stili, ad esempio TBSTYLE_TRANSPARENT per una barra degli strumenti trasparente o TBSTYLE_DROPDOWN per una barra degli strumenti che supporta i pulsanti di stile a discesa.

1. Identificare il modo in cui si desidera visualizzare i pulsanti sulla barra degli strumenti:

   - Per usare le immagini bitmap per i pulsanti, aggiungere le bitmap dei pulsanti alla barra degli strumenti chiamando [AddBitmap](#addbitmap).

   - Per usare le immagini visualizzate da un elenco di immagini per i pulsanti, specificare l'elenco di [Immagini chiamando](#setimagelist) [SetHotImageList](#sethotimagelist)o [SetDisabledImageList](#setdisabledimagelist).

   - Per usare le etichette di stringa per i pulsanti, aggiungere le stringhe alla barra degli strumenti chiamando [AddString](#addstring) e/o [AddStrings](#addstrings).

1. Aggiungere le strutture dei pulsanti alla barra degli strumenti chiamando [AddButtons](#addbuttons).

1. Se si desiderano le descrizioni comandi per un pulsante della barra degli strumenti in una finestra proprietaria che non è un `CFrameWnd` , è necessario gestire i messaggi di TTN_NEEDTEXT nella finestra proprietaria della barra degli strumenti, come descritto in [gestione delle notifiche delle descrizioni comandi](../../mfc/handling-tool-tip-notifications.md). Se la finestra padre della barra degli strumenti è derivata da `CFrameWnd` , le descrizioni comandi vengono visualizzate senza alcuna ulteriore operazione da parte dell'utente perché `CFrameWnd` fornisce un gestore predefinito.

1. Se si desidera che l'utente sia in grado di personalizzare la barra degli strumenti, gestire i messaggi di notifica della personalizzazione nella finestra proprietaria come descritto in [gestione delle notifiche di personalizzazione](../../mfc/handling-customization-notifications.md).

È possibile usare [SaveState](#savestate) per salvare lo stato corrente di un controllo della barra degli strumenti nel registro di sistema e [RestoreState](#restorestate) per ripristinare lo stato in base alle informazioni archiviate in precedenza nel registro di sistema. Oltre a salvare lo stato della barra degli strumenti tra gli utilizzi dell'applicazione, le applicazioni in genere archiviano lo stato prima che l'utente inizi a personalizzare la barra degli strumenti nel caso in cui l'utente voglia ripristinare lo stato originale della barra degli strumenti.

## <a name="support-for-internet-explorer-version-40-and-later"></a>Supporto per Internet Explorer versione 4,0 e successive

Per supportare le funzionalità introdotte in Internet Explorer, versione 4,0 e successive, in MFC sono disponibili supporto per elenchi di immagini e stili trasparenti e flat per i controlli della barra degli strumenti.

Una barra degli strumenti trasparente consente di visualizzare il client sotto la barra degli strumenti. Per creare una barra degli strumenti trasparente, utilizzare gli stili TBSTYLE_FLAT e TBSTYLE_TRANSPARENT. Funzionalità di rilevamento a caldo della barra degli strumenti trasparente; ovvero, quando il puntatore del mouse viene spostato su un pulsante attivo sulla barra degli strumenti, l'aspetto del pulsante cambia. Le barre degli strumenti create solo con lo stile TBSTYLE_FLAT conterranno pulsanti non trasparenti.

Il supporto per l'elenco immagini consente a un controllo maggiore flessibilità per il comportamento predefinito, le immagini sensibili e le immagini disabilitate. Utilizzare [Getimagine](#getimagelist), [GetHotImageList](#gethotimagelist)e [GetDisabledImageList](#getdisabledimagelist) con la barra degli strumenti trasparente per modificare l'immagine in base al relativo stato:

Per altre informazioni sull'uso di `CToolBarCtrl` , vedere [controlli](../../mfc/controls-mfc.md) e [uso di CToolBarCtrl](../../mfc/using-ctoolbarctrl.md).

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CToolBarCtrl`

## <a name="requirements"></a>Requisiti

**Intestazione:** afxcmn.h

## <a name="ctoolbarctrladdbitmap"></a><a name="addbitmap"></a> CToolBarCtrl:: AddBitmap

Aggiunge una o più immagini dei pulsanti all'elenco di immagini del pulsante archiviate nel controllo Toolbar.

```
int AddBitmap(
    int nNumButtons,
    UINT nBitmapID);

int AddBitmap(
    int nNumButtons,
    CBitmap* pBitmap);
```

### <a name="parameters"></a>Parametri

*nNumButtons*<br/>
Numero di immagini di pulsanti nella bitmap.

*nBitmapID*<br/>
Identificatore della risorsa bitmap che contiene l'immagine del pulsante o le immagini da aggiungere.

*pBitmap*<br/>
Puntatore all' `CBitmap` oggetto che contiene l'immagine o le immagini del pulsante da aggiungere.

### <a name="return-value"></a>Valore restituito

Indice in base zero della prima nuova immagine, se ha esito positivo; in caso contrario,-1.

### <a name="remarks"></a>Commenti

È possibile utilizzare l'API Windows [CreateMappedBitmap](/windows/win32/api/commctrl/nf-commctrl-createmappedbitmap) per eseguire il mapping dei colori prima di aggiungere la bitmap alla barra degli strumenti. Se si passa un puntatore a un `CBitMap` oggetto, è necessario assicurarsi che la bitmap non venga eliminata definitivamente finché la barra degli strumenti non viene distrutta.

## <a name="ctoolbarctrladdbuttons"></a><a name="addbuttons"></a> CToolBarCtrl:: AddButtons

Aggiunge uno o più pulsanti a un controllo Toolbar.

```
BOOL AddButtons(
    int nNumButtons,
    LPTBBUTTON lpButtons);
```

### <a name="parameters"></a>Parametri

*nNumButtons*<br/>
Numero di pulsanti da aggiungere.

*lpButtons*<br/>
Indirizzo di una matrice di `TBBUTTON` strutture che contiene informazioni sui pulsanti da aggiungere. Il numero di elementi nella matrice deve essere uguale a quello dei pulsanti specificati da *nNumButtons*.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Il puntatore *lpButtons* punta a una matrice di `TBBUTTON` strutture. Ogni `TBBUTTON` struttura associa il pulsante aggiunto con lo stile, l'immagine e/o la stringa del pulsante, l'ID comando, lo stato e i dati definiti dall'utente:

```cpp
typedef struct _TBBUTTON {
    int iBitmap;    // zero-based index of button image
    int idCommand;  // command to be sent when button pressed
    BYTE fsState;   // button state--see below
    BYTE fsStyle;   // button style--see below
    DWORD dwData;   // application-defined value
    int iString;    // zero-based index of button label string
} TBBUTTON;
```

I membri sono i seguenti:

- `iBitmap`

   Indice in base zero dell'immagine del pulsante,-1 se non è presente alcuna immagine per questo pulsante.

- `idCommand`

   Identificatore di comando associato al pulsante. Questo identificatore viene inviato in un messaggio di WM_COMMAND quando si sceglie il pulsante. Se il `fsStyle` membro ha il valore TBSTYLE_SEP, questo membro deve essere zero.

- `fsState`

   Flag di stato del pulsante. Può trattarsi di una combinazione dei valori elencati di seguito:

  - TBSTATE_CHECKED il pulsante ha lo stile TBSTYLE_CHECKED e viene premuto.

  - TBSTATE_ENABLED il pulsante accetta l'input dell'utente. Un pulsante che non dispone di questo stato non accetta l'input dell'utente ed è disattivato.

  - TBSTATE_HIDDEN il pulsante non è visibile e non è in grado di ricevere l'input dell'utente.

  - TBSTATE_INDETERMINATE il pulsante è disattivato.

  - TBSTATE_PRESSED è in corso la pressione del pulsante.

  - TBSTATE_WRAP un'interruzioni di riga segue il pulsante. Il pulsante deve avere anche lo stato TBSTATE_ENABLED.

- `fsStyle`

   Stile del pulsante. Può trattarsi di una combinazione dei valori elencati di seguito:

  - TBSTYLE_BUTTON crea un pulsante di push standard.

  - TBSTYLE_CHECK crea un pulsante che alterna gli stati premuti e non compressi ogni volta che l'utente fa clic su di esso. Il pulsante ha un colore di sfondo diverso quando si trova nello stato premuto.

  - TBSTYLE_CHECKGROUP crea un pulsante di controllo che rimane premuto fino a quando non viene premuto un altro pulsante del gruppo.

  - TBSTYLE_GROUP crea un pulsante che rimane premuto fino a quando non viene premuto un altro pulsante del gruppo.

  - TBSTYLE_SEP crea un separatore che fornisce un piccolo gap tra i gruppi di pulsanti. Un pulsante con questo stile non riceve l'input dell'utente.

- `dwData`

   Dati definiti dall'utente.

- `iString`

   Indice in base zero della stringa da utilizzare come etichetta del pulsante,-1 se non è presente alcuna stringa per questo pulsante.

L'immagine e/o la stringa il cui indice è stato fornito devono essere stati aggiunti in precedenza all'elenco del controllo Toolbar usando [AddBitmap](#addbitmap), [AddString](#addstring)e/o [AddStrings](#addstrings).

## <a name="ctoolbarctrladdstring"></a><a name="addstring"></a> CToolBarCtrl:: AddString

Aggiunge una nuova stringa, passata come ID di risorsa, all'elenco interno di stringhe della barra degli strumenti.

```
int AddString(UINT nStringID);
```

### <a name="parameters"></a>Parametri

*nStringID*<br/>
Identificatore della risorsa di stringa da aggiungere all'elenco di stringhe del controllo Toolbar.

### <a name="return-value"></a>Valore restituito

Indice in base zero della prima nuova stringa aggiunta in caso di esito positivo; in caso contrario,-1.

## <a name="ctoolbarctrladdstrings"></a><a name="addstrings"></a> CToolBarCtrl:: AddStrings

Aggiunge una nuova stringa o stringhe all'elenco di stringhe disponibili per un controllo Toolbar.

```
int AddStrings(LPCTSTR lpszStrings);
```

### <a name="parameters"></a>Parametri

*lpszStrings*<br/>
Indirizzo di un buffer che contiene una o più stringhe con terminazione null da aggiungere all'elenco di stringhe della barra degli strumenti. L'ultima stringa deve terminare con due caratteri null.

### <a name="return-value"></a>Valore restituito

Indice in base zero della prima nuova stringa aggiunta in caso di esito positivo; in caso contrario,-1.

### <a name="remarks"></a>Commenti

Le stringhe nel buffer devono essere separate da un carattere null. È necessario assicurarsi che l'ultima stringa includa due terminatori null. Per formattare correttamente una stringa costante, è possibile scriverla come segue:

[!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]

oppure:

[!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]

Non è necessario passare un `CString` oggetto a questa funzione perché non è possibile avere più di un carattere null in un `CString` .

## <a name="ctoolbarctrlautosize"></a><a name="autosize"></a> CToolBarCtrl:: AutoSize

Ridimensiona l'intero controllo Toolbar.

```cpp
void AutoSize();
```

### <a name="remarks"></a>Commenti

È necessario chiamare questa funzione quando viene modificata la dimensione della finestra padre o quando viene modificata la dimensione della barra degli strumenti, ad esempio quando si impostano le dimensioni del pulsante o della bitmap oppure si aggiungono stringhe.

## <a name="ctoolbarctrlchangebitmap"></a><a name="changebitmap"></a> CToolBarCtrl:: ChangeBitmap

Modifica la bitmap per un pulsante nel controllo toolbar corrente.

```
BOOL ChangeBitmap(
    int idButton,
    int iBitmap);
```

### <a name="parameters"></a>Parametri

*idButton*\
in Identificatore di comando del pulsante che deve ricevere una nuova bitmap.

*iBitmap*\
in Indice in base zero di un'immagine nell'elenco immagini del controllo toolbar corrente.

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Se questo metodo ha esito positivo, il sistema Visualizza l'immagine specificata nel pulsante specificato.

Questo metodo invia il messaggio di [TB_CHANGEBITMAP](/windows/win32/Controls/tb-changebitmap) , descritto nel Windows SDK.

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene modificata la bitmap per il pulsante **Salva file** nella bitmap per il pulsante **informazioni su** .

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]

## <a name="ctoolbarctrlcheckbutton"></a><a name="checkbutton"></a> CToolBarCtrl:: CheckButton

Controlla o cancella un pulsante specificato in un controllo Toolbar.

```
BOOL CheckButton(
    int nID,
    BOOL bCheck = TRUE);
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore di comando del pulsante da selezionare o deselezionare.

*Sezione bRicerca*<br/>
TRUE per selezionare il pulsante FALSE per cancellarlo.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Quando un pulsante è stato selezionato, sembra che sia stato premuto. Se si desidera modificare più di uno stato di un pulsante, provare a chiamare [sestate](#setstate) .

## <a name="ctoolbarctrlcommandtoindex"></a><a name="commandtoindex"></a> CToolBarCtrl:: CommandToIndex

Recupera l'indice in base zero per il pulsante associato all'identificatore di comando specificato.

```
UINT CommandToIndex(UINT nID) const;
```

### <a name="parameters"></a>Parametri

*nID*<br/>
ID di comando di cui si desidera trovare l'indice del pulsante.

### <a name="return-value"></a>Valore restituito

Indice in base zero per il pulsante associato all'ID di comando.

### <a name="remarks"></a>Commenti

## <a name="ctoolbarctrlcreate"></a><a name="create"></a> CToolBarCtrl:: create

Crea un controllo barra degli strumenti e lo collega a un `CToolBarCtrl` oggetto.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Parametri

*dwStyle*<br/>
Specifica lo stile del controllo Toolbar. Le barre degli strumenti devono avere sempre lo stile WS_CHILD. Inoltre, è possibile specificare qualsiasi combinazione di stili della barra degli strumenti e stili della finestra, come descritto in **Note**.

*Rect*<br/>
Facoltativamente specifica le dimensioni e la posizione del controllo Toolbar. Può essere un oggetto [CRect](../../atl-mfc-shared/reference/crect-class.md) o una struttura [Rect](/windows/win32/api/windef/ns-windef-rect) .

*pParentWnd*<br/>
Specifica la finestra padre del controllo Toolbar. Non deve essere NULL.

*nID*<br/>
Specifica l'ID del controllo Toolbar.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Si costruisce un `CToolBarCtrl` in due passaggi. Chiamare innanzitutto il costruttore, quindi chiamare `Create` , che crea il controllo Toolbar e lo collega all' `CToolBarCtrl` oggetto. Applicare gli stili della finestra seguenti a un controllo Toolbar.

- WS_CHILD sempre

- WS_VISIBLE in genere

- WS_DISABLED raramente

Per una descrizione degli stili della finestra, vedere [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) nel Windows SDK.

Facoltativamente, applicare una combinazione di [stili di controllo comuni](/windows/win32/Controls/common-control-styles), come descritto nel Windows SDK.

Applicare una combinazione di stili della barra degli strumenti al controllo o ai pulsanti. Gli stili sono descritti negli stili del [pulsante e del controllo della barra degli strumenti](/windows/win32/Controls/toolbar-control-and-button-styles) dell'argomento nella Windows SDK.

Per utilizzare gli stili estesi della barra degli strumenti, chiamare [SetExtendedStyle](#setextendedstyle) dopo aver chiamato `Create` . Per creare una barra degli strumenti con stili estesi della finestra, chiamare [CToolBarCtrl:: CreateEx](#createex) anziché `Create` .

Il controllo toolbar imposta automaticamente le dimensioni e la posizione della finestra della barra degli strumenti. L'altezza è basata sull'altezza dei pulsanti nella barra degli strumenti. La larghezza corrisponde alla larghezza dell'area client della finestra padre. Gli stili CCS_TOP e CCS_BOTTOM determinano se la barra degli strumenti è posizionata lungo la parte superiore o inferiore dell'area client. Per impostazione predefinita, una barra degli strumenti ha lo stile CCS_TOP.

## <a name="ctoolbarctrlcreateex"></a><a name="createex"></a> CToolBarCtrl:: CreateEx

Crea un controllo (una finestra figlio) e lo associa all' `CToolBarCtrl` oggetto.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Parametri

*dwExStyle*<br/>
Specifica lo stile esteso del controllo da creare. Per un elenco degli stili Windows estesi, vedere il parametro *dwExStyle* per [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw) nel Windows SDK.

*dwStyle*<br/>
Specifica lo stile del controllo Toolbar. Le barre degli strumenti devono avere sempre lo stile WS_CHILD. Inoltre, è possibile specificare qualsiasi combinazione di stili della barra degli strumenti e stili della finestra, come descritto nella sezione **osservazioni** di [create](#create).

*Rect*<br/>
Riferimento a una struttura [Rect](/windows/win32/api/windef/ns-windef-rect) che descrive le dimensioni e la posizione della finestra da creare, nelle coordinate client di *pParentWnd*.

*pParentWnd*<br/>
Puntatore alla finestra che rappresenta l'elemento padre del controllo.

*nID*<br/>
ID della finestra figlio del controllo.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Usare `CreateEx` anziché [create](#create) per applicare gli stili estesi di Windows, specificati dall'introduzione allo stile esteso di Windows **WS_EX_**. `CreateEx` Crea il controllo con gli stili Windows estesi specificati da *dwExStyle*. Impostare gli stili estesi specifici di un controllo usando [SetExtendedStyle](#setextendedstyle). Utilizzare, ad esempio, `CreateEx` per impostare tali stili come WS_EX_CONTEXTHELP, ma utilizzare `SetExtendedStyle` per impostare tali stili come TBSTYLE_EX_DRAWDDARROWS. Per ulteriori informazioni, vedere gli stili descritti in [stili estesi della barra degli strumenti](/windows/win32/Controls/toolbar-extended-styles) nel Windows SDK.

## <a name="ctoolbarctrlctoolbarctrl"></a><a name="ctoolbarctrl"></a> CToolBarCtrl:: CToolBarCtrl

Costruisce un oggetto `CToolBarCtrl`.

```
CToolBarCtrl();
```

### <a name="remarks"></a>Commenti

È necessario chiamare [create](#create) per rendere utilizzabile la barra degli strumenti.

## <a name="ctoolbarctrlcustomize"></a><a name="customize"></a> CToolBarCtrl:: Customize

Consente di visualizzare la finestra di dialogo Personalizza barra degli strumenti.

```cpp
void Customize();
```

### <a name="remarks"></a>Commenti

Questa finestra di dialogo consente all'utente di personalizzare la barra degli strumenti aggiungendo ed eliminando pulsanti. Per supportare la personalizzazione, la finestra padre della barra degli strumenti deve gestire i messaggi di notifica di personalizzazione, come descritto in [gestione delle notifiche di personalizzazione](../../mfc/handling-customization-notifications.md). La barra degli strumenti deve anche essere stata creata con lo stile CCS_ADJUSTABLE, come descritto in [CToolBarCtrl:: create](#create).

## <a name="ctoolbarctrldeletebutton"></a><a name="deletebutton"></a> CToolBarCtrl::D eleteButton

Elimina un pulsante dal controllo Toolbar.

```
BOOL DeleteButton(int nIndex);
```

### <a name="parameters"></a>Parametri

*nIndex*<br/>
Indice in base zero del pulsante da eliminare.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

## <a name="ctoolbarctrlenablebutton"></a><a name="enablebutton"></a> CToolBarCtrl:: EnableButton

Abilita o Disabilita il pulsante specificato in un controllo Toolbar.

```
BOOL EnableButton(
    int nID,
    BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore di comando del pulsante da abilitare o disabilitare.

*bEnable*<br/>
TRUE per abilitare il pulsante; FALSE per disabilitare il pulsante.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Quando un pulsante è stato abilitato, è possibile premerlo e selezionarlo. Se si desidera modificare più di uno stato di un pulsante, provare a chiamare [sestate](#setstate) .

## <a name="ctoolbarctrlgetanchorhighlight"></a><a name="getanchorhighlight"></a> CToolBarCtrl:: GetAnchorHighlight

Recupera l'impostazione dell'evidenziazione dell'ancoraggio per una barra degli strumenti.

```
BOOL GetAnchorHighlight() const;
```

### <a name="return-value"></a>Valore restituito

Se diverso da zero, è abilitata l'evidenziazione di ancoraggio. Se è zero, l'evidenziazione dell'ancoraggio è disabilitata.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_GETANCHORHIGHLIGHT](/windows/win32/Controls/tb-getanchorhighlight)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlgetbitmap"></a><a name="getbitmap"></a> CToolBarCtrl:: GetBitmap

Recupera l'indice della bitmap associata a un pulsante in una barra degli strumenti.

```
int GetBitmap(int nID) const;
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore di comando del pulsante di cui deve essere recuperato l'indice bitmap.

### <a name="return-value"></a>Valore restituito

Restituisce l'indice della bitmap, se ha esito positivo, oppure zero in caso contrario.

### <a name="remarks"></a>Commenti

Implementa la funzionalità di [TB_GETBITMAP](/windows/win32/Controls/tb-getbitmap) nell'Windows SDK.

## <a name="ctoolbarctrlgetbitmapflags"></a><a name="getbitmapflags"></a> CToolBarCtrl:: GetBitmapFlags

Recupera i flag bitmap dalla barra degli strumenti.

```
UINT GetBitmapFlags() const;
```

### <a name="return-value"></a>Valore restituito

Oggetto UINT con il flag di TBBF_LARGE impostato se la visualizzazione può supportare bitmap di grandi dimensioni della barra degli strumenti; in caso contrario, deselezionare.

### <a name="remarks"></a>Commenti

È necessario chiamarla dopo la creazione della barra degli strumenti, ma prima di aggiungere bitmap alla barra degli strumenti. Il valore restituito indica se la visualizzazione supporta o meno bitmap di grandi dimensioni. Se la visualizzazione supporta bitmap di grandi dimensioni e se si sceglie di utilizzarle, chiamare [SetBitmapSize](#setbitmapsize) e [SetButtonSize](#setbuttonsize) prima di aggiungere la bitmap di grandi dimensioni tramite [AddBitmap](#addbitmap).

## <a name="ctoolbarctrlgetbutton"></a><a name="getbutton"></a> CToolBarCtrl:: GetButton

Recupera le informazioni sul pulsante specificato in un controllo Toolbar.

```
BOOL GetButton(
    int nIndex,
    LPTBBUTTON lpButton) const;
```

### <a name="parameters"></a>Parametri

*nIndex*<br/>
Indice in base zero del pulsante per il quale recuperare le informazioni.

*lpButton*<br/>
Indirizzo della `TBBUTTON` struttura che deve ricevere una copia delle informazioni sul pulsante. Per informazioni sulla struttura, vedere [CToolBarCtrl:: AddButtons](#addbuttons) `TBBUTTON` .

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

## <a name="ctoolbarctrlgetbuttoncount"></a><a name="getbuttoncount"></a> CToolBarCtrl:: GetButtonCount

Recupera un conteggio dei pulsanti attualmente presenti nel controllo Toolbar.

```
int GetButtonCount() const;
```

### <a name="return-value"></a>Valore restituito

Conteggio dei pulsanti.

## <a name="ctoolbarctrlgetbuttoninfo"></a><a name="getbuttoninfo"></a> CToolBarCtrl:: GetButtonInfo

Recupera le informazioni per un pulsante in una barra degli strumenti.

```
int GetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi) const;
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore del pulsante.

*ptbbi*<br/>
Puntatore a una struttura [TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow) che riceve le informazioni sul pulsante.

### <a name="return-value"></a>Valore restituito

Indice in base zero del pulsante, se ha esito positivo; in caso contrario,-1.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_GETBUTTONINFO](/windows/win32/Controls/tb-getbuttoninfo)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlgetbuttonsize"></a><a name="getbuttonsize"></a> CToolBarCtrl:: GetButtonSize

Ottiene le dimensioni di un pulsante della barra degli strumenti.

```
DWORD GetButtonSize() const;
```

### <a name="return-value"></a>Valore restituito

Valore DWORD che contiene rispettivamente i valori di larghezza e altezza in LOWORD e HIWORD.

## <a name="ctoolbarctrlgetbuttontext"></a><a name="getbuttontext"></a> CToolBarCtrl:: GetButtonText

Recupera il testo visualizzato di un pulsante specificato sul controllo toolbar corrente.

```
CString GetButtonText(int idButton) const;
```

### <a name="parameters"></a>Parametri

*idButton*\
in Identificatore del pulsante il cui testo visualizzato viene recuperato.

### <a name="return-value"></a>Valore restituito

Oggetto [CString](../../atl-mfc-shared/using-cstring.md) che contiene il testo visualizzato del pulsante specificato.

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TB_GETBUTTONTEXT](/windows/win32/Controls/tb-getbuttontext) , descritto nel Windows SDK.

## <a name="ctoolbarctrlgetcolorscheme"></a><a name="getcolorscheme"></a> CToolBarCtrl:: GetColorScheme

Recupera la combinazione di colori del controllo toolbar corrente.

```
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;
```

### <a name="parameters"></a>Parametri

*lpColorScheme*\
out Puntatore a una struttura [ColorScheme](/windows/win32/api/commctrl/ns-commctrl-colorscheme) che riceve le informazioni sulla combinazione di colori. Quando questo metodo restituisce, la struttura descrive il colore di evidenziazione e il colore dell'ombreggiatura del controllo Toolbar.

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TB_GETCOLORSCHEME](/windows/win32/Controls/tb-getcolorscheme) , descritto nel Windows SDK.

## <a name="ctoolbarctrlgetdisabledimagelist"></a><a name="getdisabledimagelist"></a> CToolBarCtrl:: GetDisabledImageList

Recupera l'elenco di immagini utilizzato da un controllo Toolbar per visualizzare i pulsanti disabilitati.

```
CImageList* GetDisabledImageList() const;
```

### <a name="return-value"></a>Valore restituito

Puntatore a un oggetto [CImageList](../../mfc/reference/cimagelist-class.md) o null se non è impostato alcun elenco di immagini disabilitato.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_GETDISABLEDIMAGELIST](/windows/win32/Controls/tb-getdisabledimagelist)del messaggio Win32, come descritto nel Windows SDK. L'implementazione MFC di `GetDisabledImageList` Usa un `CImageList` oggetto contenente le immagini dei pulsanti del controllo Toolbar, anziché un handle per un elenco di immagini.

## <a name="ctoolbarctrlgetdroptarget"></a><a name="getdroptarget"></a> CToolBarCtrl:: GetDropTarget

Recupera l'interfaccia [IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) per un controllo Toolbar.

```
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;
```

### <a name="parameters"></a>Parametri

*ppDropTarget*<br/>
Puntatore a un puntatore di interfaccia [IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) . Se si verifica un errore, in questo indirizzo viene inserito un puntatore NULL.

### <a name="return-value"></a>Valore restituito

Restituisce un valore HRESULT che indica l'esito positivo o negativo dell'operazione.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_GETOBJECT](/windows/win32/Controls/tb-getobject)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlgetextendedstyle"></a><a name="getextendedstyle"></a> CToolBarCtrl:: GetExtendedStyle

Recupera gli stili estesi per un controllo Toolbar.

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>Valore restituito

Valore DWORD che rappresenta gli stili estesi attualmente in uso per il controllo Toolbar. Per un elenco di stili, vedere [stili estesi della barra degli strumenti](/windows/win32/Controls/toolbar-extended-styles)nel Windows SDK.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_GETEXTENDEDSTYLE](/windows/win32/Controls/tb-getextendedstyle)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlgethotimagelist"></a><a name="gethotimagelist"></a> CToolBarCtrl:: GetHotImageList

Recupera l'elenco di immagini utilizzato da un controllo Toolbar per visualizzare i pulsanti "Hot". Un pulsante attivo appare evidenziato quando il puntatore del mouse si trova sopra di esso.

```
CImageList* GetHotImageList() const;
```

### <a name="return-value"></a>Valore restituito

Puntatore a un oggetto [CImageList](../../mfc/reference/cimagelist-class.md) o null se non è impostato alcun elenco di immagini disabilitato.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_GETHOTIMAGELIST](/windows/win32/Controls/tb-gethotimagelist)del messaggio Win32, come descritto nel Windows SDK. Un pulsante attivo appare evidenziato quando il puntatore del mouse si trova sopra di esso.

## <a name="ctoolbarctrlgethotitem"></a><a name="gethotitem"></a> CToolBarCtrl:: GetHotItem

Recupera l'indice dell'elemento attivo in una barra degli strumenti.

```
int GetHotItem() const;
```

### <a name="return-value"></a>Valore restituito

Indice in base zero dell'elemento attivo in una barra degli strumenti.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_GETHOTITEM](/windows/win32/Controls/tb-gethotitem)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlgetimagelist"></a><a name="getimagelist"></a> CToolBarCtrl:: GetImages

Recupera l'elenco di immagini utilizzato da un controllo Toolbar per visualizzare i pulsanti nello stato predefinito.

```
CImageList* GetImageList() const;
```

### <a name="return-value"></a>Valore restituito

Puntatore a un oggetto [CImageList](../../mfc/reference/cimagelist-class.md) o null se non è impostato alcun elenco di immagini.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_GETIMAGELIST](/windows/win32/Controls/tb-getimagelist)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlgetinsertmark"></a><a name="getinsertmark"></a> CToolBarCtrl:: GetInsertMark

Recupera il segno di inserimento corrente per la barra degli strumenti.

```cpp
void GetInsertMark(TBINSERTMARK* ptbim) const;
```

### <a name="parameters"></a>Parametri

*ptbim*<br/>
Puntatore a una struttura [TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark) che riceve il segno di inserimento.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_GETINSERTMARK](/windows/win32/Controls/tb-getinsertmark)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a> CToolBarCtrl:: GetInsertMarkColor

Recupera il colore utilizzato per tracciare il segno di inserimento per la barra degli strumenti.

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>Valore restituito

Valore COLORREF che contiene il colore del segno di inserimento corrente.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_GETINSERTMARKCOLOR](/windows/win32/Controls/tb-getinsertmarkcolor)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlgetitemrect"></a><a name="getitemrect"></a> CToolBarCtrl:: GetItemRect

Recupera il rettangolo di delimitazione di un pulsante in un controllo Toolbar.

```
BOOL GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Parametri

*nIndex*<br/>
Indice in base zero del pulsante per il quale recuperare le informazioni.

*lpRect*<br/>
Indirizzo di una struttura [Rect](/windows/win32/api/windef/ns-windef-rect) o di un oggetto [CRect](../../atl-mfc-shared/reference/crect-class.md) che riceve le coordinate del rettangolo di delimitazione.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questa funzione non recupera il rettangolo di delimitazione per i pulsanti il cui stato è impostato su TBSTATE_HIDDEN.

## <a name="ctoolbarctrlgetmaxsize"></a><a name="getmaxsize"></a> CToolBarCtrl:: GetMaxSize

Recupera la dimensione totale di tutti i pulsanti e i separatori visibili nella barra degli strumenti.

```
BOOL GetMaxSize(LPSIZE pSize) const;
```

### <a name="parameters"></a>Parametri

*pSize*<br/>
Puntatore a una struttura di [dimensioni](/windows/win32/api/windef/ns-windef-size) che riceve le dimensioni degli elementi.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_GETMAXSIZE](/windows/win32/Controls/tb-getmaxsize)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlgetmaxtextrows"></a><a name="getmaxtextrows"></a> CToolBarCtrl:: GetMaxTextRows

Recupera il numero massimo di righe di testo visualizzate su un pulsante della barra degli strumenti.

```
int GetMaxTextRows() const;
```

### <a name="return-value"></a>Valore restituito

Numero massimo di righe di testo visualizzate su un pulsante della barra degli strumenti.

## <a name="ctoolbarctrlgetmetrics"></a><a name="getmetrics"></a> CToolBarCtrl:: GetMetrics

Recupera le metriche dell' `CToolBarCtrl` oggetto.

```cpp
void GetMetrics(LPTBMETRICS ptbm) const;
```

### <a name="parameters"></a>Parametri

*ptbm*<br/>
Puntatore alla struttura [TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics) dell' `CToolBarCtrl` oggetto.

### <a name="remarks"></a>Commenti

Questa funzione membro emula la funzionalità del messaggio di [TB_GETMETRICS](/windows/win32/Controls/tb-getmetrics) , come descritto nel Windows SDK.

## <a name="ctoolbarctrlgetpadding"></a><a name="getpadding"></a> CToolBarCtrl:: getpadding

Recupera la spaziatura interna orizzontale e verticale del controllo toolbar corrente.

```
BOOL GetPadding(
    int* pnHorzPadding,
    int* pnVertPadding) const;
```

### <a name="parameters"></a>Parametri

*pnHorzPadding*\
out Intero che riceve la spaziatura interna orizzontale del controllo barra degli strumenti, in pixel.

*pnVertPadding*\
out Intero che riceve la spaziatura interna verticale del controllo della barra degli strumenti, in pixel.

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TB_GETPADDING](/windows/win32/Controls/tb-getpadding) , descritto nel Windows SDK.

## <a name="ctoolbarctrlgetpressedimagelist"></a><a name="getpressedimagelist"></a> CToolBarCtrl:: GetPressedImageList

Recupera l'elenco di immagini utilizzato dal controllo toolbar corrente per rappresentare i pulsanti nello stato premuto.

```
CImageList* GetPressedImageList();
```

### <a name="return-value"></a>Valore restituito

Puntatore a un [CImageList](../../mfc/reference/cimagelist-class.md) che contiene l'elenco di immagini per il controllo corrente o null se non è impostato alcun elenco di immagini di questo tipo.

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TB_GETPRESSEDIMAGELIST](/windows/win32/Controls/tb-getpressedimagelist) , descritto nel Windows SDK.

## <a name="ctoolbarctrlgetrect"></a><a name="getrect"></a> CToolBarCtrl:: GetRect

Recupera il rettangolo di delimitazione per un pulsante della barra degli strumenti specificato.

```
BOOL GetRect(
    int nID,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore del pulsante.

*lpRect*<br/>
Puntatore a una struttura [Rect](/windows/win32/api/windef/ns-windef-rect) per ricevere le informazioni sul rettangolo di delimitazione.

### <a name="return-value"></a>Valore restituito

TRUE se l'operazione riesce; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_GETRECT](/windows/win32/Controls/tb-getrect)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlgetrows"></a><a name="getrows"></a> CToolBarCtrl:: GetRows

Recupera il numero di righe di pulsanti attualmente visualizzati dal controllo Toolbar.

```
int GetRows() const;
```

### <a name="return-value"></a>Valore restituito

Numero di righe di pulsanti attualmente visualizzate sulla barra degli strumenti.

### <a name="remarks"></a>Commenti

Si noti che il numero di righe sarà sempre uno, a meno che la barra degli strumenti non sia stata creata con lo stile TBSTYLE_WRAPABLE.

## <a name="ctoolbarctrlgetstate"></a><a name="getstate"></a> CToolBarCtrl:: GetState

Recupera le informazioni sullo stato del pulsante specificato in un controllo Toolbar, ad esempio se è abilitato, premuto o selezionato.

```
int GetState(int nID) const;
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore di comando del pulsante per il quale recuperare le informazioni.

### <a name="return-value"></a>Valore restituito

Informazioni sullo stato dei pulsanti in caso di esito positivo o-1 in caso contrario. Le informazioni sullo stato del pulsante possono essere una combinazione dei valori elencati in [CToolBarCtrl:: AddButtons](#addbuttons).

### <a name="remarks"></a>Commenti

Questa funzione è particolarmente utile se si desidera recuperare più di uno degli Stati dei pulsanti. Per recuperare solo uno stato, usare una delle funzioni membro seguenti: [IsButtonEnabled](#isbuttonenabled), [IsButtonChecked](#isbuttonchecked), [IsButtonPressed](#isbuttonpressed), [IsButtonHidden](#isbuttonhidden)o [IsButtonIndeterminate](#isbuttonindeterminate). Tuttavia, la `GetState` funzione membro è l'unico modo per rilevare lo stato del pulsante TBSTATE_WRAP.

## <a name="ctoolbarctrlgetstring"></a><a name="getstring"></a> CToolBarCtrl:: GetString

Recupera una stringa della barra degli strumenti.

```
int GetString(
    int nString,
    LPTSTR lpstrString,
    int cchMaxLen) const;

int GetString(
    int nString,
    CString& str) const;
```

### <a name="parameters"></a>Parametri

*nString*<br/>
Indice della stringa.

*lpstrString*<br/>
Puntatore a un buffer utilizzato per restituire la stringa.

*cchMaxLen*<br/>
Lunghezza del buffer in byte.

*str*<br/>
Stringa.

### <a name="return-value"></a>Valore restituito

Lunghezza della stringa in caso di esito positivo,-1 in caso contrario.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_GETSTRING](/windows/win32/Controls/tb-getstring)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlgetstyle"></a><a name="getstyle"></a> CToolBarCtrl:: GetStyle

Ottiene gli stili attualmente applicati a un controllo Toolbar.

```
DWORD GetStyle() const;
```

### <a name="return-value"></a>Valore restituito

DWORD che contiene una combinazione di [stili di controllo della barra degli strumenti](/windows/win32/Controls/toolbar-control-and-button-styles), come descritto nell'Windows SDK.

## <a name="ctoolbarctrlgettooltips"></a><a name="gettooltips"></a> CToolBarCtrl:: GetToolTips

Recupera l'handle del controllo ToolTip, se presente, associato al controllo Toolbar.

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>Valore restituito

Puntatore all'oggetto [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) associato a questa barra degli strumenti o null se alla barra degli strumenti non è associato alcun controllo ToolTip.

### <a name="remarks"></a>Commenti

Poiché il controllo Toolbar normalmente crea e gestisce il proprio controllo ToolTip, la maggior parte dei programmi non deve chiamare questa funzione.

## <a name="ctoolbarctrlhittest"></a><a name="hittest"></a> CToolBarCtrl:: HitTest

Determina se un punto si trova in un controllo Toolbar.

```
int HitTest(LPPOINT ppt) const;
```

### <a name="parameters"></a>Parametri

*PPT*<br/>
Puntatore a una struttura di [punti](/windows/win32/api/windef/ns-windef-point) che contiene la coordinata x dell'hit test nel `x` membro e la coordinata y dell'hit test nel `y` membro. Le coordinate sono relative all'area client della barra degli strumenti.

### <a name="return-value"></a>Valore restituito

Valore intero che indica la posizione di un punto su una barra degli strumenti. Se il valore è zero o un valore positivo, questo valore restituito è l'indice in base zero dell'elemento non separatore in cui si trova il punto.

Se il valore restituito è negativo, il punto non si trova all'interno di un pulsante. Il valore assoluto del valore restituito è l'indice di un elemento separatore o l'elemento non separatore più vicino.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_HITTEST](/windows/win32/Controls/tb-hittest)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlhidebutton"></a><a name="hidebutton"></a> CToolBarCtrl:: HideButton

Nasconde o Mostra il pulsante specificato in un controllo Toolbar.

```
BOOL HideButton(
    int nID,
    BOOL bHide = TRUE);
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore di comando del pulsante da nascondere o mostrare.

*bHide*<br/>
TRUE per nascondere il pulsante, FALSE per visualizzarlo.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Se si desidera modificare più di uno stato di un pulsante, provare a chiamare [sestate](#setstate) .

## <a name="ctoolbarctrlindeterminate"></a><a name="indeterminate"></a> CToolBarCtrl:: indeterminato

Imposta o cancella lo stato indeterminato del pulsante specificato in un controllo Toolbar.

```
BOOL Indeterminate(
    int nID,
    BOOL bIndeterminate = TRUE);
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore di comando del pulsante di cui è necessario impostare o deselezionare lo stato indeterminato.

*bIndeterminate*<br/>
TRUE per impostare lo stato indeterminato per il pulsante specificato, FALSE per cancellarlo.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

I pulsanti indeterminati vengono visualizzati in grigio, ad esempio la modalità di ricerca del pulsante grassetto sulla barra degli strumenti di un elaboratore di testo quando il testo selezionato contiene caratteri in grassetto e normali. Se si desidera modificare più di uno stato di un pulsante, provare a chiamare [sestate](#setstate) .

## <a name="ctoolbarctrlinsertbutton"></a><a name="insertbutton"></a> CToolBarCtrl:: InsertButton

Inserisce un pulsante in un controllo Toolbar.

```
BOOL InsertButton(
    int nIndex,
    LPTBBUTTON lpButton);
```

### <a name="parameters"></a>Parametri

*nIndex*<br/>
Indice in base zero di un pulsante. Questa funzione inserisce il pulsante nuovo a sinistra di questo pulsante.

*lpButton*<br/>
Indirizzo di una `TBBUTTON` struttura contenente informazioni sul pulsante da inserire. Per una descrizione della struttura, vedere [CToolBarCtrl:: AddButtons](#addbuttons) `TBBUTTON` .

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

L'immagine e/o la stringa il cui indice è stato fornito devono essere stati aggiunti in precedenza all'elenco del controllo Toolbar usando [AddBitmap](#addbitmap), [AddString](#addstring)e/o [AddStrings](#addstrings).

## <a name="ctoolbarctrlinsertmarkhittest"></a><a name="insertmarkhittest"></a> CToolBarCtrl:: InsertMarkHitTest

Recupera le informazioni sul segno di inserimento per un punto in una barra degli strumenti.

```
BOOL InsertMarkHitTest(
    LPPOINT ppt,
    LPTBINSERTMARK ptbim) const;
```

### <a name="parameters"></a>Parametri

*PPT*<br/>
Puntatore a una struttura di [punti](/windows/win32/api/windef/ns-windef-point) che contiene le coordinate dell'hit test rispetto all'area client della barra degli strumenti.

*ptbim*<br/>
Puntatore a una struttura [TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark) che riceve le informazioni sul segno di inserimento.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_INSERTMARKHITTEST](/windows/win32/Controls/tb-insertmarkhittest)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlisbuttonchecked"></a><a name="isbuttonchecked"></a> CToolBarCtrl:: IsButtonChecked

Determina se il pulsante specificato in un controllo Toolbar è selezionato.

```
BOOL IsButtonChecked(int nID) const;
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore del comando del pulsante sulla barra degli strumenti.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante è selezionato; in caso contrario, zero.

### <a name="remarks"></a>Commenti

Prendere in considerazione la chiamata a [GetState](#getstate) se si desidera recuperare più di uno stato del pulsante.

## <a name="ctoolbarctrlisbuttonenabled"></a><a name="isbuttonenabled"></a> CToolBarCtrl:: IsButtonEnabled

Determina se il pulsante specificato in un controllo Toolbar è abilitato.

```
BOOL IsButtonEnabled(int nID) const;
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore del comando del pulsante sulla barra degli strumenti.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante è abilitato; in caso contrario, zero.

### <a name="remarks"></a>Commenti

Prendere in considerazione la chiamata a [GetState](#getstate) se si desidera recuperare più di uno stato del pulsante.

## <a name="ctoolbarctrlisbuttonhidden"></a><a name="isbuttonhidden"></a> CToolBarCtrl:: IsButtonHidden

Determina se il pulsante specificato in un controllo Toolbar è nascosto.

```
BOOL IsButtonHidden(int nID) const;
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore del comando del pulsante sulla barra degli strumenti.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante è nascosto; in caso contrario, zero.

### <a name="remarks"></a>Commenti

Prendere in considerazione la chiamata a [GetState](#getstate) se si desidera recuperare più di uno stato del pulsante.

## <a name="ctoolbarctrlisbuttonhighlighted"></a><a name="isbuttonhighlighted"></a> CToolBarCtrl:: IsButtonHighlighted

Controlla lo stato di evidenziazione di un pulsante della barra degli strumenti.

```
BOOL IsButtonHighlighted(int nID) const;
```

### <a name="parameters"></a>Parametri

*nID*<br/>
in ID del comando per il pulsante della barra degli strumenti.

### <a name="return-value"></a>Valore restituito

Numero intero positivo se il pulsante è evidenziato, 0 se il pulsante non è evidenziato oppure-1 se si verifica un errore.

## <a name="ctoolbarctrlisbuttonindeterminate"></a><a name="isbuttonindeterminate"></a> CToolBarCtrl:: IsButtonIndeterminate

Determina se il pulsante specificato in un controllo Toolbar è indeterminato.

```
BOOL IsButtonIndeterminate(int nID) const;
```

### <a name="parameters"></a>Parametri

*nID*<br/>
in Identificatore del comando del pulsante sulla barra degli strumenti.

### <a name="return-value"></a>Valore restituito

Numero intero positivo se il pulsante è indeterminato, zero se il pulsante non è indeterminato, oppure-1 se si verifica un errore.

### <a name="remarks"></a>Commenti

I pulsanti indeterminati vengono visualizzati in grigio, ad esempio la modalità di visualizzazione del pulsante in grassetto sulla barra degli strumenti di un elaboratore di testo quando il testo selezionato contiene caratteri in grassetto e normali. Prendere in considerazione la chiamata a [GetState](#getstate) se si desidera recuperare più di uno stato del pulsante.

## <a name="ctoolbarctrlisbuttonpressed"></a><a name="isbuttonpressed"></a> CToolBarCtrl:: IsButtonPressed

Determina se viene premuto il pulsante specificato in un controllo Toolbar.

```
BOOL IsButtonPressed(int nID) const;
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore del comando del pulsante sulla barra degli strumenti.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante è premuto; in caso contrario, zero.

### <a name="remarks"></a>Commenti

Prendere in considerazione la chiamata a [GetState](#getstate) se si desidera recuperare più di uno stato del pulsante.

## <a name="ctoolbarctrlloadimages"></a><a name="loadimages"></a> CToolBarCtrl:: LoadImages

Carica le bitmap nell'elenco immagini di un controllo Toolbar.

```cpp
void LoadImages(
    int iBitmapID,
    HINSTANCE hinst);
```

### <a name="parameters"></a>Parametri

*iBitmapID*<br/>
ID di una bitmap contenente le immagini da caricare. Per specificare una risorsa bitmap personalizzata, impostare questo parametro sull'ID di una risorsa bitmap e impostare *hInst* su null. La risorsa bitmap verrà aggiunta all'elenco di immagini come una singola immagine. È possibile aggiungere bitmap standard definite dal sistema impostando *hInst* su HINST_COMMCTRL e impostando questo parametro su uno degli ID seguenti:

|ID bitmap|Description|
|---------------|-----------------|
|IDB_HIST_LARGE_COLOR|Bitmap di Esplora risorse di grandi dimensioni|
|IDB_HIST_SMALL_COLOR|Bitmap di Esplora risorse di piccole dimensioni|
|IDB_STD_LARGE_COLOR|Bitmap standard di grandi dimensioni|
|IDB_STD_SMALL_COLOR|Bitmap standard in dimensioni ridotte|
|IDB_VIEW_LARGE_COLOR|Visualizzare bitmap di grandi dimensioni|
|IDB_VIEW_SMALL_COLOR|Visualizza bitmap di dimensioni ridotte|

*hInst*<br/>
Handle dell'istanza di programma per l'applicazione chiamante. Questo parametro può essere HINST_COMMCTRL per caricare un elenco di immagini standard.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_LOADIMAGES](/windows/win32/Controls/tb-loadimages)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlmapaccelerator"></a><a name="mapaccelerator"></a> CToolBarCtrl:: MapAccelerator

Esegue il mapping di un carattere acceleratore a un pulsante della barra degli strumenti.

```
BOOL MapAccelerator(
    TCHAR chAccel,
    UINT* pIDBtn);
```

### <a name="parameters"></a>Parametri

*chAccel*<br/>
Carattere di accelerazione da mappare. Questo carattere è lo stesso carattere sottolineato nel testo del pulsante.

*pIDBtn*<br/>
Puntatore a un UINT che riceve l'identificatore di comando del pulsante che corrisponde all'acceleratore specificato in *chAccel*.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_MAPACCELERATOR](/windows/win32/Controls/tb-mapaccelerator)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlmarkbutton"></a><a name="markbutton"></a> CToolBarCtrl:: MarkButton

Imposta lo stato di evidenziazione di un pulsante specificato in un controllo Toolbar.

```
BOOL MarkButton(
    int nID,
    BOOL fHighlight = TRUE);
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore del pulsante.

*fHighlight*<br/>
Specifica lo stato di evidenziazione da impostare. Per impostazione predefinita, TRUE. Se è impostato su FALSE, il pulsante viene impostato sullo stato predefinito.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_MARKBUTTON](/windows/win32/Controls/tb-markbutton)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlmovebutton"></a><a name="movebutton"></a> CToolBarCtrl:: MoveButton

Sposta un pulsante da un indice a un altro.

```
BOOL MoveButton(
    UINT nOldPos,
    UINT nNewPos);
```

### <a name="parameters"></a>Parametri

*nOldPos*<br/>
Indice in base zero del pulsante da spostare.

*nNewPos*<br/>
Indice in base zero della destinazione del pulsante.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_MOVEBUTTON](/windows/win32/Controls/tb-movebutton)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlpressbutton"></a><a name="pressbutton"></a> CToolBarCtrl::P ressButton

Preme o rilascia il pulsante specificato in un controllo Toolbar.

```
BOOL PressButton(int nID, BOOL bPress = TRUE);
```

### <a name="parameters"></a>Parametri

*nID*<br/>
in Identificatore di comando del pulsante da premere o rilasciare.

*BPremere*<br/>
in TRUE per premere il pulsante specificato; FALSE per rilasciare il pulsante specificato. Il valore predefinito è TRUE.

### <a name="return-value"></a>Valore restituito

TRUE se il metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Se si desidera modificare più di uno stato di un pulsante, provare a chiamare [sestate](#setstate) .

Questo metodo invia il messaggio di [TB_PRESSBUTTON](/windows/win32/Controls/tb-pressbutton) , descritto nel Windows SDK.

## <a name="ctoolbarctrlreplacebitmap"></a><a name="replacebitmap"></a> CToolBarCtrl:: ReplaceBitmap

Sostituisce la bitmap esistente nel controllo toolbar corrente con una nuova bitmap.

```
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```

### <a name="parameters"></a>Parametri

*pReplaceBitmap*\
in Puntatore a una struttura [TBREPLACEBITMAP](/windows/win32/api/commctrl/ns-commctrl-tbreplacebitmap) che descrive la bitmap da sostituire e la nuova bitmap.

### <a name="return-value"></a>Valore restituito

TRUE se questo metodo ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TB_REPLACEBITMAP](/windows/win32/Controls/tb-replacebitmap) , descritto nel Windows SDK.

### <a name="example"></a>Esempio

Nell'esempio di codice seguente viene sostituita la bitmap per la barra degli strumenti standard con un'altra bitmap.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]

## <a name="ctoolbarctrlrestorestate"></a><a name="restorestate"></a> CToolBarCtrl:: RestoreState

Ripristina lo stato del controllo Toolbar dalla posizione nel registro di sistema specificato dai parametri.

```cpp
void RestoreState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>Parametri

*hKeyRoot*<br/>
Identifica una chiave attualmente aperta nel registro di sistema o uno dei valori di handle riservati predefiniti seguenti:

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
Punta a una stringa con terminazione null contenente il nome della sottochiave a cui è associato un valore. Questo parametro può essere null o un puntatore a una stringa vuota. Se il parametro è NULL, il valore verrà aggiunto alla chiave identificata dal parametro *hKeyRoot* .

*lpszValueName*<br/>
Punta a una stringa che contiene il nome del valore da recuperare. Se un valore con questo nome non è già presente nella chiave, la funzione lo aggiunge alla chiave.

## <a name="ctoolbarctrlsavestate"></a><a name="savestate"></a> CToolBarCtrl:: SaveState

Salva lo stato del controllo Toolbar nella posizione del registro di sistema specificato dai parametri.

```cpp
void SaveState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>Parametri

*hKeyRoot*<br/>
Identifica una chiave attualmente aperta nel registro di sistema o uno dei valori di handle riservati predefiniti seguenti:

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
Punta a una stringa con terminazione null contenente il nome della sottochiave a cui è associato un valore. Questo parametro può essere null o un puntatore a una stringa vuota. Se il parametro è NULL, il valore verrà aggiunto alla chiave identificata dal parametro *hKeyRoot* .

*lpszValueName*<br/>
Punta a una stringa che contiene il nome del valore da impostare. Se un valore con questo nome non è già presente nella chiave, la funzione lo aggiunge alla chiave.

## <a name="ctoolbarctrlsetanchorhighlight"></a><a name="setanchorhighlight"></a> CToolBarCtrl:: SetAnchorHighlight

Imposta l'impostazione dell'evidenziazione di ancoraggio per una barra degli strumenti.

```
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```

### <a name="parameters"></a>Parametri

*fAnchor*<br/>
in Specifica se l'evidenziazione dell'ancoraggio è abilitata o disabilitata. Se questo valore è diverso da zero, verrà abilitata l'evidenziazione dell'ancoraggio. Se questo valore è zero, l'evidenziazione dell'ancoraggio verrà disabilitata

### <a name="return-value"></a>Valore restituito

Impostazione di ancoraggio precedente. Se è stata abilitata l'evidenziazione, questo valore è diverso da zero. Se l'evidenziazione non è abilitata, questo valore è zero.

### <a name="remarks"></a>Commenti

Questo metodo implementa il comportamento del [TB_SETANCHORHIGHLIGHT](/windows/win32/Controls/tb-setanchorhighlight)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlsetbitmapsize"></a><a name="setbitmapsize"></a> CToolBarCtrl:: SetBitmapSize

Imposta la dimensione delle immagini bitmap effettive da aggiungere a un controllo Toolbar.

```
BOOL SetBitmapSize(CSize size);
```

### <a name="parameters"></a>Parametri

*size*<br/>
Larghezza e altezza, in pixel, delle immagini bitmap.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questa funzione deve essere chiamata solo prima di aggiungere bitmap alla barra degli strumenti. Se l'applicazione non imposta in modo esplicito le dimensioni della bitmap, il valore predefinito è 16 per 15 pixel.

## <a name="ctoolbarctrlsetbuttoninfo"></a><a name="setbuttoninfo"></a> CToolBarCtrl:: SetButtonInfo

Imposta le informazioni per un pulsante esistente in una barra degli strumenti.

```
BOOL SetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi);
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore del pulsante.

*ptbbi*<br/>
Puntatore a una struttura [TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow) che riceve le informazioni sul pulsante.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

La funzione membro implementa il comportamento del messaggio Win32 [TB_SETBUTTONINFO](/windows/win32/Controls/tb-setbuttoninfo), come descritto nel Windows SDK.

## <a name="ctoolbarctrlsetbuttonsize"></a><a name="setbuttonsize"></a> CToolBarCtrl:: SetButtonSize

Imposta la dimensione dei pulsanti nel controllo Toolbar.

```
BOOL SetButtonSize(CSize size);
```

### <a name="parameters"></a>Parametri

*size*<br/>
Larghezza e altezza, in pixel, dei pulsanti.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

È necessario che le dimensioni del pulsante siano sempre almeno pari alle dimensioni della bitmap che racchiude. Questa funzione deve essere chiamata solo prima di aggiungere bitmap alla barra degli strumenti. Se l'applicazione non imposta in modo esplicito le dimensioni del pulsante, il valore predefinito è 24 per 22 pixel.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CToolBar:: GetToolBarCtrl](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl).

## <a name="ctoolbarctrlsetbuttonstructsize"></a><a name="setbuttonstructsize"></a> CToolBarCtrl:: SetButtonStructSize

Specifica le dimensioni della `TBBUTTON` struttura.

```cpp
void SetButtonStructSize(int nSize);
```

### <a name="parameters"></a>Parametri

*nSize*<br/>
Dimensione, in byte, della `TBBUTTON` struttura.

### <a name="remarks"></a>Commenti

Se si desidera archiviare dati aggiuntivi nella `TBBUTTON` struttura, è possibile derivare una nuova struttura da `TBBUTTON` , aggiungere i membri necessari o creare una nuova struttura contenente una `TBBUTTON` struttura come primo membro. Si chiamerà quindi questa funzione per indicare alla barra degli strumenti di controllare le dimensioni della nuova struttura.

Per ulteriori informazioni sulla struttura, vedere [CToolBarCtrl:: AddButtons](#addbuttons) `TBBUTTON` .

## <a name="ctoolbarctrlsetbuttonwidth"></a><a name="setbuttonwidth"></a> CToolBarCtrl:: SetButtonWidth

Imposta le larghezze minime e massime del pulsante nel controllo Toolbar.

```
BOOL SetButtonWidth(
    int cxMin,
    int cxMax);
```

### <a name="parameters"></a>Parametri

*cxMin*<br/>
Larghezza minima del pulsante, in pixel. I pulsanti della barra degli strumenti non saranno mai più stretti di questo valore.

*cxMax*<br/>
Larghezza massima del pulsante, in pixel. Se il testo del pulsante è troppo ampio, il controllo lo Visualizza con puntini di sospensione.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_SETBUTTONWIDTH](/windows/win32/Controls/tb-setbuttonwidth)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlsetcmdid"></a><a name="setcmdid"></a> CToolBarCtrl:: SetCmdID

Imposta l'identificatore di comando che verrà inviato alla finestra proprietaria quando viene premuto il pulsante specificato.

```
BOOL SetCmdID(
    int nIndex,
    UINT nID);
```

### <a name="parameters"></a>Parametri

*nIndex*<br/>
Indice in base zero del pulsante di cui è necessario impostare l'ID di comando.

*nID*<br/>
ID del comando su cui impostare il pulsante selezionato.

### <a name="return-value"></a>Valore restituito

Restituisce un valore diverso da zero se ha esito positivo; in caso contrario, zero.

## <a name="ctoolbarctrlsetcolorscheme"></a><a name="setcolorscheme"></a> CToolBarCtrl:: SetColorScheme

Imposta la combinazione di colori del controllo toolbar corrente.

```cpp
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```

### <a name="parameters"></a>Parametri

*lpColorScheme*\
in Puntatore a una struttura [ColorScheme](/windows/win32/api/commctrl/ns-commctrl-colorscheme) che descrive il colore di evidenziazione e il colore dell'ombreggiatura del controllo Toolbar.

### <a name="remarks"></a>Commenti

Questo metodo non ha effetto se è impostato un tema visivo di Windows Vista.

Questo metodo invia il messaggio di [TB_SETCOLORSCHEME](/windows/win32/Controls/tb-setcolorscheme) , descritto nel Windows SDK.

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito viene impostata la combinazione di colori per il controllo toolbar corrente. Nell'esempio di codice i bordi sinistro e superiore di ogni pulsante dello strumento sono rossi e i bordi destro e inferiore blu. Quando l'utente preme il pulsante, i bordi rossi del pulsante diventano blu e i bordi blu diventano rossi.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]

## <a name="ctoolbarctrlsetdisabledimagelist"></a><a name="setdisabledimagelist"></a> CToolBarCtrl:: SetDisabledImageList

Imposta l'elenco di immagini che il controllo toolbar utilizzerà per visualizzare i pulsanti disabilitati.

```
CImageList* SetDisabledImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Parametri

*pImageList*<br/>
Puntatore a un `CImageList` oggetto contenente le immagini che devono essere utilizzate dal controllo Toolbar per visualizzare le immagini dei pulsanti disabilitati.

### <a name="return-value"></a>Valore restituito

Puntatore a un oggetto [CImageList](../../mfc/reference/cimagelist-class.md) usato in precedenza dal controllo Toolbar per visualizzare le immagini dei pulsanti disabilitati.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_SETDISABLEDIMAGELIST](/windows/win32/Controls/tb-setdisabledimagelist)del messaggio Win32, come descritto nel Windows SDK. L'implementazione MFC di `SetDisabledImageList` Usa un `CImageList` oggetto contenente le immagini dei pulsanti disabilitati del controllo Toolbar, anziché un handle per un elenco di immagini.

## <a name="ctoolbarctrlsetdrawtextflags"></a><a name="setdrawtextflags"></a> CToolBarCtrl:: SetDrawTextFlags

Imposta i flag nella funzione Win32 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext), che viene utilizzata per creare il testo nel rettangolo specificato, formattato in base alla modalità di impostazione dei flag.

```
DWORD SetDrawTextFlags(
    DWORD dwMask,
    DWORD dwDTFlags);
```

### <a name="parameters"></a>Parametri

*dwMask*<br/>
Combinazione di uno o più flag di DT_, specificati nella funzione Win32 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext), che indica i bit in *dwDTFlags* che verranno utilizzati durante il disegno del testo.

*dwDTFlags*<br/>
Combinazione di uno o più flag di DT_, specificati nella funzione Win32 `DrawText` , che indicano come verrà disegnato il testo del pulsante. Questo valore viene passato a `DrawText` quando viene disegnato il testo del pulsante.

### <a name="return-value"></a>Valore restituito

Valore DWORD contenente i flag di disegno del testo precedenti.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_SETDRAWTEXTFLAGS](/windows/win32/Controls/tb-setdrawtextflags)del messaggio Win32, come descritto nel Windows SDK. Questa funzione membro imposta i flag nella funzione Win32 `DrawText` , che disegna il testo nel rettangolo specificato, formattato in base alla modalità di impostazione dei flag.

## <a name="ctoolbarctrlsetextendedstyle"></a><a name="setextendedstyle"></a> CToolBarCtrl:: SetExtendedStyle

Imposta gli stili estesi per un controllo Toolbar.

```
DWORD SetExtendedStyle(DWORD dwExStyle);
```

### <a name="parameters"></a>Parametri

*dwExStyle*<br/>
Valore che specifica i nuovi stili estesi. Questo parametro può essere una combinazione degli stili estesi della barra degli strumenti.

### <a name="return-value"></a>Valore restituito

DWORD che rappresenta gli stili estesi precedenti. Per un elenco di stili, vedere [stili estesi della barra degli strumenti](/windows/win32/Controls/toolbar-extended-styles)nel Windows SDK.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_SETEXTENDEDSTYLE](/windows/win32/Controls/tb-setextendedstyle)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlsethotimagelist"></a><a name="sethotimagelist"></a> CToolBarCtrl:: SetHotImageList

Imposta l'elenco di immagini che il controllo toolbar utilizzerà per visualizzare i pulsanti "Hot".

```
CImageList* SetHotImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Parametri

*pImageList*<br/>
Puntatore a un `CImageList` oggetto contenente le immagini che devono essere utilizzate dal controllo Toolbar per visualizzare le immagini dei pulsanti di scelta rapida.

### <a name="return-value"></a>Valore restituito

Puntatore a un oggetto [CImageList](../../mfc/reference/cimagelist-class.md) usato in precedenza dal controllo Toolbar per visualizzare le immagini dei pulsanti di scelta rapida.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_SETHOTIMAGELIST](/windows/win32/Controls/tb-sethotimagelist)del messaggio Win32, come descritto nel Windows SDK.

L'implementazione MFC di `SetHotImageList` Usa un `CImageList` oggetto contenente le immagini dei pulsanti di scelta rapida del controllo Toolbar, anziché un handle per un elenco di immagini. Quando il puntatore si trova sopra, viene visualizzato un pulsante attivo.

## <a name="ctoolbarctrlsethotitem"></a><a name="sethotitem"></a> CToolBarCtrl:: SetHotItem

Imposta l'elemento attivo in una barra degli strumenti.

```
int SetHotItem(int nHot);
```

### <a name="parameters"></a>Parametri

*nHot*<br/>
Numero di indice in base zero dell'elemento che verrà reso attivo. Se questo valore è-1, nessuno degli elementi sarà attivo.

### <a name="return-value"></a>Valore restituito

Indice dell'elemento attivo precedente, oppure-1 se non è presente alcun elemento attivo.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_SETHOTITEM](/windows/win32/Controls/tb-sethotitem)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlsetimagelist"></a><a name="setimagelist"></a> CToolBarCtrl:: seimagine

Imposta l'elenco di immagini che verrà utilizzato dalla barra degli strumenti per visualizzare i pulsanti che si trovano nello stato predefinito.

```
CImageList* SetImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Parametri

*pImageList*<br/>
Puntatore a un `CImageList` oggetto contenente le immagini che devono essere utilizzate dal controllo Toolbar per visualizzare le immagini dei pulsanti nello stato predefinito.

### <a name="return-value"></a>Valore restituito

Puntatore a un oggetto [CImageList](../../mfc/reference/cimagelist-class.md) usato in precedenza dal controllo Toolbar per visualizzare le immagini dei pulsanti nello stato predefinito.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_SETIMAGELIST](/windows/win32/Controls/tb-setimagelist)del messaggio Win32, come descritto nel Windows SDK.

L'implementazione MFC di `SetImageList` Usa un `CImageList` oggetto contenente le immagini dei pulsanti del controllo Toolbar, anziché un handle per un elenco di immagini.

## <a name="ctoolbarctrlsetindent"></a><a name="setindent"></a> CToolBarCtrl:: sedent

Imposta il rientro per il primo pulsante in un controllo Toolbar.

```
BOOL SetIndent(int iIndent);
```

### <a name="parameters"></a>Parametri

*iIndent*<br/>
Valore che specifica il rientro, in pixel.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

## <a name="ctoolbarctrlsetinsertmark"></a><a name="setinsertmark"></a> CToolBarCtrl:: SetInsertMark

Imposta il segno di inserimento corrente per la barra degli strumenti.

```cpp
void SetInsertMark(TBINSERTMARK* ptbim);
```

### <a name="parameters"></a>Parametri

*ptbim*<br/>
Puntatore alla struttura [TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark) che contiene il segno di inserimento.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_SETINSERTMARK](/windows/win32/Controls/tb-setinsertmark)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a> CToolBarCtrl:: SetInsertMarkColor

Imposta il colore utilizzato per creare il segno di inserimento per la barra degli strumenti.

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>Parametri

*clrNew*<br/>
Valore COLORREF che contiene il nuovo colore del segno di inserimento.

### <a name="return-value"></a>Valore restituito

Valore COLORREF che contiene il colore del segno di inserimento precedente.

### <a name="remarks"></a>Commenti

Questa funzione membro implementa il comportamento del [TB_SETINSERTMARKCOLOR](/windows/win32/Controls/tb-setinsertmarkcolor)del messaggio Win32, come descritto nel Windows SDK.

## <a name="ctoolbarctrlsetmaxtextrows"></a><a name="setmaxtextrows"></a> CToolBarCtrl:: SetMaxTextRows

Imposta il numero massimo di righe di testo visualizzate su un pulsante della barra degli strumenti.

```
BOOL SetMaxTextRows(int iMaxRows);
```

### <a name="parameters"></a>Parametri

*iMaxRows*<br/>
Numero massimo di righe da impostare.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

## <a name="ctoolbarctrlsetmetrics"></a><a name="setmetrics"></a> CToolBarCtrl:: semetrics

Imposta le metriche dell' `CToolBarCtrl` oggetto.

```cpp
void SetMetrics(LPTBMETRICS ptbm);
```

### <a name="parameters"></a>Parametri

*ptbm*<br/>
Puntatore alla struttura [TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics) dell' `CToolBarCtrl` oggetto.

### <a name="remarks"></a>Commenti

Questa funzione membro emula la funzionalità del messaggio di [TB_SETMETRICS](/windows/win32/Controls/tb-setmetrics) , come descritto nel Windows SDK.

## <a name="ctoolbarctrlsetowner"></a><a name="setowner"></a> CToolBarCtrl:: SetOwner

Imposta la finestra proprietaria per il controllo Toolbar.

```cpp
void SetOwner(CWnd* pWnd);
```

### <a name="parameters"></a>Parametri

*pWnd*<br/>
Puntatore all' `CWnd` `CWnd` oggetto derivato da o che sarà la nuova finestra proprietaria per il controllo Toolbar.

### <a name="remarks"></a>Commenti

La finestra proprietaria è la finestra che riceve le notifiche dalla barra degli strumenti.

## <a name="ctoolbarctrlsetpadding"></a><a name="setpadding"></a> CToolBarCtrl:: sepadding

Imposta la spaziatura interna orizzontale e verticale del controllo toolbar corrente.

```
DWORD SetPadding(
    int nHorzPadding,
    int nVertPadding);
```

### <a name="parameters"></a>Parametri

*nHorzPadding*\
in Specifica la spaziatura interna orizzontale del controllo barra degli strumenti, in pixel.

*nVertPadding*\
in Specifica la spaziatura verticale del controllo barra degli strumenti, in pixel.

### <a name="return-value"></a>Valore restituito

DWORD la cui parola bassa contiene il valore di riempimento orizzontale precedente e la cui parola alta contiene il valore di riempimento verticale precedente. I valori di spaziatura interna sono misurati in pixel.

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TB_SETPADDING](/windows/win32/Controls/tb-setpadding) , descritto nel Windows SDK.

### <a name="example"></a>Esempio

Nell'esempio di codice seguente la spaziatura orizzontale e verticale del controllo toolbar corrente viene impostata su 20 pixel.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]

## <a name="ctoolbarctrlsetpressedimagelist"></a><a name="setpressedimagelist"></a> CToolBarCtrl:: SetPressedImageList

Imposta l'elenco di immagini utilizzato dal controllo toolbar corrente per rappresentare i pulsanti nello stato premuto.

```
CImagelist* SetPressedImageList(
    int iImageID,
    CImageList* pImageList);
```

### <a name="parameters"></a>Parametri

*iImageID*\
in Indice in base zero dell'elenco di immagini. Se si usa un solo elenco di immagini, impostare questo parametro su zero.

*pImageList*\
in Puntatore a un [CImageList](../../mfc/reference/cimagelist-class.md) che contiene il nuovo elenco di immagini.

### <a name="return-value"></a>Valore restituito

Puntatore a un [CImageList](../../mfc/reference/cimagelist-class.md) che contiene l'elenco di immagini precedente per il controllo corrente o null se non è stato impostato alcun elenco di immagini di questo tipo.

### <a name="remarks"></a>Commenti

Questo metodo invia il messaggio di [TB_SETPRESSEDIMAGELIST](/windows/win32/Controls/tb-setpressedimagelist) , descritto nel Windows SDK.

### <a name="example"></a>Esempio

L'esempio di codice seguente imposta l'elenco di immagini premuto in modo che corrisponda all'elenco di immagini predefinito.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]

## <a name="ctoolbarctrlsetrows"></a><a name="setrows"></a> CToolBarCtrl:: GetRows

Chiede al controllo Toolbar di ridimensionarsi sul numero di righe richiesto.

```cpp
void SetRows(
    int nRows,
    BOOL bLarger,
    LPRECT lpRect);
```

### <a name="parameters"></a>Parametri

*nRows*<br/>
Numero di righe richiesto.

*bLarger*<br/>
Indica se utilizzare più righe o meno righe se la barra degli strumenti non può essere ridimensionata al numero di righe richiesto.

*lpRect*<br/>
Punta all'oggetto [CRect](../../atl-mfc-shared/reference/crect-class.md) o alla struttura [Rect](/windows/win32/api/windef/ns-windef-rect) che riceverà il nuovo rettangolo di delimitazione della barra degli strumenti.

### <a name="remarks"></a>Commenti

Se la barra degli strumenti non può essere ridimensionata al numero o alle righe richieste, verrà ridimensionata in base alla successiva dimensione valida più grande o successiva, a seconda del valore di *bLarger*. Se *bLarger* è true, il nuovo numero di righe sarà maggiore del numero richiesto. Se *bLarger* è false, il nuovo numero di righe sarà inferiore al numero richiesto.

Un numero specificato di righe è valido per la barra degli strumenti se i pulsanti possono essere disposti in modo che tutte le righe abbiano lo stesso numero di pulsanti (ad eccezione dell'ultima riga). Una barra degli strumenti che contiene quattro pulsanti, ad esempio, non può essere ridimensionata a tre righe perché le ultime due righe dovrebbero essere più brevi. Se si è provato a ridimensionarla a tre righe, si otterrebberanno quattro righe se *bLarger* è true e due righe se *bLarger* è false.

Se nella barra degli strumenti sono presenti separatori, le regole relative al momento in cui un determinato numero di righe sono valide sono più complesse. Il layout viene calcolato in modo tale che i gruppi di pulsanti (i pulsanti con un separatore prima del primo e l'ultimo pulsante nel gruppo) non vengano mai suddivisi in più righe, a meno che il gruppo non possa rientrare in una sola riga.

Se un gruppo non rientra in una riga, il gruppo successivo verrà avviato sulla riga successiva anche se si adatta alla riga in cui è terminato il gruppo di grandi dimensioni. Lo scopo di questa regola è quello di rendere più evidenti la separazione tra gruppi di grandi dimensioni. I separatori verticali risultanti vengono conteggiati come righe.

Si noti inoltre che la `SetRows` funzione membro sceglierà sempre il layout che restituisce le dimensioni più piccole della barra degli strumenti. La creazione di una barra degli strumenti con lo stile TBSTYLE_WRAPABLE e il ridimensionamento del controllo applicherà semplicemente il metodo descritto in precedenza in base alla larghezza del controllo.

Questa funzione può essere chiamata solo per le barre degli strumenti create con lo stile TBSTYLE_WRAPABLE.

## <a name="ctoolbarctrlsetstate"></a><a name="setstate"></a> CToolBarCtrl:: sestate

Imposta lo stato del pulsante specificato in un controllo Toolbar.

```
BOOL SetState(
    int nID,
    UINT nState);
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Identificatore del comando del pulsante.

*nState*<br/>
Flag di stato. Può essere una combinazione dei valori elencati per gli Stati dei pulsanti in [CToolBarCtrl:: AddButtons](#addbuttons).

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questa funzione è particolarmente utile se si desidera impostare più di uno degli Stati dei pulsanti. Per impostare solo uno stato, utilizzare una delle funzioni membro seguenti: [EnableButton](#enablebutton), [CheckButton](#checkbutton), [HideButton](#hidebutton), [Indeterminate](#indeterminate)o [PressButton](#pressbutton).

## <a name="ctoolbarctrlsetstyle"></a><a name="setstyle"></a> CToolBarCtrl:: Sestyle

Imposta gli stili per un controllo Toolbar.

```cpp
void SetStyle(DWORD dwStyle);
```

### <a name="parameters"></a>Parametri

*dwStyle*<br/>
DWORD che contiene una combinazione di [stili di controllo della barra degli strumenti](/windows/win32/Controls/toolbar-control-and-button-styles), come descritto nell'Windows SDK.

## <a name="ctoolbarctrlsettooltips"></a><a name="settooltips"></a> CToolBarCtrl:: setooltips

Associa un controllo descrizione comando a un controllo Toolbar.

```cpp
void SetToolTips(CToolTipCtrl* pTip);
```

### <a name="parameters"></a>Parametri

*pTip*<br/>
Puntatore all'oggetto [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) .

## <a name="ctoolbarctrlsetwindowtheme"></a><a name="setwindowtheme"></a> CToolBarCtrl:: SetWindowTheme

Imposta lo stile di visualizzazione dell' `CToolBarCtrl` oggetto.

```
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```

### <a name="parameters"></a>Parametri

*pszSubAppName*<br/>
Puntatore a una stringa Unicode che contiene lo stile di visualizzazione della barra degli strumenti da impostare.

### <a name="return-value"></a>Valore restituito

Il valore restituito non viene utilizzato.

### <a name="remarks"></a>Commenti

Questa funzione membro emula la funzionalità del messaggio di [TB_SETWINDOWTHEME](/windows/win32/Controls/tb-setwindowtheme) , come descritto nel Windows SDK.

## <a name="see-also"></a>Vedi anche

[CMNCTRL1 di esempio MFC](../../overview/visual-cpp-samples.md)<br/>
[Esempio MFCIE di MFC](../../overview/visual-cpp-samples.md)<br/>
[Classe CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Grafico delle gerarchie](../../mfc/hierarchy-chart.md)<br/>
[CToolBar (classe)](../../mfc/reference/ctoolbar-class.md)
