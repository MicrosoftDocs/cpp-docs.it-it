---
title: CFileDialog (classe)
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: fe4994b91813e2965972b47c838ddaf5333cc5f0
ms.sourcegitcommit: ecf274bcfe3a977c48745aaa243e5e731f1fdc5f
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/04/2019
ms.locfileid: "66503765"
---
# <a name="cfiledialog-class"></a>CFileDialog (classe)

Incapsula la finestra di dialogo comune che viene usato per i file aperti o le operazioni di salvataggio.

## <a name="syntax"></a>Sintassi

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Membri

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|Costruisce un oggetto `CFileDialog`.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|Aggiunge un pulsante di controllo nella finestra di dialogo.|
|[CFileDialog::AddComboBox](#addcombobox)|Aggiunge una casella combinata nella finestra di dialogo.|
|[CFileDialog::AddControlItem](#addcontrolitem)|Aggiunge un elemento a un controllo contenitore nella finestra di dialogo.|
|[CFileDialog::AddEditBox](#addeditbox)|Aggiunge una casella di modifica nella finestra di dialogo.|
|[CFileDialog::AddMenu](#addmenu)|Aggiunge un menu nella finestra di dialogo.|
|[CFileDialog::AddPlace](#addplace)|Di overload. Aggiunge che una cartella all'elenco delle posizioni disponibile per l'utente di aprire o salvare gli elementi.|
|[CFileDialog::AddPushButton](#addpushbutton)|Aggiunge un pulsante nella finestra di dialogo.|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Aggiunge un gruppo di pulsanti (anche nota come pulsante di opzione) opzione per la finestra di dialogo.|
|[CFileDialog::AddSeparator](#addseparator)|Nella finestra di dialogo, aggiunge un separatore.|
|[CFileDialog::AddText](#addtext)|Aggiunge il testo contenuto nella finestra di dialogo.|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Aggiorna lo stato della `CFileDialog` corrispondere i parametri e il flag archiviato nel `m_ofn` variabile membro.|
|[CFileDialog::DoModal](#domodal)|Consente di visualizzare la finestra di dialogo e consente all'utente di effettuare una selezione.|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Abilita un elenco di riepilogo a discesa nel **Open** oppure **salvare** pulsante nella finestra di dialogo.|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Interrompe l'aggiunta di elementi da raggruppare visivamente nella finestra di dialogo.|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Ottiene lo stato corrente di un pulsante di controllo (casella di controllo) nella finestra di dialogo.|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|Ottiene lo stato corrente di un elemento in un controllo contenitore trovato nella finestra di dialogo.|
|[CFileDialog::GetControlState](#getcontrolstate)|Ottiene la visibilità corrente e gli stati di un determinato controllo abilitato.|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Ottiene il testo corrente in un controllo casella di modifica.|
|[CFileDialog::GetFileExt](#getfileext)|Restituisce l'estensione del file selezionato.|
|[CFileDialog::GetFileName](#getfilename)|Restituisce il nome del file del file selezionato.|
|[CFileDialog::GetFileTitle](#getfiletitle)|Restituisce il titolo del file selezionato.|
|[CFileDialog::GetFolderPath](#getfolderpath)|Recupera il percorso della cartella attualmente aperta o della directory per un tipo Esplora risorse **apre** oppure **Salva con nome** finestra di dialogo comune.|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Recupera l'oggetto COM interno per un oggetto personalizzato `CFileDialog` oggetto.|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Recupera l'oggetto COM interno per un `CFileDialog` che viene utilizzato come un **Open** finestra di dialogo file.|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Recupera l'oggetto COM interno per un `CFileDialog` che viene utilizzato come un **salvare** finestra di dialogo file.|
|[CFileDialog::GetNextPathName](#getnextpathname)|Restituisce il percorso completo del file successivo selezionato.|
|[CFileDialog::GetOFN](#getofn)|Recupera le `OPENFILENAME` struttura del `CFileDialog` oggetto.|
|[CFileDialog::GetPathName](#getpathname)|Restituisce il percorso completo del file selezionato.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Restituisce lo stato di sola lettura del file selezionato.|
|[CFileDialog::GetResult](#getresult)|Ottiene la scelta che l'utente ha effettuato nella finestra di dialogo.|
|[CFileDialog::GetResults](#getresults)|Ottiene le scelte dell'utente in una finestra di dialogo che consente la selezione multipla.|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Ottiene un elemento specifico da controlli contenitore specificato nella finestra di dialogo.|
|[CFileDialog::GetStartPosition](#getstartposition)|Restituisce la posizione del primo elemento dell'elenco dei nomi di file.|
|[CFileDialog::HideControl](#hidecontrol)|Nasconde il controllo specificato in un tipo Esplora risorse **aperto** oppure **Salva con nome** finestra di dialogo comune.|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Determina se la finestra di dialogo corrente in modalità di selezione cartella.|
|[CFileDialog::MakeProminent](#makeprominent)|Posizioni un controllo nella finestra di dialogo in modo da differenziarla rispetto ad altri controlli aggiunti.|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Rimuove un elemento da un controllo contenitore nella finestra di dialogo.|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Nella finestra di dialogo, imposta lo stato corrente di un pulsante di controllo (casella di controllo).|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Imposta lo stato corrente di un elemento in un controllo contenitore trovato nella finestra di dialogo.|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Imposta il testo di un elemento di controllo. Ad esempio, il testo che accompagna un pulsante di opzione o un elemento in un menu.|
|[CFileDialog::SetControlLabel](#setcontrollabel)|Imposta il testo associato a un controllo, ad esempio il testo del pulsante o un'etichetta casella di modifica.|
|[CFileDialog::SetControlState](#setcontrolstate)|Imposta la visibilità corrente e gli stati di un determinato controllo abilitato.|
|[CFileDialog::SetControlText](#setcontroltext)|Imposta il testo per il controllo specificato in un tipo Esplora risorse **aperto** oppure **Salva con nome** finestra di dialogo comune.|
|[CFileDialog::SetDefExt](#setdefext)|Imposta l'estensione predefinita per un tipo Esplora risorse **aperto** oppure **Salva con nome** finestra di dialogo comune.|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Imposta il testo corrente in un controllo casella di modifica.|
|[CFileDialog::SetProperties](#setproperties)|Fornisce un archivio delle proprietà che definisce i valori predefiniti da usare per l'elemento salvato.|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Imposta lo stato selezionato di un particolare elemento in un gruppo di pulsanti di opzione o una casella combinata trovati nella finestra di dialogo.|
|[CFileDialog::SetTemplate](#settemplate)|Imposta il modello di finestra di dialogo per la `CFileDialog` oggetto.|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Dichiara un gruppo visual nella finestra di dialogo. Le chiamate successive a qualsiasi metodo "add" aggiungono tali elementi a questo gruppo.|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Aggiorna i dati archiviati nel `m_ofn` variabile membro corrispondano allo stato corrente della finestra di dialogo file.|

### <a name="protected-methods"></a>Metodi protetti

|Nome|Descrizione|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Chiamato quando si fa clic sul pulsante.|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Chiamato quando la casella di controllo è selezionata o deselezionata.|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Chiamato quando il controllo viene attivo.|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Gestisce il messaggio WM_NOTIFY CDN_SELCHANGE.|
|[CFileDialog::OnFileNameOK](#onfilenameok)|Convalida il nome di file immesso nella finestra di dialogo.|
|[CFileDialog::OnFolderChange](#onfolderchange)|Gestisce il messaggio WM_NOTIFY CDN_FOLDERCHANGE.|
|[CFileDialog::OnInitDone](#oninitdone)|Gestisce il messaggio WM_NOTIFY CDN_INITDONE.|
|[CFileDialog::OnItemSelected](#onitemselected)|Chiamato quando viene selezionato l'elemento contenitore.|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Consente di eseguire azioni personalizzate quando cambia la selezione di file.|
|[CFileDialog::OnShareViolation](#onshareviolation)|Gli handle di condividono le violazioni.|
|[CFileDialog::OnTypeChange](#ontypechange)|Gestisce il messaggio WM_NOTIFY CDN_TYPECHANGE.|

### <a name="public-data-members"></a>Membri dati pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CFileDialog::m_ofn](#m_ofn)|Il Windows `OPENFILENAME` struttura. Fornisce accesso ai parametri della casella di dialogo file base.|

## <a name="remarks"></a>Note

Finestre di dialogo file comuni consentono di implementare selezione dei file finestre di dialogo, ad esempio, **Apri File** e **Salva con nome**, in modo che sia coerenza con gli standard di Windows.

È possibile usare `CFileDialog` com'è con il costruttore fornito, che è possibile derivare la propria classe di finestra di dialogo da `CFileDialog` e scrivere un costruttore in base alle esigenze. In entrambi i casi, queste finestre di dialogo si comporta come finestre di dialogo MFC standard derivano dal [classe CCommonDialog](../../mfc/reference/ccommondialog-class.md). `CFileDialog` si basa sul COMMDLG. File DLL che è incluso in Windows.

Sia l'aspetto e le funzionalità del `CFileDialog` con Windows Vista o versioni successive differiscono dalle versioni precedenti di Windows. Il valore predefinito `CFileDialog` usa automaticamente nel nuovo Windows Vista o versioni successive nello stile senza modifiche al codice, se un programma viene compilato ed eseguita in Windows Vista o versione successiva. Usare la *bVistaStyle* parametro nel costruttore sostituire manualmente l'aggiornamento automatico. L'eccezione per l'aggiornamento automatico è finestre di dialogo personalizzate. Non essere convertito nel nuovo stile. Per altre informazioni sui costruttori di, vedere [CFileDialog::CFileDialog](#cfiledialog).

> [!NOTE]
>  Il sistema di ID di controllo è diversa in Windows Vista o versioni successive da versioni precedenti di Windows quando si usa un `CFileDialog`. È necessario aggiornare tutti i riferimenti a `CFileDialog` controlli nel codice prima che è possibile trasferire il progetto da una versione precedente di Windows.

Alcuni `CFileDialog` metodi non sono supportati in Windows Vista o versioni successive. Controllare l'argomento di metodo singolo per informazioni sul fatto che il metodo è supportato. Inoltre, le funzioni ereditate seguenti non sono supportate in Windows Vista o versioni successive:

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

I messaggi di windows per il `CFileDialog` classe variano in base a quale sistema operativo in uso. Ad esempio, Windows XP non supporta [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel) e [CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok) per il `CFileDialog` classe. Tuttavia, Windows Vista e sistemi operativi successivi li supportano. Per altre informazioni sui diversi messaggi che vengono generati e l'ordine in cui vengono ricevuti, vedere [esempio CFileDialog: Ordine degli eventi di registrazione](../../overview/visual-cpp-samples.md).

Usare un `CFileDialog` dell'oggetto, creare prima l'oggetto utilizzando il `CFileDialog` costruttore. Dopo che è stata costruita la finestra di dialogo, è possibile impostare o modificare i valori di [CFileDialog::m_ofn](#m_ofn) struttura per inizializzare i valori o gli stati dei controlli casella di dialogo. Il `m_ofn` struttura è di tipo `OPENFILENAME`. Per altre informazioni, vedere la [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) struttura nel SDK di Windows.

Dopo l'inizializzazione i controlli di finestra di dialogo, chiamare il [CFileDialog::DoModal](#domodal) metodo per visualizzare la finestra di dialogo casella in modo che l'utente può digitare il percorso e nome file. `DoModal` Restituisce se l'utente fa clic su OK Microsoft (IDOK) o con il pulsante Annulla (IDCANCEL). Se `DoModal` restituisce IDOK, è possibile usare uno del `CFileDialog` funzioni membro pubbliche per recuperare le informazioni inserite all'utente.

> [!NOTE]
> In Windows Vista o versioni successive, più chiamate alla [IFileDialog::SetFileTypes](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) provoca un errore. La seconda chiamata a `SetFileTypes` per tutte le istanze di un `CFileDialog` verrà restituito E_UNEXPECTED in Windows Vista o versioni successive. Alcuni `CFileDialog` metodo funzioni chiamano `SetFileTypes`. Ad esempio, due chiamate a `CFileDialog::DoModal` per la stessa istanza di un `CFileDialog` genera [ASSERT](diagnostic-services.md#assert).

`CFileDialog` include diversi membri protetti che consentono di eseguire la gestione personalizzata di violazioni di condivisione, convalida del nome file e notifica di modifica di caselle di riepilogo. Questi membri protected sono funzioni di callback che la maggior parte delle applicazioni non sono necessario utilizzare, in quanto la gestione predefinita viene eseguita automaticamente. Voci della mappa messaggi per queste funzioni non sono necessarie perché sono funzioni standard.

È possibile utilizzare il Windows [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) funzione per determinare se si è verificato un errore durante l'inizializzazione della finestra di dialogo e per altre informazioni sull'errore.

La distruzione di `CFileDialog` oggetti viene gestita automaticamente. Non è necessario chiamare [CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog).

Per consentire all'utente di selezionare più file, impostare il flag OFN_ALLOWMULTISELECT prima di chiamare `DoModal`. È necessario fornire il proprio buffer di nome file per includere l'elenco restituito di più nomi di file. Eseguire questa operazione sostituendo `m_ofn.lpstrFile` con un puntatore a un buffer è stato allocato, dopo aver creato il `CFileDialog`, ma prima di chiamare `DoModal`.

Inoltre, è necessario impostare `m_ofn.nMaxFile` utilizzando il numero di caratteri nel buffer a cui punta `m_ofn.lpstrFile`. Se si imposta il numero massimo di file a cui `n`, le dimensioni del buffer necessarie sono `n * (_MAX_PATH + 1) + 1`. Il primo elemento nel buffer restituito è il percorso della cartella in cui è stato selezionato i file. Per Windows Vista o le finestre di dialogo successiva stile, le stringhe di nomi di file e directory sono con terminazione null, con un carattere null aggiuntivo dopo l'ultimo nome file. Questo formato consente le finestre di dialogo di tipo Esplora risorse restituire i nomi di file di lunga durata che includono spazi. Per le finestre di dialogo obsolete, le stringhe di nomi di file e directory sono separate da spazi e la funzione Usa nomi file brevi per i nomi di file con spazi.

Nell'esempio seguente viene illustrato come usare un buffer per recuperare ed elencare più nomi di file.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Per modificare le dimensioni del buffer in risposta all'utente la selezione di più nomi di file, è necessario derivare una nuova classe da `CFileDialog` ed eseguire l'override di [CFileDialog::OnFileNameChange](#onfilenamechange) (metodo).

Se si deriva una nuova classe da `CFileDialog`, è possibile usare una mappa messaggi per gestire tutti i messaggi. Per estendere la gestione dei messaggi predefinito, derivare una classe da `CFileDialog`, aggiungere una mappa messaggi per la nuova classe e forniscono le funzioni membro per i nuovi messaggi. Non è necessario fornire una funzione di hook per personalizzare la finestra di dialogo.

Per personalizzare la finestra di dialogo, derivare una classe da `CFileDialog`, fornire un modello di finestra di dialogo personalizzate e aggiungere una mappa messaggi per elaborare i messaggi di notifica da controlli estesi. Passare i messaggi non elaborati per la classe di base. Non è necessario personalizzare la funzione hook.

Quando si usa nel Windows Vista o versioni successive nello stile del `CFileDialog`, è possibile usare le mappe messaggi e i modelli di finestra di dialogo. In alternativa, è necessario usare le interfacce COM per funzionalità analoghe.

Per altre informazioni su come usare `CFileDialog`, vedere [classi di finestra di dialogo comuni](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Requisiti

**Intestazione:** afxdlgs. h

##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton

Aggiunge un pulsante di controllo nella finestra di dialogo.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del pulsante di controllo da aggiungere.

*strLabel*<br/>
Il nome del controllo pulsante.

*bChecked*<br/>
Valore booleano che indica lo stato corrente del controllo pulsante. TRUE se selezionato; FALSE in caso contrario,

### <a name="remarks"></a>Note

##  <a name="addcombobox"></a>  CFileDialog::AddComboBox

Aggiunge una casella combinata nella finestra di dialogo.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID della casella combinata da aggiungere.

### <a name="remarks"></a>Note

##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem

Aggiunge un elemento a un controllo contenitore nella finestra di dialogo.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del controllo contenitore a cui aggiungere l'elemento.

*dwIDItem*<br/>
L'ID dell'elemento.

*strLabel*<br/>
Testo dell'elemento.

### <a name="remarks"></a>Note

##  <a name="addeditbox"></a>  CFileDialog::AddEditBox

Aggiunge una casella di modifica nella finestra di dialogo.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID della casella di modifica da aggiungere.

*strText*<br/>
Nome della casella di modifica.

### <a name="remarks"></a>Note

##  <a name="addmenu"></a>  CFileDialog::AddMenu

Aggiunge un menu nella finestra di dialogo.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del menu da aggiungere.

*strLabel*<br/>
Il nome del menu.

### <a name="remarks"></a>Note

##  <a name="addplace"></a>  CFileDialog::AddPlace

Aggiunge che una cartella all'elenco delle posizioni disponibile per l'utente di aprire o salvare gli elementi.

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Parametri

*lpszFolder*<br/>
Un percorso della cartella da rendere disponibili all'utente. Ciò può essere solo una cartella.

*fdap*<br/>
Specifica la posizione della cartella all'interno dell'elenco.

*psi*<br/>
Puntatore a un'istanza di IShellItem che rappresenta la cartella da rendere disponibili all'utente. Ciò può essere solo una cartella.

### <a name="remarks"></a>Note

##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton

Aggiunge un pulsante nella finestra di dialogo.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del pulsante da aggiungere.

*strLabel*<br/>
Il nome del pulsante.

### <a name="remarks"></a>Note

##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList

Aggiunge un gruppo di pulsanti (anche nota come pulsante di opzione) opzione per la finestra di dialogo.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del gruppo di pulsanti di opzione da aggiungere.

### <a name="remarks"></a>Note

##  <a name="addseparator"></a>  CFileDialog::AddSeparator

Nella finestra di dialogo, aggiunge un separatore.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
Aggiungere l'ID del separatore.

### <a name="remarks"></a>Note

##  <a name="addtext"></a>  CFileDialog::AddText

Aggiunge il testo nella finestra di dialogo.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del testo da aggiungere.

*strText*<br/>
Il nome di testo.

### <a name="remarks"></a>Note

##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog

Aggiorna lo stato corrente della [CFileDialog](../../mfc/reference/cfiledialog-class.md) in base ai valori archiviati nel `m_ofn` struttura dei dati.

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Note

Nelle versioni di Windows prima di Windows Vista, il membro [OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) struttura dei dati è stata costantemente sincronizzata con lo stato del `CFileDialog`. Tutte le modifiche per il [m_ofn](#m_ofn) variabile membro sono state applicate immediatamente lo stato della finestra di dialogo. Inoltre, eventuali modifiche allo stato della finestra di dialogo aggiornare immediatamente il `m_ofn` variabile membro.

In Windows Vista o versioni successive, i valori nel `m_ofn` variabile membro e lo stato del `CFileDialog` non è garantita da sincronizzare. Questa funzione forza lo stato del `CFileDialog` da aggiornare in modo che corrisponda il `m_ofn` struttura. Windows chiama questa funzione automaticamente durante [CFileDialog::DoModal](#domodal).

Per altre informazioni su come usare il `CFileDialog` classe in Windows Vista o versioni successive, vedere [classe CFileDialog](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog).

##  <a name="cfiledialog"></a>  CFileDialog::CFileDialog

Chiamare questa funzione per costruire una finestra di dialogo file Windows standard.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Parametri

*bOpenFileDialog*<br/>
[in] Il parametro che specifica il tipo di finestra di dialogo per creare. Impostarla su TRUE per costruire una **Apri File** nella finestra di dialogo. Impostarla su FALSE per costruire una **Salva con nome File** nella finestra di dialogo.

*lpszDefExt*<br/>
[in] L'estensione file predefinita. Se l'utente non include un'estensione nota (uno che dispone di un'associazione nel computer dell'utente) nella casella Nome file, l'estensione specificata da *lpszDefExt* viene automaticamente aggiunto al nome del file. Se questo parametro è NULL, non viene aggiunto estensione.

*lpszFileName*<br/>
[in] Nome file iniziale che viene visualizzato nella casella Nome file. Se NULL, viene visualizzato alcun nome file iniziale.

*dwFlags*<br/>
[in] Una combinazione di uno o più flag utilizzabili per personalizzare la finestra di dialogo. Per una descrizione di questi flag, vedere la [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) struttura nel SDK di Windows. Se si modifica il `m_ofn.Flags` struttura membro, usare un operatore OR bit per bit delle modifiche per mantenere intatte le impostazioni predefinite.

*lpszFilter*<br/>
[in] Una serie di coppie di stringhe che specificano i filtri è possibile applicare al file. Se si specificano i filtri dei file, verranno visualizzati solo i file che corrispondono ai criteri di filtro nell'elenco dei file. Vedere la sezione Osservazioni per altre informazioni su come usare i filtri di file.

*pParentWnd*<br/>
[in] Puntatore alla finestra padre o proprietaria della finestra di dialogo file.

*dwSize*<br/>
[in] Le dimensioni del `OPENFILENAME` struttura. Questo valore dipende dalla versione del sistema operativo. MFC usato questo parametro per determinare il tipo di finestra di dialogo per creare appropriato. Le dimensioni predefinite pari a 0 indica che il codice MFC determinano le dimensioni di finestra dialogo corretto da usare in base alla versione del sistema operativo in cui viene eseguito il programma.

*bVistaStyle*<br/>
[in] **Nota** questo parametro è disponibile in Visual Studio 2008 e versioni successive e sarà essere utilizzata solo se si eseguono in Windows Vista o versioni successive la finestra di dialogo Nuovo stile.

Il parametro che specifica lo stile della finestra di dialogo file. Impostarla su true per usare il nuovo stile Vista finestre di dialogo file. In caso contrario, verrà utilizzato il vecchio stile delle finestre di dialogo. Vedere la sezione Osservazioni per altre informazioni in esecuzione in Vista.

### <a name="remarks"></a>Note

Entrambi una **Apri File** oppure **Salva con nome File** la finestra di dialogo viene costruita, a seconda del valore di *bOpenFileDialog*.

Specifica un'estensione predefinita utilizzando *lpszDefExt* potrebbe non produrre il comportamento previsto, perché raramente è prevedibile le estensioni sono associazioni di file nel computer dell'utente. Se è necessario maggiore controllo sull'aggiunta di un'estensione per impostazione predefinita, è possibile derivare la propria classe dal `CFileDialog`ed eseguire l'override di `CFileDialog::OnFileNameOK` metodo per eseguire la gestione di estensione.

Per consentire all'utente di selezionare più file, impostare il flag OFN_ALLOWMULTISELECT prima di chiamare [DoModal](#domodal). È necessario fornire il proprio buffer di nome file per archiviare l'elenco restituito di più nomi di file. Eseguire questa operazione sostituendo `m_ofn.lpstrFile` con un puntatore a un buffer è stato allocato, dopo aver creato il [CFileDialog](../../mfc/reference/cfiledialog-class.md), ma prima di chiamare `DoModal`. Inoltre, è necessario impostare `m_ofn.nMaxFile` con il numero di caratteri nel buffer a cui punta `m_ofn.lpstrFile`. Se si imposta il numero massimo di file a cui *n*, la dimensione del buffer necessarie `n`*(_MAX_PATH + 1) + 1. Ad esempio:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Per consentire all'utente di ridimensionare la finestra di dialogo tipo Esplora risorse usando il mouse o tastiera, impostare il flag OFN_ENABLESIZING. Impostazione di questo flag è necessario solo se si specifica una routine di hook o un modello personalizzato. Il flag funziona solo con una finestra di dialogo di tipo Esplora risorse; finestre di dialogo di vecchio stile non possono essere ridimensionate.

Il *lpszFilter* parametro viene utilizzato per determinare il tipo del nome file deve avere un file da visualizzare nell'elenco di file. La prima stringa nella coppia stringa descrive il filtro. la seconda stringa indica l'estensione del nome file da utilizzare. È possibile specificare più estensioni usando un punto e virgola (il carattere ';') come delimitatore. La stringa termina con due simboli di '&#124;' caratteri, seguita da un carattere NULL. È anche possibile usare una [CString](../../atl-mfc-shared/using-cstring.md) oggetto per questo parametro.

Ad esempio, Microsoft Excel consente agli utenti di aprire i file con estensioni xlc (grafico) o xls (foglio di lavoro), tra gli altri. Il filtro per Excel può essere scritta come:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

Tuttavia, se si prevede di usare direttamente questa stringa aggiornato il `OPENFILENAME` struttura, è necessario delimitare le stringhe con il carattere null '\0', anziché le barre verticali ('&#124;').

Il *bVistaStyle* parametro è applicabile solo quando in esecuzione in Windows Vista o versioni successive. In versioni precedenti di Windows, questo parametro viene ignorato. Se *bVistaStyle* è impostata su TRUE, quando si compila un programma con Visual Studio 2008 o versioni successive, il nuovo stile Vista **finestra di dialogo File** verrà utilizzato. In caso contrario, lo stile precedente MFC **finestra di dialogo File** verrà utilizzato.

Finestra di dialogo modelli non sono supportati nelle finestre di dialogo basate *bVistaStyle*

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CFileDialog::DoModal](#domodal).

##  <a name="domodal"></a>  CFileDialog::DoModal

Chiamare questa funzione per visualizzare la finestra di dialogo file comune Windows e consentire all'utente di cercare file e directory e immettere un nome file.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Valore restituito

IDOK o IDCANCEL. Se viene restituito IDCANCEL, chiamare il Windows [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) funzione per determinare se si è verificato un errore.

IDOK e IDCANCEL sono le costanti che indicano se l'utente ha selezionato il pulsante OK o Annulla.

### <a name="remarks"></a>Note

Se si desidera inizializzare le varie opzioni della finestra di dialogo file impostando i membri del `m_ofn` struttura, è necessario eseguire questa operazione prima di chiamare `DoModal`, ma dopo che viene costruito l'oggetto finestra di dialogo.

Ad esempio, se si desidera consentire all'utente di selezionare più file, impostare il flag OFN_ALLOWMULTISELECT prima di chiamare `DoModal`, come illustrato nell'esempio di codice in questo argomento.

Quando l'utente fa clic sui pulsanti OK o Annulla la finestra di dialogo o seleziona la chiusura opzione nella finestra di dialogo del controllo menu, il controllo viene restituito all'applicazione. È quindi possibile chiamare altre funzioni membro per recuperare le impostazioni o informazioni gli input dell'utente nella finestra di dialogo.

`DoModal` è una funzione virtuale sottoposto a override dalla classe `CDialog`.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown

Consente a un elenco di riepilogo a discesa all'apertura o sul pulsante nella finestra di dialogo Salva.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID dell'elenco di riepilogo a discesa.

### <a name="remarks"></a>Note

##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup

Interrompe l'aggiunta di elementi da raggruppare visivamente nella finestra di dialogo.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Valore restituito

Restituisce S_OK se l'esito positivo. un valore di errore in caso contrario.

### <a name="remarks"></a>Note

##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState

Recupera lo stato corrente di un pulsante di controllo (casella di controllo) nella finestra di dialogo.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID della casella di controllo.

*bChecked*<br/>
Lo stato della casella di controllo. TRUE indica checked; FALSE indica che è deselezionata.

### <a name="remarks"></a>Note

##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState

Recupera lo stato corrente di un elemento in un controllo contenitore trovato nella finestra di dialogo.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del controllo contenitore.

*dwIDItem*<br/>
L'ID dell'elemento.

*dwState*<br/>
Un riferimento a una variabile che riceve uno degli altri valori dall'enumerazione CDCONTROLSTATE che indica lo stato corrente del controllo.

### <a name="remarks"></a>Note

##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState

Recupera la visibilità corrente e gli stati di un determinato controllo abilitato.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del controllo.

*dwState*<br/>
Un riferimento a una variabile che riceve uno o più valori dall'enumerazione CDCONTROLSTATE che indica lo stato corrente del controllo.

### <a name="remarks"></a>Note

##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText

Recupera il testo corrente in un controllo casella di modifica.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID della casella di modifica.

*strText*<br/>
Valore del testo.

### <a name="remarks"></a>Note

##  <a name="getfileext"></a>  CFileDialog::GetFileExt

Chiamare questa funzione per recuperare l'estensione del nome file immesso nella finestra di dialogo.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Valore restituito

L'estensione del nome del file.

### <a name="remarks"></a>Note

Ad esempio, se il nome del file immesso i dati. TXT, `GetFileExt` restituisce "TXT".

Se `m_ofn.Flags` presenta il flag OFN_ALLOWMULTISELECT impostata, questa stringa contiene una sequenza di stringhe con terminazione null, con la prima stringa in corso il percorso della directory del gruppo di file selezionato, seguita dai nomi di tutti i file selezionati dall'utente. Per recuperare percorsi di file, usare il [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) funzioni membro.

##  <a name="getfilename"></a>  CFileDialog::GetFileName

Chiamare questa funzione per recuperare il nome del nome file immesso nella finestra di dialogo.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Valore restituito

Nome del file.

### <a name="remarks"></a>Note

Il nome del file include sia il prefisso e l'estensione. Ad esempio, `GetFileName` restituirà "testo. DAT"per il file C:\FILES\TEXT.DAT.

Se `m_ofn.Flags` ha il `OFN_ALLOWMULTISELECT` flag impostato, è necessario chiamare [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) per recuperare un nome di percorso di file.

##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle

Chiamare questa funzione per recuperare il titolo del file immesso nella finestra di dialogo.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Valore restituito

Il titolo del file.

### <a name="remarks"></a>Note

Il titolo del file include solo il prefisso, senza il percorso o l'estensione. Ad esempio, `GetFileTitle` restituirà "TEXT" per il file C:\FILES\TEXT.DAT.

Se `m_ofn.Flags` presenta il flag OFN_ALLOWMULTISELECT impostata, questa stringa contiene una sequenza di stringhe con terminazione null, con la prima stringa in corso il percorso della directory del gruppo di file selezionato, seguita dai nomi di tutti i file selezionati dall'utente. Per questo motivo, usare il [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) funzioni membro per recuperare il nome del file successivo nell'elenco.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CFileDialog::DoModal](#domodal).

##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath

Chiamare questa funzione membro per recuperare il percorso della cartella attualmente aperta o della directory per una finestra di dialogo comune Open di tipo Esplora risorse o Salva con nome.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Valore restituito

Oggetto [CString](../../atl-mfc-shared/reference/cstringt-class.md) oggetto contenente la cartella attualmente aperta o directory.

### <a name="remarks"></a>Note

La finestra di dialogo deve essere stata creata con lo stile OFN_EXPLORER; in caso contrario, il metodo avrà esito negativo con un'asserzione.

È possibile chiamare questo metodo solo quando viene visualizzata la finestra di dialogo. Dopo che è stata chiusa la finestra di dialogo, questa funzione non funzionerà più e il metodo avrà esito negativo con un'asserzione.

##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize

Recupera un puntatore all'oggetto COM interno per un determinato [CFileDialog](../../mfc/reference/cfiledialog-class.md).

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Valore restituito

Il puntatore all'oggetto COM interno per il `CFileDialog`. È responsabilità dell'utente per rilasciare puntatore ' this ' in modo appropriato.

### <a name="remarks"></a>Note

Utilizzare questa funzione solo in Windows Vista o versioni successive con un oggetto contenente *bVistaStyle* impostata su TRUE. Se si usa questa funzione quando *bVistaStyle* è FALSE, verrà restituito NULL in modalità di rilascio e genera un'asserzione in modalità di debug.

Per altre informazioni sul `IFileDialogCustomize` dell'interfaccia, vedere [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Esempio

Questo esempio recupera l'oggetto COM interno. Per eseguire questo esempio di codice, è necessario compilarlo in Windows Vista o versioni successive.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog

Recupera un puntatore all'oggetto COM interno per un determinato `CFileDialog`.

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Valore restituito

Il puntatore all'oggetto COM interno per il `CFileDialog`. È responsabilità dell'utente per rilasciare puntatore ' this ' in modo appropriato.

### <a name="remarks"></a>Note

Utilizzare questa funzione solo in Windows Vista o versioni successive con un oggetto contenente *bVistaStyle* impostata su TRUE. Questa funzione restituisce NULL se il `CFileDialog` non è un **aperta** nella finestra di dialogo oppure se *bVistaStyle* è impostata su FALSE. In questo caso finale, la funzione restituisce solo NULL in modalità di rilascio: in modalità di debug verrà generata un'asserzione.

Per altre informazioni sul `IFileOpenDialog` dell'interfaccia, vedere [IFileOpenDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifileopendialog).

### <a name="example"></a>Esempio

Questo esempio recupera l'oggetto COM interno. Per eseguire questo codice, è necessario compilarlo in Windows Vista o versioni successive.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog

Recupera un puntatore all'oggetto COM interno per un determinato `CFileDialog`.

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Valore restituito

Il puntatore all'oggetto COM interno per il `CFileDialog`. È responsabilità dell'utente per rilasciare puntatore ' this ' in modo appropriato.

### <a name="remarks"></a>Note

Utilizzare questa funzione solo in Windows Vista o versioni successive con un oggetto contenente *bVistaStyle* impostata su TRUE. Questa funzione restituirà NULL se il `CFileDialog` non è un **salvare** nella finestra di dialogo oppure se *bVistaStyle* è impostata su FALSE. In questo caso finale, la funzione restituisce solo NULL in modalità di rilascio: in modalità di debug verrà generata un'asserzione.

Per altre informazioni sul `IFileSaveDialog` dell'interfaccia, vedere [IFileSaveDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Esempio

Questo esempio recupera l'oggetto COM interno. Per eseguire questo esempio di codice, è necessario compilarlo in Windows Vista o versioni successive.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>  CFileDialog::GetNextPathName

Chiamare questa funzione per recuperare il nome del file successivo dal gruppo selezionato nella finestra di dialogo.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Parametri

*pos*<br/>
Un riferimento a un valore di posizione restituito da una precedente `GetNextPathName` o `GetStartPosition` chiamata di funzione. NULL se è stata raggiunta la fine dell'elenco.

### <a name="return-value"></a>Valore restituito

Percorso completo del file.

### <a name="remarks"></a>Note

Il percorso del nome file include il titolo del file e il percorso della directory intera. Ad esempio, `GetNextPathName` restituirà "C:\FILES\TEXT. DAT"per il file C:\FILES\TEXT.DAT. È possibile usare `GetNextPathName` in un ciclo di iterazione in avanti se si stabilisce la posizione iniziale con una chiamata a `GetStartPosition`.

Se la selezione è costituito da un solo file, verrà restituito il nome del file.

##  <a name="getofn"></a>  CFileDialog::GetOFN

Recupera l'oggetto associato `OPENFILENAME` struttura.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Valore restituito

Un' [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) struttura.

### <a name="remarks"></a>Note

Utilizzare la seconda versione di questa funzione per inizializzare l'aspetto di un **Apri File** oppure **Salva con nome File** della finestra di dialogo dopo la sua creazione, ma prima che venga visualizzato con il `DoModal` funzione membro. Ad esempio, è possibile impostare il `lpstrTitle` membro della `m_ofn` didascalia si desidera disporre la finestra di dialogo.

##  <a name="getpathname"></a>  CFileDialog::GetPathName

Chiamare questa funzione per recuperare il percorso completo del file immesso nella finestra di dialogo.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Valore restituito

Percorso completo del file.

### <a name="remarks"></a>Note

Il percorso del nome file include il titolo del file e il percorso della directory intera. Ad esempio, `GetPathName` restituirà "C:\FILES\TEXT. DAT"per il file C:\FILES\TEXT.DAT.

Se `m_ofn.Flags` presenta il flag OFN_ALLOWMULTISELECT impostata, questa stringa contiene una sequenza di null teminated stringhe, con la prima stringa in corso il percorso della directory del gruppo di file selezionato, seguita dai nomi di tutti i file selezionati dall'utente. Per questo motivo, usare il [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) funzioni membro per recuperare il nome del file successivo nell'elenco.

### <a name="example"></a>Esempio

  Vedere l'esempio relativo [CFileDialog::DoModal](#domodal).

##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref

Chiamare questa funzione per determinare se è stata selezionata la casella di controllo di sola lettura nelle finestre di dialogo Windows File Open e Salva con nome File standard.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se è selezionata la casella di controllo di sola lettura nella finestra di dialogo; in caso contrario 0.

### <a name="remarks"></a>Note

È possibile nascondere la casella di controllo di sola lettura impostando lo stile OFN_HIDEREADONLY nel `CFileDialog` costruttore.

> [!NOTE]
> Windows Vista o versioni successive stile `CFileDialog` gli oggetti non supportano questa funzione. Tenta di utilizzare questa funzione in un Windows Vista o successive stile `CFileDialog` genererà [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="getresult"></a>  CFileDialog::GetResult

Recupera la scelta che l'utente ha effettuato nella finestra di dialogo.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Valore restituito

Puntatore a un'istanza di IShellItem che rappresenta la scelta dell'utente.

### <a name="remarks"></a>Note

##  <a name="getresults"></a>  CFileDialog::GetResults

Recupera le scelte dell'utente in una finestra di dialogo che consente la selezione multipla.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Valore restituito

Puntatore a un IShellItemArray attraverso il quale gli elementi selezionati nella finestra di dialogo sono accessibile.

### <a name="remarks"></a>Note

##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem

Recupera un determinato elemento dal controllo contenitore specificato nella finestra di dialogo.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del controllo contenitore.

*dwIDItem*<br/>
L'ID dell'elemento selezionato dall'utente nel controllo.

### <a name="remarks"></a>Note

##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition

Chiamare questa funzione membro per recuperare la posizione del nome del primo percorso di file nell'elenco, se `m_ofn.Flags` OFN_ALLOWMULTISELECT impostato il flag.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Valore restituito

Un valore di posizione che può essere usato per iterazione. NULL se l'elenco è vuoto.

##  <a name="hidecontrol"></a>  CFileDialog::HideControl

Chiamare questa funzione membro per nascondere il controllo specificato in una finestra di dialogo comune Open di tipo Esplora risorse o Salva con nome.

```
void HideControl(int nID);
```

### <a name="parameters"></a>Parametri

*nID*<br/>
L'ID del controllo per nascondere.

### <a name="remarks"></a>Note

La finestra di dialogo deve essere stata creata con lo stile OFN_EXPLORER; in caso contrario, la funzione avrà esito negativo con un'asserzione.

##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode

Determina se la finestra di dialogo corrente è in modalità di selezione cartella.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Valore restituito

TRUE se la finestra di dialogo è in modalità di selezione cartelle. in caso contrario, FALSE.

### <a name="remarks"></a>Note

##  <a name="m_ofn"></a>  CFileDialog::m_ofn

`m_ofn` è una struttura di tipo `OPENFILENAME`. I dati in questa struttura rappresentano lo stato corrente del `CFileDialog`.

### <a name="remarks"></a>Note

Usare questa struttura per inizializzare l'aspetto di un **Apri File** o **Salva con nome File** della finestra di dialogo dopo la sua costruzione, ma prima di visualizzare con il [DoModal](#domodal) (metodo). Ad esempio, è possibile impostare il *lpstrTitle* membro di `m_ofn` didascalia si desidera disporre la finestra di dialogo.

Con lo stile di versioni successive di o di Windows Vista [CFileDialog](../../mfc/reference/cfiledialog-class.md), `m_ofn` non è garantito in modo che corrisponda sempre lo stato della finestra di dialogo. È sincronizzato con la finestra di dialogo nelle versioni precedenti di Windows. Vedere [CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog) e [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog) per altre informazioni sulla sincronizzazione i `m_ofn` struttura e il `CFileDialog` dello stato in Windows Vista o versioni successive.

Windows Vista o versioni successive file finestre di dialogo non supportano determinati membri e i flag del `CFileDialog`. Di conseguenza, si avrà alcun effetto.

Di seguito è riportato un elenco dei membri che non sono supportati da Windows Vista o versioni successive:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

I flag seguenti non sono supportati e pertanto non hanno alcun effetto quando si usa nel Windows Vista o versioni successive nello stile di `CFileDialog`:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES - sempre in modo efficace in Windows Vista o versioni successive

- OFN_NOLONGNAMES - off in modo efficace sempre in Windows Vista o versioni successive

- OFN_NONETWORKBUTTON - sempre in modo efficace in Windows Vista o versioni successive

- OFN_READONLY

- OFN_SHOWHELP

Per altre informazioni su questa struttura, vedere la [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) struttura nel SDK di Windows.

##  <a name="makeprominent"></a>  CFileDialog::MakeProminent

Posizioni un controllo nella finestra di dialogo in modo da differenziarla rispetto ad altri controlli.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del controllo.

### <a name="remarks"></a>Note

##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked

Chiamato quando si fa clic sul pulsante.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del pulsante.

### <a name="remarks"></a>Note

##  <a name="oncheckbuttontoggled"></a>  CFileDialog::OnCheckButtonToggled

Chiamato quando la casella di controllo è selezionato o deselezionato.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID della casella di controllo.

*bChecked*<br/>
Selezionato o deselezionato.

### <a name="remarks"></a>Note

##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating

Chiamato quando viene attivato il controllo.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del controllo.

### <a name="remarks"></a>Note

##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNameChange

Eseguire l'override di questo metodo se si desidera gestire il messaggio WM_NOTIFY CDN_SELCHANGE.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Note

Il sistema invia il messaggio CDN_SELCHANGE quando l'utente seleziona un nuovo file o una cartella nell'elenco di file del **aperto** oppure **Salva con nome** nella finestra di dialogo. Eseguire l'override di questo metodo se si desidera eseguire eventuali azioni in risposta a questo messaggio.

Questo messaggio viene inviato dal sistema solo se la finestra di dialogo è stata creata con il flag OFN_EXPLORER attivato. Per altre informazioni sulla notifica, vedere [CDN_SELCHANGE](/windows/desktop/dlgbox/cdn-selchange). Per informazioni sui flag OFN_EXPLORER, vedere la [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) struttura e [Open e salvare come finestre di dialogo](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK

Eseguire l'override di questa funzione solo se si desidera fornire la convalida personalizzata di nomi di file che vengono immessi in una finestra di dialogo file comuni.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Valore restituito

1 se il nome del file non è un nome file valido; in caso contrario 0.

### <a name="remarks"></a>Note

Questa funzione consente di rifiutare un nome di file per qualsiasi motivo specifico dell'applicazione. In genere, non devi usare questa funzione perché il framework fornisce la convalida predefinita di nomi di file e visualizza una finestra di messaggio se non viene immesso un nome di file non valido.

Se viene restituito 1, la finestra di dialogo rimarrà visualizzata all'utente di immettere un altro nome. La procedura di finestra di dialogo si chiude la finestra di dialogo se il valore restituito è 0. Altri diverso da zero restituisce i valori sono attualmente riservati e non devono essere utilizzati.

##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange

Eseguire l'override di questa funzione per gestire il messaggio WM_NOTIFYCDN_FOLDERCHANGE.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Note

Quando viene aperta una nuova cartella nella finestra di dialogo Apri o Salva con nome, viene inviato il messaggio di notifica.

Notifica viene inviata solo se la finestra di dialogo è stata creata con lo stile OFN_EXPLORER. Per altre informazioni sulla notifica, vedere [CDN_FOLDERCHANGE](/windows/desktop/dlgbox/cdn-folderchange). Per informazioni sullo stile OFN_EXPLORER, vedere la [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) struttura e [Open e salvare come finestre di dialogo](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="oninitdone"></a>  CFileDialog::OnInitDone

Eseguire l'override della funzione per gestire il messaggio WM_NOTIFY CDN_INITDONE.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Note

Il sistema invia questo messaggio di notifica quando il sistema abbia terminato la disposizione dei controlli nel **aperto** oppure **Salva con nome** finestra di dialogo per liberare spazio per i controlli della finestra di dialogo figlio.

Il sistema invia questo solo se la finestra di dialogo è stata creata con lo stile OFN_EXPLORER. Per altre informazioni sulla notifica, vedere [CDN_INITDONE](/windows/desktop/dlgbox/cdn-initdone). Per informazioni sullo stile OFN_EXPLORER, vedere la [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) struttura e [Open e salvare come finestre di dialogo](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

> [!NOTE]
> Windows Vista o versioni successive file finestre di dialogo non supportano questa funzione. Tentativo di utilizzare questa funzione in un Windows Vista o versione successiva finestra di dialogo file stile genererà [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected

Chiamato quando viene selezionato l'elemento contenitore.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del controllo contenitore.

*dwIDItem*<br/>
L'ID dell'elemento.

### <a name="remarks"></a>Note

##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify

Questa funzione viene chiamata ogni volta che la selezione corrente in una casella di riepilogo sta per essere modificata.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Parametri

*nIDBox*<br/>
ID della casella di riepilogo o casella combinata in cui si è verificata la selezione.

*iCurSel*<br/>
L'indice della selezione corrente.

*nCode*<br/>
Il codice di notifica di controllo. Questo parametro deve avere uno dei valori seguenti:

- Specifica CD_LBSELCHANGE *iCurSel* è l'elemento selezionato in una casella di riepilogo a selezione singola.

- Consente di specificare che CD_LBSELSUB *iCurSel* non è più selezionato in un elenco di selezione multipla.

- Consente di specificare che CD_LBSELADD *iCurSel* è selezionata in un elenco di selezione multipla.

- CD_LBSELNOITEMS specifica che la selezione non è presente in un elenco di selezione multipla.

### <a name="remarks"></a>Note

Eseguire l'override di questa funzione per la gestione personalizzata delle modifiche di selezione nella casella di riepilogo. Ad esempio, è possibile utilizzare questa funzione per visualizzare i diritti di accesso o data-last-modified di ogni file consente di selezionare l'utente.

##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation

Eseguire l'override di questa funzione per la gestione personalizzata delle violazioni di condivisione.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Parametri

*lpszPathName*<br/>
Il percorso del file in cui si è verificata la violazione di condivisione.

### <a name="return-value"></a>Valore restituito

Uno dei valori seguenti:

- Il nome del file OFN_SHAREFALLTHROUGH viene restituito dalla finestra di dialogo.

- Deve essere portato OFN_SHARENOWARN nessuna ulteriore azione.

- OFN_SHAREWARN l'utente riceve il messaggio di avviso standard per correggere l'errore.

### <a name="remarks"></a>Note

In genere, non devi usare questa funzione perché il framework fornisce il controllo delle violazioni di condivisione predefinito e visualizza una finestra di messaggio se si verifica una violazione di condivisione.

Se si desidera disabilitare il controllo delle violazioni di condivisione, usare l'operatore OR per combinare il flag OFN_SHAREAWARE con `m_ofn.Flags`.

##  <a name="ontypechange"></a>  CFileDialog::OnTypeChange

Eseguire l'override di questa funzione per gestire il messaggio WM_NOTIFYCDN_TYPECHANGE.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Note

Il messaggio di notifica viene inviato quando l'utente seleziona un nuovo tipo di file dall'elenco dei tipi di file nella finestra Apri o Salva con nome finestra di dialogo.

Notifica viene inviata solo se la finestra di dialogo è stata creata con lo stile OFN_EXPLORER. Per altre informazioni sulla notifica, vedere [CDN_TYPECHANGE](/windows/desktop/dlgbox/cdn-typechange). Per informazioni sullo stile OFN_EXPLORER, vedere la [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) struttura e [Open e salvare come finestre di dialogo](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem

Rimuove un elemento da un controllo contenitore nella finestra di dialogo.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del controllo contenitore per l'elemento da rimuovere.

*dwIDItem*<br/>
L'ID dell'elemento.

### <a name="remarks"></a>Note

##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState

Nella finestra di dialogo, imposta lo stato corrente di un pulsante di controllo (casella di controllo).

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID della casella di controllo.

*bChecked*<br/>
Lo stato della casella di controllo. TRUE indica checked; FALSE indica è deselezionata.

### <a name="remarks"></a>Note

##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState

Imposta lo stato corrente di un elemento in un controllo contenitore trovato nella finestra di dialogo.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del controllo contenitore.

*dwIDItem*<br/>
L'ID dell'elemento.

*dwState*<br/>
Uno o più valori dall'enumerazione CDCONTROLSTATE che indicano il nuovo stato del controllo.

### <a name="remarks"></a>Note

##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText

Imposta il testo di un elemento di controllo. Ad esempio, il testo che accompagna un pulsante di opzione o un elemento in un menu.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del controllo contenitore.

*dwIDItem*<br/>
L'ID dell'elemento.

*strLabel*<br/>
Testo dell'elemento.

### <a name="remarks"></a>Note

##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel

Imposta il testo associato a un controllo, ad esempio il testo del pulsante o un'etichetta casella di modifica.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del controllo.

*strLabel*<br/>
Il nome del controllo.

### <a name="remarks"></a>Note

##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState

Imposta la visibilità corrente e gli stati di un determinato controllo abilitato.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del controllo.

*dwState*<br/>
Uno o più valori dall'enumerazione CDCONTROLSTATE che indicano lo stato corrente del controllo.

### <a name="remarks"></a>Note

##  <a name="setcontroltext"></a>  CFileDialog::SetControlText

Chiamare questo metodo per impostare il testo per il controllo specificato in un tipo Esplora risorse **aperto** oppure **Salva con nome** nella finestra di dialogo.

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Parametri

*nID*<br/>
[in] L'ID del controllo per cui impostare il testo.

*lpsz*<br/>
[in] Un puntatore a una stringa che contiene il testo da impostare per il controllo.

### <a name="remarks"></a>Note

Entrambe le versioni di questa funzione sono valide per le applicazioni che utilizzano la codifica Unicode. Tuttavia, solo la versione con il tipo LPCSTR è valida per le applicazioni che utilizzano ANSI.

Per usare questo metodo, è necessario creare la finestra di dialogo con lo stile OFN_EXPLORER. In caso contrario, la funzione avrà esito negativo con un'asserzione.

##  <a name="setdefext"></a>  CFileDialog::SetDefExt

Chiamare questa funzione per impostare l'estensione di file predefinita per una finestra di dialogo comune Open di tipo Esplora risorse o Salva con nome.

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Parametri

*lpsz*<br/>
Un puntatore a una stringa contenente l'estensione predefinita da utilizzare per l'oggetto finestra di dialogo. Questa stringa non deve contenere un punto (.).

### <a name="remarks"></a>Note

La finestra di dialogo deve essere stata creata con lo stile OFN_EXPLORER; in caso contrario, la funzione avrà esito negativo con un'asserzione.

##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText

Imposta il testo corrente in un controllo casella di modifica.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID della casella di modifica.

*strText*<br/>
Valore del testo.

### <a name="remarks"></a>Note

##  <a name="setproperties"></a>  CFileDialog::SetProperties

Fornisce un archivio delle proprietà che definisce i valori predefiniti da usare per l'elemento salvato.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Parametri

*lpszPropList*<br/>
Elenco di proprietà predefinite separate da ";". Per un elenco dei flag, vedere la **Flags** sezione [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna).

### <a name="remarks"></a>Note

##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem

Imposta lo stato selezionato di un particolare elemento in un gruppo di pulsanti di opzione o una casella combinata trovati nella finestra di dialogo.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del controllo contenitore.

*dwIDItem*<br/>
L'ID dell'elemento selezionato dall'utente nel controllo.

### <a name="remarks"></a>Note

##  <a name="settemplate"></a>  CFileDialog::SetTemplate

Imposta il modello di finestra di dialogo per la [CFileDialog](../../mfc/reference/cfiledialog-class.md) oggetto.

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Parametri

*nWin3ID*<br/>
[in] Contiene il numero di ID della risorsa modello per il non-Explorer `CFileDialog` oggetto. Questo modello viene utilizzato solo in Windows NT 3.51 o quando lo stile OFN_EXPLORER non è presente.

*nWin4ID*<br/>
[in] Contiene il numero di ID di risorsa modello per Esplora `CFileDialog` oggetto. Questo modello viene utilizzato solo in Windows NT 4.0 e versioni successive, Windows 95 e versioni successive, o quando lo stile OFN_EXPLORER è presente.

*lpWin3ID*<br/>
[in] Contiene il nome della risorsa modello per il non-Explorer `CFileDialog` oggetto. Questo modello viene utilizzato solo in Windows NT 3.51 o quando lo stile OFN_EXPLORER non è presente.

*lpWin4ID*<br/>
[in] Contiene il nome della risorsa modello di Esplora `CFileDialog` oggetto. Questo modello viene utilizzato solo in Windows NT 4.0 e versioni successive, Windows 95 e versioni successive, o quando lo stile OFN_EXPLORER è presente.

### <a name="remarks"></a>Note

Il sistema userà solo uno dei modelli specificati. Il sistema determina il modello da usare in base alla presenza di stile OFN_EXPLORER e il sistema operativo in esecuzione l'applicazione in. Se si specifica sia un non-Explorer e un modello di tipo Esplora risorse, è facile supportare Windows NT 3.51, Windows NT 4.0 e versioni successive e Windows 95 e versioni successive.

> [!NOTE]
> Windows Vista o versioni successive finestre di dialogo di file di stile non supportano questa funzione. Tentativo di utilizzare questa funzione in un Windows Vista o versione successiva finestra di dialogo file stile genererà [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Un'alternativa consiste nell'usare una finestra di dialogo personalizzata. Per altre informazioni sull'uso di una classe personalizzata `CFileDialog`, vedere [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup

Dichiara un gruppo visual nella finestra di dialogo. Le chiamate successive a qualsiasi metodo "add" aggiungono tali elementi a questo gruppo.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
L'ID del gruppo visual.

*strLabel*<br/>
Il nome del gruppo.

### <a name="remarks"></a>Note

##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog

Gli aggiornamenti di `m_ofn` struttura di dati del [CFileDialog](../../mfc/reference/cfiledialog-class.md) basata sullo stato corrente dell'oggetto interno.

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Note

Nelle versioni di Windows prima di Windows Vista, il membro [OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) struttura dei dati è stata costantemente sincronizzata con lo stato del `CFileDialog`. Tutte le modifiche per il [m_ofn](#m_ofn) variabile membro influenzate direttamente lo stato della finestra di dialogo. Inoltre, tutte le modifiche allo stato della finestra di dialogo la variabile membro m_ofn viene aggiornata immediatamente.

In Windows Vista o versioni successive, il `m_ofn` struttura dei dati non vengono aggiornata automaticamente. Per garantire l'accuratezza dei dati nella `m_ofn` variabile membro, è necessario chiamare il `UpdateOFNFromShellDialog` funzione prima accedere ai dati. Windows chiama questa funzione automaticamente durante l'elaborazione delle [IFileDialog::OnFileOK](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok).

Per altre informazioni su come usare il `CFileDialog` classe in Windows Vista o versioni successive, vedere [classe CFileDialog](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Esempio

Questo esempio viene aggiornato il `CFileDialog` prima di visualizzarla. Prima di aggiornare il `m_ofn` variabile membro, è necessario sincronizzarlo per lo stato corrente della finestra di dialogo.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>Vedere anche

[Classe CCommonDialog](../../mfc/reference/ccommondialog-class.md)<br/>
[Grafico della gerarchia](../../mfc/hierarchy-chart.md)
