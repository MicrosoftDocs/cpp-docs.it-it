---
title: Classe CFileDialog
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: a7287b2e3011159573f44e9247e016d81d893491
ms.sourcegitcommit: c3bf94210bdb73be80527166264d49e33784152c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/06/2019
ms.locfileid: "68821078"
---
# <a name="cfiledialog-class"></a>Classe CFileDialog

Incapsula la finestra di dialogo comune utilizzata per le operazioni di apertura o salvataggio di file.

## <a name="syntax"></a>Sintassi

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Members

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CFileDialog:: CFileDialog](#cfiledialog)|Costruisce un oggetto `CFileDialog`.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|Aggiunge un pulsante di selezione alla finestra di dialogo.|
|[CFileDialog::AddComboBox](#addcombobox)|Aggiunge una casella combinata alla finestra di dialogo.|
|[CFileDialog::AddControlItem](#addcontrolitem)|Aggiunge un elemento a un controllo contenitore nella finestra di dialogo.|
|[CFileDialog::AddEditBox](#addeditbox)|Aggiunge una casella di modifica alla finestra di dialogo.|
|[CFileDialog:: AggiungiMenu](#addmenu)|Aggiunge un menu alla finestra di dialogo.|
|[CFileDialog:: AddPlace](#addplace)|Di overload. Aggiunge una cartella all'elenco di posizioni disponibili per l'apertura o il salvataggio degli elementi da parte dell'utente.|
|[CFileDialog::AddPushButton](#addpushbutton)|Aggiunge un pulsante alla finestra di dialogo.|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Aggiunge un gruppo di pulsanti di opzione (noto anche come pulsante di opzione) alla finestra di dialogo.|
|[CFileDialog:: AddSeparator](#addseparator)|Aggiunge un separatore alla finestra di dialogo.|
|[CFileDialog:: AddText](#addtext)|Aggiunge contenuto di testo alla finestra di dialogo.|
|[CFileDialog:: ApplyOFNToShellDialog](#applyofntoshelldialog)|Aggiorna lo stato di `CFileDialog` in modo che corrisponda ai parametri e ai flag archiviati `m_ofn` nella variabile membro.|
|[CFileDialog::D oModal](#domodal)|Visualizza la finestra di dialogo e consente all'utente di effettuare una selezione.|
|[CFileDialog:: EnableOpenDropDown](#enableopendropdown)|Consente di abilitare un elenco a discesa nel pulsante **Apri** o **Salva** della finestra di dialogo.|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Arresta l'aggiunta di elementi a un gruppo visivo nella finestra di dialogo.|
|[CFileDialog:: GetCheckButtonState](#getcheckbuttonstate)|Ottiene lo stato corrente di un pulsante di selezione (casella di controllo) nella finestra di dialogo.|
|[CFileDialog:: GetControlItemState](#getcontrolitemstate)|Ottiene lo stato corrente di un elemento in un controllo contenitore trovato nella finestra di dialogo.|
|[CFileDialog:: GetControlState](#getcontrolstate)|Ottiene gli Stati di visibilità e abilitazione correnti di un determinato controllo.|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Ottiene il testo corrente in un controllo casella di modifica.|
|[CFileDialog:: GetFileExt](#getfileext)|Restituisce l'estensione del file selezionato.|
|[CFileDialog:: GetFileName](#getfilename)|Restituisce il nome del file selezionato.|
|[CFileDialog:: GetFileTitle](#getfiletitle)|Restituisce il titolo del file selezionato.|
|[CFileDialog:: GetFolderPath](#getfolderpath)|Recupera il percorso della cartella o della directory attualmente aperta per una finestra di dialogo **Apri** o **Salva come** comune di tipo Esplora risorse.|
|[CFileDialog:: GetIFileDialogCustomize](#getifiledialogcustomize)|Recupera l'oggetto com interno per un oggetto `CFileDialog` personalizzato.|
|[CFileDialog:: GetIFileOpenDialog](#getifileopendialog)|Recupera l'oggetto com interno per un `CFileDialog` utilizzato come finestra di dialogo **Apri** file.|
|[CFileDialog:: GetIFileSaveDialog](#getifilesavedialog)|Recupera l'oggetto com interno per un `CFileDialog` oggetto utilizzato come finestra di dialogo **Salva** file.|
|[CFileDialog:: GetNextPathName](#getnextpathname)|Restituisce il percorso completo del file selezionato successivo.|
|[CFileDialog:: GetOFN](#getofn)|Recupera la `OPENFILENAME` struttura `CFileDialog` dell'oggetto.|
|[CFileDialog:: GetPathName](#getpathname)|Restituisce il percorso completo del file selezionato.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Restituisce lo stato di sola lettura del file selezionato.|
|[CFileDialog:: GetResult](#getresult)|Ottiene la scelta effettuata dall'utente nella finestra di dialogo.|
|[CFileDialog:: GetResults](#getresults)|Ottiene le scelte dell'utente in una finestra di dialogo che consente la selezione multipla.|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Ottiene un particolare elemento dai controlli contenitore specificati nella finestra di dialogo.|
|[CFileDialog:: GetStartPosition](#getstartposition)|Restituisce la posizione del primo elemento dell'elenco dei nomi di file.|
|[CFileDialog::HideControl](#hidecontrol)|Nasconde il controllo specificato in una finestra di dialogo **Apri** o **Salva come** comune di tipo Esplora risorse.|
|[CFileDialog:: IsPickFoldersMode](#ispickfoldersmode)|Determina se la finestra di dialogo corrente è in modalità di selezione cartelle.|
|[CFileDialog:: MakeProminent](#makeprominent)|Inserisce un controllo nella finestra di dialogo in modo che si trovi rispetto ad altri controlli aggiunti.|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Rimuove un elemento da un controllo contenitore nella finestra di dialogo.|
|[CFileDialog:: SetCheckButtonState](#setcheckbuttonstate)|Imposta lo stato corrente di un pulsante di selezione (casella di controllo) nella finestra di dialogo.|
|[CFileDialog:: SetControlItemState](#setcontrolitemstate)|Imposta lo stato corrente di un elemento in un controllo contenitore trovato nella finestra di dialogo.|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Imposta il testo di un elemento del controllo. Ad esempio, il testo che accompagna un pulsante di opzione o un elemento in un menu.|
|[CFileDialog:: SetControlLabel](#setcontrollabel)|Imposta il testo associato a un controllo, ad esempio il testo del pulsante o l'etichetta di una casella di modifica.|
|[CFileDialog:: SetControlState](#setcontrolstate)|Imposta la visibilità corrente e gli stati abilitati di un determinato controllo.|
|[CFileDialog::SetControlText](#setcontroltext)|Imposta il testo per il controllo specificato in una finestra di dialogo **Apri** o **Salva come** comune di tipo Esplora risorse.|
|[CFileDialog:: SetDefExt](#setdefext)|Imposta l'estensione predefinita del nome di file per una finestra di dialogo **Apri** o **Salva come** comune di tipo Esplora risorse.|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Imposta il testo corrente in un controllo casella di modifica.|
|[CFileDialog:: seproprietà](#setproperties)|Fornisce un archivio delle proprietà che definisce i valori predefiniti da usare per l'elemento salvato.|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Imposta lo stato selezionato di un particolare elemento in un gruppo di pulsanti di opzione o in una casella combinata presente nella finestra di dialogo.|
|[CFileDialog:: setemplate](#settemplate)|Imposta il modello della finestra di dialogo `CFileDialog` per l'oggetto.|
|[CFileDialog:: StartVisualGroup](#startvisualgroup)|Dichiara un gruppo visivo nella finestra di dialogo. Le chiamate successive a qualsiasi metodo "Add" aggiungono tali elementi a questo gruppo.|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Aggiorna i dati archiviati nella `m_ofn` variabile membro in modo che corrispondano allo stato corrente della finestra di dialogo file.|

### <a name="protected-methods"></a>Metodi protetti

|NOME|Descrizione|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Chiamato quando si fa clic sul pulsante.|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Chiamato quando la casella di controllo è selezionata o deselezionata.|
|[CFileDialog:: OnControlActivating](#oncontrolactivating)|Chiamato quando il controllo è attivo.|
|[CFileDialog:: OnFileNameChange](#onfilenamechange)|Gestisce il messaggio WM_NOTIFY CDN_SELCHANGE.|
|[CFileDialog:: OnFileNameOK](#onfilenameok)|Convalida il nome file immesso nella finestra di dialogo.|
|[CFileDialog:: OnFolderChange](#onfolderchange)|Gestisce il messaggio WM_NOTIFY CDN_FOLDERCHANGE.|
|[CFileDialog:: OnInitDone](#oninitdone)|Gestisce il messaggio WM_NOTIFY CDN_INITDONE.|
|[CFileDialog:: OnItemSelected](#onitemselected)|Chiamato quando viene selezionato l'elemento del contenitore.|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Consente di eseguire azioni personalizzate quando viene modificata la selezione dei file.|
|[CFileDialog:: OnShareViolation](#onshareviolation)|Gestisce le violazioni di condivisione.|
|[CFileDialog::OnTypeChange](#ontypechange)|Gestisce il messaggio WM_NOTIFY CDN_TYPECHANGE.|

### <a name="public-data-members"></a>Membri dati pubblici

|NOME|DESCRIZIONE|
|----------|-----------------|
|[CFileDialog:: m_ofn](#m_ofn)|Struttura di `OPENFILENAME` Windows. Consente di accedere ai parametri della finestra di dialogo file di base.|

## <a name="remarks"></a>Note

Le finestre di dialogo file comuni consentono di implementare le finestre di dialogo di selezione file, ad esempio **aprire file** e **Salva con nome**, in modo coerente con gli standard di Windows.

È possibile usare `CFileDialog` così com'è con il costruttore fornito oppure è possibile derivare la propria classe della finestra `CFileDialog` di dialogo da e scrivere un costruttore in base alle esigenze. In entrambi i casi, queste finestre di dialogo si comporteranno come le finestre di dialogo MFC standard, perché derivano dalla [classe CCommonDialog](../../mfc/reference/ccommondialog-class.md). `CFileDialog`si basa su COMMDLG. File DLL incluso in Windows.

Sia l'aspetto che la funzionalità di `CFileDialog` con Windows Vista o versioni successive differiscono dalle versioni precedenti di Windows. Il valore `CFileDialog` predefinito usa automaticamente il nuovo stile di Windows Vista o versione successiva senza modifiche al codice se un programma viene compilato ed eseguito in Windows Vista o versione successiva. Usare il parametro *bVistaStyle* nel costruttore per eseguire manualmente l'override di questo aggiornamento automatico. L'eccezione per l'aggiornamento automatico è rappresentata dalle finestre di dialogo personalizzate. Non verranno convertiti nel nuovo stile. Per ulteriori informazioni sul costruttore, vedere [CFileDialog:: CFileDialog](#cfiledialog).

> [!NOTE]
>  Il sistema ID controllo è diverso in Windows Vista o versioni successive rispetto alle versioni precedenti di Windows quando si `CFileDialog`utilizza un. Prima di poter trasferire il progetto `CFileDialog` da una versione precedente di Windows, è necessario aggiornare tutti i riferimenti ai controlli nel codice.

Alcuni `CFileDialog` metodi non sono supportati in Windows Vista o versioni successive. Per informazioni sull'eventuale supporto del metodo, vedere l'argomento relativo al singolo metodo. Inoltre, le funzioni ereditate seguenti non sono supportate in Windows Vista o versioni successive:

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog:: OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

I messaggi di Windows per `CFileDialog` la classe variano in base al sistema operativo in uso. Windows XP, ad esempio, non supporta [CDialog:: OnCancel](../../mfc/reference/cdialog-class.md#oncancel) e [CDialog:: OnOK (](../../mfc/reference/cdialog-class.md#onok) per la `CFileDialog` classe. Tuttavia, Windows Vista e sistemi operativi successivi li supportano. Per ulteriori informazioni sui diversi messaggi generati e sull'ordine in cui vengono ricevuti, vedere [esempio CFileDialog: Ordine](../../overview/visual-cpp-samples.md)degli eventi di registrazione.

Per utilizzare un `CFileDialog` oggetto, creare innanzitutto l'oggetto utilizzando il `CFileDialog` costruttore. Dopo che la finestra di dialogo è stata costruita, è possibile impostare o modificare qualsiasi valore nella struttura [CFileDialog:: m_ofn](#m_ofn) per inizializzare i valori o gli Stati dei controlli della finestra di dialogo. La `m_ofn` struttura è di tipo `OPENFILENAME`. Per ulteriori informazioni, vedere la struttura [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) nel Windows SDK.

Dopo aver inizializzato i controlli della finestra di dialogo, chiamare il metodo [CFileDialog::D omodal](#domodal) per visualizzare la finestra di dialogo in modo che l'utente possa digitare il percorso e il nome del file. `DoModal`Restituisce un valore che indica se l'utente ha fatto clic su OK (IDOK) o sul pulsante Annulla (IDCANCEL). Se `DoModal` restituisce IDOK, è possibile usare una `CFileDialog` delle funzioni membro pubbliche per recuperare le informazioni inserite dall'utente.

> [!NOTE]
> In Windows Vista o versioni successive, più chiamate a [IFileDialog::](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) setypes generano un errore. La seconda chiamata a `SetFileTypes` per qualsiasi istanza `CFileDialog` di restituirà E_UNEXPECTED in Windows Vista o versioni successive. Alcune `CFileDialog` funzioni di metodo `SetFileTypes`chiamano. Ad esempio, due chiamate a `CFileDialog::DoModal` per la stessa istanza di un `CFileDialog` oggetto generano [Assert](diagnostic-services.md#assert).

`CFileDialog`include diversi membri protetti che consentono di gestire in modo personalizzato le violazioni di condivisione, la convalida dei nomi di file e la notifica di modifica della casella di riepilogo. Questi membri protetti sono funzioni di callback che la maggior parte delle applicazioni non è necessario utilizzare perché la gestione predefinita viene eseguita automaticamente. Le voci della mappa messaggi per queste funzioni non sono necessarie perché sono funzioni virtuali standard.

È possibile utilizzare la funzione [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) di Windows per determinare se si è verificato un errore durante l'inizializzazione della finestra di dialogo e per ottenere ulteriori informazioni sull'errore.

L'eliminazione degli `CFileDialog` oggetti viene gestita automaticamente. Non è necessario chiamare [CDialog:: EndDialog](../../mfc/reference/cdialog-class.md#enddialog).

Per consentire all'utente di selezionare più file, impostare il flag OFN_ALLOWMULTISELECT prima di `DoModal`chiamare. È necessario fornire il proprio buffer di nome file per contenere l'elenco restituito di più nomi di file. A tale scopo, `m_ofn.lpstrFile` sostituire con un puntatore a un buffer allocato, dopo avere `CFileDialog`costruito, ma prima di chiamare `DoModal`.

Inoltre, è necessario impostare `m_ofn.nMaxFile` usando il numero di caratteri nel buffer `m_ofn.lpstrFile`a cui punta. Se si imposta il numero massimo di file da selezionare `n`, la dimensione del buffer richiesta è. `n * (_MAX_PATH + 1) + 1` Il primo elemento restituito nel buffer è il percorso della cartella in cui sono stati selezionati i file. Per le finestre di dialogo di Windows Vista o versioni successive, la directory e le stringhe dei nomi file sono con terminazione null, con un carattere null aggiuntivo dopo l'ultimo nome file. Questo formato consente alle finestre di dialogo di tipo Esplora risorse di restituire nomi di file lunghi che includono spazi. Per le finestre di dialogo obsolete, le stringhe di directory e nome file sono separate da spazi e la funzione usa nomi file brevi per i nomi di file con spazi.

Nell'esempio seguente viene illustrato come utilizzare un buffer per recuperare ed elencare più nomi di file.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Per modificare la dimensione del buffer in risposta all'utente che seleziona più nomi di file, è necessario derivare una `CFileDialog` nuova classe da ed eseguire l'override del metodo [CFileDialog:: OnFileNameChange](#onfilenamechange) .

Se si deriva una nuova classe da `CFileDialog`, è possibile utilizzare una mappa messaggi per gestire tutti i messaggi. Per estendere la gestione dei messaggi predefinita, derivare una `CFileDialog`classe da, aggiungere una mappa messaggi alla nuova classe e fornire funzioni membro per i nuovi messaggi. Non è necessario fornire una funzione hook per personalizzare la finestra di dialogo.

Per personalizzare la finestra di dialogo, derivare una `CFileDialog`classe da, fornire un modello di finestra di dialogo personalizzato e aggiungere una mappa messaggi per elaborare i messaggi di notifica dai controlli estesi. Passare tutti i messaggi non elaborati alla classe di base. Non è necessario personalizzare la funzione hook.

Quando si utilizza lo stile di Windows Vista o versioni successive del `CFileDialog`, non è possibile utilizzare le mappe messaggi e i modelli di finestra di dialogo. Al contrario, è necessario utilizzare le interfacce COM per una funzionalità simile.

Per ulteriori informazioni sull'utilizzo `CFileDialog`di, vedere [Common Dialog Classes](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Requisiti

**Intestazione:** afxdlgs. h

##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton

Aggiunge un pulsante di selezione alla finestra di dialogo.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del pulsante di controllo da aggiungere.

*strLabel*<br/>
Nome del pulsante di controllo.

*bChecked*<br/>
Valore booleano che indica lo stato corrente del pulsante di controllo. TRUE se selezionato; FALSE in caso contrario

### <a name="remarks"></a>Note

##  <a name="addcombobox"></a>  CFileDialog::AddComboBox

Aggiunge una casella combinata alla finestra di dialogo.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID della casella combinata da aggiungere.

### <a name="remarks"></a>Note

##  <a name="addcontrolitem"></a>CFileDialog:: AddControlItem

Aggiunge un elemento a un controllo contenitore nella finestra di dialogo.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del controllo contenitore a cui aggiungere l'elemento.

*dwIDItem*<br/>
ID dell'elemento.

*strLabel*<br/>
Testo dell'elemento.

### <a name="remarks"></a>Note

##  <a name="addeditbox"></a>CFileDialog:: AddEditBox

Aggiunge una casella di modifica alla finestra di dialogo.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID della casella di modifica da aggiungere.

*strText*<br/>
Nome della casella di modifica.

### <a name="remarks"></a>Note

##  <a name="addmenu"></a>CFileDialog:: AggiungiMenu

Aggiunge un menu alla finestra di dialogo.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del menu da aggiungere.

*strLabel*<br/>
Nome del menu.

### <a name="remarks"></a>Note

##  <a name="addplace"></a>CFileDialog:: AddPlace

Aggiunge una cartella all'elenco di posizioni disponibili per l'apertura o il salvataggio degli elementi da parte dell'utente.

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Parametri

*lpszFolder*<br/>
Percorso della cartella da rendere disponibile all'utente. Può trattarsi solo di una cartella.

*fdap*<br/>
Specifica la posizione della cartella all'interno dell'elenco.

*psi*<br/>
Puntatore a un IShellItem che rappresenta la cartella da rendere disponibile per l'utente. Può trattarsi solo di una cartella.

### <a name="remarks"></a>Note

##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton

Aggiunge un pulsante alla finestra di dialogo.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del pulsante da aggiungere.

*strLabel*<br/>
Nome del pulsante.

### <a name="remarks"></a>Note

##  <a name="addradiobuttonlist"></a>CFileDialog:: AddRadioButtonList

Aggiunge un gruppo di pulsanti di opzione (noto anche come pulsante di opzione) alla finestra di dialogo.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del gruppo di pulsanti di opzione da aggiungere.

### <a name="remarks"></a>Note

##  <a name="addseparator"></a>CFileDialog:: AddSeparator

Aggiunge un separatore alla finestra di dialogo.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del separatore Add.

### <a name="remarks"></a>Note

##  <a name="addtext"></a>CFileDialog:: AddText

Aggiunge testo alla finestra di dialogo.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del testo da aggiungere.

*strText*<br/>
Nome del testo.

### <a name="remarks"></a>Note

##  <a name="applyofntoshelldialog"></a>CFileDialog:: ApplyOFNToShellDialog

Aggiorna lo stato corrente di [CFileDialog](../../mfc/reference/cfiledialog-class.md) in base ai valori archiviati nella `m_ofn` struttura dei dati.

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Note

Nelle versioni di Windows precedenti a Windows Vista, la struttura dei dati [OpenFileName](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) del membro veniva continuamente sincronizzata con `CFileDialog`lo stato di. Tutte le modifiche apportate alla variabile membro [m_ofn](#m_ofn) sono state riflesse immediatamente nello stato della finestra di dialogo. Inoltre, tutte le modifiche apportate allo stato della finestra di dialogo `m_ofn` aggiornano immediatamente la variabile membro.

In Windows Vista o versioni successive, non `m_ofn` `CFileDialog` è garantito che i valori nella variabile membro e nello stato di siano sincronizzati. Questa funzione impone che lo stato dell' `CFileDialog` oggetto venga aggiornato in modo che `m_ofn` corrisponda alla struttura. Windows chiama automaticamente questa funzione durante [CFileDialog::D omodal](#domodal).

Per ulteriori informazioni su come utilizzare la classe `CFileDialog` in Windows Vista o versioni successive, vedere la [classe CFileDialog](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Esempio

  Vedere l'esempio per [CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog).

##  <a name="cfiledialog"></a>CFileDialog:: CFileDialog

Chiamare questa funzione per costruire una finestra di dialogo file standard di Windows.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Parametri

*bOpenFileDialog*<br/>
in Parametro che specifica il tipo di finestra di dialogo da creare. Impostarla su TRUE per costruire una finestra di dialogo **Apri file** . Impostarla su FALSE per costruire una finestra di dialogo **Salva con nome file** .

*lpszDefExt*<br/>
in Estensione del nome file predefinita. Se l'utente non include un'estensione nota, ovvero una che dispone di un'associazione nel computer dell'utente, nella casella nome file, l'estensione specificata da *lpszDefExt* viene automaticamente aggiunta al nome del file. Se questo parametro è NULL, non viene aggiunta alcuna estensione.

*lpszFileName*<br/>
in Nome file iniziale visualizzato nella casella nome file. Se è NULL, non viene visualizzato alcun nome file iniziale.

*dwFlags*<br/>
in Combinazione di uno o più flag che è possibile utilizzare per personalizzare la finestra di dialogo. Per una descrizione di questi flag, vedere la struttura [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) nel Windows SDK. Se si modifica il `m_ofn.Flags` membro della struttura, utilizzare un operatore OR bit per bit nelle modifiche per mantenere intatto il comportamento predefinito.

*lpszFilter*<br/>
in Serie di coppie di stringhe che specificano i filtri che è possibile applicare al file. Se si specificano filtri di file, nell'elenco file verranno visualizzati solo i file che corrispondono ai criteri di filtro. Per ulteriori informazioni sull'utilizzo dei filtri di file, vedere la sezione Osservazioni.

*pParentWnd*<br/>
in Puntatore alla finestra padre o proprietaria della finestra di dialogo file.

*dwSize*<br/>
in Dimensione della `OPENFILENAME` struttura. Questo valore dipende dalla versione del sistema operativo. MFC utilizza questo parametro per determinare il tipo appropriato di finestra di dialogo da creare. La dimensione predefinita 0 indica che il codice MFC determinerà le dimensioni corrette della finestra di dialogo da utilizzare in base alla versione del sistema operativo in cui viene eseguito il programma.

*bVistaStyle*<br/>
in **Nota** Questo parametro è disponibile in Visual Studio 2008 e versioni successive e fa in modo che la finestra di dialogo nuovo stile venga utilizzata solo se si esegue in Windows Vista o versione successiva.

Parametro che specifica lo stile della finestra di dialogo del file. Impostarla su TRUE per utilizzare le nuove finestre di dialogo file di stile vista. In caso contrario, verrà utilizzato lo stile precedente delle finestre di dialogo. Per ulteriori informazioni sull'esecuzione in vista, vedere la sezione Osservazioni.

### <a name="remarks"></a>Note

Viene creata una finestra di dialogo **Apri file** o **Salva con nome** , a seconda del valore di *bOpenFileDialog*.

La specifica di un'estensione predefinita con *lpszDefExt* potrebbe non produrre il comportamento previsto, perché raramente è prevedibile quali estensioni hanno associazioni di file nel computer dell'utente. Se è necessario un maggiore controllo sull'accodamento di un'estensione predefinita, è possibile derivare la propria classe `CFileDialog`da ed eseguire l' `CFileDialog::OnFileNameOK` override del metodo per eseguire la gestione delle estensioni.

Per consentire all'utente di selezionare più file, impostare il flag OFN_ALLOWMULTISELECT prima di chiamare [DoModal](#domodal). Per archiviare l'elenco restituito di più nomi di file, è necessario fornire il proprio buffer di nome file. A tale scopo, `m_ofn.lpstrFile` sostituire con un puntatore a un buffer allocato, dopo la costruzione di [CFileDialog](../../mfc/reference/cfiledialog-class.md), ma prima di chiamare `DoModal`. Inoltre, è necessario impostare `m_ofn.nMaxFile` con il numero di caratteri nel buffer `m_ofn.lpstrFile`a cui punta. Se si imposta il numero massimo di file da selezionare su *n*, le dimensioni del buffer necessarie sono `n`* (_MAX_PATH + 1) + 1. Ad esempio:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Per consentire all'utente di ridimensionare una finestra di dialogo di tipo Esplora utilizzando il mouse o la tastiera, impostare il flag OFN_ENABLESIZING. L'impostazione di questo flag è necessaria solo se si fornisce una procedura di hook o un modello personalizzato. Il flag funziona solo con una finestra di dialogo di tipo Esplora risorse. non è possibile ridimensionare le finestre di dialogo obsolete.

Il parametro *lpszFilter* viene usato per determinare il tipo di nome file che deve essere visualizzato nell'elenco file. La prima stringa nella coppia di stringhe descrive il filtro. la seconda stringa indica l'estensione del nome file da utilizzare. È possibile specificare più estensioni usando un punto e virgola (il carattere ";") come delimitatore. La stringa termina con due caratteri&#124;'', seguiti da un carattere null. È anche possibile usare un oggetto [CString](../../atl-mfc-shared/using-cstring.md) per questo parametro.

Ad esempio, Microsoft Excel consente agli utenti di aprire i file con estensione xlc (grafico) o xls (foglio di lavoro), tra gli altri. Il filtro per Excel può essere scritto come segue:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

Tuttavia, se si prevede di utilizzare questa stringa per aggiornare direttamente la `OPENFILENAME` struttura, è necessario delimitare le stringhe con il carattere null ' \ 0' anziché le barre verticali ('&#124;').

Il parametro *bVistaStyle* è applicabile solo quando è in esecuzione in Windows Vista o versione successiva. Nelle versioni precedenti di Windows, questo parametro viene ignorato. Se *bVistaStyle* è impostato su true, quando si compila un programma con Visual Studio 2008 o versione successiva, verrà usata la **finestra di dialogo nuovo file** di stile vista. In caso contrario, verrà utilizzata la **finestra di dialogo file** di stile MFC precedente.

I modelli di finestra di dialogo non sono supportati nelle finestre di dialogo basate su *bVistaStyle*

### <a name="example"></a>Esempio

  Vedere l'esempio per [CFileDialog::D omodal](#domodal).

##  <a name="domodal"></a>CFileDialog::D oModal

Chiamare questa funzione per visualizzare la finestra di dialogo file comune di Windows e consentire all'utente di esplorare i file e le directory e immettere un nome file.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Valore restituito

IDOK o IDCANCEL. Se viene restituito IDCANCEL, chiamare la funzione [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) di Windows per determinare se si è verificato un errore.

IDOK e IDCANCEL sono costanti che indicano se l'utente ha selezionato il pulsante OK o Annulla.

### <a name="remarks"></a>Note

Se si desidera inizializzare le varie opzioni della finestra di dialogo file impostando i membri `m_ofn` della struttura, è necessario eseguire questa operazione `DoModal`prima di chiamare, ma dopo la costruzione dell'oggetto finestra di dialogo.

Se ad esempio si desidera consentire all'utente di selezionare più file, impostare il flag OFN_ALLOWMULTISELECT prima di chiamare `DoModal`, come illustrato nell'esempio di codice in questo argomento.

Quando l'utente fa clic sui pulsanti OK o Annulla della finestra di dialogo oppure seleziona l'opzione Chiudi dal menu di controllo della finestra di dialogo, il controllo viene restituito all'applicazione. È quindi possibile chiamare altre funzioni membro per recuperare le impostazioni o le informazioni che l'utente immette nella finestra di dialogo.

`DoModal`è una funzione virtuale sottoposta a `CDialog`override dalla classe.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>CFileDialog:: EnableOpenDropDown

Consente di abilitare un elenco a discesa nel pulsante Apri o Salva della finestra di dialogo.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID dell'elenco a discesa.

### <a name="remarks"></a>Note

##  <a name="endvisualgroup"></a>CFileDialog:: EndVisualGroup

Arresta l'aggiunta di elementi a un gruppo visivo nella finestra di dialogo.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Valore restituito

Restituisce S_OK se ha esito positivo; in caso contrario, un valore di errore.

### <a name="remarks"></a>Note

##  <a name="getcheckbuttonstate"></a>CFileDialog:: GetCheckButtonState

Recupera lo stato corrente di un pulsante di selezione (casella di controllo) nella finestra di dialogo.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID della casella di controllo.

*bChecked*<br/>
Stato della casella di controllo. TRUE indica controllato; FALSE indica che l'opzione è deselezionata.

### <a name="remarks"></a>Note

##  <a name="getcontrolitemstate"></a>CFileDialog:: GetControlItemState

Recupera lo stato corrente di un elemento in un controllo contenitore trovato nella finestra di dialogo.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del controllo contenitore.

*dwIDItem*<br/>
ID dell'elemento.

*dwState*<br/>
Riferimento a una variabile che riceve uno o più valori dall'enumerazione CDCONTROLSTATE che indica lo stato corrente del controllo.

### <a name="remarks"></a>Note

##  <a name="getcontrolstate"></a>CFileDialog:: GetControlState

Recupera gli Stati di visibilità e abilitazione correnti di un determinato controllo.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del controllo.

*dwState*<br/>
Riferimento a una variabile che riceve uno o più valori dall'enumerazione CDCONTROLSTATE che indica lo stato corrente del controllo.

### <a name="remarks"></a>Note

##  <a name="geteditboxtext"></a>CFileDialog:: GetEditBoxText

Recupera il testo corrente in un controllo casella di modifica.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID della casella di modifica.

*strText*<br/>
Valore del testo.

### <a name="remarks"></a>Note

##  <a name="getfileext"></a>CFileDialog:: GetFileExt

Chiamare questa funzione per recuperare l'estensione del nome file immesso nella finestra di dialogo.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Valore restituito

Estensione del nome file.

### <a name="remarks"></a>Note

Ad esempio, se il nome del file immesso è dati. Txt, `GetFileExt` restituisce "txt".

Se `m_ofn.Flags` è impostato il flag OFN_ALLOWMULTISELECT, questa stringa contiene una sequenza di stringhe con terminazione null, con la prima stringa che corrisponde al percorso di directory del gruppo di file selezionato, seguito dai nomi di tutti i file selezionati dall'utente. Per recuperare i percorsi dei file, usare le funzioni membro [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) .

##  <a name="getfilename"></a>CFileDialog:: GetFileName

Chiamare questa funzione per recuperare il nome del nome file immesso nella finestra di dialogo.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Valore restituito

Nome del file.

### <a name="remarks"></a>Note

Il nome del file include sia il prefisso che l'estensione. Ad esempio, `GetFileName` restituirà "text. DAT "per il file C:\FILES\TEXT.DAT.

Se `m_ofn.Flags` è impostato `OFN_ALLOWMULTISELECT` il flag, è necessario chiamare [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) per recuperare un percorso di file.

##  <a name="getfiletitle"></a>CFileDialog:: GetFileTitle

Chiamare questa funzione per recuperare il titolo del file immesso nella finestra di dialogo.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Valore restituito

Titolo del file.

### <a name="remarks"></a>Note

Il titolo del file include solo il prefisso, senza il percorso o l'estensione. Ad esempio, `GetFileTitle` restituirà "Text" per il file C:\FILES\TEXT.dat.

Se `m_ofn.Flags` è impostato il flag OFN_ALLOWMULTISELECT, questa stringa contiene una sequenza di stringhe con terminazione null, con la prima stringa che corrisponde al percorso di directory del gruppo di file selezionato, seguito dai nomi di tutti i file selezionati dall'utente. Per questo motivo, usare le funzioni membro [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) per recuperare il nome file successivo nell'elenco.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CFileDialog::D omodal](#domodal).

##  <a name="getfolderpath"></a>CFileDialog:: GetFolderPath

Chiamare questa funzione membro per recuperare il percorso della cartella o della directory attualmente aperta per una finestra di dialogo Apri o Salva come comune di tipo Esplora risorse.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Valore restituito

Oggetto [CString](../../atl-mfc-shared/reference/cstringt-class.md) contenente la cartella o la directory attualmente aperta.

### <a name="remarks"></a>Note

La finestra di dialogo deve essere stata creata con lo stile OFN_EXPLORER. in caso contrario, il metodo avrà esito negativo con un'asserzione.

È possibile chiamare questo metodo solo quando viene visualizzata la finestra di dialogo. Dopo la chiusura della finestra di dialogo, questa funzione non funzionerà più e il metodo avrà esito negativo con un'asserzione.

##  <a name="getifiledialogcustomize"></a>CFileDialog:: GetIFileDialogCustomize

Recupera un puntatore all'oggetto COM interno per un determinato [CFileDialog](../../mfc/reference/cfiledialog-class.md).

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Valore restituito

Puntatore all'oggetto COM interno per l' `CFileDialog`oggetto. È responsabilità dell'utente rilasciare questo puntatore in modo appropriato.

### <a name="remarks"></a>Note

Utilizzare questa funzione solo in Windows Vista o versione successiva con un oggetto con *bVistaStyle* impostato su true. Se si usa questa funzione quando *bVistaStyle* è false, viene restituito null in modalità di rilascio e viene generata un'asserzione in modalità di debug.

Per ulteriori informazioni sull' `IFileDialogCustomize` interfaccia, vedere [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Esempio

In questo esempio viene recuperato l'oggetto COM interno. Per eseguire questo esempio di codice, è necessario compilarlo in Windows Vista o versioni successive.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>CFileDialog:: GetIFileOpenDialog

Recupera un puntatore all'oggetto COM interno per un oggetto specificato `CFileDialog`.

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Valore restituito

Puntatore all'oggetto COM interno per l' `CFileDialog`oggetto. È responsabilità dell'utente rilasciare questo puntatore in modo appropriato.

### <a name="remarks"></a>Note

Utilizzare questa funzione solo in Windows Vista o versione successiva con un oggetto con *bVistaStyle* impostato su true. Questa funzione restituisce null se `CFileDialog` non è una finestra di dialogo **aperta** o se *bVistaStyle* è impostato su false. In quest'ultimo caso, la funzione restituisce NULL solo in modalità di rilascio, in modalità di debug, verrà generata un'asserzione.

Per ulteriori informazioni sull' `IFileOpenDialog` interfaccia, vedere [IFileOpenDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifileopendialog).

### <a name="example"></a>Esempio

In questo esempio viene recuperato l'oggetto COM interno. Per eseguire questo codice, è necessario compilarlo in Windows Vista o versioni successive.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>CFileDialog:: GetIFileSaveDialog

Recupera un puntatore all'oggetto COM interno per un oggetto specificato `CFileDialog`.

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Valore restituito

Puntatore all'oggetto COM interno per l' `CFileDialog`oggetto. È responsabilità dell'utente rilasciare questo puntatore in modo appropriato.

### <a name="remarks"></a>Note

Utilizzare questa funzione solo in Windows Vista o versione successiva con un oggetto con *bVistaStyle* impostato su true. Questa funzione restituirà null se `CFileDialog` non è una finestra di dialogo **Salva** o se *bVistaStyle* è impostato su false. In quest'ultimo caso, la funzione restituisce NULL solo in modalità di rilascio, in modalità di debug, verrà generata un'asserzione.

Per ulteriori informazioni sull' `IFileSaveDialog` interfaccia, vedere [IFileSaveDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Esempio

In questo esempio viene recuperato l'oggetto COM interno. Per eseguire questo esempio di codice, è necessario compilarlo in Windows Vista o versioni successive.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>CFileDialog:: GetNextPathName

Chiamare questa funzione per recuperare il nome file successivo dal gruppo selezionato nella finestra di dialogo.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Parametri

*POS*<br/>
Riferimento a un valore di posizione restituito da una chiamata `GetNextPathName` di `GetStartPosition` funzione o precedente. NULL se è stata raggiunta la fine dell'elenco.

### <a name="return-value"></a>Valore restituito

Percorso completo del file.

### <a name="remarks"></a>Note

Il percorso del nome file include il titolo del file e l'intero percorso di directory. Ad esempio, `GetNextPathName` restituirà "C:\FILES\TEXT. DAT "per il file C:\FILES\TEXT.DAT. È possibile usare `GetNextPathName` in un ciclo di iterazione in diretta se si stabilisce la posizione iniziale con `GetStartPosition`una chiamata a.

Se la selezione è costituita da un solo file, verrà restituito il nome del file.

##  <a name="getofn"></a>CFileDialog:: GetOFN

Recupera la struttura `OPENFILENAME` associata.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Valore restituito

Struttura [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) .

### <a name="remarks"></a>Note

Utilizzare la seconda versione di questa funzione per inizializzare l'aspetto di una finestra di dialogo **Apri file** o **Salva con nome file** dopo che è stata costruita, ma prima `DoModal` che venga visualizzata con la funzione membro. Ad esempio, è possibile impostare il `lpstrTitle` membro di `m_ofn` sulla didascalia desiderata per la finestra di dialogo.

##  <a name="getpathname"></a>CFileDialog:: GetPathName

Chiamare questa funzione per recuperare il percorso completo del file immesso nella finestra di dialogo.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Valore restituito

Percorso completo del file.

### <a name="remarks"></a>Note

Il percorso del nome file include il titolo del file e l'intero percorso di directory. Ad esempio, `GetPathName` restituirà "C:\FILES\TEXT. DAT "per il file C:\FILES\TEXT.DAT.

Se `m_ofn.Flags` è impostato il flag OFN_ALLOWMULTISELECT, questa stringa contiene una sequenza di stringhe teminated null, con la prima stringa che corrisponde al percorso di directory del gruppo di file selezionato, seguito dai nomi di tutti i file selezionati dall'utente. Per questo motivo, usare le funzioni membro [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) per recuperare il nome file successivo nell'elenco.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CFileDialog::D omodal](#domodal).

##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref

Chiamare questa funzione per determinare se la casella di controllo di sola lettura è stata selezionata nelle finestre di dialogo Apri e Salva con nome del file standard di Windows.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se è selezionata la casella di controllo di sola lettura nella finestra di dialogo; in caso contrario, 0.

### <a name="remarks"></a>Note

È possibile nascondere la casella di controllo sola lettura impostando lo stile OFN_HIDEREADONLY nel `CFileDialog` costruttore.

> [!NOTE]
> Questa funzione non è supportata `CFileDialog` dagli oggetti di Windows Vista o versioni successive. Il tentativo di utilizzare questa funzione in uno stile `CFileDialog` di Windows Vista o versione successiva genererà [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="getresult"></a>CFileDialog:: GetResult

Recupera la scelta effettuata dall'utente nella finestra di dialogo.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Valore restituito

Puntatore a un IShellItem che rappresenta la scelta dell'utente.

### <a name="remarks"></a>Note

##  <a name="getresults"></a>CFileDialog:: GetResults

Recupera le scelte dell'utente in una finestra di dialogo che consente la selezione multipla.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Valore restituito

Puntatore a un IShellItemArray tramite il quale è possibile accedere agli elementi selezionati nella finestra di dialogo.

### <a name="remarks"></a>Note

##  <a name="getselectedcontrolitem"></a>CFileDialog:: GetSelectedControlItem

Recupera un particolare elemento dal controllo contenitore specificato nella finestra di dialogo.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del controllo contenitore.

*dwIDItem*<br/>
ID dell'elemento selezionato dall'utente nel controllo.

### <a name="remarks"></a>Note

##  <a name="getstartposition"></a>CFileDialog:: GetStartPosition

Chiamare questa funzione membro per recuperare la posizione del primo percorso del file nell'elenco, se `m_ofn.Flags` è impostato il flag OFN_ALLOWMULTISELECT.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Valore restituito

Valore di posizione che può essere utilizzato per l'iterazione. NULL se l'elenco è vuoto.

##  <a name="hidecontrol"></a>CFileDialog:: HideControl

Chiamare questa funzione membro per nascondere il controllo specificato in una finestra di dialogo Apri o Salva come comune di tipo Esplora risorse.

```
void HideControl(int nID);
```

### <a name="parameters"></a>Parametri

*nID*<br/>
ID del controllo da nascondere.

### <a name="remarks"></a>Note

La finestra di dialogo deve essere stata creata con lo stile OFN_EXPLORER. in caso contrario, la funzione avrà esito negativo con un'asserzione.

##  <a name="ispickfoldersmode"></a>CFileDialog:: IsPickFoldersMode

Determina se la finestra di dialogo corrente è in modalità di selezione cartelle.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Valore restituito

TRUE se la finestra di dialogo è in modalità di selezione cartelle; in caso contrario, FALSE.

### <a name="remarks"></a>Note

##  <a name="m_ofn"></a>  CFileDialog::m_ofn

`m_ofn`è una struttura di tipo `OPENFILENAME`. I dati in questa struttura rappresentano lo stato corrente dell'oggetto `CFileDialog`.

### <a name="remarks"></a>Note

Usare questa struttura per inizializzare l'aspetto di una finestra di dialogo **Apri** file o **Salva con nome file** dopo averla costruita ma prima di visualizzarla con il metodo [DoModal](#domodal) . Ad esempio, è possibile impostare il membro *lpstrTitle* di `m_ofn` sulla didascalia desiderata per la finestra di dialogo.

Con lo stile di [CFileDialog](../../mfc/reference/cfiledialog-class.md)di Windows Vista o versioni `m_ofn` successive, non è sempre garantita la corrispondenza con lo stato della finestra di dialogo. Viene sincronizzata con la finestra di dialogo nelle versioni precedenti di Windows. Per ulteriori informazioni sulla sincronizzazione della `m_ofn` struttura e `CFileDialog` dello stato in Windows Vista o versioni successive, vedere [CFileDialog:: ApplyOFNToShellDialog](#applyofntoshelldialog) e [CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog) .

Le `CFileDialog`finestre di dialogo dei file di stile di Windows Vista o versioni successive non supportano alcuni membri e flag di. Di conseguenza, questi non avranno alcun effetto.

Di seguito è riportato un elenco dei membri non supportati da Windows Vista o versioni successive:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

I flag seguenti non sono supportati e pertanto non hanno effetto quando si utilizza Windows Vista o versioni successive di `CFileDialog`:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES-always on in Windows Vista o versioni successive

- OFN_NOLONGNAMES-sempre disattivata in Windows Vista o versioni successive

- OFN_NONETWORKBUTTON-always on in Windows Vista o versioni successive

- OFN_READONLY

- OFN_SHOWHELP

Per ulteriori informazioni su questa struttura, vedere la struttura [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) nel Windows SDK.

##  <a name="makeprominent"></a>CFileDialog:: MakeProminent

Inserisce un controllo nella finestra di dialogo in modo che si trovi rispetto ad altri controlli.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del controllo.

### <a name="remarks"></a>Note

##  <a name="onbuttonclicked"></a>CFileDialog:: OnButtonClicked

Chiamato quando si fa clic sul pulsante.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del pulsante.

### <a name="remarks"></a>Note

##  <a name="oncheckbuttontoggled"></a>CFileDialog:: OnCheckButtonToggled

Chiamato quando la casella di controllo è selezionata o deselezionata.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID della casella di controllo.

*bChecked*<br/>
Selezionato o deselezionato.

### <a name="remarks"></a>Note

##  <a name="oncontrolactivating"></a>CFileDialog:: OnControlActivating

Chiamato quando il controllo viene attivato.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del controllo.

### <a name="remarks"></a>Note

##  <a name="onfilenamechange"></a>CFileDialog:: OnFileNameChange

Eseguire l'override di questo metodo se si desidera gestire il messaggio WM_NOTIFY CDN_SELCHANGE.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Note

Il sistema invia il messaggio CDN_SELCHANGE quando l'utente seleziona un nuovo file o una nuova cartella nell'elenco di file della finestra di dialogo **Apri** o **Salva con nome** . Eseguire l'override di questo metodo se si desidera eseguire qualsiasi azione in risposta a questo messaggio.

Il sistema invia questo messaggio solo se la finestra di dialogo è stata creata con il flag OFN_EXPLORER attivato. Per ulteriori informazioni sulla notifica, vedere [CDN_SELCHANGE](/windows/desktop/dlgbox/cdn-selchange). Per informazioni sul flag OFN_EXPLORER, vedere le finestre di dialogo struttura [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) e [Apri e Salva con nome](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="onfilenameok"></a>CFileDialog:: OnFileNameOK

Eseguire l'override di questa funzione solo se si desidera fornire la convalida personalizzata dei nomi file immessi in una finestra di dialogo file comune.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Valore restituito

1 se il nome file non è un nome file valido; in caso contrario, 0.

### <a name="remarks"></a>Note

Questa funzione consente di rifiutare un nome file per qualsiasi motivo specifico dell'applicazione. In genere, non è necessario utilizzare questa funzione perché il Framework fornisce la convalida predefinita dei nomi file e visualizza una finestra di messaggio se viene immesso un nome di file non valido.

Se viene restituito 1, la finestra di dialogo rimarrà visualizzata affinché l'utente immetta un altro nome file. La routine della finestra di dialogo omette la finestra di dialogo se il risultato restituito è 0. Altri valori restituiti diversi da zero sono attualmente riservati e non devono essere usati.

##  <a name="onfolderchange"></a>CFileDialog:: OnFolderChange

Eseguire l'override di questa funzione per gestire il messaggio WM_NOTIFYCDN_FOLDERCHANGE.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Note

Il messaggio di notifica viene inviato quando viene aperta una nuova cartella nella finestra di dialogo Apri o Salva con nome.

La notifica viene inviata solo se la finestra di dialogo è stata creata con lo stile OFN_EXPLORER. Per ulteriori informazioni sulla notifica, vedere [CDN_FOLDERCHANGE](/windows/desktop/dlgbox/cdn-folderchange). Per informazioni sullo stile OFN_EXPLORER, vedere le finestre di dialogo struttura [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) e [Apri e Salva con nome](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="oninitdone"></a>CFileDialog:: OnInitDone

Eseguire l'override di questa funzione per gestire il messaggio WM_NOTIFY CDN_INITDONE.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Note

Il sistema invia questo messaggio di notifica al termine dell'organizzazione dei controlli nella finestra di dialogo **Apri** o **Salva con nome** per creare spazio per i controlli della finestra di dialogo figlio.

Il sistema invia questa operazione solo se la finestra di dialogo è stata creata con lo stile OFN_EXPLORER. Per ulteriori informazioni sulla notifica, vedere [CDN_INITDONE](/windows/desktop/dlgbox/cdn-initdone). Per informazioni sullo stile OFN_EXPLORER, vedere le finestre di dialogo struttura [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) e [Apri e Salva con nome](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

> [!NOTE]
> Questa funzione non è supportata nelle finestre di dialogo di file di Windows Vista o versioni successive. Il tentativo di utilizzare questa funzione in una finestra di dialogo file di Windows Vista o versioni successive genererà [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="onitemselected"></a>CFileDialog:: OnItemSelected

Chiamato quando viene selezionato l'elemento del contenitore.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del controllo contenitore.

*dwIDItem*<br/>
ID dell'elemento.

### <a name="remarks"></a>Note

##  <a name="onlbselchangednotify"></a>CFileDialog:: OnLBSelChangedNotify

Questa funzione viene chiamata ogni volta che la selezione corrente in una casella di riepilogo sta per essere modificata.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Parametri

*nIDBox*<br/>
ID della casella di riepilogo o casella combinata in cui si è verificata la selezione.

*iCurSel*<br/>
Indice della selezione corrente.

*nCode*<br/>
Codice di notifica del controllo. Questo parametro deve avere uno dei valori seguenti:

- CD_LBSELCHANGE specifica *iCurSel* è l'elemento selezionato in una casella di riepilogo a selezione singola.

- CD_LBSELSUB specifica che *iCurSel* non è più selezionato in una casella di riepilogo a selezione multiselezione.

- CD_LBSELADD specifica che *iCurSel* è selezionato in una casella di riepilogo a selezione multiselezione.

- CD_LBSELNOITEMS specifica che non esiste alcuna selezione in una casella di riepilogo a selezione selettiva.

### <a name="remarks"></a>Note

Eseguire l'override di questa funzione per fornire la gestione personalizzata delle modifiche di selezione nella casella di riepilogo. Ad esempio, è possibile usare questa funzione per visualizzare i diritti di accesso o Data-Ultima modifica di ogni file selezionato dall'utente.

##  <a name="onshareviolation"></a>CFileDialog:: OnShareViolation

Eseguire l'override di questa funzione per fornire la gestione personalizzata delle violazioni di condivisione.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Parametri

*lpszPathName*<br/>
Percorso del file in cui si è verificata la violazione della condivisione.

### <a name="return-value"></a>Valore restituito

Uno dei valori seguenti:

- OFN_SHAREFALLTHROUGH il nome file viene restituito dalla finestra di dialogo.

- OFN_SHARENOWARN non deve essere eseguita alcuna altra azione.

- OFN_SHAREWARN l'utente riceve il messaggio di avviso standard per l'errore.

### <a name="remarks"></a>Note

In genere, non è necessario usare questa funzione perché il Framework fornisce il controllo predefinito delle violazioni della condivisione e visualizza una finestra di messaggio se si verifica una violazione di condivisione.

Se si desidera disabilitare il controllo delle violazioni di condivisione, utilizzare l'operatore OR bit per bit per combinare `m_ofn.Flags`il flag OFN_SHAREAWARE con.

##  <a name="ontypechange"></a>CFileDialog:: OnTypeChange

Eseguire l'override di questa funzione per gestire il messaggio WM_NOTIFYCDN_TYPECHANGE.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Note

Il messaggio di notifica viene inviato quando l'utente seleziona un nuovo tipo di file dall'elenco di tipi di file nella finestra di dialogo Apri o Salva con nome.

La notifica viene inviata solo se la finestra di dialogo è stata creata con lo stile OFN_EXPLORER. Per ulteriori informazioni sulla notifica, vedere [CDN_TYPECHANGE](/windows/desktop/dlgbox/cdn-typechange). Per informazioni sullo stile OFN_EXPLORER, vedere le finestre di dialogo struttura [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) e [Apri e Salva con nome](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="removecontrolitem"></a>CFileDialog:: RemoveControlItem

Rimuove un elemento da un controllo contenitore nella finestra di dialogo.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del controllo contenitore dal quale rimuovere l'elemento.

*dwIDItem*<br/>
ID dell'elemento.

### <a name="remarks"></a>Note

##  <a name="setcheckbuttonstate"></a>CFileDialog:: SetCheckButtonState

Imposta lo stato corrente di un pulsante di selezione (casella di controllo) nella finestra di dialogo.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID della casella di controllo.

*bChecked*<br/>
Stato della casella di controllo. TRUE indica controllato; FALSE indica che l'opzione è deselezionata.

### <a name="remarks"></a>Note

##  <a name="setcontrolitemstate"></a>CFileDialog:: SetControlItemState

Imposta lo stato corrente di un elemento in un controllo contenitore trovato nella finestra di dialogo.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del controllo contenitore.

*dwIDItem*<br/>
ID dell'elemento.

*dwState*<br/>
Uno o più valori dell'enumerazione CDCONTROLSTATE che indicano il nuovo stato del controllo.

### <a name="remarks"></a>Note

##  <a name="setcontrolitemtext"></a>CFileDialog:: SetControlItemText

Imposta il testo di un elemento del controllo. Ad esempio, il testo che accompagna un pulsante di opzione o un elemento in un menu.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del controllo contenitore.

*dwIDItem*<br/>
ID dell'elemento.

*strLabel*<br/>
Testo dell'elemento.

### <a name="remarks"></a>Note

##  <a name="setcontrollabel"></a>CFileDialog:: SetControlLabel

Imposta il testo associato a un controllo, ad esempio il testo del pulsante o l'etichetta di una casella di modifica.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del controllo.

*strLabel*<br/>
Nome del controllo.

### <a name="remarks"></a>Note

##  <a name="setcontrolstate"></a>CFileDialog:: SetControlState

Imposta la visibilità corrente e gli stati abilitati di un determinato controllo.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del controllo.

*dwState*<br/>
Uno o più valori dell'enumerazione CDCONTROLSTATE che indicano lo stato corrente del controllo.

### <a name="remarks"></a>Note

##  <a name="setcontroltext"></a>CFileDialog:: SetControlText

Chiamare questo metodo per impostare il testo per il controllo specificato in una finestra di dialogo **Apri** o **Salva con nome** di tipo Esplora risorse.

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Parametri

*nID*<br/>
in ID del controllo per cui impostare il testo.

*lpsz*<br/>
in Puntatore alla stringa che contiene il testo da impostare per il controllo.

### <a name="remarks"></a>Note

Entrambe le versioni di questa funzione sono valide per le applicazioni che utilizzano Unicode. Tuttavia, solo la versione con il tipo LPCSTR è valida per le applicazioni che usano ANSI.

Per utilizzare questo metodo, è necessario creare la finestra di dialogo con lo stile OFN_EXPLORER. In caso contrario, la funzione avrà esito negativo con un'asserzione.

##  <a name="setdefext"></a>CFileDialog:: SetDefExt

Chiamare questa funzione per impostare l'estensione del nome di file predefinito per una finestra di dialogo Apri o Salva come comune di tipo Esplora risorse.

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Parametri

*lpsz*<br/>
Puntatore a una stringa contenente l'estensione predefinita da utilizzare per l'oggetto finestra di dialogo. Questa stringa non deve contenere un punto (.).

### <a name="remarks"></a>Note

La finestra di dialogo deve essere stata creata con lo stile OFN_EXPLORER. in caso contrario, la funzione avrà esito negativo con un'asserzione.

##  <a name="seteditboxtext"></a>CFileDialog:: SetEditBoxText

Imposta il testo corrente in un controllo casella di modifica.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID della casella di modifica.

*strText*<br/>
Valore del testo.

### <a name="remarks"></a>Note

##  <a name="setproperties"></a>CFileDialog:: seproprietà

Fornisce un archivio delle proprietà che definisce i valori predefiniti da usare per l'elemento salvato.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Parametri

*lpszPropList*<br/>
Elenco di proprietà predefinite separate da ";". Per un elenco dei flag, vedere la sezione **Flags** di [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew).

### <a name="remarks"></a>Note

##  <a name="setselectedcontrolitem"></a>CFileDialog:: SetSelectedControlItem

Imposta lo stato selezionato di un particolare elemento in un gruppo di pulsanti di opzione o in una casella combinata presente nella finestra di dialogo.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del controllo contenitore.

*dwIDItem*<br/>
ID dell'elemento selezionato dall'utente nel controllo.

### <a name="remarks"></a>Note

##  <a name="settemplate"></a>CFileDialog:: setemplate

Imposta il modello della finestra di dialogo per l'oggetto [CFileDialog](../../mfc/reference/cfiledialog-class.md) .

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Parametri

*nWin3ID*<br/>
in Contiene il numero ID della risorsa modello per l'oggetto non di esplorazione `CFileDialog` . Questo modello viene usato solo in Windows NT 3,51 o quando lo stile OFN_EXPLORER non è presente.

*nWin4ID*<br/>
in Contiene il numero ID della risorsa modello per l'oggetto di `CFileDialog` esplorazione. Questo modello viene utilizzato solo in Windows NT 4,0 e versioni successive, Windows 95 e versioni successive oppure quando è presente lo stile OFN_EXPLORER.

*lpWin3ID*<br/>
in Contiene il nome della risorsa modello per l'oggetto non di esplorazione `CFileDialog` . Questo modello viene usato solo in Windows NT 3,51 o quando lo stile OFN_EXPLORER non è presente.

*lpWin4ID*<br/>
in Contiene il nome della risorsa modello dell'oggetto Explorer `CFileDialog` . Questo modello viene utilizzato solo in Windows NT 4,0 e versioni successive, Windows 95 e versioni successive oppure quando è presente lo stile OFN_EXPLORER.

### <a name="remarks"></a>Note

Il sistema utilizzerà solo uno dei modelli specificati. Il sistema determina il modello da usare in base alla presenza dello stile OFN_EXPLORER e del sistema operativo in cui l'applicazione è in esecuzione. Specificando un modello di tipo Esplora risorse e non di esplorazione, è facile supportare Windows NT 3,51, Windows NT 4,0 e versioni successive e Windows 95 e versioni successive.

> [!NOTE]
> Questa funzione non è supportata nelle finestre di dialogo per i file di Windows Vista o versioni successive. Il tentativo di utilizzare questa funzione in una finestra di dialogo file di Windows Vista o versioni successive genererà [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). In alternativa, è possibile utilizzare una finestra di dialogo personalizzata. Per ulteriori informazioni sull'utilizzo di un `CFileDialog`oggetto personalizzato, vedere [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

##  <a name="startvisualgroup"></a>CFileDialog:: StartVisualGroup

Dichiara un gruppo visivo nella finestra di dialogo. Le chiamate successive a qualsiasi metodo "Add" aggiungono tali elementi a questo gruppo.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametri

*dwIDCtl*<br/>
ID del gruppo di oggetti visivi.

*strLabel*<br/>
Nome del gruppo.

### <a name="remarks"></a>Note

##  <a name="updateofnfromshelldialog"></a>CFileDialog:: UpdateOFNFromShellDialog

Aggiorna la `m_ofn` struttura dei dati di [CFileDialog](../../mfc/reference/cfiledialog-class.md) in base allo stato corrente dell'oggetto interno.

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Note

Nelle versioni di Windows precedenti a Windows Vista, la struttura dei dati [OpenFileName](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) del membro veniva continuamente sincronizzata con `CFileDialog`lo stato di. Tutte le modifiche apportate alla variabile membro [m_ofn](#m_ofn) hanno influenzato direttamente lo stato della finestra di dialogo. Inoltre, qualsiasi modifica apportata allo stato della finestra di dialogo ha immediatamente aggiornato la variabile membro m_ofn.

In Windows Vista o versioni successive, `m_ofn` la struttura dei dati non viene aggiornata automaticamente. Per garantire l'accuratezza dei dati nella `m_ofn` variabile membro, è necessario chiamare la `UpdateOFNFromShellDialog` funzione prima di accedere ai dati. Windows chiama questa funzione automaticamente durante l'elaborazione di [IFileDialog:: OnFileOk](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok).

Per ulteriori informazioni su come utilizzare la classe `CFileDialog` in Windows Vista o versioni successive, vedere la [classe CFileDialog](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Esempio

Questo esempio aggiorna prima `CFileDialog` di visualizzarlo. Prima di aggiornare `m_ofn` la variabile membro, è necessario sincronizzarla con lo stato corrente della finestra di dialogo.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>Vedere anche

[Classe CCommonDialog](../../mfc/reference/ccommondialog-class.md)<br/>
[Grafico della gerarchia](../../mfc/hierarchy-chart.md)
