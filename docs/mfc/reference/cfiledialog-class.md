---
title: CFileDialog (classe) | Documenti Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
dev_langs:
- C++
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: c52d2912edc1632dc2fbe4fe330def6d357f16d2
ms.sourcegitcommit: 19a108b4b30e93a9ad5394844c798490cb3e2945
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/17/2018
ms.locfileid: "34255769"
---
# <a name="cfiledialog-class"></a>CFileDialog (classe)
Incapsula la finestra di dialogo comune che viene utilizzata per aprire file o le operazioni di salvataggio.  
  
## <a name="syntax"></a>Sintassi  
  
```  
class CFileDialog : public CCommonDialog  
```  
  
## <a name="members"></a>Membri  
  
### <a name="public-constructors"></a>Costruttori pubblici  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[CFileDialog::CFileDialog](#cfiledialog)|Costruisce un oggetto `CFileDialog`.|  
  
### <a name="public-methods"></a>Metodi pubblici  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[CFileDialog::AddCheckButton](#addcheckbutton)|Aggiunge un pulsante di controllo per la finestra di dialogo.|  
|[CFileDialog::AddComboBox](#addcombobox)|Aggiunge una casella combinata per la finestra di dialogo.|  
|[CFileDialog::AddControlItem](#addcontrolitem)|Aggiunge un elemento a un controllo contenitore nella finestra di dialogo.|  
|[CFileDialog::AddEditBox](#addeditbox)|Aggiunge una casella di modifica per la finestra di dialogo.|  
|[CFileDialog::AddMenu](#addmenu)|Aggiunge un menu per la finestra di dialogo.|  
|[CFileDialog::AddPlace](#addplace)|Di overload. Aggiunge che una cartella all'elenco di inserisce disponibile per l'utente di aprire o salvare gli elementi.|  
|[CFileDialog::AddPushButton](#addpushbutton)|Aggiunge un pulsante alla finestra di dialogo.|  
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Aggiunge un gruppo di pulsanti (noto anche come pulsante di opzione) di opzione per la finestra di dialogo.|  
|[CFileDialog::AddSeparator](#addseparator)|Aggiunge un separatore per la finestra di dialogo.|  
|[CFileDialog::AddText](#addtext)|Aggiunge il contenuto di testo alla finestra di dialogo.|  
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Aggiornare lo stato del `CFileDialog` per corrispondere ai parametri e ai flag archiviato nel `m_ofn` variabile membro.|  
|[CFileDialog::DoModal](#domodal)|Visualizza la finestra di dialogo e consente all'utente di effettuare una selezione.|  
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Abilita un elenco a discesa nel **aprire** o **salvare** pulsante nella finestra di dialogo.|  
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Interrompe l'aggiunta di elementi a un gruppo visual nella finestra di dialogo.|  
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Ottiene lo stato corrente di un pulsante di controllo (casella di controllo) nella finestra di dialogo.|  
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|Ottiene lo stato corrente di un elemento in un controllo contenitore trovato nella finestra di dialogo.|  
|[CFileDialog::GetControlState](#getcontrolstate)|Ottiene l'impostazione di visibilità corrente e gli stati di un determinato controllo abilitato.|  
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Ottiene il testo corrente in un controllo casella di modifica.|  
|[CFileDialog::GetFileExt](#getfileext)|Restituisce l'estensione del file selezionato.|  
|[CFileDialog::GetFileName](#getfilename)|Restituisce il nome del file del file selezionato.|  
|[CFileDialog::GetFileTitle](#getfiletitle)|Restituisce il titolo del file selezionato.|  
|[CFileDialog::GetFolderPath](#getfolderpath)|Recupera il percorso della cartella attualmente aperta o directory per un tipo Esplora risorse **aprire** o **Salva con nome** la finestra di dialogo comune.|  
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Recupera l'oggetto COM interno per un oggetto personalizzato `CFileDialog` oggetto.|  
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Recupera l'oggetto COM interno per un `CFileDialog` che viene utilizzato come un **aprire** la finestra di dialogo file.|  
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Recupera l'oggetto COM interno per un `CFileDialog` che viene utilizzato come un **salvare** la finestra di dialogo file.|  
|[CFileDialog::GetNextPathName](#getnextpathname)|Restituisce il percorso completo del file successivo selezionato.|  
|[CFileDialog::GetOFN](#getofn)|Recupera il `OPENFILENAME` struttura il `CFileDialog` oggetto.|  
|[CFileDialog::GetPathName](#getpathname)|Restituisce il percorso completo del file selezionato.|  
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Restituisce lo stato di sola lettura del file selezionato.|  
|[CFileDialog::GetResult](#getresult)|Ottiene la scelta dell'utente apportata nella finestra di dialogo.|  
|[CFileDialog::GetResults](#getresults)|Ottiene le scelte dell'utente in una finestra di dialogo che consente la selezione multipla.|  
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Ottiene un particolare elemento dai controlli contenitore specificato nella finestra di dialogo.|  
|[CFileDialog::GetStartPosition](#getstartposition)|Restituisce la posizione del primo elemento dell'elenco di nome file.|  
|[CFileDialog::HideControl](#hidecontrol)|Nasconde il controllo specificato in uno stile di Esplora **aprire** o **Salva con nome** la finestra di dialogo comune.|  
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Determina se la finestra di dialogo corrente nella modalità di selezione cartelle.|  
|[CFileDialog::MakeProminent](#makeprominent)|Posizioni un controllo nella finestra di dialogo in modo che distinguerlo rispetto ad altri controlli aggiunti.|  
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Rimuove un elemento da un controllo contenitore nella finestra di dialogo.|  
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Nella finestra di dialogo, imposta lo stato corrente di un pulsante di controllo (casella di controllo).|  
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Imposta lo stato corrente di un elemento in un controllo contenitore trovato nella finestra di dialogo.|  
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Imposta il testo di un elemento di controllo. Ad esempio, il testo che accompagna un pulsante di opzione o un elemento in un menu.|  
|[CFileDialog::SetControlLabel](#setcontrollabel)|Imposta il testo associato a un controllo, ad esempio il testo del pulsante o un'etichetta casella di modifica.|  
|[CFileDialog::SetControlState](#setcontrolstate)|Imposta la visibilità corrente e gli stati di un determinato controllo abilitato.|  
|[CFileDialog::SetControlText](#setcontroltext)|Imposta il testo per il controllo specificato in uno stile di Esplora **aprire** o **Salva con nome** la finestra di dialogo comune.|  
|[CFileDialog::SetDefExt](#setdefext)|Imposta l'estensione di file predefinita per un tipo Esplora risorse **aprire** o **Salva con nome** la finestra di dialogo comune.|  
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Imposta il testo corrente in un controllo casella di modifica.|  
|[CFileDialog::SetProperties](#setproperties)|Fornisce un archivio delle proprietà che definisce i valori predefiniti da usare per l'elemento salvato.|  
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Imposta lo stato selezionato di un particolare elemento in un gruppo di pulsanti di opzione o una casella combinata trovato nella finestra di dialogo.|  
|[CFileDialog::SetTemplate](#settemplate)|Imposta il modello di finestra di dialogo per la `CFileDialog` oggetto.|  
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Dichiara un gruppo visual nella finestra di dialogo. Le chiamate successive a qualsiasi metodo "Aggiungi" aggiungono tali elementi a questo gruppo.|  
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Aggiorna i dati archiviati nel `m_ofn` variabile membro in base allo stato corrente della finestra di dialogo file.|  
  
### <a name="protected-methods"></a>Metodi protetti  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Chiamata eseguita quando si fa clic sul pulsante.|  
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Chiamata eseguita quando la casella di controllo è selezionata o deselezionata.|  
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Chiamato quando il controllo è attivo.|  
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Gestisce il `WM_NOTIFY CDN_SELCHANGE` messaggio.|  
|[CFileDialog::OnFileNameOK](#onfilenameok)|Convalida il nome file immesso nella finestra di dialogo.|  
|[CFileDialog::OnFolderChange](#onfolderchange)|Gestisce il `WM_NOTIFY CDN_FOLDERCHANGE` messaggio.|  
|[CFileDialog::OnInitDone](#oninitdone)|Gestisce il `WM_NOTIFY CDN_INITDONE` messaggio.|  
|[CFileDialog::OnItemSelected](#onitemselected)|Chiamato quando viene selezionato l'elemento contenitore.|  
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Consente di eseguire azioni personalizzate quando cambia la selezione di file.|  
|[CFileDialog::OnShareViolation](#onshareviolation)|Handle di condividono le violazioni.|  
|[CFileDialog::OnTypeChange](#ontypechange)|Gestisce il `WM_NOTIFY CDN_TYPECHANGE` messaggio.|  
  
### <a name="public-data-members"></a>Membri dati pubblici  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[CFileDialog::m_ofn](#m_ofn)|Le finestre `OPENFILENAME` struttura. Fornisce l'accesso ai parametri di casella di dialogo file base.|  
  
## <a name="remarks"></a>Note  
 Finestre di dialogo file comune consentono di implementare la selezione di file finestre di dialogo, ad esempio, **Apri File** e **Salva con nome**, in modo che sia coerenza con gli standard di Windows.  
  
 È possibile utilizzare `CFileDialog` come avviene con il costruttore fornito oppure è possibile derivare la propria classe da dialogo `CFileDialog` e scrivere un costruttore in base alle esigenze. In entrambi i casi, queste finestre di dialogo si comportano come finestre di dialogo MFC standard perché vengono derivati dal [CCommonDialog classe](../../mfc/reference/ccommondialog-class.md). `CFileDialog` si basa sul COMMDLG. File DLL che è incluso in Windows.  
  
 Sia l'aspetto e la funzionalità del `CFileDialog` con Windows Vista o versioni successive differiscono dalle versioni precedenti di Windows. Il valore predefinito `CFileDialog` utilizza automaticamente il nuovo Windows Vista o lo stile successive senza modifiche al codice, se un programma viene compilato ed eseguita in Windows Vista o versione successiva. Utilizzare il `bVistaStyle` parametro nel costruttore per eseguire manualmente l'override di questo aggiornamento automatico. L'eccezione per l'aggiornamento automatico è finestre di dialogo personalizzate. Non essere convertiti nel nuovo stile. Per ulteriori informazioni sul costruttore, vedere [CFileDialog::CFileDialog](#cfiledialog).  
  
> [!NOTE]
>  Il sistema di ID di controllo è diverso in Windows Vista o versioni successive da versioni precedenti di Windows quando si utilizza un `CFileDialog`. È necessario aggiornare tutti i riferimenti a `CFileDialog` controlli nel codice prima di è possibile convertire il progetto da una versione precedente di Windows.  
  
 Alcuni `CFileDialog` metodi non sono supportati in Windows Vista o versioni successive. Controllare l'argomento di metodo singoli per informazioni su se il metodo è supportato. Inoltre, le funzioni ereditate seguenti non sono supportate in Windows Vista o versioni successive:  
  
- [CDialog](../../mfc/reference/cdialog-class.md#oninitdialog)  
  
- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)  
  
 I messaggi di windows per la `CFileDialog` classe variano in base ai quali sistema operativo in uso. Ad esempio, Windows XP non supporta [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel) e [CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok) per la `CFileDialog` classe. Tuttavia, Windows Vista e sistemi operativi successivi le supportano. Per ulteriori informazioni sui diversi messaggi che vengono generati e l'ordine in cui vengono ricevuti, vedere [esempio CFileDialog: ordine degli eventi di registrazione](../../visual-cpp-samples.md).  
  
 Per utilizzare un `CFileDialog` oggetto, creare innanzitutto l'oggetto utilizzando il `CFileDialog` costruttore. Dopo la finestra di dialogo è stata costruita, è possibile impostare o modificare i valori di [CFileDialog::m_ofn](#m_ofn) struttura per inizializzare i valori o stati dei controlli casella di dialogo. Il `m_ofn` struttura è di tipo `OPENFILENAME`. Per ulteriori informazioni, vedere il [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) struttura in Windows SDK.  
  
 Dopo l'inizializzazione di controlli di finestra di dialogo, chiamare il [CFileDialog::DoModal](#domodal) metodo per visualizzare la finestra di dialogo casella in modo che l'utente può digitare il percorso e nome file. `DoModal` Restituisce se l'utente fa clic su OK (IDOK) o il pulsante Annulla (IDCANCEL). Se `DoModal` restituisce IDOK, è possibile utilizzare uno del `CFileDialog` le funzioni membro pubbliche per recuperare le informazioni inserite dall'utente.  
  
> [!NOTE]
> In Windows Vista o versioni successive, più chiamate al metodo [IFileDialog::SetFileTypes](http://msdn.microsoft.com/library/windows/desktop/bb775980) causa un errore. La seconda chiamata a `SetFileTypes` per tutte le istanze di un `CFileDialog` restituirà `E_UNEXPECTED` in Windows Vista o versioni successive. Alcuni `CFileDialog` metodo funzioni chiamano `SetFileTypes`. Ad esempio, due chiamate a `CFileDialog::DoModal` per la stessa istanza di un `CFileDialog` genera [ASSERT](diagnostic-services.md#assert).  
  
 `CFileDialog` include diversi membri protetti che consentono di eseguire la gestione personalizzata delle violazioni di condivisione, convalida del nome file e notifica di modifica della casella di riepilogo. Questi membri protetti sono funzioni di callback che non contengono la maggior parte delle applicazioni da utilizzare in quanto gestione predefinita viene eseguita automaticamente. Le voci della mappa messaggi per queste funzioni non sono necessarie perché sono funzioni standard.  
  
 È possibile utilizzare le finestre [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916) funzione per determinare se si è verificato un errore durante l'inizializzazione della finestra di dialogo e per ulteriori informazioni sull'errore.  
  
 La distruzione del `CFileDialog` oggetti viene gestita automaticamente. Non è necessario chiamare [CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog).  
  
 Per consentire all'utente di selezionare più file, impostare il `OFN_ALLOWMULTISELECT` flag prima di chiamare `DoModal`. È necessario fornire i propri buffer di nome file per includere l'elenco restituito più nomi di file. A tale scopo sostituendo `m_ofn.lpstrFile` con un puntatore a un buffer è stato allocato, dopo aver creato il `CFileDialog`, ma prima di chiamare `DoModal`.  
  
 Inoltre, è necessario impostare `m_ofn.nMaxFile` utilizzando il numero di caratteri nel buffer a cui puntato `m_ofn.lpstrFile`. Se si imposta il numero massimo di file da selezionare per `n`, la dimensione del buffer richiesto `n * (_MAX_PATH + 1) + 1`. Il primo elemento nel buffer restituito è il percorso della cartella in cui i file sono stati selezionati. Per Windows Vista o finestre di dialogo successive stile, le stringhe di nomi file e directory sono con terminazione null, con un carattere null aggiuntivo dopo l'ultimo nome di file. Questo formato consente le finestre di dialogo di tipo Esplora risorse restituire i nomi file lunghi contenenti spazi. Per le finestre di dialogo di vecchio stile, le stringhe di nomi di file e directory sono separate da spazi e la funzione utilizza i nomi file brevi per i nomi di file con spazi.  
  
 Nell'esempio seguente viene illustrato come utilizzare un buffer per recuperare ed elencare più nomi di file.  
  
 [!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]  
  
 Per modificare le dimensioni del buffer in risposta all'utente la selezione di più nomi di file, è necessario derivare una nuova classe da `CFileDialog` ed eseguire l'override di [CFileDialog::OnFileNameChange](#onfilenamechange) metodo.  
  
 Se si deriva una nuova classe da `CFileDialog`, è possibile utilizzare una mappa messaggi per gestire tutti i messaggi. Per estendere la gestione dei messaggi predefinito, derivare una classe da `CFileDialog`, aggiungere una mappa messaggi per la nuova classe e forniscono funzioni membro per i nuovi messaggi. Non è necessario fornire una funzione hook per personalizzare la finestra di dialogo.  
  
 Per personalizzare la finestra di dialogo, derivare una classe da `CFileDialog`, fornire un modello di finestra di dialogo personalizzate e aggiungere una mappa messaggi per elaborare i messaggi di notifica da controlli estesi. Passare i messaggi non elaborati per la classe di base. Non è necessario personalizzare la funzione hook.  
  
 Quando si utilizza lo stile di versioni successive di o Windows Vista la `CFileDialog`, non è possibile utilizzare le mappe messaggi e modelli di finestra di dialogo. In alternativa, è necessario utilizzare le interfacce COM per una funzionalità simile.  
  
 Per ulteriori informazioni su come usare `CFileDialog`, vedere [classi di finestre di dialogo comuni](../../mfc/common-dialog-classes.md).  
  
## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CDialog](../../mfc/reference/cdialog-class.md)  
  
 [CCommonDialog](../../mfc/reference/ccommondialog-class.md)  
  
 `CFileDialog`  
  
## <a name="requirements"></a>Requisiti  
 **Intestazione:** afxdlgs. h  
  
##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton  
 Aggiunge un pulsante di controllo per la finestra di dialogo.  
  
```  
HRESULT AddCheckButton(
    DWORD dwIDCtl,  
    const CString& strLabel,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 ID del pulsante di controllo da aggiungere.  
  
 `strLabel`  
 Il nome del controllo pulsante.  
  
 `bChecked`  
 Valore booleano che indica lo stato corrente del controllo pulsante. `TRUE` Se selezionato; `FALSE` in caso contrario  
  
### <a name="remarks"></a>Note  
  
##  <a name="addcombobox"></a>  CFileDialog::AddComboBox  
 Aggiunge una casella combinata per la finestra di dialogo.  
  
```  
HRESULT AddComboBox(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 ID della casella combinata da aggiungere.  
  
### <a name="remarks"></a>Note  
  
##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem  
 Aggiunge un elemento a un controllo contenitore nella finestra di dialogo.  
  
```  
HRESULT AddControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 ID del controllo contenitore da aggiungere l'elemento.  
  
 `dwIDItem`  
 L'ID dell'elemento.  
  
 `strLabel`  
 Testo dell'elemento.  
  
### <a name="remarks"></a>Note  
  
##  <a name="addeditbox"></a>  CFileDialog::AddEditBox  
 Aggiunge una casella di modifica per la finestra di dialogo.  
  
```  
HRESULT AddEditBox(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 ID della casella di modifica da aggiungere.  
  
 `strText`  
 Nome della casella di modifica.  
  
### <a name="remarks"></a>Note  
  
##  <a name="addmenu"></a>  CFileDialog::AddMenu  
 Aggiunge un menu per la finestra di dialogo.  
  
```  
HRESULT AddMenu(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 ID del menu da aggiungere.  
  
 `strLabel`  
 Il nome del menu.  
  
### <a name="remarks"></a>Note  
  
##  <a name="addplace"></a>  CFileDialog::AddPlace  
 Aggiunge che una cartella all'elenco di inserisce disponibile per l'utente di aprire o salvare gli elementi.  
  
```  
void AddPlace(
    LPCWSTR lpszFolder,  
    FDAP fdap = FDAP_TOP) throw();

 
void AddPlace(
    IShellItem* psi,  
    FDAP fdap = FDAP_TOP) throw();
```  
  
### <a name="parameters"></a>Parametri  
 `lpszFolder`  
 Un percorso della cartella per renderli disponibili per l'utente. Questo può essere solo una cartella.  
  
 `fdap`  
 Specifica la posizione della cartella è all'interno dell'elenco.  
  
 `psi`  
 Puntatore a un'istanza di IShellItem che rappresenta la cartella per renderli disponibili per l'utente. Questo può essere solo una cartella.  
  
### <a name="remarks"></a>Note  
  
##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton  
 Aggiunge un pulsante alla finestra di dialogo.  
  
```  
HRESULT AddPushButton(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 ID del pulsante da aggiungere.  
  
 `strLabel`  
 Il nome del pulsante.  
  
### <a name="remarks"></a>Note  
  
##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList  
 Aggiunge un gruppo di pulsanti (noto anche come pulsante di opzione) di opzione per la finestra di dialogo.  
  
```  
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 ID del gruppo di pulsanti di opzione da aggiungere.  
  
### <a name="remarks"></a>Note  
  
##  <a name="addseparator"></a>  CFileDialog::AddSeparator  
 Aggiunge un separatore per la finestra di dialogo.  
  
```  
HRESULT AddSeparator(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 Aggiungere l'ID del separatore.  
  
### <a name="remarks"></a>Note  
  
##  <a name="addtext"></a>  CFileDialog::AddText  
 Aggiunge il testo alla finestra di dialogo.  
  
```  
HRESULT AddText(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 ID del testo da aggiungere.  
  
 `strText`  
 Il nome di testo.  
  
### <a name="remarks"></a>Note  
  
##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog  
 Aggiorna lo stato corrente del [CFileDialog](../../mfc/reference/cfiledialog-class.md) in base ai valori archiviati nel `m_ofn` struttura dei dati.  
  
```  
void ApplyOFNToShellDialog();
```  
  
### <a name="remarks"></a>Note  
 Nelle versioni di Windows precedenti a Windows Vista, il membro [OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx) struttura dei dati è stata costantemente sincronizzata con lo stato del `CFileDialog`. Tutte le modifiche di [m_ofn](#m_ofn) variabile membro sono state applicate immediatamente lo stato della finestra di dialogo. Inoltre, tutte le modifiche allo stato della finestra di dialogo aggiornano immediatamente il `m_ofn` variabile membro.  
  
 In Windows Vista o versioni successive, i valori nel `m_ofn` variabile membro e lo stato del `CFileDialog` non sono garantiti come da sincronizzare. Questa funzione determina lo stato del `CFileDialog` da aggiornare in modo che corrisponda il `m_ofn` struttura. Windows chiama questa funzione automaticamente durante [CFileDialog::DoModal](#domodal).  
  
 Per ulteriori informazioni su come usare il `CFileDialog` classe in Windows Vista o versione successiva, vedere [CFileDialog (classe)](../../mfc/reference/cfiledialog-class.md).  
  
### <a name="example"></a>Esempio  
  Per vedere l'esempio [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog).  
  
##  <a name="cfiledialog"></a>  CFileDialog::CFileDialog  
 Chiamare questa funzione per creare una finestra di dialogo di file standard Windows.  
  
```  
explicit CFileDialog(
    BOOL bOpenFileDialog,  
    LPCTSTR lpszDefExt = NULL,  
    LPCTSTR lpszFileName = NULL,  
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,  
    LPCTSTR lpszFilter = NULL,  
    CWnd* pParentWnd = NULL,  
    DWORD dwSize = 0,  
    BOOL bVistaStyle = TRUE);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `bOpenFileDialog`  
 Il parametro che specifica il tipo di finestra di dialogo per creare. Impostarla su `TRUE` per costruire un **Apri File** la finestra di dialogo. Impostarla su `FALSE` per costruire un **Salva con nome** la finestra di dialogo.  
  
 [in] `lpszDefExt`  
 Estensione di file predefinita. Se l'utente non include un'estensione nota (uno che dispone di un'associazione computer dell'utente) nella casella Nome file, l'estensione specificata da `lpszDefExt` viene aggiunto automaticamente al nome del file. Se questo parametro è `NULL`, nessuna estensione viene aggiunto.  
  
 [in] `lpszFileName`  
 Il nome file iniziale che viene visualizzato nella casella Nome file. Se `NULL`, viene visualizzato alcun nome file iniziale.  
  
 [in] `dwFlags`  
 Una combinazione di uno o più flag che è possibile utilizzare per personalizzare la finestra di dialogo. Per una descrizione di questi flag, vedere il [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) struttura in Windows SDK. Se si modifica il `m_ofn.Flags` membro di struttura, utilizzare un operatore OR bit per bit delle modifiche per mantenere intatto il comportamento predefinito.  
  
 [in] `lpszFilter`  
 Una serie di coppie di stringhe che specificano i filtri è possibile applicare al file. Se si specificano i filtri di file, verranno visualizzati solo i file che soddisfano i criteri di filtro nell'elenco di file. Vedere la sezione Osservazioni per ulteriori informazioni su come utilizzare i filtri di file.  
  
 [in] `pParentWnd`  
 Puntatore alla finestra padre o proprietaria della finestra di dialogo file.  
  
 [in] `dwSize`  
 Le dimensioni del `OPENFILENAME` struttura. Questo valore dipende dalla versione del sistema operativo. MFC utilizzato questo parametro per determinare il tipo di finestra di dialogo per creare appropriato. Le dimensioni predefinite pari a 0 indica che il codice MFC determinano le dimensioni della casella di dialogo appropriate da utilizzare in base alla versione del sistema operativo in cui viene eseguito il programma.  
  
 [in] `bVistaStyle`  
 **Nota** questo parametro è disponibile in Visual Studio 2008 e versioni successive e sarà causano la finestra di dialogo Nuovo stile deve essere usato solo se si esegue Windows Vista o versioni successive.  
  
 Il parametro che specifica lo stile della finestra di dialogo file. Impostarla su `TRUE` per utilizzare la nuova Vista file finestre di dialogo. In caso contrario, verrà utilizzato il vecchio stile di finestre di dialogo. Vedere la sezione Osservazioni per ulteriori informazioni in esecuzione in una Vista.  
  
### <a name="remarks"></a>Note  
 Entrambi un **Apri File** o **Salva con nome** viene costruita la finestra di dialogo, a seconda del valore di `bOpenFileDialog`.  
  
 Specifica un valore predefinito di estensione usando `lpszDefExt` non producano il comportamento previsto, perché è raramente stimabile le estensioni dispongono di associazioni di file nel computer dell'utente. Se è necessario maggiore controllo sull'aggiunta di un'estensione per impostazione predefinita, è possibile derivare la propria classe dal `CFileDialog`ed eseguire l'override di `CFileDialog::OnFileNameOK` metodo per eseguire la gestione di estensione.  
  
 Per consentire all'utente di selezionare più file, impostare il `OFN_ALLOWMULTISELECT` flag prima di chiamare [DoModal](#domodal). È necessario fornire il propria buffer dei nomi di file per archiviare l'elenco restituito più nomi di file. A tale scopo sostituendo `m_ofn.lpstrFile` con un puntatore a un buffer è stato allocato, dopo aver creato il [CFileDialog](../../mfc/reference/cfiledialog-class.md), ma prima di chiamare `DoModal`. Inoltre, è necessario impostare `m_ofn.nMaxFile` con il numero di caratteri nel buffer a cui puntata `m_ofn.lpstrFile`. Se si imposta il numero massimo di file da selezionare per `n`, la dimensione del buffer necessarie `n`*(_MAX_PATH + 1) + 1. Ad esempio:  
  
 [!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]  
  
 Per consentire all'utente di ridimensionare la finestra di dialogo tipo Esplora risorse con il mouse o tastiera, impostare il `OFN_ENABLESIZING` flag. Impostare questo flag è necessario solo se si fornisce un modello personalizzato o routine di hook. Il flag funziona solo con una finestra di dialogo tipo Esplora risorse. finestre di dialogo di vecchio stile non possono essere ridimensionate.  
  
 Il `lpszFilter` parametro viene utilizzato per determinare il tipo di nome file deve avere un file da visualizzare nell'elenco di file. La prima stringa nella coppia stringa descrive il filtro. la seconda stringa indica l'estensione di nome file da utilizzare. È possibile specificare più estensioni utilizzando un punto e virgola (il carattere ';') come delimitatore. La stringa termina con due simboli di '&#124;' caratteri, seguiti da un `NULL` caratteri. È inoltre possibile utilizzare un [CString](../../atl-mfc-shared/using-cstring.md) oggetto per questo parametro.  
  
 Ad esempio, [!INCLUDE[ofprexcel](../../mfc/reference/includes/ofprexcel_md.md)] consente agli utenti di aprire i file con estensioni xlc (grafico) o xls (foglio di lavoro), tra gli altri. Come è possibile scrivere il filtro per Excel:  
  
 [!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]  
  
 Tuttavia, se si prevede di utilizzare questa stringa direttamente aggiornato il `OPENFILENAME` struttura, è necessario delimitare le stringhe con il carattere null, '\0', anziché le barre verticali ('&#124;').  
  
 Il `bVistaStyle` parametro è applicabile solo quando in esecuzione in Windows Vista o versioni successive. Nelle versioni precedenti di Windows, questo parametro viene ignorato. Se `bVistaStyle` è impostato su `TRUE`, quando si compila un programma con Visual Studio 2008 o versioni successive, il nuovo stile Vista **finestra di dialogo File** verrà utilizzato. In caso contrario, lo stile MFC precedente **finestra di dialogo File** verrà utilizzato.  
  
 Finestra di dialogo modelli non sono supportati sulle finestre di dialogo in base a `bVistaStyle`  
  
### <a name="example"></a>Esempio  
  Per vedere l'esempio [CFileDialog::DoModal](#domodal).  
  
##  <a name="domodal"></a>  CFileDialog::DoModal  
 Chiamare questa funzione per visualizzare la finestra di dialogo file comune Windows e consentire all'utente di cercare file e directory e immettere un nome file.  
  
```  
virtual INT_PTR DoModal();
```  
  
### <a name="return-value"></a>Valore restituito  
 **IDOK** oppure **IDCANCEL**. Se **IDCANCEL** viene restituito, chiamare il Windows [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916) funzione per determinare se si è verificato un errore.  
  
 **IDOK** e **IDCANCEL** sono costanti che indicano se l'utente ha selezionato il pulsante OK o Annulla.  
  
### <a name="remarks"></a>Note  
 Se si desidera inizializzare le varie opzioni della finestra di dialogo file impostando i membri del **m_ofn** struttura, è consigliabile farlo prima di chiamare `DoModal`, ma dopo che l'oggetto finestra di dialogo.  
  
 Ad esempio, se si desidera consentire all'utente di selezionare più file, impostare il `OFN_ALLOWMULTISELECT` flag prima di chiamare `DoModal`, come illustrato nell'esempio di codice in questo argomento.  
  
 Quando l'utente fa clic sui pulsanti OK o Annulla la finestra di dialogo o seleziona la chiusura della finestra di dialogo opzione controllo menu, il controllo viene restituito all'applicazione. È quindi possibile chiamare altre funzioni membro per recuperare le impostazioni o informazioni gli input dell'utente nella finestra di dialogo.  
  
 `DoModal` è una funzione virtuale sottoposta a override dalla classe `CDialog`.  
  
### <a name="example"></a>Esempio  
 [!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]  
  
##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown  
 Consente a un elenco di riepilogo a discesa all'apertura o salvataggio pulsante nella finestra di dialogo.  
  
```  
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID dell'elenco a discesa.  
  
### <a name="remarks"></a>Note  
  
##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup  
 Interrompe l'aggiunta di elementi a un gruppo visual nella finestra di dialogo.  
  
```  
HRESULT EndVisualGroup();
```  
  
### <a name="return-value"></a>Valore restituito  
 Restituisce S_OK se ha esito positivo. un valore di errore in caso contrario.  
  
### <a name="remarks"></a>Note  
  
##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState  
 Recupera lo stato corrente di un pulsante di controllo (casella di controllo) nella finestra di dialogo.  
  
```  
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,  
    BOOL& bChecked);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID della casella di controllo.  
  
 `bChecked`  
 Lo stato della casella di controllo. `TRUE` indica checked; `FALSE` indica non è selezionata.  
  
### <a name="remarks"></a>Note  
  
##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState  
 Recupera lo stato corrente di un elemento in un controllo contenitore trovato nella finestra di dialogo.  
  
```  
HRESULT GetControlItemState(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    CDCONTROLSTATEF& dwState);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del controllo contenitore.  
  
 `dwIDItem`  
 L'ID dell'elemento.  
  
 `dwState`  
 Un riferimento a una variabile che riceve uno degli altri valori dell'enumerazione CDCONTROLSTATE che indica lo stato corrente del controllo.  
  
### <a name="remarks"></a>Note  
  
##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState  
 Recupera l'impostazione di visibilità corrente e gli stati di un determinato controllo abilitato.  
  
```  
HRESULT GetControlState(
    DWORD dwIDCtl,  
    CDCONTROLSTATEF& dwState);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del controllo.  
  
 `dwState`  
 Un riferimento a una variabile che riceve uno o più valori dell'enumerazione CDCONTROLSTATE che indica lo stato corrente del controllo.  
  
### <a name="remarks"></a>Note  
  
##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText  
 Recupera il testo corrente in un controllo casella di modifica.  
  
```  
HRESULT GetEditBoxText(
    DWORD dwIDCtl,  
    CString& strText);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID della casella di modifica.  
  
 `strText`  
 Valore del testo.  
  
### <a name="remarks"></a>Note  
  
##  <a name="getfileext"></a>  CFileDialog::GetFileExt  
 Chiamare questa funzione per recuperare l'estensione del nome file immesso nella finestra di dialogo.  
  
```  
CString GetFileExt() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 L'estensione del nome file.  
  
### <a name="remarks"></a>Note  
 Se, ad esempio, immettere il nome del file è dati. TXT, `GetFileExt` restituisce "TXT".  
  
 Se `m_ofn.Flags` ha il `OFN_ALLOWMULTISELECT` flag impostato, la stringa contiene una sequenza di stringhe con terminazione null, con la prima stringa il percorso della directory del gruppo di file selezionato, seguita dai nomi di tutti i file selezionati dall'utente. Per recuperare percorsi di file, utilizzare il [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) funzioni membro.  
  
##  <a name="getfilename"></a>  CFileDialog::GetFileName  
 Chiamare questa funzione per recuperare il nome del nome file immesso nella finestra di dialogo.  
  
```  
CString GetFileName() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Nome del file.  
  
### <a name="remarks"></a>Note  
 Il nome del file include sia il prefisso e l'estensione. Ad esempio, `GetFileName` restituirà "testo. DAT"per il file C:\FILES\TEXT.DAT.  
  
 Se `m_ofn.Flags` ha il `OFN_ALLOWMULTISELECT` flag impostato, è necessario chiamare [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) per recuperare un percorso di file.  
  
##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle  
 Chiamare questa funzione per recuperare il titolo del file immesso nella finestra di dialogo.  
  
```  
CString GetFileTitle() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Il titolo del file.  
  
### <a name="remarks"></a>Note  
 Il titolo del file include solo il prefisso, senza il percorso o l'estensione. Ad esempio, `GetFileTitle` restituirà "TEXT" per il file C:\FILES\TEXT.DAT.  
  
 Se `m_ofn.Flags` ha il `OFN_ALLOWMULTISELECT` flag impostato, la stringa contiene una sequenza di stringhe con terminazione null, con la prima stringa il percorso della directory del gruppo di file selezionato, seguita dai nomi di tutti i file selezionati dall'utente. Per questo motivo, è possibile utilizzare il [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) funzioni membro per recuperare il nome del file successivo nell'elenco.  
  
### <a name="example"></a>Esempio  
  Per vedere l'esempio [CFileDialog::DoModal](#domodal).  
  
##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath  
 Chiamare questa funzione membro per recuperare il percorso della cartella attualmente aperta o directory per un tipo Esplora risorse aprire o salvare come dialogo comune.  
  
```  
CString GetFolderPath() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Oggetto [CString](../../atl-mfc-shared/reference/cstringt-class.md) oggetto contenente la directory o la cartella attualmente aperta.  
  
### <a name="remarks"></a>Note  
 Nella finestra di dialogo deve essere stata creata con il **OFN_EXPLORER** stile; in caso contrario, il metodo avrà esito negativo con un'asserzione.  
  
 È possibile chiamare questo metodo solo quando viene visualizzata la finestra di dialogo. Dopo aver chiuso la finestra di dialogo, questa funzione non funzionerà più e il metodo avrà esito negativo con un'asserzione.  
  
##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize  
 Recupera un puntatore all'oggetto COM interno per un determinato [CFileDialog](../../mfc/reference/cfiledialog-class.md).  
  
```  
IFileDialogCustomize* GetIFileDialogCustomize();
```  
  
### <a name="return-value"></a>Valore restituito  
 Il puntatore all'oggetto COM interno per il `CFileDialog`. È responsabilità dell'utente di rilasciare l'indicatore di misura in modo appropriato.  
  
### <a name="remarks"></a>Note  
 Utilizzare questa funzione solo in Windows Vista o versioni successive con un oggetto che presenta `bVistaStyle` impostato su `true`. Se si utilizza questa funzione quando `bVistaStyle` è `false`, verrà restituito `NULL` in modalità di rilascio e genera un'asserzione in modalità di debug.  
  
 Per ulteriori informazioni sul `IFileDialogCustomize` interfaccia, vedere [IFileDialogCustomize](http://msdn.microsoft.com/library/windows/desktop/bb775912).  
  
### <a name="example"></a>Esempio  
 In questo esempio recupera l'oggetto COM interno. Per eseguire questo esempio di codice, è necessario compilarlo in Windows Vista o versioni successive.  
  
 [!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]  
  
##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog  
 Recupera un puntatore all'oggetto COM interno per un determinato `CFileDialog`.  
  
```  
IFileOpenDialog* GetIFileOpenDialog();
```  
  
### <a name="return-value"></a>Valore restituito  
 Il puntatore all'oggetto COM interno per il `CFileDialog`. È responsabilità dell'utente di rilasciare l'indicatore di misura in modo appropriato.  
  
### <a name="remarks"></a>Note  
 Utilizzare questa funzione solo in Windows Vista o versioni successive con un oggetto che presenta `bVistaStyle` impostato su `true`. Questa funzione restituisce `NULL` se il `CFileDialog` non è un **aprire** la finestra di dialogo o se `bVistaStyle` è impostato su `false`. In questo caso finale, la funzione restituisce solo `NULL` in modalità di rilascio - in modalità di debug verrà generata un'asserzione.  
  
 Per ulteriori informazioni sul `IFileOpenDialog` interfaccia, vedere [IFileOpenDialog](http://msdn.microsoft.com/library/windows/desktop/bb775834).  
  
### <a name="example"></a>Esempio  
 In questo esempio recupera l'oggetto COM interno. Per eseguire questo codice, è necessario compilarlo in Windows Vista o versioni successive.  
  
 [!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]  
  
##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog  
 Recupera un puntatore all'oggetto COM interno per un determinato `CFileDialog`.  
  
```  
IFileSaveDialog* GetIFileSaveDialog();
```  
  
### <a name="return-value"></a>Valore restituito  
 Il puntatore all'oggetto COM interno per il `CFileDialog`. È responsabilità dell'utente di rilasciare l'indicatore di misura in modo appropriato.  
  
### <a name="remarks"></a>Note  
 Utilizzare questa funzione solo in Windows Vista o versioni successive con un oggetto che presenta `bVistaStyle` impostato su `true`. Questa funzione restituirà `NULL` se il `CFileDialog` non è un **salvare** la finestra di dialogo o se `bVistaStyle` è impostato su `false`. In questo caso finale, la funzione restituisce solo `NULL` in modalità di rilascio - in modalità di debug verrà generata un'asserzione.  
  
 Per ulteriori informazioni sul `IFileSaveDialog` interfaccia, vedere [IFileSaveDialog](http://msdn.microsoft.com/library/windows/desktop/bb775688).  
  
### <a name="example"></a>Esempio  
 In questo esempio recupera l'oggetto COM interno. Per eseguire questo esempio di codice, è necessario compilarlo in Windows Vista o versioni successive.  
  
 [!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]  
  
##  <a name="getnextpathname"></a>  CFileDialog::GetNextPathName  
 Chiamare questa funzione per recuperare il nome del file successivo dal gruppo selezionato nella finestra di dialogo.  
  
```  
CString GetNextPathName(POSITION& pos) const;  
```  
  
### <a name="parameters"></a>Parametri  
 `pos`  
 Un riferimento a un **posizione** valore restituito da una precedente `GetNextPathName` o `GetStartPosition` chiamata di funzione. **NULL** se è stata raggiunta la fine dell'elenco.  
  
### <a name="return-value"></a>Valore restituito  
 Percorso completo del file.  
  
### <a name="remarks"></a>Note  
 Il percorso del nome file include il titolo del file e il percorso di directory completa. Ad esempio, `GetNextPathName` restituirà "C:\FILES\TEXT. DAT"per il file C:\FILES\TEXT.DAT. È possibile utilizzare `GetNextPathName` in un ciclo di iterazione in avanti, se si stabilisce la posizione iniziale con una chiamata a `GetStartPosition`.  
  
 Se la selezione è costituita da un solo file, verrà restituito il nome del file.  
  
##  <a name="getofn"></a>  CFileDialog::GetOFN  
 Recupera l'oggetto associato **OPENFILENAME** struttura.  
  
```  
const OPENFILENAME& GetOFN() const;  
  
OPENFILENAME& GetOFN();
```  
  
### <a name="return-value"></a>Valore restituito  
 Un [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) struttura.  
  
### <a name="remarks"></a>Note  
 Utilizzare la seconda versione di questa funzione per inizializzare l'aspetto di un **Apri File** o **Salva con nome** nella finestra di dialogo dopo la sua creazione, ma prima che venga visualizzato con il `DoModal` funzione membro. Ad esempio, è possibile impostare il **lpstrTitle** membro di **m_ofn** la didascalia si desidera che la finestra di dialogo.  
  
##  <a name="getpathname"></a>  CFileDialog::GetPathName  
 Chiamare questa funzione per recuperare il percorso completo del file immesso nella finestra di dialogo.  
  
```  
CString GetPathName() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Percorso completo del file.  
  
### <a name="remarks"></a>Note  
 Il percorso del nome file include il titolo del file e il percorso di directory completa. Ad esempio, `GetPathName` restituirà "C:\FILES\TEXT. DAT"per il file C:\FILES\TEXT.DAT.  
  
 Se `m_ofn.Flags` ha il `OFN_ALLOWMULTISELECT` set di flag, la stringa contiene una sequenza di null teminated stringhe, con la prima stringa il percorso della directory del gruppo di file selezionato, seguita dai nomi di tutti i file selezionati dall'utente. Per questo motivo, è possibile utilizzare il [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) funzioni membro per recuperare il nome del file successivo nell'elenco.  
  
### <a name="example"></a>Esempio  
  Per vedere l'esempio [CFileDialog::DoModal](#domodal).  
  
##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref  
 Chiamare questa funzione per determinare se la casella di controllo di sola lettura è stata selezionata nelle finestre di dialogo Windows File Open e Salva con nome di File standard.  
  
```  
BOOL GetReadOnlyPref() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se è selezionata la casella di controllo di sola lettura nella finestra di dialogo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 È possibile nascondere la casella di controllo di sola lettura impostando la `OFN_HIDEREADONLY` applicare uno stile di `CFileDialog` costruttore.  
  
> [!NOTE]
> Windows Vista o versioni successive stile `CFileDialog` oggetti non supportano questa funzione. Tentativo di utilizzare questa funzione in un Windows Vista o versioni successive stile `CFileDialog` genererà [eccezione CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).   
  
##  <a name="getresult"></a>  CFileDialog::GetResult  
 Recupera la scelta dell'utente apportata nella finestra di dialogo.  
  
```  
IShellItem* GetResult() throw();
```  
  
### <a name="return-value"></a>Valore restituito  
 Puntatore a un'istanza di IShellItem che rappresenta la scelta dell'utente.  
  
### <a name="remarks"></a>Note  
  
##  <a name="getresults"></a>  CFileDialog::GetResults  
 Recupera le scelte dell'utente in una finestra di dialogo che consente la selezione multipla.  
  
```  
IShellItemArray* GetResults() throw();
```  
  
### <a name="return-value"></a>Valore restituito  
 Puntatore a un IShellItemArray attraverso il quale gli elementi selezionati nella finestra di dialogo è possibile accedere.  
  
### <a name="remarks"></a>Note  
  
##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem  
 Recupera un elemento specifico dal controllo contenitore specificato nella finestra di dialogo.  
  
```  
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,  
    DWORD& dwIDItem);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del controllo contenitore.  
  
 `dwIDItem`  
 L'ID dell'elemento selezionato dall'utente nel controllo.  
  
### <a name="remarks"></a>Note  
  
##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition  
 Chiamare questa funzione membro per recuperare la posizione del primo nome di percorso di file nell'elenco, se `m_ofn.Flags` ha il `OFN_ALLOWMULTISELECT` flag impostato.  
  
```  
POSITION GetStartPosition() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Oggetto **posizione** valore che può essere utilizzato per l'iterazione. **NULL** se l'elenco è vuoto.  
  
##  <a name="hidecontrol"></a>  CFileDialog::HideControl  
 Chiamare questa funzione membro per nascondere il controllo specificato in un tipo Esplora risorse aprire o salvare come comune finestra di dialogo.  
  
```  
void HideControl(int nID);
```  
  
### <a name="parameters"></a>Parametri  
 `nID`  
 ID del controllo da nascondere.  
  
### <a name="remarks"></a>Note  
 Nella finestra di dialogo deve essere stata creata con il **OFN_EXPLORER** stile; in caso contrario, la funzione avrà esito negativo con un'asserzione.  
  
##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode  
 Determina se la finestra di dialogo corrente è in modalità di selezione cartelle.  
  
```  
BOOL IsPickFoldersMode() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 `TRUE` Se la finestra di dialogo si trova in modalità di selezione cartelle; in caso contrario `FALSE`.  
  
### <a name="remarks"></a>Note  
  
##  <a name="m_ofn"></a>  CFileDialog::m_ofn  
 `m_ofn` è una struttura di tipo `OPENFILENAME`. I dati in questa struttura rappresentano lo stato corrente del `CFileDialog`.  
  
### <a name="remarks"></a>Note  
 Usare questa struttura per inizializzare l'aspetto di un **Apri File** o **Salva con nome** nella finestra di dialogo dopo la creazione, ma prima di visualizzare con il [DoModal](#domodal) metodo. Ad esempio, è possibile impostare il `lpstrTitle` membro di `m_ofn` la didascalia si desidera che la finestra di dialogo.  
  
 Con lo stile di versioni successive di o Windows Vista [CFileDialog](../../mfc/reference/cfiledialog-class.md), `m_ofn` non necessariamente sempre corrispondenti allo stato della finestra di dialogo. È sincronizzato con la finestra di dialogo nelle versioni precedenti di Windows. Vedere [CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog) e [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog) per ulteriori informazioni sulla sincronizzazione i `m_ofn` struttura e il `CFileDialog` stato in Windows Vista o versioni successive.  
  
 Windows Vista o versioni successive file finestre di dialogo non supportano alcuni membri e i flag del `CFileDialog`. Di conseguenza, si avrà alcun effetto.  
  
 Di seguito è un elenco dei membri che non sono supportati da Windows Vista o versioni successive:  
  
- `lpstrCustomFilter`  
  
- `lpstrInitialDir`  
  
- `lCustData`  
  
- `lpfnHook`  
  
- `lpTemplateName`  
  
 I flag seguenti non sono supportati e pertanto non hanno alcun effetto quando si utilizza Windows Vista o successive stile di `CFileDialog`:  
  
-   OFN_ENABLEHOOK  
  
-   OFN_ENABLEINCLUDENOTIFY  
  
-   OFN_ENABLETEMPLATE  
  
-   OFN_ENABLETEMPLATEHANDLE  
  
-   OFN_EXPLORER  
  
-   OFN_EXTENSIONDIFFERENT  
  
-   OFN_HIDEREADONLY  
  
-   OFN_LONGNAMES - sempre in modo efficace in Windows Vista o versioni successive  
  
-   OFN_NOLONGNAMES - off in modo efficace sempre in Windows Vista o versioni successive  
  
-   OFN_NONETWORKBUTTON - sempre in modo efficace in Windows Vista o versioni successive  
  
-   OFN_READONLY  
  
-   OFN_SHOWHELP  
  
 Per ulteriori informazioni su questa struttura, vedere il [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) struttura in Windows SDK.  
  
##  <a name="makeprominent"></a>  CFileDialog::MakeProminent  
 Posizioni un controllo nella finestra di dialogo in modo che distinguerlo rispetto ad altri controlli.  
  
```  
HRESULT MakeProminent(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del controllo.  
  
### <a name="remarks"></a>Note  
  
##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked  
 Chiamata eseguita quando si fa clic sul pulsante.  
  
```  
virtual void OnButtonClicked(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del pulsante.  
  
### <a name="remarks"></a>Note  
  
##  <a name="oncheckbuttontoggled"></a>  CFileDialog::OnCheckButtonToggled  
 Chiamata eseguita quando la casella di controllo è selezionata o deselezionata.  
  
```  
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID della casella di controllo.  
  
 `bChecked`  
 Selezionata o deselezionata.  
  
### <a name="remarks"></a>Note  
  
##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating  
 Chiamato quando viene attivato il controllo.  
  
```  
virtual void OnControlActivating(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del controllo.  
  
### <a name="remarks"></a>Note  
  
##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNameChange  
Eseguire l'override di questo metodo se si desidera gestire il `WM_NOTIFY` `CDN_SELCHANGE` messaggio.  
  
```  
virtual void OnFileNameChange();
```  
  
### <a name="remarks"></a>Note  
 Il sistema invia il `CDN_SELCHANGE` messaggio quando l'utente seleziona un nuovo file o una cartella nell'elenco dei file il **aprire** o **Salva con nome** la finestra di dialogo. Eseguire l'override di questo metodo se si desidera eseguire azioni in risposta a questo messaggio.  
  
 Il sistema invia il messaggio solo se la finestra di dialogo è stata creata con il flag OFN_EXPLORER acceso. Per ulteriori informazioni sulla notifica, vedere [CDN_SELCHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646865). Per informazioni sui flag OFN_EXPLORER, vedere il [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) struttura e [aprire e salvare come finestre di dialogo](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK  
 Eseguire l'override di questa funzione solo se si desidera fornire la convalida personalizzata dei nomi di file che vengono immessi in una finestra di dialogo file comune.  
  
```  
virtual BOOL OnFileNameOK();
```  
  
### <a name="return-value"></a>Valore restituito  
 1 se il nome del file non è un nome di file valido; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Questa funzione consente di rifiutare un nome di file per qualsiasi motivo specifico dell'applicazione. In genere, non è necessario utilizzare questa funzione perché il framework fornisce la convalida predefinita dei nomi di file e viene visualizzato un messaggio se viene immesso un nome di file non valido.  
  
 Se viene restituito 1, la finestra di dialogo rimarrà visualizzata all'utente di immettere un altro nome. Se il valore restituito è 0, la procedura di finestra di dialogo ignora la finestra di dialogo. Altri diverso da zero valori restituiti sono attualmente riservati e non devono essere utilizzati.  
  
##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange  
 Eseguire l'override di questa funzione per gestire il **WM_NOTIFYCDN_FOLDERCHANGE** messaggio.  
  
```  
virtual void OnFolderChange();
```  
  
### <a name="remarks"></a>Note  
 Quando viene aperta una nuova cartella nella finestra di dialogo Apri o Salva con nome, viene inviato il messaggio di notifica.  
  
 Notifica viene inviata solo se la finestra di dialogo è stata creata con lo stile OFN_EXPLORER. Per ulteriori informazioni sulla notifica, vedere [CDN_FOLDERCHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646859). Per informazioni sullo stile OFN_EXPLORER, vedere il [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) struttura e [aprire e salvare come finestre di dialogo](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
##  <a name="oninitdone"></a>  CFileDialog::OnInitDone  
 Eseguire l'override di questa funzione per gestire il `WM_NOTIFY` `CDN_INITDONE` messaggio.  
  
```  
virtual void OnInitDone();
```  
  
### <a name="remarks"></a>Note  
 Il sistema invia il messaggio di notifica quando il sistema ha terminato la disposizione dei controlli nel **aprire** o **Salva con nome** la finestra di dialogo per liberare spazio per i controlli della finestra di dialogo figlio.  
  
 Il sistema invia questo solo se la finestra di dialogo è stata creata con lo stile OFN_EXPLORER. Per ulteriori informazioni sulla notifica, vedere [CDN_INITDONE](http://msdn.microsoft.com/library/windows/desktop/ms646863). Per informazioni sullo stile OFN_EXPLORER, vedere il [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) struttura e [aprire e salvare come finestre di dialogo](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
> [!NOTE]
> Windows Vista o versioni successive file finestre di dialogo non supportano questa funzione. Tentativo di utilizzare questa funzione in un Windows Vista o versione successiva finestra di dialogo file stile genererà [eccezione CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). 
  
##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected  
 Chiamato quando viene selezionato l'elemento contenitore.  
  
```  
virtual void OnItemSelected(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del controllo contenitore.  
  
 `dwIDItem`  
 L'ID dell'elemento.  
  
### <a name="remarks"></a>Note  
  
##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify  
 Questa funzione viene chiamata ogni volta che la selezione corrente in una casella di riepilogo sta per essere modificata.  
  
```  
virtual void OnLBSelChangedNotify(
    UINT nIDBox,  
    UINT iCurSel,  
    UINT nCode);
```  
  
### <a name="parameters"></a>Parametri  
 *nIDBox*  
 ID della casella di riepilogo o casella combinata, in cui si è verificata la selezione.  
  
 `iCurSel`  
 Indice della selezione corrente.  
  
 `nCode`  
 Il codice di notifica del controllo. Questo parametro deve avere uno dei valori seguenti:  
  
- **CD_LBSELCHANGE** specifica `iCurSel` è l'elemento selezionato in una casella di riepilogo a selezione singola.  
  
- **CD_LBSELSUB** specifica che `iCurSel` non è più selezionato in una casella di elenco di selezione multipla.  
  
- **CD_LBSELADD** specifica che `iCurSel` è selezionata in una casella di elenco di selezione multipla.  
  
- **CD_LBSELNOITEMS** specifica nessuna selezione esistente in una casella di elenco di selezione multipla.  
  
### <a name="remarks"></a>Note  
 Eseguire l'override di questa funzione per la gestione personalizzata delle modifiche di selezione nella casella di riepilogo. Ad esempio, è possibile utilizzare questa funzione per visualizzare i diritti di accesso o Data-ultima modifica di ogni file consente di selezionare l'utente.  
  
##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation  
 Eseguire l'override di questa funzione per la gestione personalizzata delle violazioni di condivisione.  
  
```  
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```  
  
### <a name="parameters"></a>Parametri  
 `lpszPathName`  
 Percorso del file in cui si è verificata la violazione di condivisione.  
  
### <a name="return-value"></a>Valore restituito  
 Uno dei valori seguenti:  
  
- **OFN_SHAREFALLTHROUGH** viene restituito il nome del file dalla finestra di dialogo.  
  
- **OFN_SHARENOWARN** non è necessario eseguire alcuna azione ulteriore.  
  
- **OFN_SHAREWARN** l'utente riceve il messaggio di avviso standard per questo errore.  
  
### <a name="remarks"></a>Note  
 In genere, non è necessario utilizzare questa funzione perché il framework fornisce il valore predefinito il controllo delle violazioni di condivisione e visualizza una finestra di messaggio, se si verifica una violazione di condivisione.  
  
 Se si desidera disabilitare il controllo delle violazioni di condivisione, utilizzare l'operatore OR bit per bit per combinare il flag **OFN_SHAREAWARE** con `m_ofn.Flags`.  
  
##  <a name="ontypechange"></a>  CFileDialog::OnTypeChange  
 Eseguire l'override di questa funzione per gestire il **WM_NOTIFYCDN_TYPECHANGE** messaggio.  
  
```  
virtual void OnTypeChange();
```  
  
### <a name="remarks"></a>Note  
 Quando l'utente seleziona un nuovo tipo di file dall'elenco dei tipi di file Apri o Salva con nome, viene inviato il messaggio di notifica.  
  
 Notifica viene inviata solo se la finestra di dialogo è stata creata con lo stile OFN_EXPLORER. Per ulteriori informazioni sulla notifica, vedere [CDN_TYPECHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646868). Per informazioni sullo stile OFN_EXPLORER, vedere il [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) struttura e [aprire e salvare come finestre di dialogo](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem  
 Rimuove un elemento da un controllo contenitore nella finestra di dialogo.  
  
```  
HRESULT RemoveControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del controllo del contenitore per l'elemento da rimuovere.  
  
 `dwIDItem`  
 L'ID dell'elemento.  
  
### <a name="remarks"></a>Note  
  
##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState  
 Nella finestra di dialogo, imposta lo stato corrente di un pulsante di controllo (casella di controllo).  
  
```  
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID della casella di controllo.  
  
 `bChecked`  
 Lo stato della casella di controllo. `TRUE` indica checked; `FALSE` indica Unchecked.  
  
### <a name="remarks"></a>Note  
  
##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState  
 Imposta lo stato corrente di un elemento in un controllo contenitore trovato nella finestra di dialogo.  
  
```  
HRESULT SetControlItemState(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    CDCONTROLSTATEF dwState);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del controllo contenitore.  
  
 `dwIDItem`  
 L'ID dell'elemento.  
  
 `dwState`  
 Uno o più valori dall'enumerazione CDCONTROLSTATE che indicano il nuovo stato del controllo.  
  
### <a name="remarks"></a>Note  
  
##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText  
 Imposta il testo di un elemento di controllo. Ad esempio, il testo che accompagna un pulsante di opzione o un elemento in un menu.  
  
```  
HRESULT SetControlItemText(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del controllo contenitore.  
  
 `dwIDItem`  
 L'ID dell'elemento.  
  
 `strLabel`  
 Testo dell'elemento.  
  
### <a name="remarks"></a>Note  
  
##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel  
 Imposta il testo associato a un controllo, ad esempio il testo del pulsante o un'etichetta casella di modifica.  
  
```  
HRESULT SetControlLabel(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del controllo.  
  
 `strLabel`  
 Il nome del controllo.  
  
### <a name="remarks"></a>Note  
  
##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState  
 Imposta la visibilità corrente e gli stati di un determinato controllo abilitato.  
  
```  
HRESULT SetControlState(
    DWORD dwIDCtl,  
    CDCONTROLSTATEF dwState);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del controllo.  
  
 `dwState`  
 Uno o più valori dall'enumerazione CDCONTROLSTATE che indicano lo stato corrente del controllo.  
  
### <a name="remarks"></a>Note  
  
##  <a name="setcontroltext"></a>  CFileDialog::SetControlText  
 Chiamare questo metodo per impostare il testo per il controllo specificato in uno stile di Esplora **aprire** o **Salva con nome** la finestra di dialogo.  
  
```  
void SetControlText(
    int nID,  
    LPCSTR lpsz);

 
void SetControlText(
    int nID,  
    const wchar_t *lpsz);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `nID`  
 L'ID del controllo per cui impostare il testo.  
  
 [in] `lpsz`  
 Un puntatore a una stringa che contiene il testo da impostare per il controllo.  
  
### <a name="remarks"></a>Note  
 Entrambe le versioni di questa funzione sono valide per le applicazioni che utilizzano Unicode. Tuttavia, solo la versione con il tipo LPCSTR è valida per le applicazioni che utilizzano [!INCLUDE[vcpransi](../../atl-mfc-shared/reference/includes/vcpransi_md.md)].  
  
 Per utilizzare questo metodo, è necessario creare la finestra di dialogo con lo stile OFN_EXPLORER. In caso contrario, la funzione avrà esito negativo con un'asserzione.  
  
##  <a name="setdefext"></a>  CFileDialog::SetDefExt  
 Chiamare questa funzione per impostare l'estensione di file predefinito per un tipo Esplora risorse aprire o salvare come dialogo comune.  
  
```  
void SetDefExt(LPCSTR lpsz);
```  
  
### <a name="parameters"></a>Parametri  
 `lpsz`  
 Un puntatore a una stringa contenente l'estensione predefinita da utilizzare per l'oggetto finestra di dialogo. Questa stringa non deve contenere un punto (.).  
  
### <a name="remarks"></a>Note  
 Nella finestra di dialogo deve essere stata creata con il **OFN_EXPLORER** stile; in caso contrario, la funzione avrà esito negativo con un'asserzione.  
  
##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText  
 Imposta il testo corrente in un controllo casella di modifica.  
  
```  
HRESULT SetEditBoxText(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID della casella di modifica.  
  
 `strText`  
 Valore del testo.  
  
### <a name="remarks"></a>Note  
  
##  <a name="setproperties"></a>  CFileDialog::SetProperties  
 Fornisce un archivio delle proprietà che definisce i valori predefiniti da usare per l'elemento salvato.  
  
```  
BOOL SetProperties(LPCWSTR lpszPropList);
```  
  
### <a name="parameters"></a>Parametri  
 `lpszPropList`  
 Elenco di proprietà predefinite separate da ";". Per un elenco dei flag, vedere il `Flags` sezione [OPENFILENAME](http://msdn.microsoft.com/en-us/8cecfd45-f7c1-4f8d-81a0-4e7fecc3b104).  
  
### <a name="remarks"></a>Note  
  
##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem  
 Imposta lo stato selezionato di un particolare elemento in un gruppo di pulsanti di opzione o una casella combinata trovato nella finestra di dialogo.  
  
```  
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del controllo contenitore.  
  
 `dwIDItem`  
 L'ID dell'elemento selezionato dall'utente nel controllo.  
  
### <a name="remarks"></a>Note  
  
##  <a name="settemplate"></a>  CFileDialog::SetTemplate  
 Imposta il modello di finestra di dialogo per la [CFileDialog](../../mfc/reference/cfiledialog-class.md) oggetto.  
  
```  
void SetTemplate(
    UINT nWin3ID,  
    UINT nWin4ID);

 
void SetTemplate(
    LPCTSTR lpWin3ID,  
    LPCTSTR lpWin4ID);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `nWin3ID`  
 Contiene il numero di ID di risorsa modello di non-Esplora `CFileDialog` oggetto. Questo modello viene utilizzato solo in Windows NT 3.51 o quando lo stile OFN_EXPLORER non è presente.  
  
 [in] `nWin4ID`  
 Contiene il numero ID della risorsa di modello per Esplora `CFileDialog` oggetto. Questo modello viene utilizzato solo in [!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)] e versioni successive, Windows 95 e versioni successive, o quando lo stile OFN_EXPLORER è presente.  
  
 [in] `lpWin3ID`  
 Contiene il nome della risorsa modello di non-Esplora `CFileDialog` oggetto. Questo modello viene utilizzato solo in Windows NT 3.51 o quando lo stile OFN_EXPLORER non è presente.  
  
 [in] `lpWin4ID`  
 Contiene il nome della risorsa modello di Esplora `CFileDialog` oggetto. Questo modello viene utilizzato solo in [!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)] e versioni successive, Windows 95 e versioni successive, o quando lo stile OFN_EXPLORER è presente.  
  
### <a name="remarks"></a>Note  
 Il sistema utilizzerà solo uno dei modelli specificati. Il sistema determina il modello da usare in base alla presenza dello stile OFN_EXPLORER e il sistema operativo che è in esecuzione l'applicazione. Se si specifica sia non Esplora il modello di tipo Esplora risorse, è facile per il supporto di Windows NT 3.51, [!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)] e versioni successive e Windows 95 e versioni successive.  
  
> [!NOTE]
> Windows Vista o versioni successive finestre di dialogo file stile non supportano questa funzione. Tentativo di utilizzare questa funzione in un Windows Vista o versione successiva finestra di dialogo file stile genererà [eccezione CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Un'alternativa consiste nell'utilizzare una finestra di dialogo personalizzata. Per ulteriori informazioni sull'utilizzo di un oggetto personalizzato `CFileDialog`, vedere [IFileDialogCustomize](http://msdn.microsoft.com/library/windows/desktop/bb775912).  
  
##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup  
 Dichiara un gruppo visual nella finestra di dialogo. Le chiamate successive a qualsiasi metodo "Aggiungi" aggiungono tali elementi a questo gruppo.  
  
```  
HRESULT StartVisualGroup(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parametri  
 `dwIDCtl`  
 L'ID del gruppo visual.  
  
 `strLabel`  
 Il nome del gruppo.  
  
### <a name="remarks"></a>Note  
  
##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog  
 Gli aggiornamenti di `m_ofn` struttura dei dati di [CFileDialog](../../mfc/reference/cfiledialog-class.md) in base allo stato corrente dell'oggetto interno.  
  
```  
void UpdateOFNFromShellDialog();
```  
  
### <a name="remarks"></a>Note  
 Nelle versioni di Windows precedenti a Windows Vista, il membro [OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx) struttura dei dati è stata costantemente sincronizzata con lo stato del `CFileDialog`. Tutte le modifiche di [m_ofn](#m_ofn) variabile membro influenzate direttamente lo stato della finestra di dialogo. Inoltre, tutte le modifiche allo stato della finestra di dialogo viene aggiornato immediatamente la variabile membro m_ofn.  
  
 In Windows Vista o versioni successive, il `m_ofn` struttura di data non viene aggiornata automaticamente. Per garantire l'accuratezza dei dati di `m_ofn` variabile membro, è necessario chiamare il `UpdateOFNFromShellDialog` funzione prima di accedere ai dati. Windows chiama questa funzione automaticamente durante l'elaborazione di [IFileDialog::OnFileOK](http://msdn.microsoft.com/library/windows/desktop/bb775879).  
  
 Per ulteriori informazioni su come usare il `CFileDialog` classe in Windows Vista o versione successiva, vedere [CFileDialog (classe)](../../mfc/reference/cfiledialog-class.md).  
  
### <a name="example"></a>Esempio  
 Questo esempio viene aggiornato il `CFileDialog` prima di visualizzarlo. Prima di aggiornare il `m_ofn` variabile membro, è necessario per sincronizzarla con lo stato corrente della finestra di dialogo.  
  
 [!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]  
  
## <a name="see-also"></a>Vedere anche  
 [Classe CCommonDialog](../../mfc/reference/ccommondialog-class.md)   
 [Grafico della gerarchia](../../mfc/hierarchy-chart.md)

