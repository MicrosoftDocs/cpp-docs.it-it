---
description: 'Altre informazioni su: classe COleClientItem'
title: COleClientItem (classe)
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: b0cffd8767190a9dc6b81c3c6e49af6075231e55
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/11/2020
ms.locfileid: "97250647"
---
# <a name="coleclientitem-class"></a>COleClientItem (classe)

Definisce l'interfaccia del contenitore per gli elementi OLE.

## <a name="syntax"></a>Sintassi

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Members

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Description|
|----------|-----------------|
|[COleClientItem:: COleClientItem](#coleclientitem)|Costruisce un oggetto `COleClientItem`.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Description|
|----------|-----------------|
|[COleClientItem:: Activate](#activate)|Apre l'elemento OLE per un'operazione, quindi esegue il verbo specificato.|
|[COleClientItem:: activates](#activateas)|Attiva l'elemento come un altro tipo.|
|[COleClientItem:: AttachDataObject](#attachdataobject)|Accede ai dati nell'oggetto OLE.|
|[COleClientItem:: CanCreateFromData](#cancreatefromdata)|Indica se un'applicazione contenitore può creare un oggetto incorporato.|
|[COleClientItem:: CanCreateLinkFromData](#cancreatelinkfromdata)|Indica se un'applicazione contenitore può creare un oggetto collegato.|
|[COleClientItem:: CanPaste](#canpaste)|Indica se gli Appunti contengono un elemento OLE incorporato o statico.|
|[COleClientItem:: CanPasteLink](#canpastelink)|Indica se gli Appunti contengono un elemento OLE collegabile.|
|[COleClientItem:: Close](#close)|Chiude un collegamento a un server ma non elimina definitivamente l'elemento OLE.|
|[COleClientItem:: ConvertTo](#convertto)|Converte l'elemento in un altro tipo.|
|[COleClientItem:: CopyToClipboard](#copytoclipboard)|Copia l'elemento OLE negli Appunti.|
|[COleClientItem:: CreateCloneFrom](#createclonefrom)|Crea un duplicato di un elemento esistente.|
|[COleClientItem:: CreateFromClipboard](#createfromclipboard)|Crea un elemento incorporato dagli Appunti.|
|[COleClientItem:: CreateFromData](#createfromdata)|Crea un elemento incorporato da un oggetto dati.|
|[COleClientItem:: CreateFromFile](#createfromfile)|Crea un elemento incorporato da un file.|
|[COleClientItem:: CreateLinkFromClipboard](#createlinkfromclipboard)|Crea un elemento collegato dagli Appunti.|
|[COleClientItem:: CreateLinkFromData](#createlinkfromdata)|Crea un elemento collegato da un oggetto dati.|
|[COleClientItem:: CreateLinkFromFile](#createlinkfromfile)|Crea un elemento collegato da un file.|
|[COleClientItem:: CreateNewItem](#createnewitem)|Consente di creare un nuovo elemento incorporato avviando l'applicazione server.|
|[COleClientItem:: CreateStaticFromClipboard](#createstaticfromclipboard)|Crea un elemento statico dagli Appunti.|
|[COleClientItem:: CreateStaticFromData](#createstaticfromdata)|Crea un elemento statico da un oggetto dati.|
|[COleClientItem::D ttiva](#deactivate)|Disattiva l'elemento.|
|[COleClientItem::D eactivateUI](#deactivateui)|Ripristina lo stato originale dell'interfaccia utente dell'applicazione contenitore.|
|[COleClientItem::D Elimina](#delete)|Elimina o chiude l'elemento OLE se è un elemento collegato.|
|[COleClientItem::D oDragDrop](#dodragdrop)|Esegue un'operazione di trascinamento della selezione.|
|[COleClientItem::D oVerb](#doverb)|Esegue il verbo specificato.|
|[COleClientItem::D RAW](#draw)|Disegna l'elemento OLE.|
|[COleClientItem:: GetActiveView](#getactiveview)|Ottiene la visualizzazione in cui l'elemento viene attivato sul posto.|
|[COleClientItem:: GetCachedExtent](#getcachedextent)|Restituisce i limiti del rettangolo dell'elemento OLE.|
|[COleClientItem:: GetClassID](#getclassid)|Ottiene l'ID di classe dell'elemento corrente.|
|[COleClientItem:: GetClipboardData](#getclipboarddata)|Ottiene i dati da inserire negli Appunti chiamando la `CopyToClipboard` funzione membro.|
|[COleClientItem:: GetDocument](#getdocument)|Restituisce l' `COleDocument` oggetto che contiene l'elemento corrente.|
|[COleClientItem:: GetDrawAspect](#getdrawaspect)|Ottiene la visualizzazione corrente dell'elemento per il rendering.|
|[COleClientItem:: GetExtent](#getextent)|Restituisce i limiti del rettangolo dell'elemento OLE.|
|[COleClientItem:: GetIconFromRegistry](#geticonfromregistry)|Recupera un handle per un'icona associata al server di un particolare CLSID.|
|[COleClientItem:: GetIconicMetafile](#geticonicmetafile)|Ottiene il metafile utilizzato per disegnare l'icona dell'elemento.|
|[COleClientItem:: GetInPlaceWindow](#getinplacewindow)|Restituisce un puntatore alla finestra di modifica sul posto dell'elemento.|
|[COleClientItem:: GetItemState](#getitemstate)|Ottiene lo stato corrente dell'elemento.|
|[COleClientItem:: GetLastStatus](#getlaststatus)|Restituisce lo stato dell'ultima operazione OLE.|
|[COleClientItem:: GetLinkUpdateOptions](#getlinkupdateoptions)|Restituisce la modalità di aggiornamento per un elemento collegato (funzionalità avanzata).|
|[COleClientItem:: GetType](#gettype)|Restituisce il tipo (incorporato, collegato o statico) dell'elemento OLE.|
|[COleClientItem:: GetUserType](#getusertype)|Ottiene una stringa che descrive il tipo dell'elemento.|
|[COleClientItem:: IsInPlaceActive](#isinplaceactive)|Restituisce TRUE se l'elemento è attivo sul posto.|
|[COleClientItem:: IsLinkUpToDate](#islinkuptodate)|Restituisce TRUE se un elemento collegato è aggiornato con il documento di origine.|
|[COleClientItem:: modified](#ismodified)|Restituisce TRUE se l'elemento è stato modificato dopo l'ultimo salvataggio.|
|[COleClientItem:: Open](#isopen)|Restituisce TRUE se l'elemento è attualmente aperto nell'applicazione server.|
|[COleClientItem:: outrunning](#isrunning)|Restituisce TRUE se l'applicazione server dell'elemento è in esecuzione.|
|[COleClientItem:: OnActivate](#onactivate)|Chiamato dal Framework per notificare all'elemento che è attivato.|
|[COleClientItem:: OnActivateUI](#onactivateui)|Viene chiamato dal Framework per notificare all'elemento che è attivato e che deve visualizzare l'interfaccia utente.|
|[COleClientItem:: OnChange](#onchange)|Chiamato quando il server modifica l'elemento OLE. Implementazione richiesta.|
|[COleClientItem:: OnDeactivate](#ondeactivate)|Chiamata eseguita dal framework quando un elemento viene disattivato.|
|[COleClientItem:: OnDeactivateUI](#ondeactivateui)|Chiamata eseguita dal framework quando il server ha rimosso l'interfaccia utente sul posto.|
|[COleClientItem:: OnGetClipboardData](#ongetclipboarddata)|Chiamato dal Framework per ottenere i dati da copiare negli Appunti.|
|[COleClientItem:: OnInsertMenus](#oninsertmenus)|Chiamato dal Framework per creare un menu composito.|
|[COleClientItem:: OnRemoveMenus](#onremovemenus)|Chiamato dal Framework per rimuovere i menu del contenitore da un menu composito.|
|[COleClientItem:: OnSetMenu](#onsetmenu)|Chiamata eseguita dal Framework per installare e rimuovere un menu composito.|
|[COleClientItem:: OnShowControlBars](#onshowcontrolbars)|Chiamata eseguita dal Framework per mostrare e nascondere le barre di controllo.|
|[COleClientItem:: OnUpdateFrameTitle](#onupdateframetitle)|Chiamata eseguita dal Framework per aggiornare la barra del titolo della finestra cornice.|
|[COleClientItem:: ReactivateAndUndo](#reactivateandundo)|Riattiva l'elemento e Annulla l'ultima operazione di modifica sul posto.|
|[COleClientItem:: Release](#release)|Rilascia la connessione a un elemento collegato OLE e la chiude se è stata aperta. Non elimina definitivamente l'elemento client.|
|[COleClientItem:: Reload](#reload)|Ricarica l'elemento dopo una chiamata a `ActivateAs` .|
|[COleClientItem:: Run](#run)|Esegue l'applicazione associata all'elemento.|
|[COleClientItem:: SetDrawAspect](#setdrawaspect)|Imposta la visualizzazione corrente dell'elemento per il rendering.|
|[COleClientItem:: seextent](#setextent)|Imposta il rettangolo di delimitazione dell'elemento OLE.|
|[COleClientItem:: sehostnames](#sethostnames)|Imposta i nomi visualizzati dal server quando si modifica l'elemento OLE.|
|[COleClientItem:: SetIconicMetafile](#seticonicmetafile)|Memorizza nella cache il metafile utilizzato per disegnare l'icona dell'elemento.|
|[COleClientItem:: SetItemRects](#setitemrects)|Imposta il rettangolo di delimitazione dell'elemento.|
|[COleClientItem:: SetLinkUpdateOptions](#setlinkupdateoptions)|Imposta la modalità di aggiornamento per un elemento collegato (funzionalità avanzata).|
|[COleClientItem:: SetPrintDevice](#setprintdevice)|Imposta il dispositivo di destinazione di stampa per questo elemento client.|
|[COleClientItem:: UpdateLink](#updatelink)|Aggiorna la cache di presentazione di un elemento.|

### <a name="protected-methods"></a>Metodi protetti

|Nome|Description|
|----------|-----------------|
|[COleClientItem:: CanActivate](#canactivate)|Chiamato dal Framework per determinare se è consentita l'attivazione sul posto.|
|[COleClientItem:: OnChangeItemPosition](#onchangeitemposition)|Chiamata eseguita dal framework quando viene modificata la posizione di un elemento.|
|[COleClientItem:: OnDeactivateAndUndo](#ondeactivateandundo)|Chiamato dal Framework per annullare l'operazione dopo l'attivazione.|
|[COleClientItem:: OnDiscardUndoState](#ondiscardundostate)|Chiamata eseguita dal Framework per eliminare le informazioni sullo stato di annullamento dell'elemento.|
|[COleClientItem:: OnGetClipRect](#ongetcliprect)|Chiamato dal Framework per ottenere le coordinate del rettangolo di ritaglio dell'elemento.|
|[COleClientItem:: OnGetItemPosition](#ongetitemposition)|Chiamato dal Framework per ottenere la posizione dell'elemento rispetto alla visualizzazione.|
|[COleClientItem:: OnGetWindowContext](#ongetwindowcontext)|Chiamato dal framework quando un elemento viene attivato sul posto.|
|[COleClientItem:: OnScrollBy](#onscrollby)|Chiamato dal Framework per scorrere l'elemento nella visualizzazione.|
|[COleClientItem:: OnShowItem](#onshowitem)|Chiamata eseguita dal Framework per visualizzare l'elemento OLE.|

## <a name="remarks"></a>Commenti

Un elemento OLE rappresenta i dati, creati e gestiti da un'applicazione server, che possono essere incorporati in un documento in modo che l'utente sia un singolo documento. Il risultato è un "documento composto" costituito dall'elemento OLE e da un documento contenitore.

Un elemento OLE può essere incorporato o collegato. Se è incorporata, i relativi dati vengono archiviati come parte del documento composto. Se è collegato, i relativi dati vengono archiviati come parte di un file separato creato dall'applicazione server e solo un collegamento a tale file viene archiviato nel documento composto. Tutti gli elementi OLE contengono informazioni che specificano l'applicazione server che deve essere chiamata per modificarli.

`COleClientItem` definisce diverse funzioni sottoponibili a override chiamate in risposta alle richieste dall'applicazione server. questi sottoponibili a override in genere fungono da notifiche. Ciò consente all'applicazione server di informare il contenitore delle modifiche apportate dall'utente durante la modifica dell'elemento OLE o di recuperare le informazioni necessarie durante la modifica.

`COleClientItem` può essere usato con la classe [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)o [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) . Per usare `COleClientItem` , derivare una classe da essa e implementare la funzione membro [OnChange](#onchange) , che definisce il modo in cui il contenitore risponde alle modifiche apportate all'elemento. Per supportare l'attivazione sul posto, eseguire l'override della funzione membro [OnGetItemPosition](#ongetitemposition) . Questa funzione fornisce informazioni sulla posizione visualizzata dell'elemento OLE.

Per altre informazioni sull'uso dell'interfaccia contenitore, vedere gli articoli [contenitori: implementazione di un contenitore](../../mfc/containers-implementing-a-container.md) e [attivazione](../../mfc/activation-cpp.md).

> [!NOTE]
> Il Windows SDK fa riferimento a elementi incorporati e collegati come "oggetti" e fa riferimento a tipi di elementi come "classi". Questo riferimento usa il termine "Item" per distinguere l'entità OLE dall'oggetto C++ corrispondente e il termine "Type" per distinguere la categoria OLE dalla classe C++.

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Requisiti

**Intestazione:** AFXOLE. h

## <a name="coleclientitemactivate"></a><a name="activate"></a> COleClientItem:: Activate

Chiamare questa funzione per eseguire il verbo specificato anziché [DoVerb](#doverb) , in modo che sia possibile eseguire un'elaborazione personalizzata quando viene generata un'eccezione.

```cpp
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametri

*nVerb*<br/>
Specifica il verbo da eseguire. I possibili valori sono i seguenti:

|Valore|Significato|Simbolo|
|-----------|-------------|------------|
|-0|verbo primario|OLEIVERB_PRIMARY|
|- 1|Verbo secondario|(nessuna)|
|- 1|Elemento visualizzato per la modifica|OLEIVERB_SHOW|
|-2|Modifica elemento in una finestra separata|OLEIVERB_OPEN|
|-3|Nascondi elemento|OLEIVERB_HIDE|

Il valore-1 è in genere un alias per un altro verbo. Se la modifica aperta non è supportata,-2 ha lo stesso effetto di-1. Per ulteriori valori, vedere [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) nella Windows SDK.

*pView*<br/>
Puntatore alla finestra di visualizzazione del contenitore che contiene l'elemento OLE; viene utilizzato dall'applicazione server per l'attivazione sul posto. Questo parametro deve essere NULL se il contenitore non supporta l'attivazione sul posto.

*lpMsg*<br/>
Puntatore al messaggio che ha causato l'attivazione dell'elemento.

### <a name="remarks"></a>Commenti

Se l'applicazione server è stata scritta utilizzando la libreria Microsoft Foundation Class, questa funzione determina l'esecuzione della funzione membro [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) dell' `COleServerItem` oggetto corrispondente.

Se il verbo principale è Edit e il valore zero viene specificato nel parametro *nVerb* , viene avviata l'applicazione server per consentire la modifica dell'elemento OLE. Se l'applicazione contenitore supporta l'attivazione sul posto, la modifica può essere eseguita sul posto. Se il contenitore non supporta l'attivazione sul posto (o se viene specificato il verbo di apertura), il server viene avviato in una finestra separata e la modifica può essere eseguita in tale finestra. In genere, quando l'utente dell'applicazione contenitore fa doppio clic sull'elemento OLE, il valore del verbo primario nel parametro *nVerb* determina l'azione che l'utente può eseguire. Tuttavia, se il server supporta solo un'azione, accetta tale azione, indipendentemente dal valore specificato nel parametro *nVerb* .

Per ulteriori informazioni, vedere [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) nella Windows SDK.

## <a name="coleclientitemactivateas"></a><a name="activateas"></a> COleClientItem:: activates

Utilizza le funzionalità di conversione degli oggetti OLE per attivare l'elemento come se fosse un elemento del tipo specificato da *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametri

*lpszUserType*<br/>
Puntatore a una stringa che rappresenta il tipo di utente di destinazione, ad esempio "documento di Word".

*clsidOld*<br/>
Riferimento all'ID della classe corrente dell'elemento. L'ID classe deve rappresentare il tipo dell'oggetto effettivo, come archiviato, a meno che non si tratti di un collegamento. In tal caso, deve essere il CLSID dell'elemento a cui si riferisce il collegamento. [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) fornisce automaticamente l'ID di classe corretto per l'elemento.

*clsidNew*<br/>
Riferimento all'ID della classe di destinazione.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questo metodo viene chiamato automaticamente da [COleConvertDialog::D oconvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Non viene in genere chiamato direttamente.

## <a name="coleclientitemattachdataobject"></a><a name="attachdataobject"></a> COleClientItem:: AttachDataObject

Chiamare questa funzione per inizializzare un [COleDataObject](../../mfc/reference/coledataobject-class.md) per l'accesso ai dati nell'elemento OLE.

```cpp
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parametri

*rDataObject*<br/>
Riferimento a un `COleDataObject` oggetto che verrà inizializzato per consentire l'accesso ai dati nell'elemento OLE.

## <a name="coleclientitemcanactivate"></a><a name="canactivate"></a> COleClientItem:: CanActivate

Chiamata eseguita dal framework quando l'utente richiede l'attivazione sul posto dell'elemento OLE; il valore restituito di questa funzione determina se è consentita l'attivazione sul posto.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se è consentita l'attivazione sul posto; in caso contrario, 0.

### <a name="remarks"></a>Commenti

L'implementazione predefinita consente l'attivazione sul posto se il contenitore dispone di una finestra valida. Eseguire l'override di questa funzione per implementare la logica speciale per accettare o rifiutare la richiesta di attivazione. Una richiesta di attivazione, ad esempio, può essere rifiutata se l'elemento OLE è troppo piccolo o non è attualmente visibile.

Per ulteriori informazioni, vedere [IOleInPlaceSite:: CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) nella Windows SDK.

## <a name="coleclientitemcancreatefromdata"></a><a name="cancreatefromdata"></a> COleClientItem:: CanCreateFromData

Verifica se un'applicazione contenitore può creare un oggetto incorporato dall'oggetto specificato `COleDataObject` .

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametri

*pDataObject*<br/>
Puntatore all'oggetto [COleDataObject](../../mfc/reference/coledataobject-class.md) da cui deve essere creato l'elemento OLE.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il contenitore può creare un oggetto incorporato dall' `COleDataObject` oggetto; in caso contrario, 0.

### <a name="remarks"></a>Commenti

La `COleDataObject` classe viene utilizzata nei trasferimenti di dati per il recupero di dati in vari formati dagli Appunti, tramite il trascinamento della selezione o da un elemento OLE incorporato.

I contenitori possono usare questa funzione per decidere di abilitare o disabilitare i comandi di modifica incolla e modifica incolla speciale.

Per ulteriori informazioni, vedere l'articolo [oggetti dati e origini dati (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcancreatelinkfromdata"></a><a name="cancreatelinkfromdata"></a> COleClientItem:: CanCreateLinkFromData

Verifica se un'applicazione contenitore può creare un oggetto collegato dall'oggetto specificato `COleDataObject` .

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametri

*pDataObject*<br/>
Puntatore all'oggetto [COleDataObject](../../mfc/reference/coledataobject-class.md) da cui deve essere creato l'elemento OLE.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il contenitore può creare un oggetto collegato dall' `COleDataObject` oggetto.

### <a name="remarks"></a>Commenti

La `COleDataObject` classe viene utilizzata nei trasferimenti di dati per il recupero di dati in vari formati dagli Appunti, tramite il trascinamento della selezione o da un elemento OLE incorporato.

I contenitori possono usare questa funzione per decidere di abilitare o disabilitare i comandi di modifica incolla speciale e modifica Incolla collegamento.

Per ulteriori informazioni, vedere l'articolo [oggetti dati e origini dati (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcanpaste"></a><a name="canpaste"></a> COleClientItem:: CanPaste

Chiamare questa funzione per verificare se un elemento OLE incorporato può essere incollato dagli Appunti.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se un elemento OLE incorporato può essere incollato dagli Appunti; in caso contrario, 0.

### <a name="remarks"></a>Commenti

Per ulteriori informazioni, vedere [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) e [OleQueryCreateFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) nel Windows SDK.

## <a name="coleclientitemcanpastelink"></a><a name="canpastelink"></a> COleClientItem:: CanPasteLink

Chiamare questa funzione per verificare se un elemento OLE collegato può essere incollato dagli Appunti.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se un elemento OLE collegato può essere incollato dagli Appunti; in caso contrario, 0.

### <a name="remarks"></a>Commenti

Per ulteriori informazioni, vedere [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) e [OleQueryLinkFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) nel Windows SDK.

## <a name="coleclientitemclose"></a><a name="close"></a> COleClientItem:: Close

Chiamare questa funzione per modificare lo stato di un elemento OLE dallo stato di esecuzione allo stato Loaded, ovvero caricato con il relativo gestore in memoria, ma con il server non in esecuzione.

```cpp
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parametri

*dwCloseOption*<br/>
Flag che specifica le circostanze in cui l'elemento OLE viene salvato quando torna allo stato Loaded. Può avere uno dei valori seguenti:

- OLECLOSE_SAVEIFDIRTY salvare l'elemento OLE.

- OLECLOSE_NOSAVE non salvare l'elemento OLE.

- OLECLOSE_PROMPTSAVE chiedere all'utente se salvare l'elemento OLE.

### <a name="remarks"></a>Commenti

Questa funzione non ha effetto se l'elemento OLE non è in esecuzione.

Per ulteriori informazioni, vedere [IOleObject:: Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) nell'Windows SDK.

## <a name="coleclientitemcoleclientitem"></a><a name="coleclientitem"></a> COleClientItem:: COleClientItem

Costruisce un `COleClientItem` oggetto e lo aggiunge alla raccolta di elementi del documento del contenitore che costruisce solo l'oggetto C++ e non esegue alcuna inizializzazione OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parametri

*pContainerDoc*<br/>
Puntatore al documento del contenitore che conterrà questo elemento. Può trattarsi di qualsiasi derivato [COleDocument](../../mfc/reference/coledocument-class.md) .

### <a name="remarks"></a>Commenti

Se si passa un puntatore NULL, non viene apportata alcuna aggiunta al documento del contenitore. È necessario chiamare in modo esplicito [COleDocument:: AddItem](../../mfc/reference/coledocument-class.md#additem).

Prima di usare l'elemento OLE, è necessario chiamare una delle funzioni membro di creazione seguenti:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

## <a name="coleclientitemconvertto"></a><a name="convertto"></a> COleClientItem:: ConvertTo

Chiamare questa funzione membro per convertire l'elemento nel tipo specificato da *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametri

*clsidNew*<br/>
ID classe del tipo di destinazione.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questo metodo viene chiamato automaticamente da [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Non è necessario chiamarlo direttamente.

## <a name="coleclientitemcopytoclipboard"></a><a name="copytoclipboard"></a> COleClientItem:: CopyToClipboard

Chiamare questa funzione per copiare l'elemento OLE negli Appunti.

```cpp
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parametri

*bIncludeLink*<br/>
TRUE se le informazioni di collegamento devono essere copiate negli Appunti, consentendo di incollare un elemento collegato; in caso contrario, FALSE.

### <a name="remarks"></a>Commenti

In genere, questa funzione viene chiamata durante la scrittura di gestori di messaggi per i comandi copia o taglia dal menu Modifica. È necessario implementare la selezione degli elementi nell'applicazione contenitore se si desidera implementare i comandi Copy o cut.

Per ulteriori informazioni, vedere [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) nel Windows SDK.

## <a name="coleclientitemcreateclonefrom"></a><a name="createclonefrom"></a> COleClientItem:: CreateCloneFrom

Chiamare questa funzione per creare una copia dell'elemento OLE specificato.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parametri

*pSrcItem*<br/>
Puntatore all'elemento OLE da duplicare.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

La copia è identica all'elemento di origine. È possibile utilizzare questa funzione per supportare le operazioni di annullamento.

## <a name="coleclientitemcreatefromclipboard"></a><a name="createfromclipboard"></a> COleClientItem:: CreateFromClipboard

Chiamare questa funzione per creare un elemento incorporato dal contenuto degli Appunti.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*render*<br/>
Flag che specifica il modo in cui il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender) nel Windows SDK.

*cfFormat*<br/>
Specifica il formato dati degli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a una struttura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizzata se *il rendering* è olerender_format o OLERENDER_DRAW. Fornire un valore per questo parametro solo se si desidera specificare informazioni aggiuntive sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati i valori predefiniti per gli altri campi nella `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questa funzione viene in genere chiamata dal gestore di messaggi per il comando Incolla del menu Modifica. Il comando Incolla viene abilitato dal Framework se la funzione membro [CanPaste](#canpaste) restituisce un valore diverso da zero.

Per ulteriori informazioni, vedere [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender) e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) nella Windows SDK.

## <a name="coleclientitemcreatefromdata"></a><a name="createfromdata"></a> COleClientItem:: CreateFromData

Chiamare questa funzione per creare un elemento incorporato da un `COleDataObject` oggetto.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*pDataObject*<br/>
Puntatore all'oggetto [COleDataObject](../../mfc/reference/coledataobject-class.md) da cui deve essere creato l'elemento OLE.

*render*<br/>
Flag che specifica il modo in cui il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender) nel Windows SDK.

*cfFormat*<br/>
Specifica il formato dati degli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a una struttura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizzata se *il rendering* è olerender_format o OLERENDER_DRAW. Fornire un valore per questo parametro solo se si desidera specificare informazioni aggiuntive sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati i valori predefiniti per gli altri campi nella `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Le operazioni di trasferimento dei dati, ad esempio l'incollatura dagli Appunti o le operazioni di trascinamento della selezione, forniscono `COleDataObject` oggetti contenenti le informazioni offerte da un'applicazione server. Viene in genere usato nell'override di [CView:: OnDrop](../../mfc/reference/cview-class.md#ondrop).

Per ulteriori informazioni, vedere [OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) nella Windows SDK.

## <a name="coleclientitemcreatefromfile"></a><a name="createfromfile"></a> COleClientItem:: CreateFromFile

Chiamare questa funzione per creare un elemento OLE incorporato da un file.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*lpszFileName*<br/>
Puntatore al nome del file da cui deve essere creato l'elemento OLE.

*CLSID*<br/>
Riservato per usi futuri.

*render*<br/>
Flag che specifica il modo in cui il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender) nel Windows SDK.

*cfFormat*<br/>
Specifica il formato dati degli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a una struttura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizzata se *il rendering* è olerender_format o OLERENDER_DRAW. Fornire un valore per questo parametro solo se si desidera specificare informazioni aggiuntive sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati i valori predefiniti per gli altri campi nella `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Il Framework chiama questa funzione da [COleInsertDialog:: CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) se l'utente sceglie OK nella finestra di dialogo Inserisci oggetto quando viene selezionato il pulsante Crea da file.

Per ulteriori informazioni, vedere [OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile), [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) nella Windows SDK.

## <a name="coleclientitemcreatelinkfromclipboard"></a><a name="createlinkfromclipboard"></a> COleClientItem:: CreateLinkFromClipboard

Chiamare questa funzione per creare un elemento collegato dal contenuto degli Appunti.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*render*<br/>
Flag che specifica il modo in cui il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender) nel Windows SDK.

*cfFormat*<br/>
Specifica il formato dati degli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a una struttura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizzata se *il rendering* è olerender_format o OLERENDER_DRAW. Fornire un valore per questo parametro solo se si desidera specificare informazioni aggiuntive sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati i valori predefiniti per gli altri campi nella `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questa funzione viene in genere chiamata dal gestore di messaggi per il comando Incolla collegamento nel menu Modifica. Il comando Incolla collegamento è abilitato nell'implementazione predefinita di [COleDocument](../../mfc/reference/coledocument-class.md) se gli Appunti contengono un elemento OLE a cui è possibile collegarsi.

Per ulteriori informazioni, vedere [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender) e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) nella Windows SDK.

## <a name="coleclientitemcreatelinkfromdata"></a><a name="createlinkfromdata"></a> COleClientItem:: CreateLinkFromData

Chiamare questa funzione per creare un elemento collegato da un `COleDataObject` oggetto.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*pDataObject*<br/>
Puntatore all'oggetto [COleDataObject](../../mfc/reference/coledataobject-class.md) da cui deve essere creato l'elemento OLE.

*render*<br/>
Flag che specifica il modo in cui il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender) nel Windows SDK.

*cfFormat*<br/>
Specifica il formato dati degli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a una struttura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizzata se *il rendering* è olerender_format o OLERENDER_DRAW. Fornire un valore per questo parametro solo se si desidera specificare informazioni aggiuntive sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati i valori predefiniti per gli altri campi nella `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Chiamare questo oggetto durante un'operazione DROP quando l'utente indica che è necessario creare un collegamento. Può essere usato anche per gestire il comando modifica incolla. Viene chiamato dal Framework in `COleClientItem::CreateLinkFromClipboard` e in [COlePasteSpecialDialog:: CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) quando è stata selezionata l'opzione di collegamento.

Per ulteriori informazioni, vedere [OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) nella Windows SDK.

## <a name="coleclientitemcreatelinkfromfile"></a><a name="createlinkfromfile"></a> COleClientItem:: CreateLinkFromFile

Chiamare questa funzione per creare un elemento OLE collegato da un file.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*lpszFileName*<br/>
Puntatore al nome del file da cui deve essere creato l'elemento OLE.

*render*<br/>
Flag che specifica il modo in cui il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender) nel Windows SDK.

*cfFormat*<br/>
Specifica il formato dati degli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a una struttura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizzata se *il rendering* è olerender_format o OLERENDER_DRAW. Fornire un valore per questo parametro solo se si desidera specificare informazioni aggiuntive sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati i valori predefiniti per gli altri campi nella `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Il Framework chiama questa funzione se l'utente sceglie OK nella finestra di dialogo Inserisci oggetto quando viene selezionato il pulsante Crea da file e la casella di controllo collega è selezionata. Viene chiamato da [COleInsertDialog:: CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Per ulteriori informazioni, vedere [OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) nella Windows SDK.

## <a name="coleclientitemcreatenewitem"></a><a name="createnewitem"></a> COleClientItem:: CreateNewItem

Chiamare questa funzione per creare un elemento incorporato; Questa funzione avvia l'applicazione server che consente all'utente di creare l'elemento OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*CLSID*<br/>
ID che identifica in modo univoco il tipo di elemento OLE da creare.

*render*<br/>
Flag che specifica il modo in cui il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender) nel Windows SDK.

*cfFormat*<br/>
Specifica il formato dati degli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a una struttura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizzata se *il rendering* è olerender_format o OLERENDER_DRAW. Fornire un valore per questo parametro solo se si desidera specificare informazioni aggiuntive sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati i valori predefiniti per gli altri campi nella `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Il Framework chiama questa funzione se l'utente sceglie OK nella finestra di dialogo Inserisci oggetto quando viene selezionato il pulsante Crea nuovo.

Per ulteriori informazioni, vedere [OleCreate](/windows/win32/api/ole/nf-ole-olecreate), [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) nella Windows SDK.

## <a name="coleclientitemcreatestaticfromclipboard"></a><a name="createstaticfromclipboard"></a> COleClientItem:: CreateStaticFromClipboard

Chiamare questa funzione per creare un elemento statico dal contenuto degli Appunti.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*render*<br/>
Flag che specifica il modo in cui il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender) nel Windows SDK.

*cfFormat*<br/>
Specifica il formato dati degli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a una struttura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizzata se *il rendering* è olerender_format o OLERENDER_DRAW. Fornire un valore per questo parametro solo se si desidera specificare informazioni aggiuntive sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati i valori predefiniti per gli altri campi nella `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Un elemento statico contiene i dati di presentazione ma non i dati nativi. di conseguenza, non può essere modificato. Questa funzione viene in genere chiamata se la funzione membro [CreateFromClipboard](#createfromclipboard) ha esito negativo.

Per ulteriori informazioni, vedere [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender) e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) nella Windows SDK.

## <a name="coleclientitemcreatestaticfromdata"></a><a name="createstaticfromdata"></a> COleClientItem:: CreateStaticFromData

Chiamare questa funzione per creare un elemento statico da un `COleDataObject` oggetto.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*pDataObject*<br/>
Puntatore all'oggetto [COleDataObject](../../mfc/reference/coledataobject-class.md) da cui deve essere creato l'elemento OLE.

*render*<br/>
Flag che specifica il modo in cui il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender) nel Windows SDK.

*cfFormat*<br/>
Specifica il formato dati degli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a una struttura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizzata se *il rendering* è olerender_format o OLERENDER_DRAW. Fornire un valore per questo parametro solo se si desidera specificare informazioni aggiuntive sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati i valori predefiniti per gli altri campi nella `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Un elemento statico contiene i dati di presentazione ma non i dati nativi. di conseguenza, non può essere modificato. Questo è essenzialmente lo stesso di [CreateStaticFromClipboard](#createstaticfromclipboard) , ad eccezione del fatto che un elemento statico può essere creato da un arbitrario `COleDataObject` , non solo dagli Appunti.

Usato in [COlePasteSpecialDialog:: CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) quando è selezionato static.

Per ulteriori informazioni, vedere [OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDERe](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) nella Windows SDK.

## <a name="coleclientitemdeactivate"></a><a name="deactivate"></a> COleClientItem::D ttiva

Chiamare questa funzione per disattivare l'elemento OLE e liberare tutte le risorse associate.

```cpp
void Deactivate();
```

### <a name="remarks"></a>Commenti

In genere si disattiva un elemento OLE attivo sul posto quando l'utente fa clic con il mouse sull'area client all'esterno dei limiti dell'elemento. Si noti che la disattivazione dell'elemento OLE eliminerà lo stato di annullamento, rendendo impossibile la chiamata alla funzione membro [ReactivateAndUndo](#reactivateandundo) .

Se l'applicazione supporta l'annullamento, non chiamare, `Deactivate` bensì chiamare [DeactivateUI](#deactivateui).

Per ulteriori informazioni, vedere [IOleInPlaceObject:: InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) nella Windows SDK.

## <a name="coleclientitemdeactivateui"></a><a name="deactivateui"></a> COleClientItem::D eactivateUI

Chiamare questa funzione quando l'utente disattiva un elemento attivato sul posto.

```cpp
void DeactivateUI();
```

### <a name="remarks"></a>Commenti

Questa funzione Ripristina lo stato originale dell'interfaccia utente dell'applicazione contenitore, nascondendo tutti i menu e altri controlli creati per l'attivazione sul posto.

Questa funzione non Scarica le informazioni sullo stato di annullamento per l'elemento. Tali informazioni vengono conservate in modo che [ReactivateAndUndo](#reactivateandundo) possa essere usato in un secondo momento per eseguire un comando Annulla nell'applicazione server, nel caso in cui il comando Annulla del contenitore venga scelto immediatamente dopo la disattivazione dell'elemento.

Per ulteriori informazioni, vedere [IOleInPlaceObject:: InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) nella Windows SDK.

## <a name="coleclientitemdelete"></a><a name="delete"></a> COleClientItem::D Elimina

Chiamare questa funzione per eliminare l'elemento OLE dal documento contenitore.

```cpp
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parametri

*bAutoDelete*<br/>
Specifica se l'elemento deve essere rimosso dal documento.

### <a name="remarks"></a>Commenti

Questa funzione chiama la funzione membro [Release](#release) , che a sua volta Elimina l'oggetto C++ per l'elemento, rimuovendo definitivamente l'elemento OLE dal documento. Se l'elemento OLE è incorporato, i dati nativi per l'elemento vengono eliminati. Chiude sempre un server in esecuzione; Pertanto, se l'elemento è un collegamento aperto, la funzione la chiude.

## <a name="coleclientitemdodragdrop"></a><a name="dodragdrop"></a> COleClientItem::D oDragDrop

Chiamare la `DoDragDrop` funzione membro per eseguire un'operazione di trascinamento della selezione.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parametri

*lpItemRect in*<br/>
Il rettangolo dell'elemento sullo schermo in coordinate client (pixel).

*ptOffset*<br/>
Offset da *lpItemRect in* in cui si trovava la posizione del mouse al momento del trascinamento.

*bIncludeLink*<br/>
Impostare su TRUE se i dati del collegamento devono essere copiati negli Appunti. Impostarla su FALSE se l'applicazione server non supporta i collegamenti.

*dwEffects*<br/>
Determina gli effetti che l'origine di trascinamento consentirà nell'operazione di trascinamento.

*lpRectStartDrag*<br/>
Puntatore al rettangolo che definisce la posizione in cui inizia effettivamente il trascinamento. Per ulteriori informazioni, vedere la sezione Osservazioni successiva.

### <a name="return-value"></a>Valore restituito

Valore DROPEFFECT. Se è DROPEFFECT_MOVE, i dati originali devono essere rimossi.

### <a name="remarks"></a>Commenti

L'operazione di trascinamento della selezione non viene avviata immediatamente. Attende fino a quando il cursore del mouse lascia il rettangolo specificato da *lpRectStartDrag* o fino a quando non viene superato il numero di millisecondi specificato. Se *lpRectStartDrag* è null, le dimensioni del rettangolo sono pari a un pixel.

Il tempo di ritardo viene specificato da un'impostazione della chiave del registro di sistema. È possibile modificare l'ora di ritardo chiamando [CWinApp:: WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) o [CWinApp:: WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Se non si specifica il tempo di ritardo, viene usato un valore predefinito di 200 millisecondi. Il tempo di trascinamento del ritardo viene archiviato come segue:

- Il tempo di ritardi di trascinamento di Windows NT è archiviato in HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini \Windows\DragDelay.

- Il tempo di ritardo del trascinamento di Windows 3. x viene archiviato nel file di WIN.INI, nella sezione [Windows}.

- Il ritardo di trascinamento di Windows 95/98 viene archiviato in una versione memorizzata nella cache di WIN.INI.

Per ulteriori informazioni sul modo in cui le informazioni sul ritardo di trascinamento vengono archiviate nel registro di sistema o. File INI, vedere [WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) nel Windows SDK.

## <a name="coleclientitemdoverb"></a><a name="doverb"></a> COleClientItem::D oVerb

Chiamare `DoVerb` per eseguire il verbo specificato.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametri

*nVerb*<br/>
Specifica il verbo da eseguire. Può includere uno degli elementi seguenti:

|Valore|Significato|Simbolo|
|-----------|-------------|------------|
|-0|verbo primario|OLEIVERB_PRIMARY|
|- 1|Verbo secondario|(nessuna)|
|- 1|Elemento visualizzato per la modifica|OLEIVERB_SHOW|
|-2|Modifica elemento in una finestra separata|OLEIVERB_OPEN|
|-3|Nascondi elemento|OLEIVERB_HIDE|

Il valore-1 è in genere un alias per un altro verbo. Se la modifica aperta non è supportata,-2 ha lo stesso effetto di-1. Per ulteriori valori, vedere [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) nella Windows SDK.

*pView*<br/>
Puntatore alla finestra di visualizzazione; viene utilizzato dal server per l'attivazione sul posto. Questo parametro deve essere NULL se l'applicazione contenitore non consente l'attivazione sul posto.

*lpMsg*<br/>
Puntatore al messaggio che ha causato l'attivazione dell'elemento.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il verbo è stato eseguito correttamente. in caso contrario, 0.

### <a name="remarks"></a>Commenti

Questa funzione chiama la funzione membro [Activate](#activate) per eseguire il verbo. Rileva inoltre le eccezioni e visualizza una finestra di messaggio all'utente se ne viene generata una.

Se il verbo principale è Edit e il valore zero viene specificato nel parametro *nVerb* , viene avviata l'applicazione server per consentire la modifica dell'elemento OLE. Se l'applicazione contenitore supporta l'attivazione sul posto, la modifica può essere eseguita sul posto. Se il contenitore non supporta l'attivazione sul posto (o se viene specificato il verbo di apertura), il server viene avviato in una finestra separata e la modifica può essere eseguita in tale finestra. In genere, quando l'utente dell'applicazione contenitore fa doppio clic sull'elemento OLE, il valore del verbo primario nel parametro *nVerb* determina l'azione che l'utente può eseguire. Tuttavia, se il server supporta solo un'azione, accetta tale azione, indipendentemente dal valore specificato nel parametro *nVerb* .

## <a name="coleclientitemdraw"></a><a name="draw"></a> COleClientItem::D RAW

Chiamare questa funzione per creare l'elemento OLE nel rettangolo di delimitazione specificato utilizzando il contesto di dispositivo specificato.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Puntatore a un oggetto [CDC](../../mfc/reference/cdc-class.md) utilizzato per disegnare l'elemento OLE.

*lpBounds*<br/>
Puntatore a un oggetto o a una struttura [CRect](../../atl-mfc-shared/reference/crect-class.md) `RECT` che definisce il rettangolo di delimitazione in cui tracciare l'elemento OLE (in unità logiche determinate dal contesto di dispositivo).

*nDrawAspect*<br/>
Specifica l'aspetto dell'elemento OLE, ovvero la modalità di visualizzazione. Se *nDrawAspect* è-1, viene usato l'ultimo aspetto impostato usando [SetDrawAspect](#setdrawaspect) . Per ulteriori informazioni sui valori possibili per questo flag, vedere [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

La funzione può utilizzare la rappresentazione del metafile dell'elemento OLE creato dalla funzione membro [onpare](../../mfc/reference/coleserveritem-class.md#ondraw) di `COleServerItem` .

In genere si usa `Draw` per la visualizzazione schermo, passando il contesto del dispositivo della schermata come *PDC*. In questo caso, è necessario specificare solo i primi due parametri.

Il parametro *lpBounds* identifica il rettangolo nel contesto di dispositivo di destinazione (relativo alla modalità di mapping corrente). Il rendering può comportare il ridimensionamento dell'immagine e può essere utilizzato dalle applicazioni contenitore per imporre una visualizzazione che si ridimensiona tra la visualizzazione visualizzata e l'immagine stampata finale.

Per ulteriori informazioni, vedere [IViewObject::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) nel Windows SDK.

## <a name="coleclientitemgetactiveview"></a><a name="getactiveview"></a> COleClientItem:: GetActiveView

Restituisce la visualizzazione in cui l'elemento è attivato sul posto.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Valore restituito

Puntatore alla visualizzazione; in caso contrario, NULL se l'elemento non è attivato sul posto.

## <a name="coleclientitemgetcachedextent"></a><a name="getcachedextent"></a> COleClientItem:: GetCachedExtent

Chiamare questa funzione per recuperare la dimensione dell'elemento OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametri

*lpSize*<br/>
Puntatore a una `SIZE` struttura o a un oggetto [CSize](../../atl-mfc-shared/reference/csize-class.md) che riceverà le informazioni sulle dimensioni.

*nDrawAspect*<br/>
Specifica l'aspetto dell'elemento OLE di cui devono essere recuperati i limiti. Per i valori possibili, vedere [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; 0 se l'elemento OLE è vuoto.

### <a name="remarks"></a>Commenti

Questa funzione fornisce le stesse informazioni di [GetExtent](#getextent). Tuttavia, è possibile chiamare `GetCachedExtent` per ottenere informazioni sull'extent durante l'elaborazione di altri gestori OLE, ad esempio [OnChange](#onchange). Le dimensioni si trovano in unità MM_HIMETRIC.

Questo è possibile perché `GetCachedExtent` utilizza l'interfaccia [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) anziché utilizzare l'interfaccia [IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject) per ottenere l'ambito di questo elemento. L' `IViewObject2` oggetto com memorizza nella cache le informazioni sull'extent utilizzate nella precedente chiamata a [IViewObject::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw).

Per ulteriori informazioni, vedere [IViewObject2:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) nel Windows SDK.

## <a name="coleclientitemgetclassid"></a><a name="getclassid"></a> COleClientItem:: GetClassID

Restituisce l'ID di classe dell'elemento nella memoria a cui punta *pClassId*.

```cpp
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parametri

*pClassID*<br/>
Puntatore a un identificatore di tipo [CLSID](/windows/win32/com/clsid-key-hklm) per recuperare l'ID di classe. Per informazioni su CLSID, vedere la Windows SDK.

### <a name="remarks"></a>Commenti

L'ID di classe è un numero a 128 bit che identifica in modo univoco l'applicazione che modifica l'elemento.

Per ulteriori informazioni, vedere [IPersist:: GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) nella Windows SDK.

## <a name="coleclientitemgetclipboarddata"></a><a name="getclipboarddata"></a> COleClientItem:: GetClipboardData

Chiamare questa funzione per ottenere un `COleDataSource` oggetto contenente tutti i dati che verrebbero inseriti negli Appunti da una chiamata alla funzione membro [CopyToClipboard](#copytoclipboard) .

```cpp
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parametri

*pDataSource*<br/>
Puntatore a un oggetto [COleDataSource](../../mfc/reference/coledatasource-class.md) che riceverà i dati contenuti nell'elemento OLE.

*bIncludeLink*<br/>
TRUE se devono essere inclusi i dati di collegamento. in caso contrario, FALSE.

*lpOffset*<br/>
Offset del cursore del mouse dall'origine dell'oggetto in pixel.

*lpSize*<br/>
Dimensioni dell'oggetto in pixel.

### <a name="remarks"></a>Commenti

`GetClipboardData` viene chiamato come implementazione predefinita di [OnGetClipboardData](#ongetclipboarddata). Eseguire l'override `OnGetClipboardData` solo se si desidera offrire formati di dati oltre a quelli offerti da `CopyToClipboard` . Inserire i formati nell' `COleDataSource` oggetto prima o dopo la chiamata `CopyToClipboard` a, quindi passare l' `COleDataSource` oggetto alla funzione [COleDataSource::](../../mfc/reference/coledatasource-class.md#setclipboard) selettore. Se, ad esempio, si desidera che la posizione dell'elemento OLE nel relativo documento contenitore venga accompagnata negli Appunti, è necessario definire un formato personalizzato per passare le informazioni e inserirle in `COleDataSource` prima di chiamare `CopyToClipboard` .

## <a name="coleclientitemgetdocument"></a><a name="getdocument"></a> COleClientItem:: GetDocument

Chiamare questa funzione per ottenere un puntatore al documento che contiene l'elemento OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Valore restituito

Puntatore al documento che contiene l'elemento OLE. NULL se l'elemento non fa parte di un documento.

### <a name="remarks"></a>Commenti

Questo puntatore consente l'accesso all' `COleDocument` oggetto passato come argomento al `COleClientItem` costruttore.

## <a name="coleclientitemgetdrawaspect"></a><a name="getdrawaspect"></a> COleClientItem:: GetDrawAspect

Chiamare la `GetDrawAspect` funzione membro per determinare l'aspetto o la visualizzazione corrente dell'elemento.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Valore restituito

Valore dell'enumerazione DVASPECT i cui valori sono elencati nel riferimento per [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Commenti

L'aspetto specifica il modo in cui deve essere eseguito il rendering dell'elemento.

## <a name="coleclientitemgetextent"></a><a name="getextent"></a> COleClientItem:: GetExtent

Chiamare questa funzione per recuperare la dimensione dell'elemento OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parametri

*lpSize*<br/>
Puntatore a una `SIZE` struttura o a un `CSize` oggetto che riceverà le informazioni sulle dimensioni.

*nDrawAspect*<br/>
Specifica l'aspetto dell'elemento OLE di cui devono essere recuperati i limiti. Per i valori possibili, vedere [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; 0 se l'elemento OLE è vuoto.

### <a name="remarks"></a>Commenti

Se l'applicazione server è stata scritta utilizzando la libreria Microsoft Foundation Class, questa funzione causa la chiamata della funzione membro [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) dell' `COleServerItem` oggetto corrispondente. Si noti che le dimensioni recuperate potrebbero essere diverse da quelle dell'ultima impostazione della funzione membro [seextent](#setextent) . la dimensione specificata da `SetExtent` viene considerata come un suggerimento. Le dimensioni si trovano in unità MM_HIMETRIC.

> [!NOTE]
> Non chiamare `GetExtent` durante l'elaborazione di un gestore OLE, ad esempio [OnChange](#onchange). In alternativa, chiamare [GetCachedExtent](#getcachedextent) .

Per ulteriori informazioni, vedere [IOleObject:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) nel Windows SDK.

## <a name="coleclientitemgeticonfromregistry"></a><a name="geticonfromregistry"></a> COleClientItem:: GetIconFromRegistry

Chiamare questa funzione membro per recuperare un handle per una risorsa icona associata al server di un particolare CLSID.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parametri

*CLSID*<br/>
Riferimento al CLSID per il server associato all'icona.

### <a name="return-value"></a>Valore restituito

Handle valido per la risorsa icona oppure NULL se l'icona del server o un'icona predefinita non è stata trovata.

### <a name="remarks"></a>Commenti

Questa funzione membro non avvierà il server o otterrà un'icona dinamicamente, anche se il server è già in esecuzione. Questa funzione membro apre invece l'immagine eseguibile del server e recupera l'icona statica associata al server come è stata registrata.

## <a name="coleclientitemgeticonicmetafile"></a><a name="geticonicmetafile"></a> COleClientItem:: GetIconicMetafile

Recupera il metafile utilizzato per disegnare l'icona dell'elemento.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Valore restituito

Handle per il metafile in caso di esito positivo; in caso contrario, NULL.

### <a name="remarks"></a>Commenti

Se non è presente alcuna icona corrente, viene restituita un'icona predefinita. Questo metodo viene chiamato automaticamente dalle finestre di dialogo MFC/OLE e in genere non viene chiamato direttamente.

Questa funzione chiama anche [SetIconicMetafile](#seticonicmetafile) per memorizzare nella cache il metafile per un uso successivo.

## <a name="coleclientitemgetinplacewindow"></a><a name="getinplacewindow"></a> COleClientItem:: GetInPlaceWindow

Chiamare la `GetInPlaceWindow` funzione membro per ottenere un puntatore alla finestra in cui l'elemento è stato aperto per la modifica sul posto.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Valore restituito

Puntatore alla finestra di modifica sul posto dell'elemento; NULL se l'elemento non è attivo o se il server non è disponibile.

### <a name="remarks"></a>Commenti

Questa funzione deve essere chiamata solo per gli elementi attivi sul posto.

## <a name="coleclientitemgetitemstate"></a><a name="getitemstate"></a> COleClientItem:: GetItemState

Chiamare questa funzione per ottenere lo stato corrente dell'elemento OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Valore restituito

`COleClientItem::ItemState`Valore enumerato, che può essere uno dei seguenti: `emptyState` , `loadedState` , `openState` , `activeState` , `activeUIState` . Per informazioni su questi Stati, vedere l'articolo [contenitori: Client-Item stati](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Commenti

Per ricevere una notifica quando viene modificato lo stato dell'elemento OLE, usare la funzione membro [OnChange](#onchange) .

Per ulteriori informazioni, vedere l'articolo [contenitori: Client-Item stati](../../mfc/containers-client-item-states.md).

## <a name="coleclientitemgetlaststatus"></a><a name="getlaststatus"></a> COleClientItem:: GetLastStatus

Restituisce il codice di stato dell'ultima operazione OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Valore restituito

Valore SCODE.

### <a name="remarks"></a>Commenti

Per le funzioni membro che restituiscono un valore BOOL di FALSE o altre funzioni membro che restituiscono NULL, `GetLastStatus` restituisce informazioni più dettagliate sugli errori. Tenere presente che la maggior parte delle funzioni membro OLE genera eccezioni per errori più gravi. Le informazioni specifiche sull'interpretazione di SCODE dipendono dalla chiamata OLE sottostante che ha restituito per ultimo un valore SCODE.

Per ulteriori informazioni su SCODE, vedere la pagina relativa alla [struttura dei codici di errore com](/windows/win32/com/structure-of-com-error-codes) nella documentazione Windows SDK.

## <a name="coleclientitemgetlinkupdateoptions"></a><a name="getlinkupdateoptions"></a> COleClientItem:: GetLinkUpdateOptions

Chiamare questa funzione per ottenere il valore corrente dell'opzione di aggiornamento del collegamento per l'elemento OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Valore restituito

Uno dei valori seguenti:

- Quando possibile, OLEUPDATE_ALWAYS aggiornare l'elemento collegato. Questa opzione supporta il pulsante di opzione collegamento-aggiornamento automatico nella finestra di dialogo collegamenti.

- OLEUPDATE_ONCALL aggiornare l'elemento collegato solo su richiesta dall'applicazione contenitore (quando viene chiamata la funzione membro [UpdateLink](#updatelink) ). Questa opzione supporta il pulsante di opzione collegamento manuale-aggiornamento nella finestra di dialogo collegamenti.

### <a name="remarks"></a>Commenti

Si tratta di un'operazione avanzata.

Questa funzione viene chiamata automaticamente dalla classe [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) .

Per ulteriori informazioni, vedere [IOleLink:: GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) nella Windows SDK.

## <a name="coleclientitemgettype"></a><a name="gettype"></a> COleClientItem:: GetType

Chiamare questa funzione per determinare se l'elemento OLE è incorporato o collegato o statico.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Valore restituito

Unsigned Integer con uno dei valori seguenti:

- OT_LINK l'elemento OLE è un collegamento.

- OT_EMBEDDED l'elemento OLE è incorporato.

- OT_STATIC l'elemento OLE è statico, ovvero contiene solo dati di presentazione, non dati nativi e pertanto non può essere modificato.

## <a name="coleclientitemgetusertype"></a><a name="getusertype"></a> COleClientItem:: GetUserType

Chiamare questa funzione per ottenere la stringa visibile dall'utente che descrive il tipo dell'elemento OLE, ad esempio "documento di Word".

```cpp
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parametri

*nUserClassType*<br/>
Valore che indica la variante desiderata della stringa che descrive il tipo dell'elemento OLE. Il valore può essere uno dei seguenti:

- USERCLASSTYPE_FULL il nome completo del tipo visualizzato all'utente.

- USERCLASSTYPE_SHORT un nome breve (massimo 15 caratteri) da usare nei menu a comparsa e nella finestra di dialogo Modifica collegamenti.

- USERCLASSTYPE_APPNAME nome dell'applicazione che gestisce la classe.

*rString*<br/>
Riferimento a un oggetto [CString](../../atl-mfc-shared/reference/cstringt-class.md) in cui deve essere restituita la stringa che descrive il tipo dell'elemento OLE.

### <a name="remarks"></a>Commenti

Si tratta spesso della voce nel database di registrazione del sistema.

Se il nome completo del tipo è richiesto ma non disponibile, viene utilizzato il nome breve. Se nel database di registrazione non viene trovata alcuna voce per il tipo di elemento OLE o se non sono presenti tipi di utente registrati per il tipo di elemento OLE, viene usato il tipo di utente attualmente archiviato nell'elemento OLE. Se il nome del tipo di utente è una stringa vuota, viene utilizzato "Unknown Object".

Per ulteriori informazioni, vedere [IOleObject:: GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) nel Windows SDK.

## <a name="coleclientitemisinplaceactive"></a><a name="isinplaceactive"></a> COleClientItem:: IsInPlaceActive

Chiamare questa funzione per verificare se l'elemento OLE è attivo sul posto.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento OLE è attivo sul posto; in caso contrario, 0.

### <a name="remarks"></a>Commenti

È normale eseguire una logica diversa a seconda che l'elemento venga modificato sul posto. La funzione verifica se lo stato dell'elemento corrente è uguale a `activeState` o `activeUIState` .

## <a name="coleclientitemislinkuptodate"></a><a name="islinkuptodate"></a> COleClientItem:: IsLinkUpToDate

Chiamare questa funzione per verificare se l'elemento OLE è aggiornato.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento OLE è aggiornato; in caso contrario, 0.

### <a name="remarks"></a>Commenti

Un elemento collegato può non essere aggiornato se il documento di origine è stato aggiornato. Un elemento incorporato che contiene collegamenti al suo interno può diventare non aggiornato. La funzione esegue un controllo ricorsivo dell'elemento OLE. Si noti che determinare se un elemento OLE non è aggiornato può risultare costoso quanto l'esecuzione di un aggiornamento.

Questo metodo viene chiamato automaticamente dall'implementazione di [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) .

Per ulteriori informazioni, vedere [IOleObject:: IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) nel Windows SDK.

## <a name="coleclientitemismodified"></a><a name="ismodified"></a> COleClientItem:: modified

Chiamare questa funzione per verificare se l'elemento OLE è dirty (modificato dall'ultimo salvataggio).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento OLE è modificato; in caso contrario, 0.

### <a name="remarks"></a>Commenti

Per ulteriori informazioni, vedere [IPersistStorage:: IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) nell'Windows SDK.

## <a name="coleclientitemisopen"></a><a name="isopen"></a> COleClientItem:: Open

Chiamare questa funzione per verificare se l'elemento OLE è aperto; ovvero, viene aperto in un'istanza dell'applicazione server in esecuzione in una finestra separata.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento OLE è aperto; in caso contrario, 0.

### <a name="remarks"></a>Commenti

Viene usato per determinare quando creare l'oggetto con un motivo di tratteggio. Un oggetto aperto deve avere un modello di tratteggio disegnato sulla parte superiore dell'oggetto. Per eseguire questa operazione, è possibile usare un oggetto [CRectTracker](../../mfc/reference/crecttracker-class.md) .

## <a name="coleclientitemisrunning"></a><a name="isrunning"></a> COleClientItem:: outrunning

Chiamare questa funzione per verificare se l'elemento OLE è in esecuzione; ovvero se l'elemento viene caricato e in esecuzione nell'applicazione server.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento OLE è in esecuzione; in caso contrario, 0.

### <a name="remarks"></a>Commenti

Per ulteriori informazioni, vedere [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) nel Windows SDK.

## <a name="coleclientitemonactivate"></a><a name="onactivate"></a> COleClientItem:: OnActivate

Chiamato dal Framework per notificare all'elemento che è stato appena attivato sul posto.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Commenti

Si noti che questa funzione viene chiamata per indicare che il server è in esecuzione e non per indicare che l'interfaccia utente è stata installata nell'applicazione contenitore. A questo punto, l'oggetto non dispone di un'interfaccia utente attiva (non è `activeUIState` ). Non ha installato i menu o la barra degli strumenti. Quando si verifica questa situazione, viene chiamata la funzione membro [OnActivateUI](#onactivateui) .

L'implementazione predefinita chiama la funzione membro [OnChange](#onchange) con OLE_CHANGEDSTATE come parametro. Eseguire l'override di questa funzione per eseguire un'elaborazione personalizzata quando un elemento diventa attivo sul posto.

## <a name="coleclientitemonactivateui"></a><a name="onactivateui"></a> COleClientItem:: OnActivateUI

Il Framework chiama `OnActivateUI` quando l'oggetto è entrato nello stato attivo dell'interfaccia utente.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Commenti

L'oggetto ha ora installato la barra degli strumenti e i menu.

L'implementazione predefinita memorizza l'HWND del server per le chiamate successive `GetServerWindow` .

## <a name="coleclientitemonchange"></a><a name="onchange"></a> COleClientItem:: OnChange

Chiamata eseguita dal framework quando l'utente modifica, Salva o chiude l'elemento OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parametri

*nCode*<br/>
Motivo per cui il server ha modificato l'elemento. Può avere uno dei valori seguenti:

- OLE_CHANGED l'aspetto dell'elemento OLE è stato modificato.

- OLE_SAVED l'elemento OLE è stato salvato.

- OLE_CLOSED l'elemento OLE è stato chiuso.

- OLE_CHANGED_STATE l'elemento OLE è stato modificato da uno stato a un altro.

*dwParam*<br/>
Se *nCode* è OLE_SAVED o OLE_CLOSED, questo parametro non viene utilizzato. Se *nCode* è OLE_CHANGED, questo parametro specifica l'aspetto dell'elemento OLE che è stato modificato. Per i valori possibili, vedere il parametro *dwParam* di [COleClientItem::D RAW](#draw). Se *nCode* è OLE_CHANGED_STATE, questo parametro è un `COleClientItem::ItemState` valore enumerato e descrive lo stato immesso. Può avere uno dei valori seguenti:,, `emptyState` `loadedState` `openState` , `activeState` o `activeUIState` .

### <a name="remarks"></a>Commenti

Se l'applicazione server viene scritta utilizzando la libreria Microsoft Foundation Class, questa funzione viene chiamata in risposta alle `Notify` funzioni membro di `COleServerDoc` o `COleServerItem` . L'implementazione predefinita contrassegna il documento del contenitore come modificato se *nCode* è OLE_CHANGED o OLE_SAVED.

Per OLE_CHANGED_STATE, lo stato corrente restituito da [GetItemState](#getitemstate) sarà ancora lo stato precedente, ovvero lo stato corrente prima di questa modifica dello stato.

Eseguire l'override di questa funzione per rispondere alle modifiche apportate allo stato dell'elemento OLE. In genere l'aspetto dell'elemento viene aggiornato invalidando l'area in cui viene visualizzato l'elemento. Chiamare l'implementazione della classe di base all'inizio dell'override.

## <a name="coleclientitemonchangeitemposition"></a><a name="onchangeitemposition"></a> COleClientItem:: OnChangeItemPosition

Chiamata eseguita dal Framework per notificare al contenitore che l'extent dell'elemento OLE è stato modificato durante l'attivazione sul posto.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parametri

*rectPos*<br/>
Indica la posizione dell'elemento rispetto all'area client dell'applicazione contenitore.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la posizione dell'elemento viene modificata correttamente; in caso contrario, 0.

### <a name="remarks"></a>Commenti

L'implementazione predefinita determina il nuovo rettangolo visibile dell'elemento OLE e chiama [SetItemRects](#setitemrects) con i nuovi valori. L'implementazione predefinita calcola il rettangolo visibile per l'elemento e passa tali informazioni al server.

Eseguire l'override di questa funzione per applicare regole speciali all'operazione di ridimensionamento/spostamento. Se l'applicazione è scritta in MFC, questa chiamata viene generata perché il server ha chiamato [COleServerDoc:: RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

## <a name="coleclientitemondeactivate"></a><a name="ondeactivate"></a> COleClientItem:: OnDeactivate

Chiamata eseguita dal framework quando l'elemento OLE passa dallo stato attivo sul posto ( `activeState` ) allo stato Loaded, ovvero viene disattivato dopo un'attivazione sul posto.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Commenti

Si noti che questa funzione viene chiamata per indicare che l'elemento OLE è chiuso e non che l'interfaccia utente è stata rimossa dall'applicazione contenitore. In tal caso, viene chiamata la funzione membro [OnDeactivateUI](#ondeactivateui) .

L'implementazione predefinita chiama la funzione membro [OnChange](#onchange) con OLE_CHANGEDSTATE come parametro. Eseguire l'override di questa funzione per eseguire un'elaborazione personalizzata quando viene disattivato un elemento attivo sul posto. Se, ad esempio, si supporta il comando Annulla nell'applicazione contenitore, è possibile eseguire l'override di questa funzione per annullare lo stato di annullamento, a indicare che l'ultima operazione eseguita sull'elemento OLE non può essere annullata dopo la disattivazione dell'elemento.

## <a name="coleclientitemondeactivateandundo"></a><a name="ondeactivateandundo"></a> COleClientItem:: OnDeactivateAndUndo

Chiamato dal framework quando l'utente richiama il comando Annulla dopo aver attivato l'elemento OLE sul posto.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Commenti

L'implementazione predefinita chiama [DeactivateUI](#deactivateui) per disattivare l'interfaccia utente del server. Eseguire l'override di questa funzione se si sta implementando il comando Undo nell'applicazione contenitore. Nell'override chiamare la versione della classe base della funzione e quindi annullare l'ultimo comando eseguito nell'applicazione.

Per ulteriori informazioni, vedere [IOleInPlaceSite::D eactivateandundo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) nel Windows SDK.

## <a name="coleclientitemondeactivateui"></a><a name="ondeactivateui"></a> COleClientItem:: OnDeactivateUI

Chiamato quando l'utente disattiva un elemento attivato sul posto.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parametri

*bUndoable*<br/>
Specifica se le modifiche di modifica sono annullabili.

### <a name="remarks"></a>Commenti

Questa funzione Ripristina lo stato originale dell'interfaccia utente dell'applicazione contenitore, nascondendo tutti i menu e altri controlli creati per l'attivazione sul posto.

Se *bUndoable* è false, il contenitore deve disabilitare il comando Undo, ignorando in effetti lo stato di annullamento del contenitore, perché indica che l'ultima operazione eseguita dal server non è annullabile.

## <a name="coleclientitemondiscardundostate"></a><a name="ondiscardundostate"></a> COleClientItem:: OnDiscardUndoState

Chiamato dal framework quando l'utente esegue un'azione che elimina lo stato di annullamento durante la modifica dell'elemento OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Commenti

L'implementazione predefinita non esegue alcuna operazione. Eseguire l'override di questa funzione se si sta implementando il comando Undo nell'applicazione contenitore. Nella sostituzione ignorare lo stato di annullamento dell'applicazione contenitore.

Se il server è stato scritto con il libreria Microsoft Foundation Class, il server può causare la chiamata di questa funzione chiamando [COleServerDoc::D iscardundostate](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Per ulteriori informazioni, vedere [IOleInPlaceSite::D iscardundostate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) nel Windows SDK.

## <a name="coleclientitemongetclipboarddata"></a><a name="ongetclipboarddata"></a> COleClientItem:: OnGetClipboardData

Chiamata eseguita dal Framework per ottenere un `COleDataSource` oggetto contenente tutti i dati che verrebbero inseriti negli Appunti da una chiamata a [CopyToClipboard](#copytoclipboard) o alla funzione membro [DoDragDrop](#dodragdrop) .

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parametri

*bIncludeLink*<br/>
Impostare su TRUE se i dati di collegamento devono essere copiati negli Appunti. Impostare su FALSE se l'applicazione server non supporta i collegamenti.

*lpOffset*<br/>
Puntatore all'offset del cursore del mouse dall'origine dell'oggetto in pixel.

*lpSize*<br/>
Puntatore alla dimensione dell'oggetto in pixel.

### <a name="return-value"></a>Valore restituito

Puntatore a un oggetto [COleDataSource](../../mfc/reference/coledatasource-class.md) che contiene i dati degli Appunti.

### <a name="remarks"></a>Commenti

L'implementazione predefinita di questa funzione chiama [GetClipboardData](#getclipboarddata).

## <a name="coleclientitemongetcliprect"></a><a name="ongetcliprect"></a> COleClientItem:: OnGetClipRect

Il Framework chiama la `OnGetClipRect` funzione membro per ottenere le coordinate del rettangolo di ritaglio dell'elemento che viene modificato sul posto.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parametri

*rClipRect*<br/>
Puntatore a un oggetto della classe [CRect](../../atl-mfc-shared/reference/crect-class.md) che conterrà le coordinate del rettangolo di ritaglio dell'elemento.

### <a name="remarks"></a>Commenti

Le coordinate sono espresse in pixel rispetto all'area client della finestra dell'applicazione contenitore.

L'implementazione predefinita restituisce semplicemente il rettangolo client della visualizzazione in cui l'elemento è attivo sul posto.

## <a name="coleclientitemongetitemposition"></a><a name="ongetitemposition"></a> COleClientItem:: OnGetItemPosition

Il Framework chiama la `OnGetItemPosition` funzione membro per ottenere le coordinate dell'elemento che viene modificato sul posto.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parametri

*rPosition*<br/>
Riferimento all'oggetto [CRect](../../atl-mfc-shared/reference/crect-class.md) che conterrà le coordinate della posizione dell'elemento.

### <a name="remarks"></a>Commenti

Le coordinate sono espresse in pixel rispetto all'area client della finestra dell'applicazione contenitore.

L'implementazione predefinita di questa funzione non esegue alcuna operazione. Le applicazioni che supportano la modifica sul posto richiedono la relativa implementazione.

## <a name="coleclientitemongetwindowcontext"></a><a name="ongetwindowcontext"></a> COleClientItem:: OnGetWindowContext

Chiamato dal framework quando un elemento viene attivato sul posto.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parametri

*ppMainFrame*<br/>
Puntatore a un puntatore alla finestra cornice principale.

*ppDocFrame*<br/>
Puntatore a un puntatore alla finestra cornice del documento.

*lpFrameInfo*<br/>
Puntatore a una struttura [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) che riceverà informazioni sulla finestra cornice.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Questa funzione viene utilizzata per recuperare informazioni sulla finestra padre dell'elemento OLE.

Se il contenitore è un'applicazione MDI, l'implementazione predefinita restituisce un puntatore all'oggetto [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) in *ppMainFrame* e un puntatore all'oggetto [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) attivo in *ppDocFrame*. Se il contenitore è un'applicazione SDI, l'implementazione predefinita restituisce un puntatore all'oggetto [CFrameWnd](../../mfc/reference/cframewnd-class.md) in *PPMAINFRAME* e restituisce null in *ppDocFrame*. L'implementazione predefinita riempie anche i membri di *lpFrameInfo*.

Eseguire l'override di questa funzione solo se l'implementazione predefinita non è adatta all'applicazione; ad esempio, se l'applicazione dispone di un paradigma dell'interfaccia utente diverso da SDI o MDI. Si tratta di un oggetto avanzato sottoponibile a override.

Per ulteriori informazioni, vedere [IOleInPlaceSite:: GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) e la struttura [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) nel Windows SDK.

## <a name="coleclientitemoninsertmenus"></a><a name="oninsertmenus"></a> COleClientItem:: OnInsertMenus

Chiamato dal Framework durante l'attivazione sul posto per inserire i menu dell'applicazione contenitore in un menu vuoto.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parametri

*pMenuShared*<br/>
Punta a un menu vuoto.

*lpMenuWidths*<br/>
Punta a una matrice di sei valori LONG che indica il numero di menu presenti in ognuno dei gruppi di menu seguenti: file, modifica, contenitore, oggetto, finestra, guida. L'applicazione contenitore è responsabile dei gruppi di menu file, contenitore e finestra, corrispondenti agli elementi 0, 2 e 4 di questa matrice.

### <a name="remarks"></a>Commenti

Questo menu viene quindi passato al server, che inserisce i propri menu, creando un menu composito. Questa funzione può essere chiamata ripetutamente per compilare diversi menu compositi.

L'implementazione predefinita inserisce in *pMenuShared* i menu del contenitore sul posto; ovvero i gruppi di menu file, contenitore e finestra. [CDocTemplate:: SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) viene usato per impostare questa risorsa di menu. L'implementazione predefinita assegna anche i valori appropriati agli elementi 0, 2 e 4 in *lpMenuWidths*, a seconda della risorsa di menu. Eseguire l'override di questa funzione se l'implementazione predefinita non è appropriata per l'applicazione. ad esempio, se l'applicazione non usa modelli di documento per associare le risorse ai tipi di documento. Se si esegue l'override di questa funzione, è necessario anche eseguire l'override di [OnSetMenu](#onsetmenu) e [OnRemoveMenus](#onremovemenus). Si tratta di un oggetto avanzato sottoponibile a override.

Per ulteriori informazioni, vedere [IOleInPlaceFrame:: InsertMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) nella Windows SDK.

## <a name="coleclientitemonremovemenus"></a><a name="onremovemenus"></a> COleClientItem:: OnRemoveMenus

Viene chiamato dal Framework per rimuovere i menu del contenitore dal menu composto specificato quando termina l'attivazione sul posto.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parametri

*pMenuShared*<br/>
Punta al menu composito costruito dalle chiamate alla funzione membro [OnInsertMenus](#oninsertmenus) .

### <a name="remarks"></a>Commenti

L'implementazione predefinita rimuove da *pMenuShared* i menu del contenitore sul posto, ovvero i gruppi di menu file, contenitore e finestra. Eseguire l'override di questa funzione se l'implementazione predefinita non è appropriata per l'applicazione. ad esempio, se l'applicazione non usa modelli di documento per associare le risorse ai tipi di documento. Se si esegue l'override di questa funzione, è probabile che si esegua l'override anche di [OnInsertMenus](#oninsertmenus) e [OnSetMenu](#onsetmenu) . Si tratta di un oggetto avanzato sottoponibile a override.

I sottomenu in *pMenuShared* possono essere condivisi da più di un menu composito se il server ha chiamato ripetutamente `OnInsertMenus` . Pertanto, non è necessario eliminare alcun sottomenu nell'override di `OnRemoveMenus` . è necessario scollegarli.

Per ulteriori informazioni, vedere [IOleInPlaceFrame:: RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) nella Windows SDK.

## <a name="coleclientitemonscrollby"></a><a name="onscrollby"></a> COleClientItem:: OnScrollBy

Chiamata eseguita dal Framework per scorrere l'elemento OLE in risposta alle richieste provenienti dal server.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parametri

*sizeExtent*<br/>
Specifica le distanze, in pixel, per scorrere nelle direzioni x e y.

### <a name="return-value"></a>Valore restituito

Diverso da zero se è stato eseguito lo scorrimento dell'elemento; 0 se non è stato possibile scorrere l'elemento.

### <a name="remarks"></a>Commenti

Se, ad esempio, l'elemento OLE è parzialmente visibile e l'utente si sposta al di fuori dell'area visibile durante l'esecuzione della modifica sul posto, questa funzione viene chiamata per rendere visibile il cursore. L'implementazione predefinita non esegue alcuna operazione. Eseguire l'override di questa funzione per scorrere l'elemento in base al valore specificato. Si noti che, in seguito allo scorrimento, la parte visibile dell'elemento OLE può cambiare. Chiamare [SetItemRects](#setitemrects) per aggiornare il rettangolo visibile dell'elemento.

Per ulteriori informazioni, vedere [IOleInPlaceSite:: scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) nella Windows SDK.

## <a name="coleclientitemonsetmenu"></a><a name="onsetmenu"></a> COleClientItem:: OnSetMenu

Chiamata eseguita due volte dal framework quando l'attivazione sul posto inizia e termina; la prima volta che si installa il menu composito e la seconda volta (con *holemenu* uguale a null) per rimuoverlo.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parametri

*pMenuShared*<br/>
Puntatore al menu composito costruito dalle chiamate alla funzione membro [OnInsertMenus](#oninsertmenus) e alla `InsertMenu` funzione.

*holemenu*<br/>
Handle per il descrittore di menu restituito dalla `OleCreateMenuDescriptor` funzione o null se il codice di invio deve essere rimosso.

*hwndActiveObject*<br/>
Handle per la finestra di modifica per l'elemento OLE. Si tratta della finestra che riceverà i comandi di modifica da OLE.

### <a name="remarks"></a>Commenti

L'implementazione predefinita installa o rimuove il menu composito, quindi chiama la funzione [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) per installare o rimuovere il codice di invio. Eseguire l'override di questa funzione se l'implementazione predefinita non è appropriata per l'applicazione. Se si esegue l'override di questa funzione, è probabile che si esegua l'override anche di [OnInsertMenus](#oninsertmenus) e [OnRemoveMenus](#onremovemenus) . Si tratta di un oggetto avanzato sottoponibile a override.

Per ulteriori informazioni, vedere [OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)e [IOleInPlaceFrame:: semenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) nella Windows SDK.

## <a name="coleclientitemonshowcontrolbars"></a><a name="onshowcontrolbars"></a> COleClientItem:: OnShowControlBars

Chiamata eseguita dal Framework per mostrare e nascondere le barre di controllo dell'applicazione contenitore.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parametri

*pFrameWnd*<br/>
Puntatore alla finestra cornice dell'applicazione contenitore. Può trattarsi di una finestra cornice principale o di una finestra figlio MDI.

*bShow*<br/>
Specifica se le barre di controllo devono essere visualizzate o nascoste.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiamata di funzione causa una modifica nello stato della barra di controllo; 0 se la chiamata non causa alcuna modifica o se *pFrameWnd* non punta alla finestra cornice del contenitore.

### <a name="remarks"></a>Commenti

Questa funzione restituisce 0 se le barre di controllo si trovano già nello stato specificato da *bShow.* Questa situazione si verifica, ad esempio, se le barre di controllo sono nascoste e *bShow* è false.

L'implementazione predefinita rimuove la barra degli strumenti dalla finestra cornice di primo livello.

## <a name="coleclientitemonshowitem"></a><a name="onshowitem"></a> COleClientItem:: OnShowItem

Chiamata eseguita dal Framework per visualizzare l'elemento OLE, rendendolo completamente visibile durante la modifica.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Commenti

Viene usato quando l'applicazione contenitore supporta collegamenti a elementi incorporati, ovvero se la classe del documento è stata derivata da [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md). Questa funzione viene chiamata durante l'attivazione sul posto o quando l'elemento OLE è un'origine di collegamento e l'utente vuole modificarlo. L'implementazione predefinita attiva la prima visualizzazione del documento contenitore. Eseguire l'override di questa funzione per scorrere il documento in modo che l'elemento OLE sia visibile.

## <a name="coleclientitemonupdateframetitle"></a><a name="onupdateframetitle"></a> COleClientItem:: OnUpdateFrameTitle

Chiamata eseguita dal Framework durante l'attivazione sul posto per aggiornare la barra del titolo della finestra cornice.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se la funzione ha aggiornato correttamente il titolo del frame; in caso contrario, zero.

### <a name="remarks"></a>Commenti

L'implementazione predefinita non modifica il titolo della finestra cornice. Eseguire l'override di questa funzione se si vuole un titolo di frame diverso per l'applicazione, ad esempio "elemento *app Server*  -   in *Nomedoc*" (come in, "Microsoft Excel-foglio di calcolo in REPORT.DOC"). Si tratta di un oggetto avanzato sottoponibile a override.

## <a name="coleclientitemreactivateandundo"></a><a name="reactivateandundo"></a> COleClientItem:: ReactivateAndUndo

Chiamare questa funzione per riattivare l'elemento OLE e annullare l'ultima operazione eseguita dall'utente durante la modifica sul posto.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Se l'applicazione contenitore supporta il comando Annulla, chiamare questa funzione se l'utente sceglie il comando Annulla immediatamente dopo la disattivazione dell'elemento OLE.

Se l'applicazione server viene scritta con le librerie di Microsoft Foundation Class, questa funzione causa la chiamata di [COleServerDoc:: OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo)da parte del server.

Per ulteriori informazioni, vedere [IOleInPlaceObject:: ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) nella Windows SDK.

## <a name="coleclientitemrelease"></a><a name="release"></a> COleClientItem:: Release

Chiamare questa funzione per pulire le risorse utilizzate dall'elemento OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parametri

*dwCloseOption*<br/>
Flag che specifica le circostanze in cui l'elemento OLE viene salvato quando torna allo stato Loaded. Per un elenco di valori possibili, vedere [COleClientItem:: Close](#close).

### <a name="remarks"></a>Commenti

`Release` viene chiamato dal `COleClientItem` distruttore.

Per ulteriori informazioni, vedere [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) nella Windows SDK.

## <a name="coleclientitemreload"></a><a name="reload"></a> COleClientItem:: Reload

Chiude e ricarica l'elemento.

```
BOOL Reload();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Chiamare la `Reload` funzione dopo aver attivato l'elemento come un elemento di un altro tipo mediante una chiamata a [Activate](#activateas).

## <a name="coleclientitemrun"></a><a name="run"></a> COleClientItem:: Run

Esegue l'applicazione associata a questo elemento.

```cpp
void Run();
```

### <a name="remarks"></a>Commenti

Chiamare la `Run` funzione membro per avviare l'applicazione server prima di attivare l'elemento. Questa operazione viene eseguita automaticamente da [Activate](#activate) e [DoVerb](#doverb), pertanto in genere non è necessario chiamare questa funzione. Chiamare questa funzione se è necessario eseguire il server per impostare un attributo dell'elemento, ad esempio [seextent](#setextent), prima di eseguire [DoVerb](#doverb).

## <a name="coleclientitemsetdrawaspect"></a><a name="setdrawaspect"></a> COleClientItem:: SetDrawAspect

Chiamare la `SetDrawAspect` funzione membro per impostare l'aspetto o la visualizzazione dell'elemento.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parametri

*nDrawAspect*<br/>
Valore dell'enumerazione DVASPECT. Per il parametro è possibile specificare uno dei valori riportati di seguito:

- DVASPECT_CONTENT elemento viene rappresentato in modo tale che possa essere visualizzato come oggetto incorporato all'interno del relativo contenitore.

- Viene eseguito il rendering di DVASPECT_THUMBNAIL elemento in una rappresentazione "thumbnail" in modo che possa essere visualizzato in uno strumento di esplorazione.

- DVASPECT_ICON elemento è rappresentato da un'icona.

- DVASPECT_DOCPRINT elemento viene rappresentato come se fosse stampato usando il comando stampa del menu file.

### <a name="remarks"></a>Commenti

L'aspetto specifica il modo in cui l'elemento deve essere sottoposto a rendering tramite il metodo di [traccia](#draw) quando viene usato il valore predefinito per l'argomento *nDrawAspect* della funzione.

Questa funzione viene chiamata automaticamente dall'icona di modifica (e da altre finestre di dialogo che chiamano direttamente la finestra di dialogo Cambia icona) per abilitare l'aspetto di visualizzazione iconico quando richiesto dall'utente.

## <a name="coleclientitemsetextent"></a><a name="setextent"></a> COleClientItem:: seextent

Chiamare questa funzione per specificare la quantità di spazio disponibile per l'elemento OLE.

```cpp
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parametri

*size*<br/>
Oggetto [CSize](../../atl-mfc-shared/reference/csize-class.md) che contiene le informazioni sulle dimensioni.

*nDrawAspect*<br/>
Specifica l'aspetto dell'elemento OLE di cui devono essere impostati i limiti. Per i valori possibili, vedere [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Commenti

Se l'applicazione server è stata scritta utilizzando la libreria Microsoft Foundation Class, in questo modo viene chiamata la funzione membro [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) dell' `COleServerItem` oggetto corrispondente. L'elemento OLE può quindi regolare la visualizzazione di conseguenza. Le dimensioni devono essere in unità MM_HIMETRIC. Chiamare questa funzione quando l'utente ridimensiona l'elemento OLE o se si supporta una forma di negoziazione del layout.

Per ulteriori informazioni, vedere [IOleObject:: seextent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) nel Windows SDK.

## <a name="coleclientitemsethostnames"></a><a name="sethostnames"></a> COleClientItem:: sehostnames

Chiamare questa funzione per specificare il nome dell'applicazione contenitore e il nome del contenitore per un elemento OLE incorporato.

```cpp
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parametri

*lpszHost*<br/>
Puntatore al nome visibile dall'utente dell'applicazione contenitore.

*lpszHostObj*<br/>
Puntatore a una stringa di identificazione del contenitore che contiene l'elemento OLE.

### <a name="remarks"></a>Commenti

Se l'applicazione server è stata scritta utilizzando la libreria Microsoft Foundation Class, questa funzione chiama la funzione membro [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) del `COleServerDoc` documento che contiene l'elemento OLE. Queste informazioni vengono utilizzate nei titoli delle finestre quando l'elemento OLE viene modificato. Ogni volta che viene caricato un documento contenitore, il Framework chiama questa funzione per tutti gli elementi OLE nel documento. `SetHostNames` si applica solo agli elementi incorporati. Non è necessario chiamare questa funzione ogni volta che un elemento OLE incorporato viene attivato per la modifica.

Viene anche chiamato automaticamente con il nome dell'applicazione e il nome del documento quando un oggetto viene caricato o quando un file viene salvato con un nome diverso. Di conseguenza, in genere non è necessario chiamare direttamente questa funzione.

Per ulteriori informazioni, vedere [IOleObject:: Filehostnames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) nella Windows SDK.

## <a name="coleclientitemseticonicmetafile"></a><a name="seticonicmetafile"></a> COleClientItem:: SetIconicMetafile

Memorizza nella cache il metafile utilizzato per disegnare l'icona dell'elemento.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parametri

*hMetaPict*<br/>
Handle per il metafile utilizzato per disegnare l'icona dell'elemento.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Commenti

Usare [GetIconicMetafile](#geticonicmetafile) per recuperare il metafile.

Il parametro *hMetaPict* viene copiato nell'elemento. di conseguenza, *hMetaPict* deve essere liberato dal chiamante.

## <a name="coleclientitemsetitemrects"></a><a name="setitemrects"></a> COleClientItem:: SetItemRects

Chiamare questa funzione per impostare il rettangolo di delimitazione o il rettangolo visibile dell'elemento OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametri

*lprcPosRect*<br/>
Puntatore al rettangolo contenente i limiti dell'elemento OLE rispetto alla relativa finestra padre, nelle coordinate del client.

*lprcClipRect*<br/>
Puntatore al rettangolo contenente i limiti della parte visibile dell'elemento OLE rispetto alla relativa finestra padre, nelle coordinate del client.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Commenti

Questa funzione viene chiamata dall'implementazione predefinita della funzione membro [OnChangeItemPosition](#onchangeitemposition) . È necessario chiamare questa funzione ogni volta che la posizione o la parte visibile dell'elemento OLE viene modificata. In genere ciò significa che è possibile chiamarlo dalle funzioni membro [OnSize](../../mfc/reference/cwnd-class.md#onsize) e [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) della visualizzazione.

Per ulteriori informazioni, vedere [IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) nella Windows SDK.

## <a name="coleclientitemsetlinkupdateoptions"></a><a name="setlinkupdateoptions"></a> COleClientItem:: SetLinkUpdateOptions

Chiamare questa funzione per impostare l'opzione di aggiornamento del collegamento per la presentazione dell'elemento collegato specificato.

```cpp
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parametri

*dwUpdateOpt*<br/>
Il valore dell'opzione di aggiornamento del collegamento per questo elemento. Questo valore deve essere uno dei seguenti:

- Quando possibile, OLEUPDATE_ALWAYS aggiornare l'elemento collegato. Questa opzione supporta il pulsante di opzione collegamento-aggiornamento automatico nella finestra di dialogo collegamenti.

- OLEUPDATE_ONCALL aggiornare l'elemento collegato solo su richiesta dall'applicazione contenitore (quando viene chiamata la funzione membro [UpdateLink](#updatelink) ). Questa opzione supporta il pulsante di opzione collegamento manuale-aggiornamento nella finestra di dialogo collegamenti.

### <a name="remarks"></a>Commenti

In genere, non è consigliabile modificare le opzioni di aggiornamento scelte dall'utente nella finestra di dialogo collegamenti.

Per ulteriori informazioni, vedere [IOleLink:: SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) nella Windows SDK.

## <a name="coleclientitemsetprintdevice"></a><a name="setprintdevice"></a> COleClientItem:: SetPrintDevice

Chiamare questa funzione per modificare il dispositivo di destinazione di stampa per questo elemento.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parametri

*PTD*<br/>
Puntatore a una struttura di dati [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) , che contiene informazioni sul nuovo dispositivo di destinazione di stampa. Può essere NULL.

*PPD*<br/>
Puntatore a una struttura di dati [PrintDlg](/windows/win32/api/commdlg/ns-commdlg-printdlga) , che contiene informazioni sul nuovo dispositivo di destinazione di stampa. Può essere NULL.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la funzione ha avuto esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Commenti

Questa funzione aggiorna il dispositivo di destinazione di stampa per l'elemento, ma non aggiorna la cache di presentazione. Per aggiornare la cache di presentazione per un elemento, chiamare [UpdateLink](#updatelink).

Gli argomenti di questa funzione contengono informazioni utilizzate dal sistema OLE per identificare il dispositivo di destinazione. La `PRINTDLG` struttura contiene informazioni utilizzate da Windows per inizializzare la finestra di dialogo Stampa comune. Dopo che l'utente ha chiuso la finestra di dialogo, Windows restituisce informazioni sulle selezioni dell'utente nella struttura. Il `m_pd` membro di un oggetto [CPrintDialog](../../mfc/reference/cprintdialog-class.md) è una `PRINTDLG` struttura.

Per ulteriori informazioni su questa struttura, vedere [PrintDlg](/windows/win32/api/commdlg/ns-commdlg-printdlga) nel Windows SDK.

Per ulteriori informazioni, vedere [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) nel Windows SDK.

## <a name="coleclientitemupdatelink"></a><a name="updatelink"></a> COleClientItem:: UpdateLink

Chiamare questa funzione per aggiornare immediatamente i dati di presentazione dell'elemento OLE.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero in caso di esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Commenti

Per gli elementi collegati, la funzione trova l'origine del collegamento per ottenere una nuova presentazione per l'elemento OLE. Questo processo può comportare l'esecuzione di una o più applicazioni server, che potrebbero richiedere molto tempo. Per gli elementi incorporati, la funzione funziona in modo ricorsivo, verificando se l'elemento incorporato contiene collegamenti che potrebbero non essere aggiornati e aggiornarli. L'utente può anche aggiornare manualmente singoli collegamenti tramite la finestra di dialogo collegamenti.

Per ulteriori informazioni, vedere [IOleLink:: Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) nel Windows SDK.

## <a name="see-also"></a>Vedi anche

[MFCBIND di esempio MFC](../../overview/visual-cpp-samples.md)<br/>
[OCLIENT di esempio MFC](../../overview/visual-cpp-samples.md)<br/>
[Classe CDocItem](../../mfc/reference/cdocitem-class.md)<br/>
[Grafico delle gerarchie](../../mfc/hierarchy-chart.md)<br/>
[Classe COleServerItem](../../mfc/reference/coleserveritem-class.md)
