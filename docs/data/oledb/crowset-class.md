---
title: Classe CRowset
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: 8cacbd6d188b3453c0111cca6565b7def9e3aa1e
ms.sourcegitcommit: ec6dd97ef3d10b44e0fedaa8e53f41696f49ac7b
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/25/2020
ms.locfileid: "88831567"
---
# <a name="crowset-class"></a>Classe CRowset

Incapsula un oggetto OLE DB set di righe e diverse interfacce correlate e fornisce metodi di manipolazione per i dati del set di righe.

## <a name="syntax"></a>Sintassi

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Parametri

*TAccessor*<br/>
Classe della funzione di accesso. Il valore predefinito è `CAccessorBase`.

## <a name="requirements"></a>Requisiti

**Intestazione:** atldbcli.h

## <a name="members"></a>Membri

### <a name="methods"></a>Metodi

| Nome | Descrizione |
|-|-|
|[AddRefRows](#addrefrows)|Incrementa il conteggio dei riferimenti associato alla riga corrente.|
|[Close](#close)|Rilascia le righe e l' `IRowset` interfaccia corrente.|
|[Confronta](#compare)|Confronta due segnalibri usando [IRowsetLocate:: compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).|
|[CRowset](#crowset)|Crea un nuovo `CRowset` oggetto e, facoltativamente, lo associa a un' `IRowset` interfaccia fornita come parametro.|
|[Elimina](#delete)|Elimina le righe dal set di righe utilizzando [IRowsetChange: DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)).|
|[FindNextRow](#findnextrow)|Trova la riga corrispondente successiva dopo il segnalibro specificato.|
|[GetApproximatePosition](#getapproximateposition)|Restituisce la posizione approssimativa di una riga corrispondente a un segnalibro.|
|[GetData](#getdata)|Recupera dati dalla copia della riga del set di righe.|
|[GetDataHere](#getdatahere)|Recupera i dati dal buffer specificato.|
|[GetOriginalData](#getoriginaldata)|Recupera i dati recuperati o trasmessi più di recente dall'origine dati, ignorando le modifiche in sospeso.|
|[GetRowStatus](#getrowstatus)|Restituisce lo stato di tutte le righe.|
|[Inserimento](#insert)|Crea e inserisce una nuova riga usando [IRowsetChange: InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85)).|
|[IsSameRow](#issamerow)|Confronta la riga specificata con la riga corrente.|
|[MoveFirst](#movefirst)|Riposiziona il percorso di recupero successivo nella posizione iniziale.|
|[MoveLast](#movelast)|Passa all'ultimo record.|
|[MoveNext](#movenext)|Recupera i dati dalla riga sequenziale successiva o da un numero specificato di posizioni oltre la riga successiva.|
|[MovePrev](#moveprev)|Passa al record precedente.|
|[MoveToBookmark](#movetobookmark)|Recupera la riga contrassegnata da un segnalibro o dalla riga in corrispondenza di un offset specificato da tale segnalibro.|
|[MoveToRatio](#movetoratio)|Recupera le righe a partire da una posizione frazionaria nel set di righe.|
|[ReleaseRows](#releaserows)|Chiama [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) per rilasciare l'handle di riga corrente.|
|[SetData](#setdata)|Imposta i valori dei dati in una o più colonne di una riga utilizzando [IRowsetChange: SetData](/previous-versions/windows/desktop/ms721232(v=vs.85)).|
|[Annulla](#undo)|Annulla le modifiche apportate a una riga dall'ultimo recupero o [aggiornamento](../../data/oledb/crowset-update.md).|
|[Aggiornamento](#update)|Trasmette tutte le modifiche in sospeso apportate alla riga corrente dall'ultimo recupero o aggiornamento.|
|[UpdateAll](#updateall)|Trasmette tutte le modifiche in sospeso apportate a tutte le righe dall'ultimo recupero o aggiornamento.|

## <a name="remarks"></a>Osservazioni

In OLE DB, un set di righe è l'oggetto attraverso il quale un programma imposta e recupera i dati.

Questa classe non è destinata a essere creata come istanza, ma viene invece passata come parametro di modello a `CTable` o `CCommand` ( `CRowset` è l'impostazione predefinita).

## <a name="crowsetaddrefrows"></a><a name="addrefrows"></a> CRowset:: AddRefRows

Chiama [IRowset:: AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85)) per incrementare (di uno) il conteggio dei riferimenti associato all'handle di riga corrente.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Questo metodo incrementa il conteggio dei riferimenti per l'handle di riga corrente. Chiamare [ReleaseRows](../../data/oledb/crowset-releaserows.md) per decrementare il conteggio. Le righe restituite dai metodi di spostamento hanno un conteggio dei riferimenti di uno.

## <a name="crowsetclose"></a><a name="close"></a> CRowset:: Close

Rilascia le righe e l'interfaccia [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) corrente.

### <a name="syntax"></a>Sintassi

```cpp
void Close() throw();
```

### <a name="remarks"></a>Osservazioni

Questo metodo rilascia tutte le righe attualmente presenti nel set di righe.

## <a name="crowsetcompare"></a><a name="compare"></a> CRowset:: compare

Confronta due segnalibri usando [IRowsetLocate:: compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).

### <a name="syntax"></a>Sintassi

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Parametri

*Segnalibro1*<br/>
in Primo segnalibro da confrontare.

*Segnalibro2*<br/>
in Secondo segnalibro da confrontare.

*pComparison*<br/>
out Puntatore al risultato del confronto.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Questo metodo richiede l'interfaccia facoltativa `IRowsetLocate` , che potrebbe non essere supportata in tutti i provider. in tal caso, il metodo restituisce E_NOINTERFACE. È inoltre necessario impostare su `DBPROP_IRowsetLocate` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe.

Per informazioni sull'uso di segnalibri nei consumer, vedere [uso dei segnalibri](../../data/oledb/using-bookmarks.md).

## <a name="crowsetcrowset"></a><a name="crowset"></a> CRowset:: CRowset

Crea un nuovo `CRowset` oggetto e, facoltativamente, lo associa a un'interfaccia [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) fornita come parametro.

### <a name="syntax"></a>Sintassi

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Parametri

*pRowset*<br/>
[in] Puntatore a un'interfaccia `IRowset` da associare a questa classe.

## <a name="crowsetdelete"></a><a name="delete"></a> CRowset::D Elimina

Chiama [IRowsetChange::D eleterows](/previous-versions/windows/desktop/ms724362(v=vs.85)) per eliminare la riga corrente dal set di righe.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

## <a name="crowsetfindnextrow"></a><a name="findnextrow"></a> CRowset:: FindNextRow

Trova la riga corrispondente successiva dopo il segnalibro specificato.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Parametri

*op*<br/>
in Operazione da utilizzare per il confronto di valori di riga. Per i valori, vedere [IRowsetFind:: FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85)).

*pData*<br/>
in Puntatore al valore da confrontare.

*wType*<br/>
in Indica il tipo di dati della parte del valore del buffer. Per informazioni sugli indicatori di tipo, vedere la pagina relativa ai [tipi di dati](/previous-versions/windows/desktop/ms723969(v=vs.85)) nella Guida *di riferimento per programmatori OLE DB* nel Windows SDK.

*nLength*<br/>
in Lunghezza, in byte, della struttura di dati del consumer allocata per il valore dei dati. Per informazioni dettagliate, vedere la descrizione di `cbMaxLen` in [strutture DBBINDING](/previous-versions/windows/desktop/ms716845(v=vs.85)) nella Guida *di riferimento per programmatori OLE DB.*

*bPrecision*<br/>
in Precisione massima utilizzata durante il recupero dei dati. Utilizzato solo se *wType* è DBTYPE_NUMERIC. Per ulteriori informazioni, vedere [conversioni che coinvolgono DBTYPE_NUMERIC o DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) nella Guida *di riferimento per programmatori OLE DB*.

*bScale*<br/>
in Scala utilizzata durante il recupero dei dati. Utilizzato solo se *wType* è DBTYPE_NUMERIC o DBTYPE_DECIMAL. Per ulteriori informazioni, vedere [conversioni che coinvolgono DBTYPE_NUMERIC o DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) nella Guida *di riferimento per programmatori OLE DB*.

*bSkipCurrent*<br/>
in Numero di righe dal segnalibro da cui iniziare una ricerca.

*pBookmark*<br/>
in Segnalibro per la posizione in cui avviare una ricerca.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Questo metodo richiede l'interfaccia facoltativa `IRowsetFind` , che potrebbe non essere supportata in tutti i provider. in tal caso, il metodo restituisce E_NOINTERFACE. È inoltre necessario impostare su `DBPROP_IRowsetFind` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe.

Per informazioni sull'uso di segnalibri nei consumer, vedere [uso dei segnalibri](../../data/oledb/using-bookmarks.md).

## <a name="crowsetgetapproximateposition"></a><a name="getapproximateposition"></a> CRowset:: GetApproximatePosition

Restituisce la posizione approssimativa di una riga corrispondente a un segnalibro.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Parametri

*pBookmark*<br/>
in Puntatore a un segnalibro che identifica la riga di cui deve essere trovata la posizione. NULL se è necessario solo il conteggio delle righe.

*pPosition*<br/>
out Puntatore alla posizione in cui `GetApproximatePosition` restituisce la posizione della riga. NULL se la posizione non è obbligatoria.

*pcRows*<br/>
out Puntatore alla posizione in cui `GetApproximatePosition` restituisce il numero totale di righe. NULL se il conteggio delle righe non è obbligatorio.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Questo metodo richiede l'interfaccia facoltativa `IRowsetScroll` , che potrebbe non essere supportata in tutti i provider. in tal caso, il metodo restituisce E_NOINTERFACE. È inoltre necessario impostare su `DBPROP_IRowsetScroll` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe.

Per informazioni sull'uso di segnalibri nei consumer, vedere [uso dei segnalibri](../../data/oledb/using-bookmarks.md).

## <a name="crowsetgetdata"></a><a name="getdata"></a> CRowset:: GetData

Recupera dati dalla copia della riga del set di righe.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Parametri

*nAccessor*<br/>
in Numero di indice (offset zero) della funzione di accesso da utilizzare per l'accesso ai dati.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Se si specifica una funzione di accesso che non è un autoaccesso in [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), usare questo metodo per ottenere i dati in modo esplicito passando il numero di funzione di accesso.

## <a name="crowsetgetdatahere"></a><a name="getdatahere"></a> CRowset:: GetDataHere

Recupera i dati dalla riga corrente e li inserisce nel buffer specificato.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Parametri

*nAccessor*<br/>
in Numero di indice della funzione di accesso da utilizzare per accedere ai dati.

*pBuffer*<br/>
out Buffer in cui inserire i dati per il record corrente.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Per un esempio di come usare questa funzione, vedere l'esempio relativo a più [letture](../../overview/visual-cpp-samples.md).

## <a name="crowsetgetoriginaldata"></a><a name="getoriginaldata"></a> CRowset:: GetOriginalData

Chiama `IRowsetUpdate::GetOriginalData` per recuperare i dati recuperati o trasmessi più di recente dall'origine dati.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Questo metodo recupera i dati recuperati o trasmessi più di recente all'origine dati. non recupera i valori in base alle modifiche in sospeso.

Questo metodo richiede l'interfaccia facoltativa `IRowsetUpdate` , che potrebbe non essere supportata in tutti i provider. in tal caso, il metodo restituisce E_NOINTERFACE. È inoltre necessario impostare su `DBPROP_IRowsetUpdate` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe.

## <a name="crowsetgetrowstatus"></a><a name="getrowstatus"></a> CRowset:: GetRowStatus

Restituisce lo stato di tutte le righe.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Parametri

*pStatus*<br/>
out Puntatore a una posizione in cui viene `GetRowStatus` restituito il valore di stato. Vedere DBPENDINGSTATUS nella Guida di riferimento per programmatori OLE DB.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Questo metodo richiede l'interfaccia facoltativa `IRowsetUpdate` , che potrebbe non essere supportata in tutti i provider. in tal caso, il metodo restituisce E_NOINTERFACE. È inoltre necessario impostare su `DBPROP_IRowsetUpdate` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe.

## <a name="crowsetinsert"></a><a name="insert"></a> CRowset:: Insert

Crea e Inizializza una nuova riga usando i dati dalla funzione di accesso.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Parametri

*nAccessor*<br/>
in Numero della funzione di accesso da utilizzare per inserire i dati.

*bGetHRow*<br/>
in Indica se l'handle per la riga inserita viene recuperato.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Questo metodo richiede l'interfaccia facoltativa `IRowsetChange` , che potrebbe non essere supportata in tutti i provider. in tal caso, il metodo restituisce E_NOINTERFACE. È inoltre necessario impostare su `DBPROP_IRowsetChange` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe.

L'inserimento potrebbe non riuscire se una o più colonne non sono scrivibili. Modificare la mappa del cursore per risolvere il problema.

### <a name="example"></a>Esempio

Nell'esempio seguente viene illustrato come accedere a un'origine dati tramite un set di righe e quindi inserire una stringa utilizzando una tabella in tale set di righe.

Per prima cosa, creare una classe di tabella inserendo un nuovo oggetto ATL nel progetto. Ad esempio, fare clic con il pulsante destro del mouse sul progetto nel riquadro area di lavoro e scegliere **nuovo oggetto ATL**. Nella categoria **accesso ai dati** selezionare **consumer**. Creare un oggetto consumer di tipo **Table**. Selezionando **Table** viene creato un set di righe direttamente dalla tabella. Se si seleziona il **comando** , viene creato un set di righe tramite un comando SQL. Consente di selezionare un'origine dati, specificando una tabella tramite cui accedere a tale origine dati. Se si chiama l'oggetto consumer **CCustomerTable**, è necessario implementare il codice di inserimento come segue:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="crowsetissamerow"></a><a name="issamerow"></a> CRowset:: IsSameRow

Confronta la riga specificata con la riga corrente.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Parametri

*hRow*<br/>
in Handle per la riga da confrontare con la riga corrente.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard. S_OK indica che le righe sono uguali. Per altri valori, vedere [IRowsetIndentity:: IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) nella Guida *di riferimento per programmatori OLE DB* nel Windows SDK.

## <a name="crowsetmovefirst"></a><a name="movefirst"></a> CRowset:: MoveFirst

Sposta il cursore nella posizione iniziale e recupera la riga iniziale.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Chiama [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) per riposizionare il percorso di recupero successivo nella posizione iniziale (la posizione che era il percorso di recupero successivo al momento della creazione del set di righe) e recupera la riga iniziale.

## <a name="crowsetmovelast"></a><a name="movelast"></a> CRowset:: MoveLast

Sposta il cursore sull'ultima riga.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Chiama [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) per riposizionare il percorso di recupero successivo nell'ultima posizione e recupera l'ultima riga.

Per questo metodo è necessario impostare su `DBPROP_CANSCROLLBACKWARDS` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe. Per ottenere prestazioni ottimali, è anche possibile impostare la `DBPROP_QUICKRESTART` VARIANT_TRUE.

## <a name="crowsetmovenext"></a><a name="movenext"></a> CRowset:: MoveNext

Sposta il cursore sul record successivo.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Parametri

*lSkip*<br/>
in Numero di righe da ignorare prima del recupero.

*bForward*<br/>
in Passare **`true`** per andare avanti al record successivo, **`false`** per spostarsi all'indietro.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard. Quando è stata raggiunta la fine del set di righe, restituisce DB_S_ENDOFROWSET.

### <a name="remarks"></a>Osservazioni

Recupera la riga sequenziale successiva dall' `CRowset` oggetto, ricordando la posizione precedente. Facoltativamente, è possibile scegliere di ignorare le righe *lSkip* o tornare indietro.

Per questo metodo è necessario impostare le proprietà seguenti prima `Open` di chiamare nella tabella o nel comando contenente il set di righe:

- `DBPROP_CANSCROLLBACKWARDS` deve essere VARIANT_TRUE se *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS` deve essere VARIANT_TRUE se *bForward* = false

In caso contrario (se *lSkip* >= 0 e *bForward* = true), non è necessario impostare proprietà aggiuntive.

## <a name="crowsetmoveprev"></a><a name="moveprev"></a> CRowset:: MovePrev

Sposta il cursore sul record precedente.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Per questo metodo è necessario impostare `DBPROP_CANFETCHBACKWARDS` o su `DBPROP_CANSCROLLBACKWARDS` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe.

## <a name="crowsetmovetobookmark"></a><a name="movetobookmark"></a> CRowset:: MoveToBookmark

Recupera la riga contrassegnata da un segnalibro o dalla riga in corrispondenza di un offset specificato (*lSkip*) dal segnalibro.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Parametri

*bookmark*<br/>
in Segnalibro che contrassegna la posizione da cui si desidera recuperare i dati.

*lSkip*<br/>
in Numero totale di righe dal segnalibro alla riga di destinazione. Se *lSkip* è zero, la prima riga recuperata è la riga con segnalibro. Se *lSkip* è 1, la prima riga recuperata è la riga successiva alla riga con segnalibro. Se *lSkip* è-1, la prima riga recuperata è la riga prima della riga con segnalibro.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Questo metodo richiede l'interfaccia facoltativa `IRowsetLocate` , che potrebbe non essere supportata in tutti i provider. in tal caso, il metodo restituisce E_NOINTERFACE. È inoltre necessario impostare su `DBPROP_IRowsetLocate` VARIANT_TRUE e su `DBPROP_CANFETCHBACKWARDS` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe.

Per informazioni sull'uso di segnalibri nei consumer, vedere [uso dei segnalibri](../../data/oledb/using-bookmarks.md).

## <a name="crowsetmovetoratio"></a><a name="movetoratio"></a> CRowset:: MoveToRatio

Recupera le righe a partire da una posizione frazionaria nel set di righe.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Parametri

*nNumerator*<br/>
in Numeratore utilizzato per determinare la posizione frazionaria da cui recuperare i dati.

*nDenominator*<br/>
in Denominatore utilizzato per determinare la posizione frazionaria da cui recuperare i dati.

*bForward*<br/>
in Indica se spostarsi avanti o indietro. Il valore predefinito è in futuro.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

`MoveToRatio` Recupera le righe in base all'approssimativamente alla formula seguente:

`(nNumerator *  RowsetSize ) / nDenominator`

dove `RowsetSize` è la dimensione del set di righe, misurata in righe. L'accuratezza di questa formula dipende dal provider specifico. Per informazioni dettagliate, vedere [IRowsetScroll:: GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85)).

Questo metodo richiede l'interfaccia facoltativa `IRowsetScroll` , che potrebbe non essere supportata in tutti i provider. in tal caso, il metodo restituisce E_NOINTERFACE. È inoltre necessario impostare su `DBPROP_IRowsetScroll` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe.

## <a name="crowsetreleaserows"></a><a name="releaserows"></a> CRowset:: ReleaseRows

Chiama [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) per rilasciare l'handle di riga corrente.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

## <a name="crowsetsetdata"></a><a name="setdata"></a> CRowset:: SetData

Imposta i valori dei dati in una o più colonne di una riga.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Parametri

*nAccessor*<br/>
in Numero della funzione di accesso da utilizzare per accedere ai dati.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Per il `SetData` form che non accetta argomenti, vengono utilizzate tutte le funzioni di accesso per l'aggiornamento. In genere si chiama `SetData` per impostare i valori dei dati nelle colonne di una riga, quindi chiamare [Update](../../data/oledb/crowset-update.md) per trasmettere tali modifiche.

Questo metodo richiede l'interfaccia facoltativa `IRowsetChange` , che potrebbe non essere supportata in tutti i provider. in tal caso, il metodo restituisce E_NOINTERFACE. È inoltre necessario impostare su `DBPROP_IRowsetChange` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe.

L'operazione di impostazione potrebbe non riuscire se una o più colonne non sono scrivibili. Modificare la mappa del cursore per risolvere il problema.

## <a name="crowsetundo"></a><a name="undo"></a> CRowset:: Undo

Annulla le modifiche apportate a una riga dall'ultimo recupero o [aggiornamento](../../data/oledb/crowset-update.md).

### <a name="syntax"></a>Sintassi

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametri

*pcRows*<br/>
out Puntatore alla posizione in cui `Undo` restituisce il numero di righe che ha tentato di annullare se necessario.

*phRow*<br/>
out Puntatore alla posizione in cui `Undo` restituisce una matrice di handle per tutte le righe in cui si è tentato di annullare se necessario.

*pStatus*<br/>
out Puntatore alla posizione in cui viene `Undo` restituito il valore dello stato della riga. Se *pStatus* è null, non viene restituito alcuno stato.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Questo metodo richiede l'interfaccia facoltativa `IRowsetUpdate` , che potrebbe non essere supportata in tutti i provider. in tal caso, il metodo restituisce E_NOINTERFACE. È inoltre necessario impostare su `DBPROP_IRowsetUpdate` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe.

## <a name="crowsetupdate"></a><a name="update"></a> CRowset:: Update

Trasmette tutte le modifiche in sospeso apportate alla riga corrente dall'ultima operazione di recupero o `Update` chiamata su di essa.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametri

*pcRows*<br/>
out Puntatore alla posizione in cui `Update` restituisce il numero di righe che ha tentato di aggiornare, se necessario.

*phRow*<br/>
out Puntatore alla posizione in cui `Update` restituisce l'handle della riga che ha tentato di aggiornare. Se *phRow* è null, non viene restituito alcun handle.

*pStatus*<br/>
out Puntatore alla posizione in cui viene `Update` restituito il valore dello stato della riga. Se *pStatus* è null, non viene restituito alcuno stato.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

### <a name="remarks"></a>Osservazioni

Trasmette tutte le modifiche in sospeso apportate alla riga corrente dall'ultimo recupero o aggiornamento della riga (utilizzando `Update` o [UpdateAll](../../data/oledb/crowset-updateall.md)). In genere si chiama [SetData](../../data/oledb/crowset-setdata.md) per impostare i valori dei dati nelle colonne di una riga e quindi si chiama `Update` per trasmettere tali modifiche.

Questo metodo richiede l'interfaccia facoltativa `IRowsetUpdate` , che potrebbe non essere supportata in tutti i provider. in tal caso, il metodo restituisce E_NOINTERFACE. È inoltre necessario impostare su `DBPROP_IRowsetUpdate` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe.

## <a name="crowsetupdateall"></a><a name="updateall"></a> CRowset:: UpdateAll

Trasmette tutte le modifiche in sospeso apportate a tutte le righe dall'ultima operazione di recupero o `Update` chiamata su di essa.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametri

*pcRows*<br/>
out Puntatore alla posizione in cui `UpdateAll` restituisce il numero di righe che ha tentato di aggiornare, se necessario.

*pphRow*<br/>
out Puntatore alla memoria in cui `UpdateAll` viene restituito l'handle della riga che ha tentato di aggiornare. Se *pphRow* è null, non viene restituito alcun handle.

*ppStatus*<br/>
out Puntatore alla posizione in cui viene `Update` restituito il valore dello stato della riga. Se *ppStatus* è null, non viene restituito alcuno stato.

### <a name="remarks"></a>Osservazioni

Trasmette tutte le modifiche in sospeso apportate a tutte le righe dall'ultimo recupero o aggiornamento di tali righe tramite [Update](../../data/oledb/crowset-update.md) o `UpdateAll` . `UpdateAll` aggiornerà ogni riga modificata, indipendentemente dal fatto che sia ancora presente il relativo handle (vedere *pphRow*).

Se ad esempio si è utilizzato `Insert` per inserire cinque righe in un set di righe, è possibile chiamare `Update` cinque volte o chiamare `UpdateAll` una sola volta per aggiornarle tutte.

Questo metodo richiede l'interfaccia facoltativa `IRowsetUpdate` , che potrebbe non essere supportata in tutti i provider. in tal caso, il metodo restituisce E_NOINTERFACE. È inoltre necessario impostare su `DBPROP_IRowsetUpdate` VARIANT_TRUE prima di chiamare `Open` nella tabella o nel comando contenente il set di righe.

### <a name="return-value"></a>Valore restituito

Valore HRESULT standard.

## <a name="see-also"></a>Vedere anche

[Esempio DBViewer](../../overview/visual-cpp-samples.md)<br/>
[Esempio di MultiRead](../../overview/visual-cpp-samples.md)<br/>
[Esempio di attributi MultiRead](../../overview/visual-cpp-samples.md)<br/>
[Modelli di consumer OLE DB](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[Riferimento ai modelli consumer OLE DB](../../data/oledb/ole-db-consumer-templates-reference.md)
